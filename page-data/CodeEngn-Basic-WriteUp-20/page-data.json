{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/CodeEngn-Basic-WriteUp-20/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#d8c8c8","images":{"fallback":{"src":"/static/272a5737466fd6e246df148c9b6c4667/44060/0.png","srcSet":"/static/272a5737466fd6e246df148c9b6c4667/9b061/0.png 51w,\n/static/272a5737466fd6e246df148c9b6c4667/8155e/0.png 102w,\n/static/272a5737466fd6e246df148c9b6c4667/44060/0.png 203w","sizes":"(min-width: 203px) 203px, 100vw"},"sources":[{"srcSet":"/static/272a5737466fd6e246df148c9b6c4667/f9c43/0.webp 51w,\n/static/272a5737466fd6e246df148c9b6c4667/f4dc5/0.webp 102w,\n/static/272a5737466fd6e246df148c9b6c4667/41a9d/0.webp 203w","type":"image/webp","sizes":"(min-width: 203px) 203px, 100vw"}]},"width":660,"height":399.90147783251234}}}},"body":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.18181818181818%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACXklEQVR42k3QS2vUUBgG4Oz9Kf4Vd4IbN4ILXagVRaG0iyoUFamlhdrWtjPTud+SzKRzyeTSSTLJSXKSc5KcJCdzaUUKLlz5F2QYLIVn8fLxwgsf82Kj+Hy9sP659X67sbnDfzkSt/b7X0+VvZJx0nZOOfi96R5yKN8nZXnaNK55+0YmfyCORiZmHj47fvTq7Mnb3OO1/MsP7Np29+kmu7GvbB1quxX3awm+3tXeHIDNPN5upN+E6wP5d937e5Yv7BdYRhRV4WLU65uipAxHiiip6lhXL/WxNhnrpmFawHZc6LoQesj3MULBEvRcH3nMr0V8lelXsx0aoQWFswQmAUgjOw1AElgEmWloE2QSZAZQDz09xibByyONHGZG52n4qcfec6w2jcMImRdco1EtlHLH1XKhUT1XRGHU56rF3I+DvXqlUMyfGJqyyHASOsyCwhv7fthnwvEDzw3TCNQrpS7bEHus2OPYeolvlgdCu1kpin1e4GvF/Emrdt7lWwQDZkEtMFiXm+8uOx99F1DiWrpsapLvaLahQOvS0kf2RNHVIQRjSxsZY3GyJC2XZzRISDJNUxonaeTEoUMJTCM3CZ0s9m7zLPEz4mWxN028aeJniZeGDjOniGArDkAcgDR0ImSpUg9MFEuXVamnqUPLkMFE4dtVgkESOncxWexFyCIYEAziwEauPpYHEQIYGuXckdBhCbYJtgtnR8jV48BeNVeYm5/pnOKrabAyp6jD1rhWhW9Xu1y9y9b4dpVrVdhm+bbzX8goojC8WD72ljzsSsPO0qAzGnRWWRGFu52VfxqJD9K3naY7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/272a5737466fd6e246df148c9b6c4667/c9b55/0.webp 165w,\n/static/272a5737466fd6e246df148c9b6c4667/cb011/0.webp 203w\"\n              sizes=\"(max-width: 203px) 100vw, 203px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/272a5737466fd6e246df148c9b6c4667/04c57/0.png 165w,\n/static/272a5737466fd6e246df148c9b6c4667/2efce/0.png 203w\"\n            sizes=\"(max-width: 203px) 100vw, 203px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/272a5737466fd6e246df148c9b6c4667/2efce/0.png\"\n            alt=\"start\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 프로그램은 Key파일을 필요로 하는 프로그램이다. 위 문구가 출력되도록 하려면 crackme3.key 파일안의 데이터는 무엇이 되어야 하는가\r\nEx) 41424344454647\r\n(정답이 여러개 있는 문제로 인증시 맞지 않다고 나올 경우 게시판에 비공개로 올려주시면 확인해드리겠습니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABPElEQVR42s3Qy07CQBgF4El8Gd9AUbFcI6l0WnqB0oBIfBDd6wsYExagS0EZcKs+gmBskQjsiAmMnTJSQsAxRo3uLDu/nMXJn5zNDw72lzVF0jXVSKeyRjqpyoaeVGVJgoIIt5WEKEtQFD5KxtBlCcI4ryfVlKYkRAEcHS7F+Wg+t7OX381lM0oCpjSF34pEgtzmui8aDoYDnH9tNRoKyBIMcf4N34rAxwQ+FuL84OS4VDmvnJ2WCoVCuVxG1epnagjVEPrVvy41hKqXF1f1eqlYBL1Oz3Unz/2++dCaTKeMsTf2h/l8zhjrdbuAUooxJoQ4DsHeDAYDSmmjcQcIIS/fbG8wxuOxe99sAsdxvM/+z9i27eFwiBfx8zDXdSmlr4sYjUaz2cwyTdBuP1qW2WpZ3mNZZqfzdHtz/Q6ydULbhQUauQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/c9b55/1.webp 165w,\n/static/9af08ad88c7e45cc18c9571bb6f88c1c/d8e38/1.webp 266w\"\n              sizes=\"(max-width: 266px) 100vw, 266px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/04c57/1.png 165w,\n/static/9af08ad88c7e45cc18c9571bb6f88c1c/b4ffe/1.png 266w\"\n            sizes=\"(max-width: 266px) 100vw, 266px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/b4ffe/1.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>그냥 실행시키면 다음과 같이 뜬다. Key파일이 있으면 문제와 같이 뜨는 걸로 추정된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+0lEQVR42k2Q227TQBRF/ZkQEpOChBBC4YkP4LcKSRyHNE1pLvb4FtvjuXlmPHh8mYS+o7RQdT0c7XOkvbV1rA9fv00mk8mnj18mn8dvh6M3A3s4sEePczgYvXn9JOzh4N3YtoeDK3s0Grx6fzUe20PLXa72+70zdxaOM5vNZtOpu1jM5467WMym05vVjeu6zmzuusvp9MfCcebz+c/lcnt///362ipLboyRUgohZCU552XJCKGcC0qZlJILwTm/iLKUQhJChBBVpQAAVp7neZaXJaeUJlGCMe77/vQCVvKigCXnjNE8h3/O577rtdZxHFlRFPuen2Y5zOH2fpskx77vuxdgTIIgyLIcFUUYhIQQpVRVVYf93krTLEszhHEBiwAECOGmabqu6/9DaRnHMUIYQuj7AADAhVBKeZ53MedZjjFmjCmlHh4ejDHPTmMMQiiKYoQKjEl6PCKEe2Pqug4AsCop2q5tm3/Uda21btu267r2EWPM6XR6Sjyfz8aYp2NRQAv43na3S4+p53me70dh6AOglGqaRuumbdv6Ea31c7TWuu97CKEF8/zgeQAASinG+LA/bLc7TMhvpXa7XRhGUspLySCM40QIobVOkoQQdvn23WazXq9vb9d3d78opUVRFBBSQp41Y4xSii5LwRhDCG02G8/zblarv11RIT8vF5f7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/112c34d65c8dd751ed07706e03476791/c9b55/2.webp 165w,\n/static/112c34d65c8dd751ed07706e03476791/f2908/2.webp 330w,\n/static/112c34d65c8dd751ed07706e03476791/cd572/2.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/112c34d65c8dd751ed07706e03476791/04c57/2.png 165w,\n/static/112c34d65c8dd751ed07706e03476791/d9ecf/2.png 330w,\n/static/112c34d65c8dd751ed07706e03476791/d7398/2.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/112c34d65c8dd751ed07706e03476791/d7398/2.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 프로그램에 대한 조사를 해 보니 아무런 패킹이 되어있지 않다. 이대로 올리디버거로 분석을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB7UlEQVR42nWQSW/UQBCFq92L3bbb9tjuxfs+48wQJQSJoAACCQ1iCBw4ceEC/ASu/HhkKyiJEE+tPnR11fdewc8fv87Ovp5ffqv0rf70O3/zXW+Paj6Z3Uc9n6LhOI1fzovjRX1q1TGM3iXxMf57QJtSKbnd1UaGyW5XzFmq3TBxpRHBhgKAY3uBizlFwmPMJvBQTTNqk0slCRCU91wJtDxbAAgBAkB53pdNU7ftfLYXIoClYCGELYtAXY95XlZNwSmDcvLb0I8A8DJhbYayGsbtNIz906vLJ4f9NI11XRmjwyiEqu7TVE3bIfZ97/Xb4EVHWwCFUAAoBqAQC1kLP+VOkqZSpp7nMkYty1ptt2OWFf3QEGCHD4fkRkMBYADwXS5KPM4d13UZYwitjtYbVlddXpT92Anq4s8X9kvjNITVNvcdbjtLeuwSSuiqO+DDhWVZMc/bTZzkVb+bWy9lNGLcdbizNlucEIwxppTeM++3rTNtJKc2zpqgl2gD4Ky19ac2TTcOJjNlWRRF/gjedZOUWmkV+wL21+XzZ2Hk8oD7iU/4krsq+i7LtFKpTINAPCK33UKetoOK5eH2St9UYvDELMImtIMFwokXWYhgDP+qaUaZqnEaEhHp96+864r2iMSEYMIoMAYANvxHfwDcaTBRd562vgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7419fa8db3633b577368ff16c87d18fe/c9b55/3.webp 165w,\n/static/7419fa8db3633b577368ff16c87d18fe/f2908/3.webp 330w,\n/static/7419fa8db3633b577368ff16c87d18fe/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7419fa8db3633b577368ff16c87d18fe/04c57/3.png 165w,\n/static/7419fa8db3633b577368ff16c87d18fe/d9ecf/3.png 330w,\n/static/7419fa8db3633b577368ff16c87d18fe/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7419fa8db3633b577368ff16c87d18fe/32056/3.png\"\n            alt=\"first\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열었을 시의 첫 화면이다. CRACKME3.KEY라는 파일을 생성하고 이를 읽는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGklEQVR42mXNTU/CMADG8bYM3Gi3Dtgco1s3unYvQtRExHgyHkzUZCyw8aZcOPn9v4EJejD4y//0XB5wqOqPslqU5Xa7a07WTbOq1/tqdagWx83ma7/b1/Wqrpt/gBqnIhIs8FgwghCCX1o44pz5Warcnv2zIoTAGZVN8qtpXqRJIhjzXdf1PKffv4xiKVMZcm73bMcZUEoty0IItf4ARXE9mUyzXColbNvCBJumYRhECCWVUErxkLFw5Ptez6bnz8d0liSLsXgV4h3CWwBuTt1FcRnHb3mxHA5fTPOJ0ucufsTkHuM5IXNKHzqdGfhU03iccs7DMEKoDYAGYQsAPQgSziMps4HjYWwBADXtotsluo51g2Biddr6N+7FLD5aSAMRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e25a9c07173b1f1d212af20c0549a157/c9b55/4.webp 165w,\n/static/e25a9c07173b1f1d212af20c0549a157/f2908/4.webp 330w,\n/static/e25a9c07173b1f1d212af20c0549a157/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e25a9c07173b1f1d212af20c0549a157/04c57/4.png 165w,\n/static/e25a9c07173b1f1d212af20c0549a157/d9ecf/4.png 330w,\n/static/e25a9c07173b1f1d212af20c0549a157/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e25a9c07173b1f1d212af20c0549a157/32056/4.png\"\n            alt=\"Text string\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>모든 문자열을 조사했다. 문제에서 보였던 문구가 있는 주소들이 존재한다. 이들에게 중단점을 걸고 주변을 관찰해 보았다. 다음은 401191주소지 근처이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAdElEQVR42gXB0Q7BQBAF0KtrZ3RDWMG6206riSjal0r9gVfx/3/jHHwtjxxTnlIa7DUXHZHOWGaAWNTb3bCPfYz3EK7rTa/Sem+iptqINPhY9eDT2sm62b9/ciOOByABJ4C6upRlFULtHAtH56hKEapmEf4Bm1QJoS0aq3UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f8dc312c0c33d63ebfee60030eca84a/c9b55/5.webp 165w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/f2908/5.webp 330w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f8dc312c0c33d63ebfee60030eca84a/04c57/5.png 165w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/d9ecf/5.png 330w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f8dc312c0c33d63ebfee60030eca84a/32056/5.png\"\n            alt=\"cmp\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CMP AL,1 이후 AL과 1이 같을 시 이 파트를 지나가는 것을 볼 수 있다. 다음은 40137F 주소지 근처이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA20lEQVR42n3NyU7DMBSFYfsmvh5iZ2icxo7j2E1LkCBISIhNF2zZAe//NIhhifj0b48OOZ2uIVzX9dq2+zQ93u8vc3z205PtHyhdKb0QshCS/i6lybk5zqNSIoS83cZDb4ZB13WJyACQ/MOnPPqU86J17eO6bUkrbWqjKlkUHEAWAEVRMoaInDFkjAPA7/jjvN6FHJbZHnrulu7cVV5VSkkhpKxGn0bvUk5+8nawxhhrrRCCfSOvKd24OAY/D0fy/oa7wwA4IDSUQOnbYzS6a5qfN0qBf0EpFefiEyj4EtcrB4wjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/778057592a633d9600967fc9b166d228/c9b55/6.webp 165w,\n/static/778057592a633d9600967fc9b166d228/f2908/6.webp 330w,\n/static/778057592a633d9600967fc9b166d228/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/778057592a633d9600967fc9b166d228/04c57/6.png 165w,\n/static/778057592a633d9600967fc9b166d228/d9ecf/6.png 330w,\n/static/778057592a633d9600967fc9b166d228/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/778057592a633d9600967fc9b166d228/32056/6.png\"\n            alt=\"function\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 문구가 뜨게 하는 부분이 하나의 함수로 이루어져 있음을 볼 수 있다. 함수의 시작은 주소 401362이다. 위의 401191 주소지 근처에서 여기로 이어지는 것을 볼 수 있다. 다시 401191주소지 근처로 돌아가서 CMP 구문에 중단점을 걸고 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 269px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.636363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArklEQVR42o2NTQ6CMBgF3wdU2tpSMBFoaWuE4m9CPILe/1ImGncm+lazeJOBdX0LHIAIjMAeaIchjbt2uxFy7awdvB/TFKM3pum6ViuZ53nB2P1xRwjeAWeiE9GNKBAJKddScs6JSAhRVZXWWinFGOOcF0WeZRmAZVnQO2uB4yt7BSx+7y2nlBBj6Farg1Knpr5o1Zfl+0FEH/guzylhcL1pjI1hnKew86ap/y8/AVSPDP2KjCIMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bd9c2466d07685164673b23d1a5ede04/c9b55/7.webp 165w,\n/static/bd9c2466d07685164673b23d1a5ede04/9fef4/7.webp 269w\"\n              sizes=\"(max-width: 269px) 100vw, 269px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bd9c2466d07685164673b23d1a5ede04/04c57/7.png 165w,\n/static/bd9c2466d07685164673b23d1a5ede04/98fe2/7.png 269w\"\n            sizes=\"(max-width: 269px) 100vw, 269px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bd9c2466d07685164673b23d1a5ede04/98fe2/7.png\"\n            alt=\"EAX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>AL은 EAX의 뒤의 8비트이므로 0E이다. EAX의 마지막 두 16진수가 01이 되어야 정답 판정을 받을 수 있을 것이다. 다음은 CMP AL,1 명령어가 있는 401188주소지의 이전 부분이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/ElEQVR42jXGy07CQBgG0G/qzLRz+9uR0hZoh96Q7lgZgQRXuDBGV+7UjTHx/d/ABGJyFgdNU4+bfj0v3ce3f3tKa2E2TjXKNNqOJptSFLiRuoypYigZW0VRwjkXIooirOra+5QMxd3k2tXMktNklHHKknZKKABSmmUz0Mw77/NFFdZhu90ulguEthvHfqqD+PqRr+fboGjKXEfpQOlEjBiAOKFd2Aw66TNf5Lm1tiyroijR923bN10xZ5+/9P6SBZ6MSRKk6mI1SrZk4BDSTnm15mzQydxqGUtHxlqNLDsLcQRO4/3+bvcs+Al4ADsAF+x4ySNwAvb/Dtf8Act2GQHR3efaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/c9b55/8.webp 165w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/f2908/8.webp 330w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/6407c/8.webp 599w\"\n              sizes=\"(max-width: 599px) 100vw, 599px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/04c57/8.png 165w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/d9ecf/8.png 330w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/43142/8.png 599w\"\n            sizes=\"(max-width: 599px) 100vw, 599px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/43142/8.png\"\n            alt=\"pop eax\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>POP EAX를 함으로써 CMP를 하기 직전 시점에서 스택의 가장 위에 있는 값을 EAX로 pop하는 것을 볼 수 있다. 즉 CMP하는 시점에서 스택의 맨 위의 값에 따라 키값의 여부가 결정된다고 결론내릴 수 있다. 이제부터 스택을 기준으로 분석을 하도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABDElEQVR42l2Ny04CMQBFbzsFwozzgnb6bucBQ0g0ISJEFy5Y4YaPMP7/PygaSfTkbO+58G4QjVSSp3k9Gbd5XWRZlqbzIs8ZSwA0TVBaee+kkvhHG0epVBdtuZDs/mEhZyy5wlhCCAFg7aof+hBDiKEoS0op+QUxjpyLNrpyIZP1xriE/K0LEYw1zhkheFHkP8Xb86aql+tVr12LOKQdQ0VAKUAJKEA4D0IqF6JxXindSKmUsc5pYxD8SjR8M3oTPJ6OpJ9gDeS4DqcAg9FhO9jOLjsn2lZ7L5Squ85U1RyXy0dZndp4bty5eHuv+tdMHzJ9vLPHqnsh5T6dncT0eZkcSrIHdsDjt7svPwFsDRrGDsXohgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/c9b55/9.webp 165w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/f2908/9.webp 330w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/ff4b8/9.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/04c57/9.png 165w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/d9ecf/9.png 330w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/32056/9.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/32056/9.png\"\n            alt=\"CreateWindowExA\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 384px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.242424242424235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABX0lEQVR42o2P227UMBRFncnNiT2xPUnsE18SJ3YmhbY/xROXEYyE6B/BA/DS9gerSoOoVAmxHrfO0t4HPdw//vr988f3ez/faX2y5gTwNcY7Y85te3Ljl6urb4M+d90nQj5K+XnyZwkflHyfpe8QgIprNGatiQjB+9lJ6fsepOwatt83e2sGUIrSWjzDD4InCbog+877SSlf1XwcjbUDF0YpULKjlHLOhBCMMSE4Y03DGiFYWZYXWWuIa9A6UnpY1xDXBdSCMSGkxhjX1R9whTEuMSaUZll2kZXs53kydg3xjdHgvW+7qSzrqsJ5nqdpWhR5lqZ5UWCMizxP/o5GSA8QwmLdFuNb78cYZ6nmXj7/zFhTE9K2B0oIY1zKnrFmt3shA8gQF+fWGK+nyYXghbAIvbj4B6Dksvhx3I7HG2vBuYFzg9AueaUnr6NhgG3bYrw9Hm+myS7L2B7cfzY/Abm0K4zZ20IyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/52e1fef7788a36491dd2301cd3b940fd/c9b55/10.webp 165w,\n/static/52e1fef7788a36491dd2301cd3b940fd/f2908/10.webp 330w,\n/static/52e1fef7788a36491dd2301cd3b940fd/e6f2f/10.webp 384w\"\n              sizes=\"(max-width: 384px) 100vw, 384px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/52e1fef7788a36491dd2301cd3b940fd/04c57/10.png 165w,\n/static/52e1fef7788a36491dd2301cd3b940fd/d9ecf/10.png 330w,\n/static/52e1fef7788a36491dd2301cd3b940fd/804b2/10.png 384w\"\n            sizes=\"(max-width: 384px) 100vw, 384px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/52e1fef7788a36491dd2301cd3b940fd/804b2/10.png\"\n            alt=\"stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CreateWindowExA 함수를 지난 후의 스택이다. 401159 주소지의 PUSH 0040210E WindowName = “CrackMe v3.0 - Uncracked”가 그대로 최종 스택이 됨을 볼 수 있다. 이제부터 40210E를 추적해 가며 관찰해 보도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABUklEQVR42j2Ly2rcMBhGf40944tsp/JIlmxLsnWzx3ZJCIE2kHZXSumuFEqzCMmu2+YJ+uolE8jh8G0OHzw//73//TQaN89+GM3x1wPbeuIviCe1q4+eZApLrU+UzZSO5F2aprgo8BkwRgmhKOMhWGOtuLzRrieUHJuatZTUBQBKkrLCOEuSEmNcFPDGskzjMFEmOKdpmkd+ycrorSL0sm07GmeHQa/rwnlzDuc8z0EpT5kQgiVpvnNzQaIkff0hdH5zMRjnOtlv2xqmELzXWkutYdncaDxjzbra0erd9x8X73G2ADCAElANEEND+InXqsqV5MbKVtRVleX5Hq6nu2n4TOlV113j3N7+/FatJ6ACWA+JhJ0EpKOdPcQy2as4lgi1AK928O/q66P9opqPwX7i/Yf9nydYPQQFnYHIATgAfzhsuDiV1VpVSxwHAI/Qi/8BKFYlZwkUTLkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/776414fcde6a39cfdfc381536c211848/c9b55/11.webp 165w,\n/static/776414fcde6a39cfdfc381536c211848/f2908/11.webp 330w,\n/static/776414fcde6a39cfdfc381536c211848/ff4b8/11.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/776414fcde6a39cfdfc381536c211848/04c57/11.png 165w,\n/static/776414fcde6a39cfdfc381536c211848/d9ecf/11.png 330w,\n/static/776414fcde6a39cfdfc381536c211848/32056/11.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/776414fcde6a39cfdfc381536c211848/32056/11.png\"\n            alt=\"entry point\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Entry point 지점이다. CreateFileA 함수를 지난 후 401037주소지에서 PUSH 20.0040210E를 하는 부분이 있다. “CrackMe v3.0” 뒤에 공백으로 되어 있지만 바로 아래의 4012F5함수를 지나고 나면 아래와 같이 “Uncracked”라는 문자열이 붙는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 514px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAb0lEQVR42jXBQQrCMBBA0Z/JDHEaqK12p4KgC10UEWsMuBV6E0/heTynK9/j9b7IKbOHA2whQeDPFp67pTWNrgdv25RSVJOuT/3K3RW+H8rM7szxymYkj4QJJrhBFXmqFpFiVmN8iJQQ7qpVtYqUH9uJCJv7SrYlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fdcc718fb78d221d1383ea97d490975d/c9b55/12.webp 165w,\n/static/fdcc718fb78d221d1383ea97d490975d/f2908/12.webp 330w,\n/static/fdcc718fb78d221d1383ea97d490975d/7a333/12.webp 514w\"\n              sizes=\"(max-width: 514px) 100vw, 514px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fdcc718fb78d221d1383ea97d490975d/04c57/12.png 165w,\n/static/fdcc718fb78d221d1383ea97d490975d/d9ecf/12.png 330w,\n/static/fdcc718fb78d221d1383ea97d490975d/dea13/12.png 514w\"\n            sizes=\"(max-width: 514px) 100vw, 514px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fdcc718fb78d221d1383ea97d490975d/dea13/12.png\"\n            alt=\"Uncracked\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수 4012F5함수를 조사하였다. 아래는 함수 4012F5이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 553px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.363636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqklEQVR42j3CWwqCQBQA0Osjysm5o6MTOjOahmZBGFmW9RNROwhX0APa/wbqq8OB1/Pxfn/q+k7xlOgrcY487Barc57fhGgJ2VPaMrZ1x41hrAEa2+6I01B3Z9sb8DlyP5yIhHlEykAlopqVZSqrZaqUiGOeZZGUpCigmoNpWgAj+NM6TvU0ijJExjyfDh1xuPC+DzzOPB+RcR4gYhCaWhmWNQAgAAaA+fsFvq8RO6Bz3X4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9541758657cab3738bddf2ec69347bde/c9b55/13.webp 165w,\n/static/9541758657cab3738bddf2ec69347bde/f2908/13.webp 330w,\n/static/9541758657cab3738bddf2ec69347bde/e58ce/13.webp 553w\"\n              sizes=\"(max-width: 553px) 100vw, 553px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9541758657cab3738bddf2ec69347bde/04c57/13.png 165w,\n/static/9541758657cab3738bddf2ec69347bde/d9ecf/13.png 330w,\n/static/9541758657cab3738bddf2ec69347bde/74cfa/13.png 553w\"\n            sizes=\"(max-width: 553px) 100vw, 553px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9541758657cab3738bddf2ec69347bde/74cfa/13.png\"\n            alt=\"4012F5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“CrackMe v3.0”이라는 문자열이 들어 있는 40210E의 뒤에 Little Endian 방식으로 55202D20( - U), 6172636E(ncra), 64656B63(cked)라는 문자열을 쌓고 있다. 이 문자열들은 함수 4012F5 이전의 과정에서 온 것으로 보인다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.72727272727272%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABwUlEQVR42mWS3XLbIBCF10YCZAn0jwQyIAlL/otb15m005le56KdiXORtI/Q93+DVm4ynqTfnDs47GF34fH8q6qV1SrTNnx8Yk1AlzSo6KJZ4NqD2F8WlaTEcB4iBO+opamlGkdnelcfjkqXiUgykQmVL2IMyEtYmseMUZqnCcb4jVlrV4o6S2NEI88NhLx73O/6USlpu3bcrAl5Mc8uQGsG1eilqgKeoe02LgCHl+MXszeu963rhnH4dDru99uus9poIco45iD1UJbVyrXSrYKHM3Oe1wMks9kkAOSbQloeCcZqJaWUURTRIEAITZUPuheVkLJIC3b7fMAdghogB5j/q+4TTCmeU+IhNH/N/Pqnn+6szf3Q/SiHe/T7yd/c4M0RqwMN7rB/C3Ai5CuhdxH7RoMv89kR4ONFHyYt9Y2pnG23SzOudntje8pTmuRhJCjNABKACAADEIAFQAAQXtXblVVKqYJnOdsdmCRTZnrtttbWWCVE1jRVmrLZNTSA68amrDhnQZyS02dlaz/wMZm4XPPGcdd1bTMhizx/M0ez7FUh+s6a9Wbx/SHrEu543MaJ4940M78Kk8L3yH8L8Jc/hcIrtBL19GIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/85208abf9c12bde8ee6f04585c086339/c9b55/14.webp 165w,\n/static/85208abf9c12bde8ee6f04585c086339/f2908/14.webp 330w,\n/static/85208abf9c12bde8ee6f04585c086339/ff4b8/14.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/85208abf9c12bde8ee6f04585c086339/04c57/14.png 165w,\n/static/85208abf9c12bde8ee6f04585c086339/d9ecf/14.png 330w,\n/static/85208abf9c12bde8ee6f04585c086339/32056/14.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/85208abf9c12bde8ee6f04585c086339/32056/14.png\"\n            alt=\"restart\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다시 실행시켜서 처음부터 한줄씩 실행시켜 보았다. CreateFileA함수를 지난 후 CMP EAX,-1을 하여 같지 않으면 401043주소지로 jump하는데, 40210E의 문자열 뒤에 Uncracked라는 문자열이 붙고 401041주소지에서 JUMP가 발생하여 ReadFile함수를 실행하지 않게 되는 것을 확인하였다. 인위적으로 CreateFileA의 인자로 들어가는 “CRACKME3.KEY”라는 이름의 파일을 생성한 후 임의의 문자열 “12345”를 해당 파일에 저장한 후 다시 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 94px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.8723404255319%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADKUlEQVR42lVTWXPiRhD+eoRuxLHGYCNxCGEuAbYRtzEgDsMas9i79iZV+7aVyltSlcf8+9SM1lXOV/3Q0zPfzNc93cjl7Vaj5jgFx75wSwUQdKAM2MIcYTZQAHLCvwMyQBYCvaCzXi/D9SZcr8LZFECR6Ag8AVtgBxyBB2ANBMAK+CnizxE5k8212+2W7/tt3y0XGGPRy8UPj0dOHbgGbgAPqEZkWdEs09Q0PRE3dU0DQQUSgAaYwCcgDSSBFCCBbyWBOHhqHP3R4MdvX64azeFkctytwK+nf4E34A/gL+AfobMHPAJ/iuVavM9RcsvjUa9YKl816v3bDojrPIrTY2Av0h4Lwdci+Q1wL/LiIEmRZUXXdE3VZFkhIhKa5XcjYTLAhKMBMbHk8NvNzWbpd7uL+8ndKAD/EpoDU2ABzISEobA9MAf6Iu5H5Hanud6E3V4QhvPlbAzgkmjL2JaxMePOd8YeJWkhSUfG5ozuGNszdsP1Cdk6h6Gpmq7rjPGwKQobiY+KLAOKMON9KyqYGwTXt/1ex2/WqxUApmWVq27JtS/ydqVacwqO320PBjdOyS44eadcLFUKuewZJ48mg7e309Pzy/e3l+Pjluecy4bhXTjv+1f16fR+d9i+PIa/vx76QWfW60wng3A1bnsuJyuqlk6nk8lU0rISSYsRmCzr8bhq6IaViCeTimmYqZR19klPJBRDV824bhiqLoSfnedct5jJZfN2vlQsQOSTF61/LtrrUnToNdACOqJtLeDsfTC6u4f5zTBYh8vNagHGjx4YeybqEd0SC4n+FhUOGZ2IHoheGB2iaucubb9Zc4qlStnNX/BRs4hqhArBFW3oAA2gIswWU1Ej+vXPUkw2DF03dDkma5rK+0mSZE2VFCWmqhSLyYrCZMW0LN2MG/G4rCiQJMQkTh5Ohq/fvpxevz4ddvvPvNrnmcxsPp7NgqZXrnnl3mD8vN9+Pn1dPpx2+3B5v1gtZ5PbFid7Ve9+Pg0Go/lk7LfqAFLptO83Wg2vUip0/Kbn1UeDoFKtebWWY1/6rW6367ebvyYafBYIHyEiRPS/SISP5/4DIG5laOul9KIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/92edcb95c24f6fed90dbae32c0291b2d/1edfe/15.webp 94w\"\n              sizes=\"(max-width: 94px) 100vw, 94px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/92edcb95c24f6fed90dbae32c0291b2d/37939/15.png 94w\"\n            sizes=\"(max-width: 94px) 100vw, 94px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/92edcb95c24f6fed90dbae32c0291b2d/37939/15.png\"\n            alt=\"EAX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX가 FFFFFFFF가 아닌 1E4가 됨으로써 401035주소지에서 jump를 하여 4012F5함수를 실행하지 않고, 뒤이어 401041주소지에서 jump를 수행하지 않아 ReadFile을 수행하는 것을 관찰하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/UlEQVR42j2PO0/DMAAGv8R1IbRx2+BHnNhOmocbUIqEVAhqWFgpDEhIiF/QEfX/LyzQ20+6Q5Yra2oh06pe65Qz6Zbez+QUArgGAvwzKcuuLK2xVinJWDwhBDqTxlRSppwn0QUlTFLvpUsQAfRsgpBp3fZlXWS51qnYbBrOE/R9t93uVLq2rsmlWd480bevyvs45bHmCyUivgSmIWFtcWdXSoq8KDyLBQkvcTr9HI8nrQ9N+1G69+1wuP9+jZqRdSO7HRfr53k2hPQB2LPJyyocKNkHwQDsEDwiy5SxNRfKOWdSqfuOf45wCCogQRCew8NZLK7ms5gxSv9+fgEOtRueWS2QSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/c9b55/16.webp 165w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/f2908/16.webp 330w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/ff4b8/16.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/04c57/16.png 165w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/d9ecf/16.png 330w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/32056/16.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/32056/16.png\"\n            alt=\"after ReadFile\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ReadFile 함수를 지나온 직후이다. 아무것도 없던 402008주소지에 CRACKME3.KEY에 입력했던 ASCII “12345”가 들어 있다. 401066주소지에서 CMP를 하고 jump를 수행하는데, 4021A0 주소지에 5가 들어 있다. 12와 같지 않으므로 401037로 jump한다. 그렇게 되면 위에서 수행하지 않았던 함수 4012F5를 수행하고, 전과 같이 “CrackMe v3.0” 문자열 뒤에 Uncracked 문자열이 붙게 된다. 4021A0은 ReadFile의 인자로서 들어가는 pBytesRead였다. CRACKME3.KEY파일에 들어가는 문자열이 16진수로 12, 즉 18바이트가 되면 이를 우회할 수 있을 것이다. CRACKME3.KEY파일을 다음과 같이 수정하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 176px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.51515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABMklEQVR42j2N206DQABE+Q+thYW9QXeBZekCRq2mGl+MMWmVai92LS0VqLWJ/2+wick8zDycM8buq9IfC5WISHIRMRGxtoielL6IeCR5rEKViP/0VShj//rmom62xv67ub0bdEF3vlqUdVnoZVXpzb6pmmL2/tIcdg/3QwucQGRCZAK7k2ayr0ILnOaTsbEpV54HIbZiJdIszrJYJWFy3o+TMEkjlUrmYQeeQWQibNl2h/uU+xQiMxTMGA4vqetwn/YYZhxR1+4xwjghBLgeJNRhDMs4kJL7Ab0apAhbCFuYAIQtIwjI0+hxOh2/r3Rdab18zd/yw09TFnO9nE0Wk+168ZyPivV8+6nrZgORSaiNCcAEGH96G5N2I2IRasPW3d5S1yGuQ13n+OZ6KMvkETvCvwgLUWFYszdFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4f4f6ff0e150f768aff7c309ac90673e/c9b55/17.webp 165w,\n/static/4f4f6ff0e150f768aff7c309ac90673e/eb777/17.webp 176w\"\n              sizes=\"(max-width: 176px) 100vw, 176px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4f4f6ff0e150f768aff7c309ac90673e/04c57/17.png 165w,\n/static/4f4f6ff0e150f768aff7c309ac90673e/06437/17.png 176w\"\n            sizes=\"(max-width: 176px) 100vw, 176px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4f4f6ff0e150f768aff7c309ac90673e/06437/17.png\"\n            alt=\"CRACKME3.KEY\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우회가 되는 것을 확인하였다. 계속 한줄씩 진행하던 도중 다음과 같이 문자열이 변형되는 것을 발견하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.363636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAsElEQVR42i3CPQuCQAAA0PvwTD1PQ9PzW89QhKQhiVRKaC+i2qOhoSWqpd8fQY8HPqF3j/LA85M0in1ebpf5uaXxiJYaFSrLNMVGAACZsAmWKPiD8Bf0dbWaNZyLfFqlYV4My+C4QGIkV4y4OpF0glVJkhGyddNnJueeME1uGK6ijMHj/bzeXmG4z7JDIXZOfUo2Fy8eNKejtGN6bxiNZc0hHBDsMe4IWWPcI9RCuPoCoqgTekPVml0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/c9b55/18.webp 165w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/f2908/18.webp 330w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/ff4b8/18.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/04c57/18.png 165w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/d9ecf/18.png 330w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/32056/18.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/32056/18.png\"\n            alt=\"after 401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수 401311을 통과하자 402008주소지에 ASCII “123456789abcdef012”라고 입력되어 있던 문자열이 앞의 아홉 바이트는 모두 p로 바뀌었고, 열 번째 문자열부터 다섯 바이트는 변형이 되었으며, 나머지 바이트는 유지되었다. 아래는 함수 401311과 함수 시작 시 레지스터 상태이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/19.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/19.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/19.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/19.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/19.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/19.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/19.png\"\n            alt=\"reg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>문자열의 변형은 XOR 연산으로 인해 일어난 것임을 알 수 있었다. EBX의 일부인 BL을 41로 채우고, 이를 1씩 증가시켜 4F가 될 때까지 반복시키기 때문에 앞의 14바이트만 변형이 일어나고 나머지 문자열은 그대로 유지되는 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9klEQVR42l2OWU7DMABEJ7YTO7GdZilZnDhbqwZaxFZVrYSAj4K4Qi+AED0EZ0etBB+M3kjvZ6TB97w7VsNQGGvrwZp8+1y87tMikIVWWmqtJxMSRQCIH8RhqLRW5yoAmPZNWPVtXvZt05hML27S3UaVxMkd4hLiEErB2GksZaJUkKZpnMRSSq0VluOs7xZ9aS/Hcd7ai/WjedvHVoja9wLBufA8ATiAy5hmzPU87rqcMpdRhqapsswOxgxdKQMSTavV6rrOEk6p8JjvM87J6SEoIPAvx6/Pw+Gjr95N/gLctrOHbvOkqh3CK4RL4O6XNbA9y/0fPy3pF0D9yWBtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/078b816b0464797335a26e8e4019c9bb/c9b55/20.webp 165w,\n/static/078b816b0464797335a26e8e4019c9bb/f2908/20.webp 330w,\n/static/078b816b0464797335a26e8e4019c9bb/ff4b8/20.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/078b816b0464797335a26e8e4019c9bb/04c57/20.png 165w,\n/static/078b816b0464797335a26e8e4019c9bb/d9ecf/20.png 330w,\n/static/078b816b0464797335a26e8e4019c9bb/32056/20.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/078b816b0464797335a26e8e4019c9bb/32056/20.png\"\n            alt=\"return\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수가 끝나고 리턴한 이후이다. 어떠한 과정을 거치고 AL의 값을 AND연산한 결과를 바탕으로 jump를 수행하는데, 이 분기하는 지점은 위에서 Uncracked를 띄우는 함수 4012F5를 지나가는 곳이다. Uncracked가 뜨지 않게 하기 위해서는 AL이 반드시 1이 되어야 한다. 주소지 40109F에서 jump가 발생하지 않게 하기 위한 조건을 위의 어셈블리어를 분석해 가며 조사하였다.</p>\n<p>| XOR DWORD PTR DS:[4020F9],12345678 | 4020F9 주소지에 들어있는 문자열과 12345678를 XOR연산을 시키고 있다. 주소지 4020F9에는 4C7이 들어 있으며, 12345678과 XOR연산을 한 결과는 123452BF가 되며 이것이 주소지 4020F9에 담긴다. |\r\n| ADD ESP,4 | 스택을 쌓는 과정이다. |\r\n| PUSH 20.00402008 | CRACKME3.KEY의 문자열이 변형된 결과인 ppp~f012 문자열을 스택에 쌓는다. |\r\n| CALL 20.0040133C | 이 함수를 통과한 후 EAX에 32313066이라는 값이 쌓였다. 주소지 402008의 맨 마지막 4바이트가 little endian 방식으로 저장된 것과 같다. |\r\n| ADD ESP,4 | 스택을 쌓는 과정이다. |\r\n| CMP EAX,DWORD PTR DS:[4020F9] | EAX에 있는 32313066과 4020F9 주소지에 있는 123452BF를 비교한다. |\r\n| SETE AL | SETE은 Set if Equal이다. 위의 비교대상이 같다면 AL을 1로, 다르면 0으로 세트한다. |\r\n| PUSH EAX | 현재 EAX에 있는 값을 스택에 쌓는다. |\r\n| TEST AL,AL | AL값끼리 AND연산을 진행한다. |\r\n| JE SHORT 20.00401037 | 결과가 0일 시 jump를 수행한다. |</p>\n<p>결론적으로 jump를 수행하는 40109F에서 jump를 우회하기 위해서는 4020F9에 little endian으로 들어있는 아스키 코드와 CRACKME3.KEY에 저장되어 있는 18바이트의 문자열 중 마지막 4바이트의 아스키 코드가 일치하면 된다. 한편, 주소지 4020F9는 CRACKME3.KEY파일에 들어있는 문자열을 변형시키던 함수 401311에서 영향을 받은 곳이었다. 어떤 방식으로 영향을 받았는지 다시 확인하기 위해 함수 401311을 다시 조사하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/21.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/21.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/21.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/21.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/21.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/21.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/21.png\"\n            alt=\"function 401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>반복을 진행하며 EAX에 있는 값을 주소지 4020F9에 더하고 있는 것을 볼 수 있다. 즉 최종적으로 4020F9에 들어가는 결과값은 CRACKME3.KEY의 앞 14바이트에 어떤 문자열이 오느냐에 따라 달려 있다고 볼 수 있다. 정리하자면, CRACKME3.KEY에 들어 있는 문자열의 앞 14바이트가 함수 401311을 통해 생성된 4020F9 주소지에 저장되는 값을 0x12345678과 AND연산한 결과가 CRACKME3.KEY의 나머지 4바이트와 일치하는 것이 정답의 조건이 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.909090909090907%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGElEQVR42o3GvU+DQBzG8R+98n4c5Y6DK1IxEEQ4XqqT0cHEOBhpdXJoQicTo3+Ak6NDq4N/s7GJg3HxkyffPEAI9iaY0iiOM9vWhfCEcH3uWCMwn17w2ysWSJ0CBAAhwAh+2W62H+/bzeazbZ9VrT9IVlNxHwR3jrMs0otOXpXl4yy+5f6SkN7zFtjpXbenbIHtGxjWw3pYDcPDUbHQ9DpJLjk/Mwypqk2cnubyPMuuLauxrFrTpWHU+neladaqKsGjE+5PmB/vz1JCNM6JrisIAVLAzY9ZV0mZMWorCozHgNCuPwfaeds01bzruvlJVVVVWRaHRZ7njPlTEcVRxAMRhoJS9ncQ7UWc+4zSMOQY2wCAduAfvgCtiCWOe/HtgQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/01e59951367951a4c336595cdf49838c/c9b55/22.webp 165w,\n/static/01e59951367951a4c336595cdf49838c/f2908/22.webp 330w,\n/static/01e59951367951a4c336595cdf49838c/8efa6/22.webp 393w\"\n              sizes=\"(max-width: 393px) 100vw, 393px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/01e59951367951a4c336595cdf49838c/04c57/22.png 165w,\n/static/01e59951367951a4c336595cdf49838c/d9ecf/22.png 330w,\n/static/01e59951367951a4c336595cdf49838c/d72ec/22.png 393w\"\n            sizes=\"(max-width: 393px) 100vw, 393px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/01e59951367951a4c336595cdf49838c/d72ec/22.png\"\n            alt=\"401093\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우선, 주소 401093 지점 이전에 4020F9 값을 EAX와 같게 조작해 주고 경과를 관찰해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.90909090909091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAeElEQVR42mPIEBcKk1USEROREOfn42NVt1fiUeNklmVkEGFgYGKAASY2dg4OTgYuLiY2NkZmZgZOTkZ2diaGypyMuNA0EVFndXU/CUk3/sB0Xl0rBlldBgFDBgYDMNJnYDDi4LDl4DDj4bVlZzdnZTHh4bVlYzMDAJhlC6EjcRqdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f005357d884b0a2ca2d4d08b557bec17/c9b55/23.webp 165w,\n/static/f005357d884b0a2ca2d4d08b557bec17/f2908/23.webp 330w,\n/static/f005357d884b0a2ca2d4d08b557bec17/ff4b8/23.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f005357d884b0a2ca2d4d08b557bec17/04c57/23.png 165w,\n/static/f005357d884b0a2ca2d4d08b557bec17/d9ecf/23.png 330w,\n/static/f005357d884b0a2ca2d4d08b557bec17/32056/23.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f005357d884b0a2ca2d4d08b557bec17/32056/23.png\"\n            alt=\"bypass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>JE 부분에서 jump가 일어나지 않았고 CrackMe 문자열 뒤에 Cracked가 뜸으로써 우회가 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB10lEQVR42o3R4W/SQBQA8P5vzokmxphlsolssGXGRMMgsyP+S/4HfPCTSmHABoVCe+21lAormA561/ZazPoMxeiSscRfXi7vPrzce/e41/vpg2wms5/OZjLZzN7eq93D7JujXPb5s1Rqe+vpk8f3I7W9ld7d2Xn5gisWC+Xzj2el03OePyudloqFMs9/KvMnx/mjXO44vyHyhwfFwod3b0+4yWRMCFmszF3XJYS4ycV7GKWUMabrOkcpAYA4jmElvl1Zn0mWuJPGSXYLANOpzbnuAgBms97E+goxIIT6A7nbvkIq/mGNZakvdjqdtnjVvNSwbo3MkWUtl0sAsK+vOUpcAGh9eS98frSMfvUlSUVI1TSkoL40kHo9We7rWG9eXIptEWMjTrr78zKlFACIMyQ/9WXEoihiLAxYEIYhC0PGWLjCfD8IAhaG0d8Z18V3Z/4v/4qnth0EASGEUup5dOP3rtfh+74f+K672kYURYZhcJZlLRaLG8e52WQ+n9u2jRAaj8e1mlCtCsZwiDEeDAaqqnKz6ZQx5nmef4/neYwxx3G63Z5pmtXv3yqVioKQLMuiKI5GJieKHYyx+gBN0xRFaTQatVqt1Wq1ms16vS4IgiRJjcbFb4vlU0tn1OHbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/33c2430dc25e7c2dbd0349e00b315937/c9b55/24.webp 165w,\n/static/33c2430dc25e7c2dbd0349e00b315937/d8e38/24.webp 266w\"\n              sizes=\"(max-width: 266px) 100vw, 266px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/33c2430dc25e7c2dbd0349e00b315937/04c57/24.png 165w,\n/static/33c2430dc25e7c2dbd0349e00b315937/b4ffe/24.png 266w\"\n            sizes=\"(max-width: 266px) 100vw, 266px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/33c2430dc25e7c2dbd0349e00b315937/b4ffe/24.png\"\n            alt=\"good work cracker 2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>단, 완성된 창에서 “Cracked by: CodeEngn이 아닌 다른 문자열이 들어가 있다. CodeEngn 대신에 들어가 있는 문자열은 CRACKME3.KEY 파일에 넣었던 문자열의 앞 14바이트가 변조된 값이다. 변조 과정은 XOR 연산이었으며, XOR 연산은 역연산을 해도 같은 결과가 나오므로 변조 전의 문자가 무엇이었는지를 다음과 같은 과정으로 추적하였다.</p>\n<p>| CodeEngn 문자열의 ASCII 코드\r\nC = 0x43   o = 0x6f   d = 0x64   e = 0x65\r\nE = 0x45   n = 0x6e   g = 0x67   n = 0x6e</p>\n<p>이 CodeEngn의 아스키 코드를 41부터 1씩 증가시켜가며 XOR 연산을 시킨다.\r\n결과는 아래와 같다.\r\n0x02 0x2d 0x27 0x21 0x00 0x28 0x20 0x26\r\n아스키 코드 0x21 아래로는 문자로 표기할 수 없다. |</p>\n<p>9번째 바이트부터 14번째 바이트까지는 없어져야 한다. 여기서 잠시 함수 401311을 다시 확인해 보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/25.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/25.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/25.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/25.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/25.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/25.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/25.png\"\n            alt=\"401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>40132A에서 AL이 0과 같을 시 함수를 바로 빠져나오는 것을 볼 수 있다. 즉 아홉번째 반복에서 BL값인 0x49와 XOR 연산을 하였을 때 null이 되는 것을 아홉번째 바이트에 들어가도록 하고, 10번째 바이트부터 15번째 바이트는 아무 문자나 넣어도 상관 없을 것이다.  맨 마지막 4바이트는  위에서 4020F9 주소지에서 연산했던 과정과 같으므로 위와 같은 과정을 통해 찾았다. 이로써 CRACKME3.KEY에 들어갈 문자열의 아스키 코드 16진수 값은 아래와 같다.\r\n02 2D 27 21 00 28 20 26 49 ?? ?? ?? ?? ?? 7B 55 34 12</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABnUlEQVR42k3PzW7TQBAHcL8YQo1E+RAnBISKp+AVKo4IDqVN1Z5RVYkKeAAkcKPaXrdNkzg5UNvr1oqd2E7WdsruZj9REoH4aTSay8zob/j+4e3t96qmWTYpigKhUkq5t7v79Mmj11vNl8+fvWq+aG41G42Njfv3/tXjzQebDxtGmg7reoIx5ZzrFaWU5/Vt23Jd4ALn/Ny9cIF1dmbbFnBs27La7VMXgG9fvhqzWX13h7Msq+dzSgmhBCGU5/nqClNKccYJJkJIISQlhFGmpNRa30SRUUyLsiyrqirLEiFUVdV4nI7HGVtUvR9vsgR2e/1erz8cDAeDweVl5wK4cTzSWkMYGtPpdL25Vtf1ZEVrOZ9BzqiUSgjBOZdSKrWcGWPLzzeRkef57D8IlWmaxHEshGRcLRhb/EWXqQjnHGMshLi+/mUQSrTWchVjjXNeFAUhBOPfeK1ettFoFARB+7QNYRQEged5xtGn4/fvPhwcHuzv77VaH3d2Wtvbb09OPidJ4vt+GIYhDMMshBHsXnUBAKZpOo7T6VyZ5s8/Vp+WkjQ8tgMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/886453b6d860edfc7633b1fc04785ff2/c9b55/26.webp 165w,\n/static/886453b6d860edfc7633b1fc04785ff2/f2908/26.webp 330w,\n/static/886453b6d860edfc7633b1fc04785ff2/7f61c/26.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/886453b6d860edfc7633b1fc04785ff2/04c57/26.png 165w,\n/static/886453b6d860edfc7633b1fc04785ff2/d9ecf/26.png 330w,\n/static/886453b6d860edfc7633b1fc04785ff2/e17e5/26.png 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/886453b6d860edfc7633b1fc04785ff2/e17e5/26.png\"\n            alt=\"cracked\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>제출한 정답: 022D27210028202649DEADBEEF007B553412</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"a157c370-0da9-54f3-8722-7154190cca2c","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-20/","title":"CodeEngn Basic 20","readingTime":{"text":"14 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}