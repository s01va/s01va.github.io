{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-00/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/36a459e9efc737fe6e47df4ce8d4367a/f742d/0.png","srcSet":"/static/36a459e9efc737fe6e47df4ce8d4367a/cef89/0.png 55w,\n/static/36a459e9efc737fe6e47df4ce8d4367a/63f69/0.png 110w,\n/static/36a459e9efc737fe6e47df4ce8d4367a/f742d/0.png 220w","sizes":"(min-width: 220px) 220px, 100vw"},"sources":[{"srcSet":"/static/36a459e9efc737fe6e47df4ce8d4367a/4ad21/0.webp 55w,\n/static/36a459e9efc737fe6e47df4ce8d4367a/9d129/0.webp 110w,\n/static/36a459e9efc737fe6e47df4ce8d4367a/bef87/0.webp 220w","type":"image/webp","sizes":"(min-width: 220px) 220px, 100vw"}]},"width":660,"height":399}}}},"body":"<p>BOF의 OS의 종류와 버전은 LOB의 VM을 통해 Red Hat Linux 6.2라는 것을 알 수 있으며 리눅스 환경이므로 ELF 파일구조를 사용함과 어셈블리어가 at&#x26;t 문법임을 유추해 낼 수 있다. 그리고 아래와 같이 i686 아키텍처이므로 32bit 메모리를 사용함을 알 수 있다.</p>\n<p><img src=\"./images/0.png\" alt=\"arch\"></p>\n<p>LOB 풀이에 사용한 쉘코드는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\x31\\xd2\\xb0\\x0b\\xcd\\x80</code></pre></div>\n<p>25bytes shellcode(execve(“/bin/sh”) 사용)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\xd9\\xc5\\xd9\\x74\\x24\\xf4\\xb8\\x15\\xc3\\x69\\xd7\\x5d\\x29\\xc9\\xb1\\x0b\\x31\\x45\\x1a\\x03\\x45\\x1a\\x83\\xc5\\x04\\xe2\\xe0\\xa9\\x62\\x8f\\x93\\x7c\\x13\\x47\\x8e\\xe3\\x52\\x70\\xb8\\xcc\\x17\\x17\\x38\\x7b\\xf7\\x85\\x51\\x15\\x8e\\xa9\\xf3\\x01\\x98\\x2d\\xf3\\xd1\\xb6\\x4f\\x9a\\xbf\\xe7\\xfc\\x34\\x40\\xaf\\x51\\x4d\\xa1\\x82\\xd6</code></pre></div>\n<p>/x2f가 없는 shellcode</p>\n<p>그리고 LOB의 default shell(bash)의 버전이 낮아 /xff의 입력을 /x00으로 받아들이는 오류가 있으므로 bash2를 사용하도록 한다. root 권한으로 이를 한꺼번에 바꾸도록 한다. root의 패스워드는 hackerschoolbof이다. root로 로그인 후 /etc/passwd를 열어 bash를 bash2로 모두 치환해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 487px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.7878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABx0lEQVR42oWT65KiMBSEVYRdwEACOdckKEF9/0fcCuPU3qyZ739Xd59ODtfrQogAnoWIkJmsHc0wTJMDxKZpDl9wfzxVBBEQQENIKbmduj4fvmVdMyH4eRZhYiLmGCMitG37vfh2uyKi9zMVKTGzqhChqDjnmh9N9cnpdPrPOa+qKsIiQogadFkiIYYYYlBEsNY656Z56vv+X3HOGT6c98DeexHRIBo0xjhN7uvOKzMDeEQsbQGQOaWoyqKqylV1Ou68F+/X9gDgAVRZNTAT7rN1XXf8wvnxfIgo+CImwtsrCKhqWtLk3OXSt13X9/0b823LokpEIhKClsBBrXVt+7Nt22Gn6zpjTNPU53N1PBx+t8h5E2FE3B+JhhC8B2JGBGbxfp69JyYP3gyDGYa/3Lf7FmPY1yqklEIIMaUlLarl4CyMhNZZ66ybnDHGOTvNc1kub1lVuOxcbu69jzEuKRGT7klE5WIuF2OaulBVp/NOVVXFuYi5dFaV2XsWXpYlphiCIkGI4X6/T/P0ivqZu9Quv2pfhYj2sUrz14Mr5uomN1p7Pr/7J2su3NZrXjM9cYTBjtaU0wx2HJ1zbdvWdW2thY9Wf/AL9kc5L21tMx0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/989ac234ac71783cbcb20e02fe84f6cc/c9b55/1.webp 165w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/f2908/1.webp 330w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/9d50c/1.webp 487w\"\n              sizes=\"(max-width: 487px) 100vw, 487px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/989ac234ac71783cbcb20e02fe84f6cc/04c57/1.png 165w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/d9ecf/1.png 330w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/7b439/1.png 487w\"\n            sizes=\"(max-width: 487px) 100vw, 487px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/989ac234ac71783cbcb20e02fe84f6cc/7b439/1.png\"\n            alt=\"bash2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음은 C언어의 stack frame structure이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 494px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 146.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADIElEQVR42oWU2W7jOhBE8/9/lQTIU4Ib2EY2ixItWqTEnRQXbZYHFhNP4pm5Pg+GALnUZHV13/R9Twi5u7tbr9ebzeb19XW1WpVl2TRNVVV93x//zc3xeDTGYIyNMdM0DcMwjmO3oLWOMV4Rc86zLLPWSimVUnLBGEMp7bruilgptV6v53m+eBdjvH5srTXGWErJOU9lhRBt22qtq6oihFhry7IsigIhtN1uKaWfYq01YwxjTCnd7/fNwn6/d85Za9Od53k+LKSH8xk/xUmGEEpiQkiM8UI8z/MwDPPCNE2Hw+Hz2EIIYwznXGttjFFKxRiVUhBCpRSl9Onp6fn5+b+FLMsQQkqpk7htW8aYUspa27Zt8txamxp2PB77vrcLzjljzLkFN13XCSGUUqmmtVZrnVqltQ4h/J/bQggAAMZYa805r+vaGDMsaK3zPPfe8wUhRLr5b8PyPN9sNk3TCCE4503TKKVCCOnOGOOiKG5vbx8eHj4+PqZp+lGZMVaWJcY4ZatpGmttyqkxZrvdOueklNbaP1P0mTAIIUKILKQ8JP+dc+e//l3MGAMAQAh3ux1cKIpiv1BVFaW0bdvdbielvPjE51QRQowxjDHv/blnlNIQwjAMh8NhHMeLC5/E0zQppYwx3nvnXIyxXfDeCyGuTJX3nhDy9va22+0AAO/v70IIvUAp9d6n5Nd1rbU+HA4/xKmBnPMUT2tt2gfTNDnnuq6z1qbYhhAuPLsJIRBCIIQY45Tk82wSQrqu45zv93uxcFl5HMe6rl9eXhBCEMLtdpscppSm6e37vus67/2fi+EkJoQ454ZhSJNwdjWEUFXVarW6v79/fHwEACilvnfr5DaEMM/zqqoQQkVRMMbSDFFK8zynlFZVlYwYx/FHZWttUkop27ZNHU6/yctzvP6SsLquAQBpmMIXMcZpmrTWV/ocY8yyjHP+3Y9xHKWUIQTGmBAihJAsbJrmu+GnZVAUhVpI/ZBSJqvTeDrn+r43C1rry2wrpQAATdNkWZbnOYQQABBCSJvsyt6OMVZfIITKsowxpt5O05RKzV98F/8CAspxhm3KR+sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/c9b55/2.webp 165w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/f2908/2.webp 330w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/32f69/2.webp 494w\"\n              sizes=\"(max-width: 494px) 100vw, 494px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/04c57/2.png 165w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/d9ecf/2.png 330w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/d72d4/2.png 494w\"\n            sizes=\"(max-width: 494px) 100vw, 494px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/d72d4/2.png\"\n            alt=\"[memory map of a typical C ELF executable on x86]\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"24316794-b5a6-57cd-971d-8ede61fe9a9f","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-00/","title":"LOB Intro","readingTime":{"text":"2 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}