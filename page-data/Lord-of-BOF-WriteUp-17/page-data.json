{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-17/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/83e1d875168ef03540c918a22ff6948f/a2478/0.png","srcSet":"/static/83e1d875168ef03540c918a22ff6948f/194ba/0.png 101w,\n/static/83e1d875168ef03540c918a22ff6948f/b6cea/0.png 202w,\n/static/83e1d875168ef03540c918a22ff6948f/a2478/0.png 403w","sizes":"(min-width: 403px) 403px, 100vw"},"sources":[{"srcSet":"/static/83e1d875168ef03540c918a22ff6948f/5ffd5/0.webp 101w,\n/static/83e1d875168ef03540c918a22ff6948f/741d6/0.webp 202w,\n/static/83e1d875168ef03540c918a22ff6948f/3a8fb/0.webp 403w","type":"image/webp","sizes":"(min-width: 403px) 403px, 100vw"}]},"width":660,"height":399.6029776674938}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - succubus\r\n        - calling functions continuously\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token comment\">// the inspector</span>\r\n<span class=\"token keyword\">int</span> check <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">MO</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>cmd<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the MO!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// olleh!</span>\r\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">YUT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the YUT!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">GUL</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the GUL!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">GYE</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the GYE!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">DO</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the DO!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>addr<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// you cannot use library</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strchr</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\x40'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You cannot use library\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check address</span>\r\n        addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>DO<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>addr<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You must fall in love with DO\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// overflow!</span>\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// stack destroyer</span>\r\n        <span class=\"token comment\">// 100 : extra space for copied argv[1]</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token operator\">+</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbfffffff</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token operator\">+</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// LD_* eraser</span>\r\n        <span class=\"token comment\">// 40 : extra space for memset function</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">-</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우선 76번째 줄의 조건을 반드시 충족시켜야 한다. argv[1]+44의 주소를 addr에 들어있는 값인 DO함수의 주소와 일치시켜야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 403px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/83e1d875168ef03540c918a22ff6948f/045fd/0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAx0lEQVR42lXM25KDIBBFUZBLQBOB7kbAhkQn//+PU5m8OOdxV60jcsYQAjMj5VI2rZWU0mitlJqmSSlljNH6E6y1SilxXWsFCYmwjzGeT0Qgoq2UBFBriSkiUQzhfl9SStbYf3j8mXV9bGWrtYb1kTMZY+zNHcfLeyeEmOfZuZvz3nsnr3jnnZkBAJAaM0L6dqV17z3GIIQ4zvP9PscY589ptL5i7qOHsAJSHyPGKOXnXU5T2/fvV6m1d26t5bwhQoKUUlzuyy/A0A/Z5GlCAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/83e1d875168ef03540c918a22ff6948f/c9b55/0.webp 165w,\n/static/83e1d875168ef03540c918a22ff6948f/f2908/0.webp 330w,\n/static/83e1d875168ef03540c918a22ff6948f/ca1b5/0.webp 403w\"\n              sizes=\"(max-width: 403px) 100vw, 403px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/83e1d875168ef03540c918a22ff6948f/04c57/0.png 165w,\n/static/83e1d875168ef03540c918a22ff6948f/d9ecf/0.png 330w,\n/static/83e1d875168ef03540c918a22ff6948f/045fd/0.png 403w\"\n            sizes=\"(max-width: 403px) 100vw, 403px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/83e1d875168ef03540c918a22ff6948f/045fd/0.png\"\n            alt=\"disas_DO\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>DO함수의 시작지점은 0x80487ec이다. 해당 조건문을 우회하는지 다음을 통해 알아보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0d0d4b01129f7b47466ee124199e9c93/32056/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAc0lEQVR42nXMOxbDIAxEUeEUEYggaRTzceX9rzIH97nNm2porgXAAXcHUD8VgVqriERAtYkIAGbmnM1MRFprOXMphda1zn720fENc3O4PS8RgR0wv+mfOcd1rfu+VdXM1HTMIVKO43g90oNSIqJEtPfu9gN/oQf8XjFfdAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0d0d4b01129f7b47466ee124199e9c93/c9b55/1.webp 165w,\n/static/0d0d4b01129f7b47466ee124199e9c93/f2908/1.webp 330w,\n/static/0d0d4b01129f7b47466ee124199e9c93/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0d0d4b01129f7b47466ee124199e9c93/04c57/1.png 165w,\n/static/0d0d4b01129f7b47466ee124199e9c93/d9ecf/1.png 330w,\n/static/0d0d4b01129f7b47466ee124199e9c93/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0d0d4b01129f7b47466ee124199e9c93/32056/1.png\"\n            alt=\"succubus1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>성공적으로 우회하였다. 이 상태에서 쉘을 띄우는 가장 좋은 방법은 system 함수를 포함하고 있는 MO함수를 활용하는 것으로 보인다. 하지만 MO 함수를 포함한 모든 함수에 check 조건문을 우회시키기 위해 다음과 같이 함수 주소를 쌓는다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| GYE address |\r\n| GUL address |\r\n| YUT address |\r\n| MO address |\r\n| ... |</p>\n<p>이러한 스택은 다음과 같은 과정을 거쳐 만들어지게 된다. 만약 페이로드를 패딩 44byte + DO함수 주소로만 설정하게 되면 이러한 과정을 거친다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| ... |</p>\n<p>DO 함수를 실행시킨 후에는 이렇게 바뀌게 된다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| SFP |\r\n| ... |</p>\n<p>DO 함수가 끝난 후에는 SFP 다음 내용이 eip에 들어가게 된다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| GYE address |\r\n| GUL address |\r\n| YUT address |\r\n| MO address |\r\n| ... |</p>\n<p>그렇기 때문에 위와 같은 스택을 구성하는 것이다.\r\n함수의 주소들은 gdb에서 ‘disas [함수명]’ 명령어로도 찾을 수 있지만 다른 방법으로도 찾을 수 있다.</p>\n<ul>\n<li>nm: 파일 심볼 검색</li>\n<li>readelf: ELF 파일에 대한 정보를 보여줌</li>\n</ul>\n<p>nm 명령어를 통해 필요한 모든 함수의 주소지를 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 454px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/af706b2ff367a5f402395dc119276209/b3c1d/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAeElEQVR42pXLyw7DIBBDUdiwCTABhozN4/9/M1LVXVqpPcsr2xls7VVLAXCZqWp9K0c8YFfOudSqvddWc04pxbMU1SaS3dxr70VSREi6B+8+euULINFVY4ogvff+2/6Jc8w5eu9yipm5vxjAwaYaQjBg7RVT/PF8A83yCf2HqYWQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/af706b2ff367a5f402395dc119276209/c9b55/2.webp 165w,\n/static/af706b2ff367a5f402395dc119276209/f2908/2.webp 330w,\n/static/af706b2ff367a5f402395dc119276209/44d9f/2.webp 454w\"\n              sizes=\"(max-width: 454px) 100vw, 454px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/af706b2ff367a5f402395dc119276209/04c57/2.png 165w,\n/static/af706b2ff367a5f402395dc119276209/d9ecf/2.png 330w,\n/static/af706b2ff367a5f402395dc119276209/b3c1d/2.png 454w\"\n            sizes=\"(max-width: 454px) 100vw, 454px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/af706b2ff367a5f402395dc119276209/b3c1d/2.png\"\n            alt=\"nm_succubus\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>이를 활용해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f32d8389472645da94bbb4b1650ee05/32056/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVR42o3O23KEIAwGYBRosGZFViISAm73/R+yo2tnerjpd5dM/iRq2zZmFpH9sbdWc95ijK3VlFI5MCISUWuVVhKRNa23G4rIOI5KqmTOKaW2N6mVpdRzLoQwBz+fAEBr3X/pus5aq5RSpRSiSERcivcTADjnhpf3gzuT6qerw8whHOtzzjiO6n+usFQhohgXEUE8wt9/s9ZqrY0xv45fZebMhe/L8nx+zLPv+96+WQAwxnjvp2lyDhBxGIa/4U8AQBA+0jgEnQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f32d8389472645da94bbb4b1650ee05/c9b55/3.webp 165w,\n/static/5f32d8389472645da94bbb4b1650ee05/f2908/3.webp 330w,\n/static/5f32d8389472645da94bbb4b1650ee05/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f32d8389472645da94bbb4b1650ee05/04c57/3.png 165w,\n/static/5f32d8389472645da94bbb4b1650ee05/d9ecf/3.png 330w,\n/static/5f32d8389472645da94bbb4b1650ee05/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f32d8389472645da94bbb4b1650ee05/32056/3.png\"\n            alt=\"succubus2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>이제 MO 함수에 인자로 shell을 주면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 425px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/2fbbf/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.39393939393939%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42n2S25KkIBBERQVsQW4tt4JCndn//8YNtbdndiNm64mXpE5mVldq9X411kEpKSetFekJo5RSNgwDY4y/h7Hunzk+DoAcYgwhfHwcwa/32zqXc7LOKqWklEopIeau6wj5Ji61YkMAsNa2rRmjF7WM4ziMtNbCORsp9cEviwzBj+P412YoAAW891JKbLiuK2P02tDHlISYGeP7sWWA49hTTthw4pzcABVrrSWmqLXGhucvi+y6ru/7EMPllO3HprWaZ/F4PE60Zen7/hYjYk05G2u3rYUQpJTXZgIAxmjK2PFxOGeNtZwxrfXE+R/PWCrWmNKiVNtayklK8cLOwDmnjLUNYwyttXmehRBfzm/PIQZtbK0lhCDELSYxRiEEpRSxAkCp5fl0SqmvwAvWUkuIp+fWMOf8xs6Qb+z92GOMtaLWi5DCWPN4TKcYW8NL49xz3zd4i/s+lzJNr8AAYD92KYTWmnM+DMPdcyn1vC3rXGsYY5zn8xj6YUg5TdPpuWJ9Pp0xWghhjCFv7lKgFPDBCynP2NM7MJLzhU3Z569P66xcFsaYUso6N93YFc+ir1bs1tolfnlOAHdgZ1Tr2rY28depv7DPntvVs7Hbd8+EhBDd05Hu57mrSjlrYy7ssx5yib1fp4n/R9slyNY5Y21MCbE655QxIYah7xlnL7wf5jfTFTRkGwdzLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/c9b55/4.webp 165w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/f2908/4.webp 330w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/8dc4f/4.webp 425w\"\n              sizes=\"(max-width: 425px) 100vw, 425px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/04c57/4.png 165w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/d9ecf/4.png 330w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/2fbbf/4.png 425w\"\n            sizes=\"(max-width: 425px) 100vw, 425px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/2fbbf/4.png\"\n            alt=\"disas_MO\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/32056/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.3939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmElEQVR42o1R2ZLjIAxUwLdnsA1C3HZ8JJn9/x/cgqTmebooqUFqoZJg3VYi1ETWWq21EKJpGsYZY4xzXlU8O17u7MZ59X5njDVNA847hYpIa41CiFIClZLTNC0FVDBnOs/LjBrfmQpVFltrnbVSSSGEMUZKOQzDt/ju+37IyHYcx2EYuq5rmqbv+7quEREQ0VhrrAkxhBhyGWu9d+u2pjU557TW65pSijkh+GkSzjpjSBPBeV33+xZTPM5z3TbnvQ+eiHwIPjgiKr0sSkkiGoahqnjXdZyxuq4hrav3DlF5H7TW8Gdksc2N4TxPZMyyzL+xWzm/PNvb5+Hts/jr62scx7Zt+4Iqo86Bv/zsQ7DWLDJDKVnGO7Rtw6vPegHgvVvOP7yu67eF4zyO85RyYYzFlI7jyDsAsM7u+46Up6A17cfuvQOARS7HsccYuq6D63E9Xy9dBNv9/vr3Q0UQgr8elzEmF7L2elwhegBQiM/nY7tvWVx2E4QQAECGYkrTNAEAogoxTHPmUsqYIqICACFECB5RtW37H0l+KA+15kr6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/c9b55/5.webp 165w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/f2908/5.webp 330w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/04c57/5.png 165w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/d9ecf/5.png 330w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/32056/5.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 228px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/d4770/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhklEQVR42l2M0RKCIBAAZbLEpgANuAOEQy+1///Cxnpp2ted3QYQiHme6dK2iIjg+/6aiV4714WnQqXWuiwxBiFE88fMvG/PddsKEa9cqKQUlFL9Bynl7a5yztOUnHNKG0TAEM7t6YghYIrgvNfDaMYRMVhru677+QsppbUPQDDmiLXRX/MGF+kMgR+al3cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/c9b55/6.webp 165w,\n/static/b1dfa25e7a901e5aa4f940b968cdf029/b80f5/6.webp 228w\"\n              sizes=\"(max-width: 228px) 100vw, 228px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/04c57/6.png 165w,\n/static/b1dfa25e7a901e5aa4f940b968cdf029/d4770/6.png 228w\"\n            sizes=\"(max-width: 228px) 100vw, 228px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/d4770/6.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>/bin/sh 문자열의 주소를 알아내었다. 이 주소를 이용해 보았으나 잘 되지 않아 근처의 주소지를 써서 공격에 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/01d7517618f324546f32b91888d47cf1/32056/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5klEQVR42pXQ2WrEMAwFUCfjmcR74njTkgXy//9YklJa2ocy50kIrpAkWqtERMzHsW/7ltICiMTMRMdxLGmZ43yeJyLwyrzyFAIxIWEpWTBTgwaI274RMxIwc8p5XRkQSq2ttXRDhFGNSinnnFJj1wmBCDHOpZTWYBzH120YhteXx6P/JKXsrsQPiBiCzzkB4vMpxVvWlUMIMcZ5nn8P/hcz5VJSSjnn0mqMMV9VqbU65/wUvPPGGOectdZ777wzxnjvtdYCrm9BSklrrZQyRl+MUUr1ff93l64T301r7TRNUr557e0DLbkUkBYlVgsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/01d7517618f324546f32b91888d47cf1/c9b55/7.webp 165w,\n/static/01d7517618f324546f32b91888d47cf1/f2908/7.webp 330w,\n/static/01d7517618f324546f32b91888d47cf1/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/01d7517618f324546f32b91888d47cf1/04c57/7.png 165w,\n/static/01d7517618f324546f32b91888d47cf1/d9ecf/7.png 330w,\n/static/01d7517618f324546f32b91888d47cf1/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/01d7517618f324546f32b91888d47cf1/32056/7.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>my-pass: here to stay</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"e310755b-83c6-5cfe-8750-856ba19da4f2","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-17/","title":"LOB 17번 (zombie_assassin -> succubus)","readingTime":{"text":"4 min read"}},"listingPagePath":"/blog/"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}