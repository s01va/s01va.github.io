{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-10/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/9aae59d0f8212e5d76085639332d8242/b7b7c/0.png","srcSet":"/static/9aae59d0f8212e5d76085639332d8242/182cc/0.png 91w,\n/static/9aae59d0f8212e5d76085639332d8242/2c6ad/0.png 181w,\n/static/9aae59d0f8212e5d76085639332d8242/b7b7c/0.png 362w","sizes":"(min-width: 362px) 362px, 100vw"},"sources":[{"srcSet":"/static/9aae59d0f8212e5d76085639332d8242/98c2e/0.webp 91w,\n/static/9aae59d0f8212e5d76085639332d8242/483ec/0.webp 181w,\n/static/9aae59d0f8212e5d76085639332d8242/def5b/0.webp 362w","type":"image/webp","sizes":"(min-width: 362px) 362px, 100vw"}]},"width":660,"height":399.2817679558011}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - skeleton\r\n        - argv hunter\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> saved_argc<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check the length of argument</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argument is too long!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// argc saver</span>\r\n        saved_argc <span class=\"token operator\">=</span> argc<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// ultra argv hunter!</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>saved_argc<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| saved_argc[4] |\r\n| buffer[40] |\r\n| Stack frame pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>환경변수부터 buffer 40바이트, argv[0]까지 모두 0으로 초기화시키고 있다. 초기화가 이루어진 후 스택에 남아있는 부분이 있는지 gdb를 통해 알아보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 362px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9aae59d0f8212e5d76085639332d8242/10600/0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA8UlEQVR42kWQ23LDIAwFAYekNY4TbHERxhKGTP7/Ezu4mXYf9KJZHUmi1vp4PLz325attTln50AIIU+UUn9VKvmPOHm/3yus4FzeMjO3VrctjeMYY1yWZQXoo0OIGH3wcJJSmozpcq2VaGemeZ4xIRM5B9frVSklhLjf77XV5/M5qKGUQpS11mf3zC6l7F1mY0zESEQhBLssl8vQ5XneKUvVNydm4j2E2F51HL8/ycx8HOWTzIyI4OBXHo2p9dD6IqUshYl2731rLe+b1lokTD4ERJymCQAiRnBgrR2Gvvbt9lUKT1O/8POFdcUYQwjl4B+v4hiSWfw9vQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9aae59d0f8212e5d76085639332d8242/c9b55/0.webp 165w,\n/static/9aae59d0f8212e5d76085639332d8242/f2908/0.webp 330w,\n/static/9aae59d0f8212e5d76085639332d8242/c2de8/0.webp 362w\"\n              sizes=\"(max-width: 362px) 100vw, 362px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9aae59d0f8212e5d76085639332d8242/04c57/0.png 165w,\n/static/9aae59d0f8212e5d76085639332d8242/d9ecf/0.png 330w,\n/static/9aae59d0f8212e5d76085639332d8242/10600/0.png 362w\"\n            sizes=\"(max-width: 362px) 100vw, 362px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9aae59d0f8212e5d76085639332d8242/10600/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/078b956a3d5bcb574da5b170cd9c35b7/f27fb/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhUlEQVR42mXNyw7DIAxEUbupmkgQQWh42GAg5P//saJddlZ3MzowrntcXVpzzkViopQ5x+ABIIRgjAGA1rtUqbVaY4sIEXt/btsKY9y9tVLksJaLlJyZOcZ5du8zET2XRSmltdp3va6v2bvGBwIA9H7VKolIa0U8ZaLkv7Jzx0/+HyIC4gcbDguswOLOBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/078b956a3d5bcb574da5b170cd9c35b7/c9b55/1.webp 165w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/f2908/1.webp 330w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/b6b2f/1.webp 417w\"\n              sizes=\"(max-width: 417px) 100vw, 417px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/078b956a3d5bcb574da5b170cd9c35b7/04c57/1.png 165w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/d9ecf/1.png 330w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/f27fb/1.png 417w\"\n            sizes=\"(max-width: 417px) 100vw, 417px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/078b956a3d5bcb574da5b170cd9c35b7/f27fb/1.png\"\n            alt=\"disas2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>main+368에서 leave하고 있다. 이 지점까지 실행시킨 후 스택에 남은 공간이 있는지의 여부를 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 320px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/72799/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqUlEQVR42n2P2w6DIBAFoaaigLVR8QJ12QW0//+HjbXxSTuPJzuZLJsBlxTbtun73pjOOtc2z34YAEGIO79tcM7ZKev6TilgIPDeuUkpyb886nocRztZrXWe5+fysqwxBk8IiM5ZIX53Uum6fjDGLrO7nGJAIkD03peF2HeldVVp9p8lbWUkmj3CDLIsDlkrxTnPsuxS3n8G9EBESEdZCNEZM8NLyvJK/gByDw+kdyPTtQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/c9b55/2.webp 165w,\n/static/866d21dfb4856a8fc7479b9f003ce7f1/4c812/2.webp 320w\"\n              sizes=\"(max-width: 320px) 100vw, 320px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/04c57/2.png 165w,\n/static/866d21dfb4856a8fc7479b9f003ce7f1/72799/2.png 320w\"\n            sizes=\"(max-width: 320px) 100vw, 320px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/72799/2.png\"\n            alt=\"stack mem\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 389px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/267f2f6c64fe9d3e672028b69986dcbc/00a4e/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAXUlEQVR42j3LQQ6AIAwF0ULLCleA8mlVDHr/MxqNcVZvMzSu8xij902Eicg5V8ocgnjvmdl/8e8Xj4MIqVlTtdWEn5mI4jRVwExTznvv2pBTroAqYoy2GoB5WVDrDUqbBntKcrqhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/267f2f6c64fe9d3e672028b69986dcbc/c9b55/3.webp 165w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/f2908/3.webp 330w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/b1289/3.webp 389w\"\n              sizes=\"(max-width: 389px) 100vw, 389px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/267f2f6c64fe9d3e672028b69986dcbc/04c57/3.png 165w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/d9ecf/3.png 330w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/00a4e/3.png 389w\"\n            sizes=\"(max-width: 389px) 100vw, 389px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/267f2f6c64fe9d3e672028b69986dcbc/00a4e/3.png\"\n            alt=\"stack mem2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>메모리 끝에서 경로가 남아있는 부분을 찾았다. argv[0]부분이 이 주소지에 아직 남아있는 것을 발견하였다. B가 250번 반복되는 이름을 가진 디렉토리를 생성하고 실행파일 skeleton을 복사하여 위와 같은 실험을 반복하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/930729abcceb5e79a34d2d9015333518/ace37/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiklEQVR42iWLCw6DMAxDOcGalP4oUKb1M5JQ7n+8qcyyrCfLntZti0sI3ulZ72k3xjjvnHOzmZclWGvjGlNKMcbjfXgfXkopBQCgAKZWa/u2WkoptbVWS82fXIdayZmImYVYiAYSy9W7XNLvLv2ehPkSGRMROklY+Dmc52hCCACAGgERUQPi3/jkD3rJFZwl0zLSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/930729abcceb5e79a34d2d9015333518/c9b55/4.webp 165w,\n/static/930729abcceb5e79a34d2d9015333518/f2908/4.webp 330w,\n/static/930729abcceb5e79a34d2d9015333518/cc661/4.webp 660w,\n/static/930729abcceb5e79a34d2d9015333518/be082/4.webp 666w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/930729abcceb5e79a34d2d9015333518/04c57/4.png 165w,\n/static/930729abcceb5e79a34d2d9015333518/d9ecf/4.png 330w,\n/static/930729abcceb5e79a34d2d9015333518/1f083/4.png 660w,\n/static/930729abcceb5e79a34d2d9015333518/ace37/4.png 666w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/930729abcceb5e79a34d2d9015333518/1f083/4.png\"\n            alt=\"mkdir\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ac5da69f634c35b6477e4be1564ac408/5c6e9/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiElEQVR42jWOQQ6DMAwEba+dCyJIgEIgTkl7If3/BytadQ57Ga00dLa2H0eMIxGpaozRTKFqpj8A3KsaQhCI6i3MgpnR9e5X72ldiUhE0rZ5Le356v0q7ssy55xTSvOy1kc9z+bFvdY95ziOVNz3ckxTvM/AMAzMHIIBEAEA+zYwCzPrH2Emog9q9gjsfdG33AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ac5da69f634c35b6477e4be1564ac408/c9b55/5.webp 165w,\n/static/ac5da69f634c35b6477e4be1564ac408/f2908/5.webp 330w,\n/static/ac5da69f634c35b6477e4be1564ac408/9d6da/5.webp 492w\"\n              sizes=\"(max-width: 492px) 100vw, 492px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ac5da69f634c35b6477e4be1564ac408/04c57/5.png 165w,\n/static/ac5da69f634c35b6477e4be1564ac408/d9ecf/5.png 330w,\n/static/ac5da69f634c35b6477e4be1564ac408/5c6e9/5.png 492w\"\n            sizes=\"(max-width: 492px) 100vw, 492px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ac5da69f634c35b6477e4be1564ac408/5c6e9/5.png\"\n            alt=\"mem: argv[0]\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>동일하게 메모리 끝쪽에 argv[0]이 남아있는 것을 발견하였다. 이것을 이용하여 다음과 같은 익스플로잇을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a491e7465642f8566347ff6686f8887/5f4af/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1UlEQVR42o2OS27DMAxEZTl1/UmlRI7Fn0h31ZPYZzB8/4sUShZdFAU6Gw5IPnKcmYmIqRJR0UKEqpoBmBkRcs7MLCKIAAAsnPNCiGmez/N0wixFRLhoLRU2JWIAQEJmJmYiIn6eZgaEUiTG23EczsxU1VQBoJSSl8eSF6njMAxDiMF73zSNb3w11TZvl4tzbt93t66fiDUUItpqMYYQQppTW5d927bul17NbdtcXpfpYxrHMaV0T/eu66bp+t517m/9wPPXI15jvMX6m6Dv+xBq4P/A3wR1GLNDhfpgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9a491e7465642f8566347ff6686f8887/c9b55/6.webp 165w,\n/static/9a491e7465642f8566347ff6686f8887/f2908/6.webp 330w,\n/static/9a491e7465642f8566347ff6686f8887/cc661/6.webp 660w,\n/static/9a491e7465642f8566347ff6686f8887/ced6d/6.webp 665w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9a491e7465642f8566347ff6686f8887/04c57/6.png 165w,\n/static/9a491e7465642f8566347ff6686f8887/d9ecf/6.png 330w,\n/static/9a491e7465642f8566347ff6686f8887/1f083/6.png 660w,\n/static/9a491e7465642f8566347ff6686f8887/5f4af/6.png 665w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9a491e7465642f8566347ff6686f8887/1f083/6.png\"\n            alt=\"mkdir ln\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c16e25ae28c9799ad0d42121cb6b0377/31493/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAcUlEQVR42pXNUQrDMAwD0MAiyU0DZYU5geS7u/8NR53tAHsfRsIGJ3fvvR/HIYmkbQZAkoUM3DOQJChpZUmptfY8T5I5P7iIQAawGu5V5g9CfEK6rveY8+VeSlEo+wpmpi18i7SyZOsmjTla81pr+t8H4rEG9yxk1iEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c16e25ae28c9799ad0d42121cb6b0377/c9b55/7.webp 165w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/f2908/7.webp 330w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/cc661/7.webp 660w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/c2945/7.webp 664w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c16e25ae28c9799ad0d42121cb6b0377/04c57/7.png 165w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/d9ecf/7.png 330w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/1f083/7.png 660w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/31493/7.png 664w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c16e25ae28c9799ad0d42121cb6b0377/1f083/7.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>my-pass: shellcoder</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"d1570ba2-13f5-55a8-923f-88a3e6a96c6b","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-10/","title":"LOB 10번 (vampire -> skeleton)","readingTime":{"text":"2 min read"}},"listingPagePath":"/blog/"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}