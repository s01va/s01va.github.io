{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-13/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/4d3a4bbdb82d73e112ebde43c6067301/43ec3/0.png","srcSet":"/static/4d3a4bbdb82d73e112ebde43c6067301/44065/0.png 151w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/0b26b/0.png 301w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/43ec3/0.png 602w","sizes":"(min-width: 602px) 602px, 100vw"},"sources":[{"srcSet":"/static/4d3a4bbdb82d73e112ebde43c6067301/cc7b4/0.webp 151w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/7abbd/0.webp 301w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/e8977/0.webp 602w","type":"image/webp","sizes":"(min-width: 602px) 602px, 100vw"}]},"width":660,"height":400.1661129568106}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - bugbear\r\n        - RTL1\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack betrayed you!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| SFP |\r\n| RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>두번째 if문에 argv[1][47] == ‘/xbf’일 시 프로그램을 종료하게 함으로써 스택에 오버플로우 시키는 방법을 사용하지 못하게 하고 있다. 문제에서 RTL을 힌트로 주었으니 이를 활용해 보려 한다.</p>\n<p>앞의 LD_PRELOAD를 이용하는 skeleton 문제에서 라이브러리 관련 설명과 함께 풀이를 한 바 있다. RTL은 Return To Library로, 링킹된 라이브러리의 또다른 함수로 리턴시켜 실행시키는 기법이다. 쉘을 실행시키는 것이 목적인데, 가장 쉬운 방법으로 system(“/bin/sh”)가 있다. argument로 “/bin/sh”를 주고, ret 자리에 system함수의 주소를 준 후, 크기가 4만큼의 패딩을 준 후 해당 함수의 인자로 들어가야 할 “/bin/sh”의 주소를 줄 것이다. 보통 함수의 인자가 ebp+4의 자리에 위치하기 때문이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4d3a4bbdb82d73e112ebde43c6067301/32056/0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuklEQVR42nXQwW6FQAgFUKzRCQwDyCg+R+1r4v//44tx0UXTs7ob4AY4v89tex3nERFmWm6ccx6GgTJxYfij6zoAWJYF3j/viCXWmOfZfWqtiUjOGRHdPaWkqohoZsxMdAcRAYDWGtRa3b1Wj3tHTD61ve3HbqZq+siZzCylVB5SoOuu6wKvbjo9p0wNEZGQiPq+h3/81n6tq8e07du8zKJCRKoqUigTEYoqcxnHkZm5FOb7Bd3XPRwRH0XeDojf6sK7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4d3a4bbdb82d73e112ebde43c6067301/c9b55/0.webp 165w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/f2908/0.webp 330w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/ff4b8/0.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4d3a4bbdb82d73e112ebde43c6067301/04c57/0.png 165w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/d9ecf/0.png 330w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/32056/0.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4d3a4bbdb82d73e112ebde43c6067301/32056/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>인자로 준 “A” * 44는 buffer의 패딩, “BBBB”는 ret에 넣을 system 함수의 주소 자리, “CCCC”는 인자를 주기 전의 패딩이며 “DDDD”는 “/bin/sh”문자열의 주소 자리이다. system 함수의 주소는 0x40058ae0이므로 argv[1][47]==’/xbf’의 조건문에도 걸리지 않을 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/735a569eb06dff739428281772845b18/699b7/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAZElEQVR42hXIUQ6DIBBAwUeAALtEi6VGoKi9/yUb53PY98+yrLVWVdWcQwiAtTZJEhURMcYAMaaUnnHOAt57zZnXugCllPt3n9dV6xsIMXznbO3oY3jngDZ668eYQ1WAbSvzPP848wX8bleYegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/735a569eb06dff739428281772845b18/c9b55/1.webp 165w,\n/static/735a569eb06dff739428281772845b18/f2908/1.webp 330w,\n/static/735a569eb06dff739428281772845b18/3cb93/1.webp 596w\"\n              sizes=\"(max-width: 596px) 100vw, 596px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/735a569eb06dff739428281772845b18/04c57/1.png 165w,\n/static/735a569eb06dff739428281772845b18/d9ecf/1.png 330w,\n/static/735a569eb06dff739428281772845b18/699b7/1.png 596w\"\n            sizes=\"(max-width: 596px) 100vw, 596px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/735a569eb06dff739428281772845b18/699b7/1.png\"\n            alt=\"memory1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/17602/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiElEQVR42iXNURKDIAxF0adBEfWjjgkECGD3v8lO27uAc2HdjmOfpqnUkn8RkXOu1JpLkSgAvPfWTHO+mQGc52nNkipUNWwbABYWicxM80xEEqNIvPkGsCxrTFGEX9cFIISQNH1da+04dgDVqjWrtTrniKj11nrPOQNYvX/ezxhDs/7P43n66B8OGgvB2IRZewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/c9b55/2.webp 165w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/f2908/2.webp 330w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/9e35d/2.webp 597w\"\n              sizes=\"(max-width: 597px) 100vw, 597px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/04c57/2.png 165w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/d9ecf/2.png 330w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/17602/2.png 597w\"\n            sizes=\"(max-width: 597px) 100vw, 597px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/17602/2.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 214px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/73bfb588bdae516145a5fff5b43cfcbf/a48b3/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.939393939393941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42l3N2xKCIBAAUB9kxgULNJVLMiy4C1Yz9f9/12vT+YHTYcZ6Nn1RV232e7DOAQyF+fXkiIWYClOMMWHywXd/EFPY92WZN+uc3ZZ1HUdlpnlbb8ZM2hhttHXOeT9Puu+FEGIAACkBoPu8H6kcVLkwYc6YczmKBPgNJMhwD0wH1Ra85Xa2s45KfQFWEg6qsmTNdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/73bfb588bdae516145a5fff5b43cfcbf/c9b55/3.webp 165w,\n/static/73bfb588bdae516145a5fff5b43cfcbf/7190f/3.webp 214w\"\n              sizes=\"(max-width: 214px) 100vw, 214px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/73bfb588bdae516145a5fff5b43cfcbf/04c57/3.png 165w,\n/static/73bfb588bdae516145a5fff5b43cfcbf/a48b3/3.png 214w\"\n            sizes=\"(max-width: 214px) 100vw, 214px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/73bfb588bdae516145a5fff5b43cfcbf/a48b3/3.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>“/bin/sh” 문자열이 시작하는 지점은 0xbffffc44이다. 이를 바탕으로 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28cef41a223e1b00dd3f0530534e6970/32056/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAfElEQVR42l2KyxKDIAwAlZFKQoI8LYkw/v9fdtre3MPuZZcx5zWuXIqqnO+ztaYqqhpTHPOac8QUe++1tVJLyRkRmfk4ggO3lJJFOiB47wHAWguAROSBmNk5Z4xZjXl9scuD3ruI3Pdda3X7TkQhBASEBHTwtm2Pf/37lw8HmQiV3hblAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28cef41a223e1b00dd3f0530534e6970/c9b55/4.webp 165w,\n/static/28cef41a223e1b00dd3f0530534e6970/f2908/4.webp 330w,\n/static/28cef41a223e1b00dd3f0530534e6970/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28cef41a223e1b00dd3f0530534e6970/04c57/4.png 165w,\n/static/28cef41a223e1b00dd3f0530534e6970/d9ecf/4.png 330w,\n/static/28cef41a223e1b00dd3f0530534e6970/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28cef41a223e1b00dd3f0530534e6970/32056/4.png\"\n            alt=\"exploit1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>공격에 실패하였으나 경로명이 보이는 것을 보아 “/bin/sh” 문자열이 bugbear의 복사본 파일에서는 0xbffffc44에 위치하였으나, 원본 파일에서 0xbffffc44는 “/bin/sh”의 약간 뒤에 위치하고 있음을 추측해 낼 수 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/43b24253ee4a45805bb449309053ffed/32056/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhklEQVR42iXEUQ6DIAwAUGNbqG1t5oCBgPP+t1zi3sdb5jWv67rvb8q5tZpLySWPMVJKY/TeT3evtR7v43W8mFkfROTuy5yz9z7nUFUACCEgYoyRmYkohPCfmREAEQEAidZ1JaKltlo+pbV2nk1VNxFVMVMzY2Z5qKmI8LaZmYi4e4xx3/cfDd0JrbWKLZ4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/43b24253ee4a45805bb449309053ffed/c9b55/5.webp 165w,\n/static/43b24253ee4a45805bb449309053ffed/f2908/5.webp 330w,\n/static/43b24253ee4a45805bb449309053ffed/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/43b24253ee4a45805bb449309053ffed/04c57/5.png 165w,\n/static/43b24253ee4a45805bb449309053ffed/d9ecf/5.png 330w,\n/static/43b24253ee4a45805bb449309053ffed/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/43b24253ee4a45805bb449309053ffed/32056/5.png\"\n            alt=\"exploit2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>“/bin/sh”의 주소지를 0xbffffc3a로 설정하니 공격에 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 124px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1694baa98cfd30178d7e3359af4093c6/d6e54/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.322580645161295%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABOklEQVR42m2N2W6CUBCGh+Vw9gMIRBE3lNXlxtqogBoNvWjTm/b9H6bRNk1N/ZLJ5P+Tbwb8wKOEMEptx+u4qtvrBZ4LAEqpW00ZZwTj2+acC8E5/FI3u3P70tT7l9e3ffV8ODZdvyNd//3zo2qq6WgwLfL2Uu9P7eWwa86XptrqugZ/0X4GTNPQDeO79HyfEWxh4jo2AFydewvG8SxLk2g8HkZhVhRe4DHhzMscAGZpHo0mge+VRUkJvt7X7u14mmZZEidJmsSzJLEd20BWEPgA4LpefzAMw27UDy1kwn+QiUzTJBgTTHRdQwhLJS2EOOOMUowtIa8RHrJYreqmXj9t6sNOBxhMsu3xVJZpXmTz5WK+XB3adrNeI9N4IHMubKUYpVIKAMCE2o6jlLQsxLlQSkqlBGfao89fPsgf01Rq9bMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1694baa98cfd30178d7e3359af4093c6/4a469/6.webp 124w\"\n              sizes=\"(max-width: 124px) 100vw, 124px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1694baa98cfd30178d7e3359af4093c6/d6e54/6.png 124w\"\n            sizes=\"(max-width: 124px) 100vw, 124px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1694baa98cfd30178d7e3359af4093c6/d6e54/6.png\"\n            alt=\"mypass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>my-pass: new divide</p>\n<ul>\n<li>system 함수에 “/bin/sh”이라는 문자열이 이미 포함되어 있다는 것을 알게 되었다.</li>\n</ul>\n<p>문자열을 찾기 위해 아래와 같은 코드를 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">1</span>  #include <span class=\"token operator\">&lt;</span>stdio<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span>\r\n<span class=\"token number\">2</span>  \r\n<span class=\"token number\">3</span>  <span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n<span class=\"token number\">4</span>          <span class=\"token keyword\">long</span> fsystem <span class=\"token operator\">=</span> <span class=\"token number\">0x400391e0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">5</span>          <span class=\"token keyword\">long</span> shell <span class=\"token operator\">=</span> fsystem<span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">6</span>  \r\n<span class=\"token number\">7</span>          <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>shell<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n<span class=\"token number\">8</span>                  shell<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">9</span>          <span class=\"token punctuation\">}</span>\r\n<span class=\"token number\">10</span> \r\n<span class=\"token number\">11</span>         <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh = 0x%x\\n\"</span><span class=\"token punctuation\">,</span> shell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">12</span> \r\n<span class=\"token number\">13</span>         <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">14</span> <span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 511px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1f29dc65442c56750734ff0bf3e3072/92e00/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiUlEQVR42lXBWxKDIAwAQLDy0EHCKyqSAN7/kp3pX3fFQzTn6J3H7FetTK2UTJ3fd3YmPDGllAsSc2sPANjNevDucNpogSde14Unnj+13sfhQgw555Tivu/OHSFAweKcU0opra21xph1/YhG1Ee/601MxDzm8OABIKYUY9i2TQghl0UuUkop/n0BIbcLuoVcZSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d1f29dc65442c56750734ff0bf3e3072/c9b55/7.webp 165w,\n/static/d1f29dc65442c56750734ff0bf3e3072/f2908/7.webp 330w,\n/static/d1f29dc65442c56750734ff0bf3e3072/4719d/7.webp 511w\"\n              sizes=\"(max-width: 511px) 100vw, 511px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d1f29dc65442c56750734ff0bf3e3072/04c57/7.png 165w,\n/static/d1f29dc65442c56750734ff0bf3e3072/d9ecf/7.png 330w,\n/static/d1f29dc65442c56750734ff0bf3e3072/92e00/7.png 511w\"\n            sizes=\"(max-width: 511px) 100vw, 511px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d1f29dc65442c56750734ff0bf3e3072/92e00/7.png\"\n            alt=\"ps\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>system함수 내에서 “/bin/sh”이라는 문자열이 있는 주소는 0x400fbff9이다.</p>","categories":["writeup","pwnable"],"date":"February 05, 2016","description":"","id":"76ed7f40-9621-5e7f-894d-3235eb4d4188","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-13/","title":"LOB 13번 (darkknight -> bugbear)","readingTime":{"text":"4 min read"}},"listingPagePath":"/blog/"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}