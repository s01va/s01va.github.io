{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/Lord-of-BOF-WriteUp-12/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/d4ec033e988120e831a4098214b1e92b/972a9/0.png","srcSet":"/static/d4ec033e988120e831a4098214b1e92b/8ade6/0.png 123w,\n/static/d4ec033e988120e831a4098214b1e92b/0b8a8/0.png 247w,\n/static/d4ec033e988120e831a4098214b1e92b/972a9/0.png 493w","sizes":"(min-width: 493px) 493px, 100vw"},"sources":[{"srcSet":"/static/d4ec033e988120e831a4098214b1e92b/b7020/0.webp 123w,\n/static/d4ec033e988120e831a4098214b1e92b/086cd/0.webp 247w,\n/static/d4ec033e988120e831a4098214b1e92b/c5d55/0.webp 493w","type":"image/webp","sizes":"(min-width: 493px) 493px, 100vw"}]},"width":660,"height":400.2839756592292}}}},"body":"<p>source code:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/*\r\n        The Lord of the BOF : The Fellowship of the BOF\r\n        - darkknight\r\n        - FPO\r\n*/</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">problem_child</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>src<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span><span class=\"token number\">40</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> src<span class=\"token punctuation\">,</span> <span class=\"token number\">41</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\\n\"</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>argc<span class=\"token operator\">&lt;</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"argv error\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">problem_child</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Stack frame structure:</p>\n<p>| buffer[40] |\r\n| [problem_child] SFP |\r\n| [problem_child] RET |\r\n| [main] SFP  |\r\n| [main] RET |\r\n| argc |\r\n| argv |\r\n| environ |</p>\n<p>힌트로 FPO를 주었다. FPO는 Frame Pointer Overflow의 약자로, fake ebp의 일종이다. 여태까지 공격한 것들을 보면 return address 이후로는 손을 댈 수 없는 것이 원칙이었으나, fake ebp기법을 활용해 ebp의 위치를 옮기면 공격자가 원하는 위치에서 원하는 return address를 추출하는 것이 가능하다.</p>\n<p>problem_child 함수를 보면 strncpy(buffer, src, 41) 함수가 존재하는데, 이 함수에는 원래는 40bytes인 buffer의 1byte를 오버플로우 시킬 수 있는 취약점이 존재한다. 즉 problem_child 함수의 SFP의 1byte를 수정시킬 수 있는 점을 보고 FPO라는 공격기법을 힌트로 준 것으로 보인다. 아래는 이를 시도한 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByklEQVR42nWS247bMAwFY4uyJSciFce6kJTs/P9XFnHT7maL8pHAwXAOeMk5xRiZOaWUS04pbem1md3svQcA52Y3z9M0Oeemebp8n95bLiWl7XjuolJKFuH1sTrviLD1jhh678I1BHTOfYRbUxZGROaiqrnkWuuWsgVjJ5tyGoch51xf+7Is/pP8Cst9vatK33cWFmFRnefJWqtNAcyWtn3vhBhuN2thuAzDcIZVlVVjJOYqqjnnUksudZ5na23lasGs21ZrxnC7Xq8hhD/R82x5haM22d9kKcxICACiai3kUlgkICIhES7LEmO01l70dKZPcsoFMYAxLDJNdkup1nK9Xr33iCFgcM4Nl+HSujJLvMd2kuUks8grDMCixoxbSq2143kQ4e12I6LFL29n+ce5cEUMxphcijHjI22l1vt6R6IYafGeYpys/e0sFOk7WVQRgwU4nk/v3JaSqkSK3rtxHC3AV2H1rEf+kkupLJHIjGNhBgsp5/3Yj+czEiIGIjJgvtq+P1ZV7ieZXwISwtvZe2+tdc4ty2LM+PM9tfez7dJ6Tzkxs7QWIwFAqQWMufxvHo/1VNLe25ZSPzoRzvMMAOM4/nzmz/kFaAczAUbYeO0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d4ec033e988120e831a4098214b1e92b/c9b55/0.webp 165w,\n/static/d4ec033e988120e831a4098214b1e92b/f2908/0.webp 330w,\n/static/d4ec033e988120e831a4098214b1e92b/4efd5/0.webp 493w\"\n              sizes=\"(max-width: 493px) 100vw, 493px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d4ec033e988120e831a4098214b1e92b/04c57/0.png 165w,\n/static/d4ec033e988120e831a4098214b1e92b/d9ecf/0.png 330w,\n/static/d4ec033e988120e831a4098214b1e92b/f88d0/0.png 493w\"\n            sizes=\"(max-width: 493px) 100vw, 493px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d4ec033e988120e831a4098214b1e92b/f88d0/0.png\"\n            alt=\"disas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>bp를 problem_child가 종료되기 직전인 0x8048469(leave)에 걸고 buffer에 41바이트를 채워넣어 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.242424242424242%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAoklEQVR42o3PwY7DIAwE0AAbAybYcWggNvn/71y1ao+76pNGcxzNonq1dvTRzUxEKtFPCN655RvHIfvOvZ+Vqoioqoic55lzSikhPgtgzTmFEAAgxphevPfLGMNM7Rkdo8/7VlWb8xpDbapeIkK1VqoAgIgxwrquAOCcW1przFxKISZiKgUR874zETHTe+Ev8546bdtKRmyPdrQGAP7D/Xv+F6wWC5BnU6LdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/c9b55/1.webp 165w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/f2908/1.webp 330w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/48c21/1.webp 591w\"\n              sizes=\"(max-width: 591px) 100vw, 591px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/04c57/1.png 165w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/d9ecf/1.png 330w,\n/static/a723dfc191ff7a9e367aa98c52a2ee01/e4c9a/1.png 591w\"\n            sizes=\"(max-width: 591px) 100vw, 591px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a723dfc191ff7a9e367aa98c52a2ee01/e4c9a/1.png\"\n            alt=\"memory1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAh0lEQVR42h2LUQ7DIAzFHmUdHWmQBoMmgZbd/5RT509bhprl/C4lX3NaN6LonFvcwok5JaIdgPeemTkxEQFY1/WunGDdti0AaEcVFVHxf9RUTWutAJ7hqartkJwzgEhRVFtruOaM9HLO2ei3EvHL4h++j6Fmtd1z2MI4h5iVTwFA+z6/s5/nD4oFCpafzHd7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c965a6fb47be64b9cd02997a3fc80837/c9b55/2.webp 165w,\n/static/c965a6fb47be64b9cd02997a3fc80837/f2908/2.webp 330w,\n/static/c965a6fb47be64b9cd02997a3fc80837/3cb93/2.webp 596w\"\n              sizes=\"(max-width: 596px) 100vw, 596px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c965a6fb47be64b9cd02997a3fc80837/04c57/2.png 165w,\n/static/c965a6fb47be64b9cd02997a3fc80837/d9ecf/2.png 330w,\n/static/c965a6fb47be64b9cd02997a3fc80837/699b7/2.png 596w\"\n            sizes=\"(max-width: 596px) 100vw, 596px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c965a6fb47be64b9cd02997a3fc80837/699b7/2.png\"\n            alt=\"memory2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>ebp의 한 바이트가 덮여있는 것을 볼 수 있다. 또한 ebp가 한 바이트가 덮여있는 SFP 주소지인 0xbffffa41을 가리키고 있는 것을 볼 수 있다. 본래 buffer의 크기만큼 채워 보았을 때 ebp가 어떠한지도 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42nXLwQ7DIAwDUGDQNIFAqJaUTXT//5lTuffJ8sGS3RjjOPr1u8xMROY1zWzOaaZI2FpjZtgBEXOmGCMi7rgTUc7Z2aKqava+y85x3tO5YgoAMcYtpS2lEEJa4uLMtHdh5lqriJRSiIgrS5fChZlTSu7J+H7UtLUGALXV1oWIvPfhdfPBe++fzn9VmgpP1nC1vAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/c9b55/3.webp 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/f2908/3.webp 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/bc223/3.webp 594w\"\n              sizes=\"(max-width: 594px) 100vw, 594px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/04c57/3.png 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/d9ecf/3.png 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png 594w\"\n            sizes=\"(max-width: 594px) 100vw, 594px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png\"\n            alt=\"memory3\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>이로써 ebp의 한 바이트를 조작할 수 있음을 확인하였다. 이제 0xbfffa00 ~ 0xbfffaff 범위에 쉘코드를 넣고 이 범위에 맞추어서 problem_child의 ebp를 조작하면 된다. strncpy 직후인 problem_child+21에 bp를 걸고 buffer의 위치를 확인해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 594px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.181818181818183%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAjklEQVR42nXLwQ7DIAwDUGDQNIFAqJaUTXT//5lTuffJ8sGS3RjjOPr1u8xMROY1zWzOaaZI2FpjZtgBEXOmGCMi7rgTUc7Z2aKqava+y85x3tO5YgoAMcYtpS2lEEJa4uLMtHdh5lqriJRSiIgrS5fChZlTSu7J+H7UtLUGALXV1oWIvPfhdfPBe++fzn9VmgpP1nC1vAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/c9b55/3.webp 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/f2908/3.webp 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/bc223/3.webp 594w\"\n              sizes=\"(max-width: 594px) 100vw, 594px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7f4cbfc0bbeff4093e11167f16874f04/04c57/3.png 165w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/d9ecf/3.png 330w,\n/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png 594w\"\n            sizes=\"(max-width: 594px) 100vw, 594px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7f4cbfc0bbeff4093e11167f16874f04/5fd3e/3.png\"\n            alt=\"memory4\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 598px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.09090909090909%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA30lEQVR42o3PW7LDIAiAYYoRosZLYsRWTZv9r/JMXMH5XuDlHwZo7ZNzllqk1jFG6530gojwH/nYQwhSTu99iPEsZ0rpyMfKD+vsnGSMUYuaOxtjmPmJnXN2cttmnXWb25wLMTpnt4mZtF6ICBGJiJjU9MTXNT6tpRRFZD/2GKMxq7Um7THtyawrAChErTWRfk16evr7/n1/96KUtfb6Xn10YwwA9NE/reWcn9fO3EbvvSuliLj31q/LBw/vd5VaFSIzz+MHMwG8ipQiEmMEAB/8WcpZCiIuixYpItU6+wdrRBAxkYOEuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3594f855e32a0ef14f388b7511e243b5/c9b55/4.webp 165w,\n/static/3594f855e32a0ef14f388b7511e243b5/f2908/4.webp 330w,\n/static/3594f855e32a0ef14f388b7511e243b5/83245/4.webp 598w\"\n              sizes=\"(max-width: 598px) 100vw, 598px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3594f855e32a0ef14f388b7511e243b5/04c57/4.png 165w,\n/static/3594f855e32a0ef14f388b7511e243b5/d9ecf/4.png 330w,\n/static/3594f855e32a0ef14f388b7511e243b5/0c69d/4.png 598w\"\n            sizes=\"(max-width: 598px) 100vw, 598px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3594f855e32a0ef14f388b7511e243b5/0c69d/4.png\"\n            alt=\"memory5\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 445px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACcklEQVR42n2T6Y6kMAyEYSD3fSdOgN73f8lV0r3S7mi0JQS/bMqfyxv0HlMIMTrvY04xRkIIQug8DkIJoYRSep7n9qMatBB8SqmPEWLIJTeAXHKt5X7u677v16O1UlpzzoUUQnBrrbGWMballHLJ3vsYQx8DAKy1tZbrvvq4vPfH8XWeJ6UUY0QowQgRQiijGOMtpgAdYgxKqVLy9Tz368mlWGvv5zZGI4S54JiQ+WCMCSaUfGynlKD3EGNr7Xnu3ruxhlLGORNCSDmNGjNNMkYF55RRztmn2HsPvRlrYoy11ZiylJIxpuabamNiDM45qeQPwPro0CczvMQ5k1JyzpVShFCE0L7vX0vbtu37qtn/FI8xSsm55BBCnwKllFwilJznsf1HvY8YQ8q5Ls4+xlKyNUZr1VqDDuO6JjA8l48QwghTRsniN4HFlZBaax8XADjvGrR7rqqXUpSSlFJjLRdCaS2lsNaquXm1xRgbQIhB6bWq+24dUkrWuusaanE6juPra87+Hn/f9++rmjMP6KOnnIUQSskQgtZaCOG8f1PQeuLQRu9Lm/N+psq5PvrzeqB3xhghRHCOCZZSOueMtUKIRXv/B1iptZR8nudEgfG8AzqTND+USCk455QyhNDPh+GdDWtyo/Uk16oP3jsHALVV6J1zxjhffaekknz25G/ayYdQaoHeG4Bztra6wjPJvW9ACEEo5bPNSpHgc5Cc87iulKLWCqC+fr2u+84lO++f57bGHMfxPum/9bG9It2c9z6EBq3U6r1f7YUxZv1EzGyLqWVYKKU+xca61qqxtne4rgs6fGgLTghRWjlvtfnQ/qbfDh47weHvOK8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/c9b55/5.webp 165w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/f2908/5.webp 330w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/75680/5.webp 445w\"\n              sizes=\"(max-width: 445px) 100vw, 445px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/04c57/5.png 165w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/d9ecf/5.png 330w,\n/static/3eb56ffcbb915eb93f93fbac6a477d5d/e66bf/5.png 445w\"\n            sizes=\"(max-width: 445px) 100vw, 445px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3eb56ffcbb915eb93f93fbac6a477d5d/e66bf/5.png\"\n            alt=\"info_frame\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>buffer가 0xbffffab4 ~ 0xbffffadb에 위치하고 있는 것을 확인하였다. 또한 바로 다음에 수행할 명령어의 위치를 나타내는 eip가 ebp보다 4만큼 큰 것을 확인하였다. 이를 이용하여 buffer 자리에 25바이트 쉘코드를 삽입하고 0xbffffab4로 eip를 조작하면 공격이 성공할 것이다. 페이로드를 아래와 같이 만들어서 공격을 진행해 보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.272727272727277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAj0lEQVR42o3PsQ6DMAwEUKNQ18SOkyBMjEoZyv//Y8VQWqkLb7jtdDporbm72TSZubuI3D4Q8cxfiAgAy7KAqkZmGmgYBiJCxCPviIghhL7v4U/XdQBgZvDctse61lpjjMwsIqrKwpqzpFQOOcaoqimlXHIphZmJaN9f0NxttnGsIQS45rs8tzYdfw0uO8tvmLsJb7NocS4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/953bcca7ab4fb23278ce657a56781ec7/c9b55/6.webp 165w,\n/static/953bcca7ab4fb23278ce657a56781ec7/f2908/6.webp 330w,\n/static/953bcca7ab4fb23278ce657a56781ec7/ff4b8/6.webp 602w\"\n              sizes=\"(max-width: 602px) 100vw, 602px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/953bcca7ab4fb23278ce657a56781ec7/04c57/6.png 165w,\n/static/953bcca7ab4fb23278ce657a56781ec7/d9ecf/6.png 330w,\n/static/953bcca7ab4fb23278ce657a56781ec7/32056/6.png 602w\"\n            sizes=\"(max-width: 602px) 100vw, 602px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/953bcca7ab4fb23278ce657a56781ec7/32056/6.png\"\n            alt=\"exploit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></p>\n<p>my-pass: new attacker</p>","categories":["writeup","wargame","pwnable"],"date":"February 05, 2016","description":"","id":"c5b25ef4-6bef-5d0e-b53a-abd59a7accdf","keywords":["lob"],"slug":"/Lord-of-BOF-WriteUp-12/","title":"LOB 12번 (golem -> darkknight)","readingTime":{"text":"3 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}