{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/WriteUp-Webhackingkr-07/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/ed4fdc83ed13d101714328b2e50a4200/bc51f/0.png","srcSet":"/static/ed4fdc83ed13d101714328b2e50a4200/41200/0.png 165w,\n/static/ed4fdc83ed13d101714328b2e50a4200/f979a/0.png 330w,\n/static/ed4fdc83ed13d101714328b2e50a4200/bc51f/0.png 660w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/ed4fdc83ed13d101714328b2e50a4200/322ad/0.webp 165w,\n/static/ed4fdc83ed13d101714328b2e50a4200/de3b3/0.webp 330w,\n/static/ed4fdc83ed13d101714328b2e50a4200/2b2b5/0.webp 660w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ed4fdc83ed13d101714328b2e50a4200/cecac/0.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABKElEQVR42q2SXU+DMBSGW0YLbYFpBnPsI4ExWOBKvDBzI1HDhnpjYjQx/v8f8poCRi9NxsWT97Rpnpy2h9TNCz4+v/D69o66ecZDfWqzun9ElKSYhgsEszmmsz7DRbcXLjENV5DjSwh3DOVeYLZYgZTlNaqqQlUdsNvtUddH1McT7vYH5HmBLNsiTTOk2bat43iNKE5QZDHyZIkyinB7UyLZJCiKHIQxDsdx4HkeOLcgpYJUCrYQELr+i1IQQnbYFmzOoDiHoxQYt+AHPkjz1CDZrEEIORvbkiDzYAVP+IMImSl1dgtK6NlCziQIpWSQ7lqh7tAYjUCNDqPPQYRapmvNWUI6yHVp/4bq91OGYGRYerAZTNPETwoh4LpuO+z/RZ9XSmIyucI3dRoKu6ybfUcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ed4fdc83ed13d101714328b2e50a4200/c9b55/0.webp 165w,\n/static/ed4fdc83ed13d101714328b2e50a4200/f2908/0.webp 330w,\n/static/ed4fdc83ed13d101714328b2e50a4200/cc661/0.webp 660w,\n/static/ed4fdc83ed13d101714328b2e50a4200/8cb3e/0.webp 728w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ed4fdc83ed13d101714328b2e50a4200/04c57/0.png 165w,\n/static/ed4fdc83ed13d101714328b2e50a4200/d9ecf/0.png 330w,\n/static/ed4fdc83ed13d101714328b2e50a4200/1f083/0.png 660w,\n/static/ed4fdc83ed13d101714328b2e50a4200/cecac/0.png 728w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ed4fdc83ed13d101714328b2e50a4200/1f083/0.png\"\n            alt=\"07\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>7번 문제는 이렇게 생겼다.</p>\n<p>auth 버튼을 누르면 다음과 같은 경고창이 뜬다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2838f5b219759bc153865cef49af7324/31aff/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZElEQVR42o2OTWsaYRSF33HeGapWYq3jF0kEg3WSMHW0KrGb1uYDxom4kCJdhGyrG/9Vob+mi7pJ7c53LLSlLoVS85RMQFpowQMPB86953LFYPiGbq9P5+yCF6/OeHl6jn3sYOUKpKwsjzO5DelsfkPKymHld0laWR4kdkgkU+G+aDWbNBsNWq0TOp0OnufTbj+n/qyBW6vjujVct47jPMU+PMK2j7APj3GrVZwn+5QLBdqOQ7lS4aBUQiQfJYnH4wgh6HZ9lAr4OJ1yc/OJ2ewzi8UXgmCBCgLmSjGfK5RSfP/2lYvz07D3MBZDl5JoNIpIpzNheIfv+9xp+WPJarVivV7zL/38dRu653n3XU0LPaLpCDMSQ9f1MBgMBmyjdx/g/RQue/2wp+vy/mAkdLH5sFgsMplMGI1GjMfj//L66i3D6zF7e7v82deEhjAMAyklpmn+NdwOA8OII2UMKaOYRoLfV0gRXiWvlaIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2838f5b219759bc153865cef49af7324/c9b55/1.webp 165w,\n/static/2838f5b219759bc153865cef49af7324/f2908/1.webp 330w,\n/static/2838f5b219759bc153865cef49af7324/cc661/1.webp 660w,\n/static/2838f5b219759bc153865cef49af7324/7fbc2/1.webp 823w\"\n              sizes=\"(max-width: 660px) 100vw, 660px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2838f5b219759bc153865cef49af7324/04c57/1.png 165w,\n/static/2838f5b219759bc153865cef49af7324/d9ecf/1.png 330w,\n/static/2838f5b219759bc153865cef49af7324/1f083/1.png 660w,\n/static/2838f5b219759bc153865cef49af7324/31aff/1.png 823w\"\n            sizes=\"(max-width: 660px) 100vw, 660px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2838f5b219759bc153865cef49af7324/1f083/1.png\"\n            alt=\"after click auth\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>view-source는 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../../config.php\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'view_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token function\">view_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token delimiter important\">?></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token variable\">$go</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'val'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0;url=index.php?val=1>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;html>&lt;head>&lt;title>admin page&lt;/title>&lt;/head>&lt;body bgcolor='black'>&lt;font size=2 color=gray>&lt;b>&lt;h3>Admin page&lt;/h3>&lt;/b>&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/2|-|\\+|from|_|=|\\\\s|\\*|\\//i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Access Denied!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token function\">dbconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$rand</span><span class=\"token operator\">=</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"query error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Access_Denied!')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">elseif</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Hello admin')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n&lt;a href=./?view_source=1>view-source<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>~ 첫번째 조건문</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$go</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'val'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0;url=index.php?val=1>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;html>&lt;head>&lt;title>admin page&lt;/title>&lt;/head>&lt;body bgcolor='black'>&lt;font size=2 color=gray>&lt;b>&lt;h3>Admin page&lt;/h3>&lt;/b>&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>val이라는 변수를 $_GET해서 $go라는 변수에 넣고, $go라는 변수가 없으면 val=1로 생성한다.</p>\n<p>그래서 초기 url이 <code class=\"language-text\">https://webhacking.kr/challenge/web-07/index.php?val=1</code>이었던 것으로 보인다.</p>\n<p>두번째 조건문</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/2|-|\\+|from|_|=|\\\\s|\\*|\\//i\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$go</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Access Denied!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>preg_match라는 함수는 정규식을 사용하여 문자열을 검색이 가능하다.</p>\n<p>$go 변수에 '2', '-', '+', 'from', '_', '=', ' ', '*', '/' 등이 검색되면 Access Denied라는 문구를 띄운다.</p>\n<p>이 조건문을 우회하려면 변수 val에 어떤 값을 입력할 때 위에서 언급된 것들을 피해야 한다.</p>\n<p>이 조건문을 우회하고 난 이후의 조건문들</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$db</span> <span class=\"token operator\">=</span> <span class=\"token function\">dbconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$rand</span><span class=\"token operator\">=</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span><span class=\"token operator\">==</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$result</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$db</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"select lv from chall7 where lv=(((((<span class=\"token interpolation\"><span class=\"token variable\">$go</span></span>)))))\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nice try!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>dbconnect()를 한 후 위의 다섯 조건문들 중 하나에 랜덤하게 들어간다.</p>\n<p>$go변수, 즉 val에 넣는 값이 그대로 where절에 들어가 쿼리를 실행하게 된다.</p>\n<p>그리고 그 쿼리의 결과를 $result변수에 넣는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token function\">mysqli_fetch_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"query error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Access_Denied!')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">elseif</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;input type=button style=border:0;bgcolor='gray' value='auth' onclick=\\\"alert('Hello admin')\\\">&lt;p>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>쿼리 결과가 담긴 $result를 array형태로 만들어 $data에 저장한다.</p>\n<p>data 배열의 맨 첫번째 요소, 즉 lv가 2가 되어야 이 문제를 풀 수 있다.</p>","categories":["writeup","wargame","webhacking"],"date":"February 08, 2020","description":"리뉴얼 기념 정주행","id":"a8ff128d-4d3c-55e1-997d-c492fcc64f1a","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-07/","title":"Webhacking.kr 7번","readingTime":{"text":"3 min read"}},"listingPagePath":"/blog/"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}