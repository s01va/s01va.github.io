{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/WriteUp-Webhackingkr-06/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"06\"></p>\n<p>view-source를 누르면 아래와 같은 코드를 볼 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../../config.php\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'view_source'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token function\">view_source</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"guest\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"123qwe\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token function\">Setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">86400</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/challenge/web-06/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">Setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"password\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">86400</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/challenge/web-06/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=refresh content=0>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Challenge 6<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\r\n<span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">background</span><span class=\"token punctuation\">:</span>black<span class=\"token punctuation\">;</span> <span class=\"token property\">color</span><span class=\"token punctuation\">:</span>white<span class=\"token punctuation\">;</span> <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span>10pt<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\r\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token variable\">$decode_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$decode_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;hr>&lt;a href=./?view_source=1 style=color:yellow;>view-source&lt;/a>&lt;br>&lt;br>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ID : <span class=\"token interpolation\"><span class=\"token variable\">$decode_id</span></span>&lt;br>PW : <span class=\"token interpolation\"><span class=\"token variable\">$decode_pw</span></span>&lt;hr>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$decode_id</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"admin\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$decode_pw</span><span class=\"token operator\">==</span><span class=\"token string double-quoted-string\">\"nimda\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">solve</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>쿠키에 담긴 변수를 대조하여 문제를 풀게 하고 있다.\r\n각 admin, nimda 문자열을 base64암호화를 20회 시킨 후, 위의 소스코드대로 문자열을 바꿔치기해주면 된다.</p>\n<p>위의 코드를 복사해서 약간 수정하여 php 샌드박스에 돌려 보았다.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">\r\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"nimda\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">20</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_id</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"!\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"@\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"3\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"$\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"4\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"^\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"5\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&amp;\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"6\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"*\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"7\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"(\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token variable\">$val_pw</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"8\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\")\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  \r\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"val_id = \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$val_id</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"val_pw = \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$val_pw</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token delimiter important\">?></span></span>\r\n</code></pre></div>\n<p>이 결과값들 각 쿠키 user, passwd에 넣고 새로고침 해주면 문제가 풀린다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"pwned\"></p>","categories":["writeup","wargame","webhacking"],"date":"February 08, 2020","description":"리뉴얼 기념 정주행","id":"866d0d62-56a7-5a0d-8f08-9a62be2cf1cc","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-06/","title":"Webhacking.kr 6번","readingTime":{"text":"2 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}