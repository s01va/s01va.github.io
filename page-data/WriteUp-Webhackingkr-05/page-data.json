{"componentChunkName":"component---node-modules-gatsby-theme-portfolio-minimal-src-templates-article-index-tsx","path":"/WriteUp-Webhackingkr-05/","result":{"pageContext":{"article":{"banner":{"alt":null,"caption":null,"src":null},"body":"<p><img src=\"./images/0.PNG\" alt=\"05\"></p>\n<p>login / join이 있다.</p>\n<p><img src=\"./images/1.PNG\" alt=\"join_denied\"></p>\n<p>join은 접근이 되지 않는다.</p>\n<p><img src=\"./images/2.PNG\" alt=\"login\"></p>\n<p>login 화면은 위와 같이 뜬다.</p>\n<p><img src=\"./images/3.PNG\" alt=\"try_login\"></p>\n<p><img src=\"./images/4.PNG\" alt=\"login failed\"></p>\n<p>위처럼 입력했더니 wrong password라고 뜬다. html 코드나 쿠키 등은 별 특이사항이 없었다.</p>\n<p>URL이 기존 문제들처럼 /web-[문제번호]/ 뒤에 /mem/ + login.php의 형태로 이루어져 있어\r\nlogin.php를 지운 /web-05/mem/으로 접속을 시도해 보았다.</p>\n<p><img src=\"./images/5.PNG\" alt=\"mem\"></p>\n<p>접속이 가능한 것을 볼 수 있다. 여기에서 join.php를 열어보는 시도를 해 보았다.</p>\n<p><img src=\"./images/6.PNG\" alt=\"bye\"></p>\n<p>이전과는 다르게 bye라는 알림창을 띄운다. 여기에서 html을 확인해 보았다.</p>\n<p><img src=\"./images/7.PNG\" alt=\"html\"></p>\n<p>위의 코드 중 <code class=\"language-text\">&lt;script></code> 파트만 가져와서 보면 아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">\r\nl<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">;</span>\r\nll<span class=\"token operator\">=</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">;</span>\r\nlll<span class=\"token operator\">=</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">;</span>\r\nllll<span class=\"token operator\">=</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">;</span>\r\nlllll<span class=\"token operator\">=</span><span class=\"token string\">'e'</span><span class=\"token punctuation\">;</span>\r\nllllll<span class=\"token operator\">=</span><span class=\"token string\">'f'</span><span class=\"token punctuation\">;</span>\r\nlllllll<span class=\"token operator\">=</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">;</span>\r\nllllllll<span class=\"token operator\">=</span><span class=\"token string\">'h'</span><span class=\"token punctuation\">;</span>\r\nlllllllll<span class=\"token operator\">=</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">;</span>\r\nllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'j'</span><span class=\"token punctuation\">;</span>\r\nlllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'k'</span><span class=\"token punctuation\">;</span>\r\nllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'l'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'m'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'n'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'p'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'q'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'r'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'s'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'t'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'u'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'v'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">;</span>\r\nlllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">;</span>\r\nllllllllllllllllllllllllll<span class=\"token operator\">=</span><span class=\"token string\">'z'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">I</span><span class=\"token operator\">=</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">II</span><span class=\"token operator\">=</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">III</span><span class=\"token operator\">=</span><span class=\"token string\">'3'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIII</span><span class=\"token operator\">=</span><span class=\"token string\">'4'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'5'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'6'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'7'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'8'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'9'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">IIIIIIIIII</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>\r\nli<span class=\"token operator\">=</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">;</span>\r\nii<span class=\"token operator\">=</span><span class=\"token string\">'&lt;'</span><span class=\"token punctuation\">;</span>\r\niii<span class=\"token operator\">=</span><span class=\"token string\">'>'</span><span class=\"token punctuation\">;</span>\r\nlIllIllIllIllIllIllIllIllIllIl<span class=\"token operator\">=</span>lllllllllllllll<span class=\"token operator\">+</span>llllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>llllllllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>ll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>lllll<span class=\"token punctuation\">;</span>\r\n\r\nlIIIIIIIIIIIIIIIIIIl<span class=\"token operator\">=</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllllll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>lllll<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>lIIIIIIIIIIIIIIIIIIl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lIllIllIllIllIllIllIllIllIllIl<span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bye'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">throw</span> <span class=\"token string\">\"stop\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span><span class=\"token string\">'U'</span><span class=\"token operator\">+</span><span class=\"token string\">'R'</span><span class=\"token operator\">+</span><span class=\"token string\">'L'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span><span class=\"token string\">'='</span><span class=\"token operator\">+</span><span class=\"token constant\">I</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'access_denied'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">throw</span> <span class=\"token string\">\"stop\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;font size=2 color=white>Join&lt;/font>&lt;p>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.&lt;p>.&lt;p>.&lt;p>.&lt;p>.&lt;p>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;form method=post action='</span><span class=\"token operator\">+</span>llllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span>llllllllllllllll<span class=\"token operator\">+</span>llllllll<span class=\"token operator\">+</span>llllllllllllllll\r\n<span class=\"token operator\">+</span><span class=\"token string\">'>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;table border=1>&lt;tr>&lt;td>&lt;font color=gray>id&lt;/font>&lt;/td>&lt;td>&lt;input type=text name='</span><span class=\"token operator\">+</span>lllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span><span class=\"token string\">' maxlength=20>&lt;/td>&lt;/tr>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;tr>&lt;td>&lt;font color=gray>pass&lt;/font>&lt;/td>&lt;td>&lt;input type=text name='</span><span class=\"token operator\">+</span>llllllllllllllll<span class=\"token operator\">+</span>lllllllllllllllllllllll<span class=\"token operator\">+</span><span class=\"token string\">'>&lt;/td>&lt;/tr>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tdocument<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;tr align=center>&lt;td colspan=2>&lt;input type=submit>&lt;/td>&lt;/tr>&lt;/form>&lt;/table>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p>이 코드를 보고 bye나 access_denied가 아닌 pass를 띄우기 위해 맞춰주어야 할 조건들이 위에 명시되어 있다.</p>\n<p>첫번째 조건:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>lIIIIIIIIIIIIIIIIIIl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lIllIllIllIllIllIllIllIllIllIl<span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>두번째 조건:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">eval</span><span class=\"token punctuation\">(</span>llll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>lll<span class=\"token operator\">+</span>lllllllllllllllllllll<span class=\"token operator\">+</span>lllllllllllll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span>llllllllllllll<span class=\"token operator\">+</span>llllllllllllllllllll<span class=\"token operator\">+</span>li<span class=\"token operator\">+</span><span class=\"token string\">'U'</span><span class=\"token operator\">+</span><span class=\"token string\">'R'</span><span class=\"token operator\">+</span><span class=\"token string\">'L'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>lllllllllllll<span class=\"token operator\">+</span>lllllllllllllll<span class=\"token operator\">+</span>llll<span class=\"token operator\">+</span>lllll<span class=\"token operator\">+</span><span class=\"token string\">'='</span><span class=\"token operator\">+</span><span class=\"token constant\">I</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이 두 조건을 피해주면 된다.</p>\n<p><code class=\"language-text\">eval()</code> 함수는 문자열을 코드화 시켜주는 함수이다.\r\n웹 브라우저의 개발자 도구에서 콘솔 기능을 사용하여 위의 코드를 분석한다.</p>\n<p><img src=\"./images/8.PNG\" alt=\"var\"></p>\n<p>먼저 변수와 관련된 모든 부분을 입력해 준다.\r\n그리고 첫번째 조건 속 문자들이 무엇인지 조사했다.</p>\n<p><code class=\"language-text\">eval(lIIIIIIIIIIIIIIIIIIl)</code>의 <code class=\"language-text\">lIIIIIIIIIIIIIIIIIIl</code></p>\n<p><img src=\"./images/9.PNG\" alt=\"document.cookie\"></p>\n<p><code class=\"language-text\">indexOf(lIllIllIllIllIllIllIllIllIllIl)</code>의 <code class=\"language-text\">lIllIllIllIllIllIllIllIllIllIl</code></p>\n<p><img src=\"./images/10.PNG\" alt=\"oldzombie\"></p>\n<p>쿠키 중 oldzombie라는 이름을 가진 쿠키가 있으면 첫번째 조건을 우회할 수 있다.</p>\n<p><img src=\"./images/11.PNG\" alt=\"make_cookie_oldzombie\"></p>\n<p>첫번째 조건을 우회하여 bye가 아닌 access_denied가 뜨는 것을 볼 수 있다.</p>\n<p><img src=\"./images/12.PNG\" alt=\"access_denied\"></p>\n<p>두번째 조건 속 문자들이 무엇인지 조사했다.</p>\n<p><code class=\"language-text\">eval(llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+'U'+'R'+'L')</code>의\r\n<code class=\"language-text\">llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+'U'+'R'+'L'</code></p>\n<p><img src=\"./images/13.PNG\" alt=\"document.URL\"></p>\n<p><code class=\"language-text\">indexOf(lllllllllllll+lllllllllllllll+llll+lllll+'='+I)==-1)</code>의 <code class=\"language-text\">lllllllllllll+lllllllllllllll+llll+lllll+'='+I)==-1</code></p>\n<p><img src=\"./images/14.PNG\" alt=\"mode=1\"></p>\n<p>URL에 mode라는 변수를 넣으면 두번째 조건을 우회할 수 있다.</p>\n<p><img src=\"./images/15.PNG\" alt=\"Join\"></p>\n<p>두 조건을 모두 우회하여 Join이라는 문자열과 함께 가입 양식을 받을 수 있다.</p>\n<p><img src=\"./images/16.PNG\" alt=\"Join2\"></p>\n<p>아무 값이나 입력했다.(admin라고 입력하면 이미 존재하는 id라고 한다.)</p>\n<p><img src=\"./images/17.PNG\" alt=\"signup\"></p>\n<p><img src=\"./images/18.PNG\" alt=\"login\"></p>\n<p>로그인 페이지로 돌아가 join에서 입력했던 id와 패스워드를 입력하면 admin으로 로그인 할 수 있는 권한이 주어진다.</p>\n<p>join 페이지로 돌아가 admin 앞에 공백을 추가하고 가입을 시도해 보았다.</p>\n<p><img src=\"./images/19.PNG\" alt=\"join  admin\"></p>\n<p><img src=\"./images/20.PNG\" alt=\"success\"></p>\n<p>공백+admin으로 sign up하는데 성공했다.</p>\n<p><img src=\"./images/21.PNG\" alt=\"login s01va\"></p>\n<p>s01va로 로그인한 후 공백+admin으로 로그인을 시도했다.</p>\n<p><img src=\"./images/22.PNG\" alt=\"login success\"></p>\n<p><img src=\"./images/23.PNG\" alt=\"pwned\"></p>","categories":["writeup","wargame","webhacking"],"date":"February 11, 2020","description":"리뉴얼 기념 정주행","id":"7317edbe-bb35-5a6d-b1d3-2d1601848991","keywords":["webhacking.kr"],"slug":"/WriteUp-Webhackingkr-05/","title":"Webhacking.kr 5번","readingTime":{"text":"4 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["1094019748","460736852"],"slicesMap":{}}